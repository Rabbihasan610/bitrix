
; /* Start:"a:4:{s:4:"full";s:97:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/script.min.js?169925794962259";s:6:"source";s:77:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/script.js";s:3:"min";s:81:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/script.min.js";s:3:"map";s:81:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/script.map.js";}"*/
BX.namespace("BX.Main");if(typeof BX.Main.interfaceButtons==="undefined"){BX.Main.interfaceButtons=function(t,e){this.classItem="main-buttons-item";this.classItemSublink="main-buttons-item-sublink";this.classItemText="main-buttons-item-text";this.classItemCounter="main-buttons-item-counter";this.classItemIcon="main-buttons-item-icon";this.classItemMore="main-buttons-item-more";this.classOnDrag="main-buttons-drag";this.classDropzone="main-buttons-submenu-dropzone";this.classSeparator="main-buttons-submenu-delimiter";this.classHiddenLabel="main-buttons-hidden-label";this.classSubmenuItem="main-buttons-submenu-item";this.classItemDisabled="main-buttons-disabled";this.classItemOver="--over";this.classMenuShown="--menu-shown";this.classItemActive="main-buttons-item-active";this.classSubmenu="main-buttons-submenu";this.classSecret="secret";this.classItemLocked="--locked";this.classExtraItemLink="";this.classExtraItemText="";this.classExtraItemIcon="";this.classExtraItemCounter="";this.submenuIdPrefix="main_buttons_popup_";this.childMenuIdPrefix="main_buttons_popup_child_";this.submenuWindowIdPrefix="menu-popup-";this.classSettingMenuItem="main-buttons-submenu-setting";this.classEditState="main-buttons-edit";this.classEditItemButton="main-buttons-item-edit-button";this.classDragItemButton="main-buttons-item-drag-button";this.classSettingsApplyButton="main-buttons-submenu-settings-apply";this.classSettingsResetButton="main-buttons-submenu-settings-reset";this.classSetHome="main-buttons-set-home";this.classSetHide="main-buttons-set-hide";this.classManage="main-buttons-manage";this.classContainer="main-buttons";this.classSubmenuNoHiddenItem="main-buttons-submenu-item-no-hidden";this.classDefaultSubmenuItem="menu-popup-item";this.classDefaultSubmenuDelimimeter="popup-window-delimiter-section";this.classInner="main-buttons-inner-container";this.listContainer=null;this.dragItem=null;this.overItem=null;this.moreButton=null;this.messages=null;this.licenseParams=null;this.ajaxSettings=null;this.enableItemMouseEnter=true;this.menuShowTimeout=null;this.isMoreMenuShown=false;this.onDragStarted=false;this.isSettingsEnabled=true;this.containerId=e.containerId;this.isEditEnabledState=false;this.theme=BX.Type.isStringFilled(e.theme)?e.theme:"default";this.maxItemLength=BX.Type.isNumber(e.maxItemLength)&&e.maxItemLength>6?e.maxItemLength:20;this.tmp={};this.itemData=new WeakMap;this.handleMoreMenuItemMouseEnter=this.handleMoreMenuItemMouseEnter.bind(this);this.init(t,e);return{getItemById:this.getItemById.bind(this),getAllItems:this.getAllItems.bind(this),getHiddenItems:this.getHiddenItems.bind(this),getVisibleItems:this.getVisibleItems.bind(this),getDisabledItems:this.getDisabledItems.bind(this),getMoreButton:this.getMoreButton.bind(this),adjustMoreButtonPosition:this.adjustMoreButtonPosition.bind(this),getItemData:this.getItemData.bind(this),getSubmenu:this.getMoreMenu.bind(this),showSubmenu:this.showMoreMenu.bind(this),closeSubmenu:this.closeMoreMenu.bind(this),refreshSubmenu:this.refreshMoreMenu.bind(this),getMoreMenu:this.getMoreMenu.bind(this),showMoreMenu:this.showMoreMenu.bind(this),closeMoreMenu:this.closeMoreMenu.bind(this),refreshMoreMenu:this.refreshMoreMenu.bind(this),getCurrentSettings:this.getCurrentSettings.bind(this),saveSettings:this.saveSettings.bind(this),updateCounter:this.updateCounter.bind(this),getActive:this.getActive.bind(this),isDisabled:this.isDisabled.bind(this),isVisibleItem:this.isVisibleItem.bind(this),isEditEnabled:this.isEditEnabled.bind(this),isActiveInMoreMenu:this.isActiveInMoreMenu.bind(this),isSettingsEnabled:this.isSettingsEnabled,classes:{item:this.classItem,itemText:this.classItemText,itemCounter:this.classItemCounter,itemIcon:this.classItemIcon,itemDisabled:this.classItemDisabled,itemOver:this.classItemOver,itemActive:this.classItemActive,itemLocked:this.classItemLocked,menuShown:this.classMenuShown,submenu:this.classSubmenu,submenuItem:this.classSubmenuItem,containerOnDrag:this.classOnDrag,classSettingMenuItem:this.classSettingMenuItem},itemsContainer:this.listContainer,itemsContainerId:this.listContainer.id}};BX.Main.interfaceButtons.prototype={init:function(t,e){this.listContainer=BX(this.getId());if(!BX.Type.isPlainObject(e)){throw"BX.MainButtons: params is not Object"}if(!("containerId"in e)||!BX.Type.isStringFilled(e.containerId)){throw"BX.MainButtons: containerId not set in params"}if(!BX.Type.isDomNode(this.listContainer)){throw"BX.MainButtons: #"+e.containerId+" is not dom node"}if("classes"in e&&BX.Type.isPlainObject(e.classes)){this.setCustomClasses(e.classes)}if("messages"in e&&BX.Type.isPlainObject(e.messages)){this.setMessages(e.messages)}if("licenseWindow"in e&&BX.Type.isPlainObject(e.licenseWindow)){this.setLicenseWindowParams(e.licenseWindow)}if("disableSettings"in e&&e.disableSettings==="true"){this.isSettingsEnabled=false;this.visibleControlMoreButton()}this.initSaving(e.ajaxSettings);this.moreButton=this.getMoreButton();this.listChildItems={};this.initItems();this.adjustMoreButtonPosition();this.bindEventsOnMoreButton();this.bindOnResizeFrame();BX.Event.bind(this.getContainer(),"click",BX.delegate(this._onDocumentClick,this));BX.addCustomEvent("onPullEvent-main",BX.delegate(this._onPush,this));this.updateMoreButtonCounter();if(this.isActiveInMoreMenu()){this.activateItem(this.moreButton)}const s=this.getHomeItem();if(s){const{url:t}=s;this.lastHomeLink=t}const i=Array.from(this.container.querySelectorAll(".main-buttons-item-child-button"));i.forEach((function(t){const e=t.closest(".main-buttons-item-child");if(e.dataset.isOpened){this.realChildButton=e;const t=e.closest(".main-buttons-item-child-button-cloned");if(t){this.clonedChildButton=t}}BX.Event.bind(t,"click",this.onShowChildButtonClick.bind(this))}),this)},calculateChildListWidth:function(){if(this.realChildButton){const t=this.realChildButton.querySelectorAll(".main-buttons-item-child-list-inner .main-buttons-item");const e=10;return Array.from(t).reduce((function(t,e){const s=BX.Text.toNumber(BX.Dom.style(e,"width"));const i=BX.Text.toNumber(BX.Dom.style(e,"margin-left"));const n=BX.Text.toNumber(BX.Dom.style(e,"margin-right"));return t+s+i+n}),e)}return 0},onShowChildButtonClick:function(t){t.preventDefault();if(!this.realChildButton){this.realChildButton=t.currentTarget.closest(".main-buttons-item-child")}const e=this.realChildButton.querySelector(".main-buttons-item-child-list");this.enableItemMouseEnter=false;setTimeout((()=>{this.enableItemMouseEnter=true}),200);const s=BX.Dom.attr(this.realChildButton,"data-child-items");const i=BX.Dom.attr(this.realChildButton,"data-is-opened");let n={};if(i){BX.Dom.attr(this.realChildButton,"data-is-opened",null);s.forEach((function(t){const e=this.getContainer().querySelector('[data-id="'+t+'"]');BX.Dom.style(e,"display",null);if(t.hasOwnProperty("PARENT_ITEM_ID")){n[t["PARENT_ITEM_ID"]]="N"}}),this);if(this.clonedChildButton){BX.Dom.remove(this.clonedChildButton)}BX.Dom.style(e,{overflow:null,"max-width":null});n=JSON.stringify(n);this.saveOptions("expanded_lists",n)}else{BX.Dom.attr(this.realChildButton,"data-is-opened",true);BX.Dom.style(e,"max-width",this.calculateChildListWidth()+"px");this.cloneChildButton(this.realChildButton);s.forEach((t=>{const e=this.getContainer().querySelector('[data-id="'+t+'"]');BX.Dom.insertBefore(e,this.realChildButton);BX.Dom.style(e,"display","inline-block");if(t.hasOwnProperty("PARENT_ITEM_ID")){n[t["PARENT_ITEM_ID"]]="Y"}}));setTimeout((()=>{BX.Dom.style(e,"overflow","unset")}),200);n=JSON.stringify(n);this.saveOptions("expanded_lists",n)}setTimeout((()=>{this._onResizeHandler()}),200)},cloneChildButton:function(t){this.clonedChildButton=BX.Runtime.clone(t);const e=this.clonedChildButton.querySelector(".main-buttons-item-child-list");if(e){BX.Dom.remove(e)}BX.Dom.addClass(this.clonedChildButton,"main-buttons-item-child-button-cloned");BX.Dom.style(this.clonedChildButton,"transition","none");BX.Dom.insertBefore(this.clonedChildButton,t);BX.Event.bind(this.clonedChildButton,"click",this.onShowChildButtonClick.bind(this));setTimeout((()=>{BX.Dom.style(this.clonedChildButton,"transition",null)}),0)},_onDocumentClick:function(t){if(this.isDragButton(t.target)){t.preventDefault();t.stopPropagation()}let e=this.getItem(t);if(BX.Type.isDomNode(e)){if(this.isSettings(e)){this.enableEdit();return false}if(this.isApplySettingsButton(e)){t.preventDefault();t.stopPropagation();this.disableEdit();return false}if(this.isResetSettingsButton(e)){this.resetSettings();return false}if(this.isEditButton(t.target)){this.handleEditButtonClick(t);return false}if(this.isSetHide(e)){const t=this.getVisibleItems();const e=BX.Type.isArray(t)?t.length:null;const s=this.editItemData.ID.replace(this.listContainer.id+"_","");let i=this.getItemById(s);const n=this.getItemAlias(i);i=this.isVisibleItem(i)?i:n;if(this.isDisabled(n)){this.enableItem(n)}else if(!this.isDisabled(n)&&e>2){this.disableItem(n)}if(e===1){BX.onCustomEvent(window,"BX.Main.InterfaceButtons:onHideLastVisibleItem",[i,this])}this.refreshMoreMenu();this.saveSettings();this.adjustMoreButtonPosition();if(this.isEditEnabled()){this.enableEdit()}this.editMenu.popupWindow.close();return false}if(this.isSetHome(e)){const t=this.editItemData.ID.replace(this.listContainer.id+"_","");const e=this.getItemById(t);const s=this.getItemAlias(e);if(this.isDisabled(s)){this.enableItem(s)}this.listContainer.insertBefore(e,BX.firstChild(this.listContainer));this.adjustMoreButtonPosition();this.refreshMoreMenu();this.saveSettings();if(this.isEditEnabled()){this.enableEdit()}this.editMenu.popupWindow.close();return false}if(!this.isDragButton(t.target)&&!this.isEditButton(t.target)){const s=this.getItemData(e);let i=s["ON_CLICK"];if(this.isSublink(t.target)){i=BX.Type.isPlainObject(s["SUB_LINK"])?s["SUB_LINK"]["ON_CLICK"]:""}if(BX.Type.isStringFilled(i)){t.preventDefault();this.execScript(i,t)}}}if(this.isEditEnabled()&&this.getMoreMenu()){this.getMoreMenu().getPopupWindow().setAutoHide(false)}},isActiveInMoreMenu:function(){const t=this.getHiddenItems();const e=this.getDisabledItems();const s=t.concat(e);return s.some((function(t){const e=this.getItemData(t);return e["IS_ACTIVE"]===true}),this)},_onPush:function(t,e){if(t==="user_counter"&&e&&BX.message("SITE_ID")in e){const t=e[BX.message("SITE_ID")];for(const e in t){if(t.hasOwnProperty(e)){this.updateCounter(e,t[e])}}}},getActive:function(){let t=this.getAllItemsData();let e=null;let s=null;while(BX.Type.isArrayFilled(t)){const i=t.shift();if(i["IS_ACTIVE"]===true){if(s===null){s=i}e=i;t=BX.Type.isArrayFilled(i["ITEMS"])?[...i["ITEMS"]]:null}}if(e!==null&&s!==null){const t=BX(s.ID);if(BX.Type.isDomNode(t)){e.NODE=t}else{e.NODE=null}}return e},isSetHome:function(t){return BX.Dom.hasClass(t,this.classSetHome)},isSetHide:function(t){return BX.Dom.hasClass(t,this.classSetHide)},getSettingsButton:function(){return BX.Buttons.Utils.getByClass(this.getMoreMenuContainer(),this.classSettingMenuItem)},getSettingsApplyButton:function(){return BX.Buttons.Utils.getByClass(this.getMoreMenuContainer(),this.classSettingsApplyButton)},isApplySettingsButton:function(t){return BX.Dom.hasClass(t,this.classSettingsApplyButton)},enableEdit:function(){const t=this.getMoreMenu();if(t){const e=t.getPopupWindow();e.setAutoHide(false);BX.Dom.addClass(e.getPopupContainer(),this.classEditState)}BX.Dom.addClass(this.listContainer,this.classEditState);this.isEditEnabledState=true},disableEdit:function(){const t=this.getMoreMenu();if(t){const e=t.getPopupWindow();e.setAutoHide(true);BX.Dom.removeClass(e.getPopupContainer(),this.classEditState)}BX.Dom.removeClass(this.listContainer,this.classEditState);this.isEditEnabledState=false;this.destroyItemEditMenu()},isEditEnabled:function(){return this.isEditEnabledState},showItemEditMenu:function(t,e){if(BX.Type.isPlainObject(t)&&"ID"in t){const s=[this.listContainer.id,"_edit_item"].join("");let i=BX.Main.MenuManager.getMenuById(s);if(i){BX.Main.MenuManager.destroy(s)}i=this.createItemEditMenu(t,s,e);i.popupWindow.show()}},destroyItemEditMenu:function(){const t=[this.listContainer.id,"_edit_item"].join("");const e=BX.Main.MenuManager.getMenuById(t);if(e){BX.Main.MenuManager.destroy(t)}},getContainer:function(){if(!BX.Type.isDomNode(this.container)){this.container=BX(this.containerId).parentNode.parentNode}return this.container},getItemEditMenu:function(){return BX.Main.MenuManager.getMenuById([this.listContainer.id,"_edit_item"].join(""))},createItemEditMenu:function(t,e,s){const i=[{text:this.message("MIB_SET_HOME"),className:"main-buttons-set-home menu-popup-no-icon"}];const n=t["ID"].replace(this.listContainer.id+"_","");const o=this.getItemById(n);if(this.isDisabled(o)){i.push({text:this.message("MIB_SET_SHOW"),className:"main-buttons-set-hide menu-popup-no-icon"})}else{i.push({text:this.message("MIB_SET_HIDE"),className:"main-buttons-set-hide menu-popup-no-icon"})}if(t["IS_PINNED"]){const e=this.getParentItem(t["ID"]);i.push({text:this.message("MIB_UNPIN_ITEM").replace("#NAME#",e?e["TEXT"]:""),onclick:(e,s)=>{this.handleItemUnpin(t,o);s.getMenuWindow().close()}})}const a=BX.pos(s);const u={menuId:e,anchor:s,menuItems:i,settings:{autoHide:true,offsetTop:0,offsetLeft:a.width/2,zIndex:20,angle:{position:"top",offset:a.width/2}}};const r=BX.Main.MenuManager.create(u.menuId,u.anchor,u.menuItems,u.settings);if(this.isVisibleItem(o)){t.NODE=o}else{t.NODE=this.getItemAlias(o)}this.editItemData=t;if("menuItems"in r&&BX.Type.isArray(r.menuItems)){r.menuItems.forEach((function(t){BX.Event.bind(t.layout.item,"click",BX.delegate(this._onDocumentClick,this))}),this)}BX.onCustomEvent(window,"BX.Main.InterfaceButtons:onBeforeCreateEditMenu",[r,t,this]);this.editMenu=r;return r},setHome:function(){const t=this.getHomeItem();if(!t){return}const{itemData:e,url:s,firstVisibleItem:i}=t;if(!e){return}if(this.lastHomeLink!==s){this.saveOptions("firstPageLink",s);BX.onCustomEvent("BX.Main.InterfaceButtons:onFirstItemChange",[s,i])}this.lastHomeLink=s},getHomeItem:function(){const t=this.getVisibleItems();const e=BX.Type.isArray(t)&&t.length>0?t[0]:null;if(!e){return null}const s=this.getItemData(e);const i=this.normalizeUrl(s["URL"]);if(this.canBeHomed(i,s)){return{itemData:s,url:i,firstVisibleItem:e}}if(BX.Type.isArrayFilled(s["ITEMS"])){for(let t=0;t<s["ITEMS"].length;t++){const i=s["ITEMS"][t];if(i["IS_PINNED"]||i["IS_DISBANDED"]||i["IS_DELIMITER"]){continue}const n=this.normalizeUrl(i["URL"]);if(this.canBeHomed(n,i)){return{itemData:i,url:n,firstVisibleItem:e}}}}return null},normalizeUrl:function(t){if(!BX.Type.isStringFilled(t)){return""}if(t.charAt(0)==="?"){const e=document.createElement("a");e.href=t;t=e.pathname+e.search}return t},canBeHomed:function(t,e){if(!BX.Type.isStringFilled(t)||BX.Type.isStringFilled(e["ON_CLICK"])){return false}if(BX.Reflection.getClass("BX.SidePanel.Instance")){const e=BX.SidePanel.Instance.getUrlRule(t);if(e){return false}}const s=new BX.Event.BaseEvent({data:{itemLink:t,itemData:e}});BX.Event.EventEmitter.emit("BX.Main.InterfaceButtons:onBeforeFirstItemChange",s);return!s.isDefaultPrevented()},isEditButton:function(t){return BX.Dom.hasClass(t,this.classEditItemButton)},isDragButton:function(t){return BX.Dom.hasClass(t,this.classDragItemButton)},isResetSettingsButton:function(t){return BX.Dom.hasClass(t,this.classSettingsResetButton)},getContainerHeight:function(){const t=this.getAllItems().map((function(t){const e=getComputedStyle(t);return BX.height(t)+parseInt(e.marginTop)+parseInt(e.marginBottom)}));return Math.max.apply(Math,t)},setLicenseWindowParams:function(t){this.licenseParams=t||{}},message:function(t){let e;try{e=this.messages[t]}catch(t){e=""}return e},setCustomClasses:function(t){if(!BX.Type.isPlainObject(t)){return}this.classItem=t.item||this.classItem;this.classItemSublink=t.itemSublink||this.classItemSublink;this.classItemText=t.itemText||this.classItemText;this.classItemCounter=t.itemCounter||this.classItemCounter;this.classItemIcon=t.itemIcon||this.classItemIcon;this.classItemMore=t.itemMore||this.classItemMore;this.classItemOver=t.itemOver||this.classItemOver;this.classMenuShown=t.menuShown||this.classMenuShown;this.classItemActive=t.itemActive||this.classItemActive;this.classItemDisabled=t.itemDisabled||this.classItemDisabled;this.classOnDrag=t.onDrag||this.classOnDrag;this.classDropzone=t.dropzone||this.classDropzone;this.classSeparator=t.separator||this.classSeparator;this.classSubmenuItem=t.submenuItem||this.classSubmenuItem;this.classSubmenu=t.submenu||this.classSubmenu;this.classSecret=t.secret||this.classSecret;this.classItemLocked=t.itemLocked||this.classItemLocked;this.classExtraItemLink=t.extraItemLink||this.classExtraItemLink;this.classExtraItemText=t.extraItemText||this.classExtraItemText;this.classExtraItemIcon=t.extraItemIcon||this.classExtraItemIcon;this.classExtraItemCounter=t.extraItemCounter||this.classExtraItemCounter},setMessages:function(t){if(!BX.Type.isPlainObject(t)){return}this.messages=t},makeFullItemId:function(t){if(!BX.Type.isStringFilled(t)){return}return[this.listContainer.id,t.replace("-","_")].join("_")},getItemById:function(t){let e=null;if(BX.Type.isStringFilled(t)){const s=t.startsWith(this.listContainer.id)?t:this.makeFullItemId(t);e=BX.Buttons.Utils.getBySelector(this.listContainer,"#"+s.replaceAll(":","\\:"))}return e},getItemCounterObject:function(t){let e=null;if(BX.Type.isDomNode(t)){e=BX.Buttons.Utils.getByClass(t,this.classItemCounter)}return e},updateCounter:function(t,e){if(t.indexOf("crm")===0&&e<0){return}this.updateItemsByCounterId(this.getAllItemsData(),t,e);this.updateMoreButtonCounter()},updateItemsByCounterId:function(t,e,s,i=[]){for(let n=0;n<t.length;n++){const o=t[n];if(o["COUNTER_ID"]===e){o["COUNTER"]=Number(s);this.setCounterValueById(e,o["COUNTER"]);for(let t=i.length-1;t>=0;t--){const e=i[t];e["COUNTER"]=e["ITEMS"].reduce(((t,e)=>{const s=e["IS_PINNED"]===true;const i=BX.Type.isNumber(e["COUNTER"])&&!s?e["COUNTER"]:0;return t+i}),0);this.setCounterValueById(e["COUNTER_ID"],e["COUNTER"])}}if(o["ITEMS"]){this.updateItemsByCounterId(o["ITEMS"],e,s,[...i,o])}}},recalculateItemsCounters:function(t,e=[]){let s=0;for(let i=0;i<t.length;i++){const n=t[i];if(n["ITEMS"]){n["COUNTER"]=this.recalculateItemsCounters(n["ITEMS"],[...e,n])}const o=n["IS_PINNED"]===true;s+=BX.Type.isNumber(n["COUNTER"])&&!o?n["COUNTER"]:0}for(let t=e.length-1;t>=0;t--){const s=e[t];s["COUNTER"]=s["ITEMS"].reduce(((t,e)=>{const s=e["IS_PINNED"]===true;const i=BX.Type.isNumber(e["COUNTER"])&&!s?e["COUNTER"]:0;return t+i}),0);this.setCounterValueById(s["COUNTER_ID"],s["COUNTER"])}return s},setCounterValueById:function(t,e){if(!BX.Type.isStringFilled(t)){return}const s=e>99?"99+":e>0?e:"";const i=document.querySelectorAll(`[data-mib-counter-id="${t}"]`);Array.from(i).forEach((t=>{t.textContent=s}))},setMoreButtonCounter:function(t){const e=this.getItemCounterObject(this.moreButton);e.textContent=t>99?"99+":t>0?t:""},bindEventsOnMoreButton:function(){BX.Event.bind(this.moreButton,"click",this.handleMoreButtonClick.bind(this));BX.Event.bind(this.moreButton,"mouseenter",this.handleMoreButtonMouseEnter.bind(this));BX.Event.bind(this.moreButton,"mouseleave",this.handleMoreButtonMouseLeave.bind(this))},bindOnResizeFrame:function(){window.frames["maininterfacebuttonstmpframe-"+this.getId()].onresize=BX.throttle(this._onResizeHandler,20,this)},getId:function(){return BX.Buttons.Utils.getByClass(this.getContainer(),this.classInner).id},getAllItems:function(){return BX.Buttons.Utils.getByClass(this.listContainer,this.classItem,true)},getAllItemsData:function(){return this.getAllItems().map((t=>this.getItemData(t)))},getVisibleItems:function(){const t=this.getAllItems();let e=[];if(t&&t.length){e=t.filter((t=>this.isVisibleItem(t)&&!this.isDisabled(t)))}return e},getHiddenItems:function(){const t=this.getAllItems();let e=[];if(t&&t.length){e=t.filter((t=>!this.isVisibleItem(t)&&!this.isDisabled(t)))}return e},getDisabledItems:function(){return this.getAllItems().filter((t=>this.isDisabled(t)))},getMoreButton:function(){const t=this.getContainer().getElementsByClassName(this.classItemMore);return t[0]||null},getLastVisibleItem:function(){const t=this.getVisibleItems();let e=null;if(BX.Type.isArray(t)&&t.length){e=t[t.length-1]}if(!BX.Type.isDomNode(e)){e=null}return e},getLastDisabledItem:function(){const t=this.getDisabledItems();let e=null;if(BX.Type.isArray(t)&&t.length){e=t[t.length-1]}if(!BX.Type.isDomNode(e)){e=null}return e},adjustMoreButtonPosition:function(){this.updateMoreButtonCounter();if(this.getMoreMenu()){this.getMoreMenu().getPopupWindow().adjustPosition()}},getMoreMenuId:function(t){let e="";if(BX.Type.isDomNode(this.listContainer)&&BX.Type.isStringFilled(this.listContainer.id)){e=this.submenuIdPrefix+this.listContainer.id}if(t){e=this.submenuWindowIdPrefix+e}return e},getChildMenuId:function(){let t="";if(BX.Type.isDomNode(this.listContainer)&&BX.Type.isStringFilled(this.listContainer.id)){t=this.childMenuIdPrefix+this.listContainer.id}return t},getMenuItemText:function(t,e=null){const s=BX.Type.isElementNode(t)?this.getItemData(t):t;return BX.Tag.render`
				<span class="main-buttons-menu-popup-item">${[BX.Tag.render`<span class="${this.classItemIcon}"></span>`,this.createItemText(s),this.createItemCounter(s),e&&this.isEditEnabled()?this.createItemPin(s,e):""]}</span>
			`},createRootItem:function(t){let e=this.classItem;e+=BX.Type.isStringFilled(t["CLASS"])?" "+t["CLASS"]:"";if(t["IS_PASSIVE"]){e+=" --passive"}else if(t["IS_ACTIVE"]){if(BX.Type.isStringFilled(this.classItemActive)){e+=" "+this.classItemActive}else{e+=" main-buttons-item-active"}}if(t["HAS_MENU"]){e+=" --has-menu"}if(t["IS_LOCKED"]){e+=" --locked"}const s=BX.Tag.render`
				<div
					id="${t["ID"]}"
					class="${e}"
					data-disabled="${t["IS_DISABLED"]}"
					data-class="${t["CLASS_SUBMENU_ITEM"]}"
					data-id="${t["DATA_ID"]}"
					data-top-menu-id="${this.getId()}"
					title=""
				>${[this.createItemLink(t,true),BX.Type.isPlainObject(t["SUB_LINK"])?this.createItemSubLink(t["SUB_LINK"]):""]}</div>
			`;this.setItemData(s,t);return s},createItemLink:function(t,e=false){t=BX.Type.isPlainObject(t)?t:{};let s;const i=["main-buttons-item-link",this.classExtraItemLink].join(" ").trim();if(BX.Type.isStringFilled(t["URL"])){s=BX.Tag.render`<a class="${i}" href="${BX.Text.encode(t["URL"])}"></a>`}else{s=BX.Tag.render`<span class="${i}"></span>`}BX.Dom.append(this.createItemIcon(t),s);BX.Dom.append(this.createItemText(t,e),s);BX.Dom.append(this.createItemCounter(t),s);return s},createItemSubLink:function(t){t=BX.Type.isPlainObject(t)?t:{};const e=BX.Type.isStringFilled(t["CLASS"])?" "+t["CLASS"]:"";const s=BX.Type.isStringFilled(t["URL"])?BX.Text.encode(t["URL"]):"";return BX.Tag.render`
				<a class="${this.classItemSublink}${e}" href="${s}"></a>
			`},createItemIcon:function(t){const e=[this.classItemIcon,this.classExtraItemIcon].join(" ").trim();return BX.Tag.render`<span class="${e}"></span>`},createItemText:function(t,e=false){t=BX.Type.isPlainObject(t)?t:{};const s=[this.classItemText,this.classExtraItemText].join(" ").trim();let i=BX.Type.isStringFilled(t["TEXT"])?t["TEXT"]:"";if(e&&i.length>this.maxItemLength){i=i.substring(0,this.maxItemLength-3)+"..."}let n="";if(BX.Type.isPlainObject(t["SUPER_TITLE"])){let{TEXT:e,CLASS:s,COLOR:i}=t["SUPER_TITLE"];s=BX.Type.isStringFilled(s)?` ${s}`:"";const o=BX.Type.isStringFilled(i)?` style="color:${i}"`:"";n=BX.Tag.render`
					<span class="main-buttons-item-super-title${s}"${o}>${e}</span>
				`}return BX.Tag.render`
				<span class="${s}">${[BX.Tag.render`<span 
						class="main-buttons-item-drag-button"
						onclick="${this.handleDragButtonClick.bind(this)}" 
						data-slider-ignore-autobinding="true"
					></span>`,n,BX.Tag.render`
						<span class="main-buttons-item-text-title">
							<span class="main-buttons-item-text-box">${BX.Text.encode(i)}<span class="main-buttons-item-menu-arrow"></span></span>
						</span>
					`,BX.Tag.render`<span 
						class="main-buttons-item-edit-button"
						onclick="${this.handleEditButtonClick.bind(this)}" 
						data-slider-ignore-autobinding="true"
					></span>`,BX.Tag.render`<span class="main-buttons-item-text-marker"></span>`]}</span>
			`},createItemCounter:function(t){t=BX.Type.isPlainObject(t)?t:{};const e=[this.classItemCounter,this.classExtraItemCounter].join(" ").trim();let s="";const i=BX.Type.isNumber(t["MAX_COUNTER_SIZE"])?t["MAX_COUNTER_SIZE"]:99;if(BX.Type.isNumber(t["COUNTER"])&&t["COUNTER"]>0){s=t["COUNTER"]>i?`${i}+`:t["COUNTER"]}const n=BX.Type.isStringFilled(t["COUNTER_ID"])?t["COUNTER_ID"]:"";return BX.Tag.render`<span data-mib-counter-id="${n}" class="${e}">${s}</span>`},createItemPin:function(t,e){return BX.Tag.render`
				<span class="main-buttons-item-pin" 
					data-slider-ignore-autobinding="true"
					onclick="${this.handleItemPin.bind(this,t,e)}"
					onmouseenter="${this.handleItemPinEnter.bind(this)}"
					onmouseleave="${this.handleItemPinLeave.bind(this)}"
				></span>
			`},getLockedClass:function(t){let e="";if(BX.Type.isDomNode(t)&&this.isLocked(t)){e=this.classItemLocked}return e},getMoreMenuItems:function(){const t=this.getAllItems();const e=this.getHiddenItems();const s=this.getDisabledItems();const i=[];if(t.length){t.forEach((t=>{if(e.indexOf(t)===-1&&s.indexOf(t)===-1){const e=this.getItemData(t);i.push({id:e["DATA_ID"],html:this.getMenuItemText(t),href:e["URL"],onclick:e["ON_CLICK"],title:t.getAttribute("title"),className:[this.classSubmenuItem,this.getIconClass(t),this.classSecret,this.getAliasLink(t),this.getLockedClass(t)].join(" "),items:this.getMoreMenuSubItems(t),events:{onMouseEnter:this.handleMoreMenuItemMouseEnter}})}}))}if(e.length){e.forEach((t=>{const e=this.getItemData(t);const s=[this.classSubmenuItem,this.getIconClass(t),this.getAliasLink(t),this.getLockedClass(t)];if(e["IS_ACTIVE"]===true){s.push(this.classItemActive)}i.push({id:e["DATA_ID"],html:this.getMenuItemText(t),href:e["URL"],onclick:e["ON_CLICK"],title:t.getAttribute("title"),className:s.join(" "),items:this.getMoreMenuSubItems(t),events:{onMouseEnter:this.handleMoreMenuItemMouseEnter}})}))}if(this.isSettingsEnabled){i.push({delimiter:true,html:"<span>"+this.message("MIB_MANAGE")+"</span>",className:[this.classSeparator,this.classSubmenuItem,this.classManage].join(" ")});i.push({html:this.message("MIB_SETTING_MENU_ITEM"),className:[this.classSettingMenuItem,this.classSubmenuItem].join(" ")});const t=["ui-btn",this.theme==="default"?"ui-btn-sm":"ui-btn-xs","ui-btn-success-light","ui-btn-no-caps","ui-btn-round","ui-btn-icon-main-buttons-apply"];i.push({html:`\n\t\t\t\t\t<span class="${t.join(" ")}">\n\t\t\t\t\t\t<span class="ui-btn-text">${this.message("MIB_APPLY_SETTING_MENU_ITEM")}</span>\n\t\t\t\t\t</span>`,className:[this.classSettingsApplyButton,this.classSubmenuItem].join(" ")});i.push({html:this.message("MIB_RESET_SETTINGS"),className:[this.classSettingsResetButton,this.classSubmenuItem].join(" ")});i.push({delimiter:true,html:"<span>"+this.message("MIB_HIDDEN")+"</span>",className:[this.classSeparator,this.classSubmenuItem,this.classHiddenLabel].join(" ")});if(!s.length){i.push({html:"<span>"+this.message("MIB_NO_HIDDEN")+"</span>",className:[this.classSubmenuItem,this.classSubmenuNoHiddenItem].join(" ")})}if(s.length){s.forEach((t=>{const e=this.getItemData(t);const s=[this.classSubmenuItem,this.classItemDisabled,this.getIconClass(t),this.getAliasLink(t),this.getLockedClass(t)];if(e["IS_ACTIVE"]===true){s.push(this.classItemActive)}i.push({id:e["DATA_ID"],html:this.getMenuItemText(t),href:e["URL"],onclick:e["ON_CLICK"],title:t.getAttribute("title"),className:s.join(" "),items:this.getMoreMenuSubItems(t),events:{onMouseEnter:this.handleMoreMenuItemMouseEnter}})}))}}return i},getMenuItems:function(t){return this.createMenuItems(this.getItemData(t),t)},getMoreMenuSubItems:function(t){return this.createMenuItems(this.getItemData(t),null)},createMenuItems:function(t,e=null){if(!BX.Type.isArrayFilled(t["ITEMS"])){return[]}const s=t["ITEMS"];const i=[];for(let t=0;t<s.length;t++){const n=s[t];if(n["IS_PINNED"]||n["IS_DISBANDED"]){continue}const o=n["IS_DELIMITER"]===true;if(o){const t=i.length===0;const e=i[i.length-1];if(t||e&&e["delimiter"]===true){continue}}const a=["menu-popup-no-icon","main-buttons-menu-item"];if(n["IS_ACTIVE"]===true){a.push("main-buttons-menu-item-active")}const u=BX.Text.toBoolean(n["IS_LOCKED"]);if(u){a.push(this.classItemLocked)}if(this.isEditEnabled()){a.push(this.classEditState)}let r;if(o){r={delimiter:true,className:a.join(" "),text:n["TEXT"]}}else{r={html:this.getMenuItemText(n,e),href:n["URL"],onclick:n["ON_CLICK"],title:n["TITLE"],className:a.join(" ")}}const l=n.hasOwnProperty("AJAX_OPTIONS");if(l){r.cacheable=true;r.events=this._getEvents(n["AJAX_OPTIONS"]);r.items=[{id:"loading",text:this.message("MIB_MAIN_BUTTONS_LOADING")}]}else if(BX.Type.isArrayFilled(n["ITEMS"])&&!this.isEditEnabled()){const t=this.createMenuItems(n,e);if(t.length){r.items=t}}i.push(r)}if(i.length&&i[i.length-1]["delimiter"]===true){i.pop()}return i},_setAjaxMode:function(t){for(let e in t){if(!t.hasOwnProperty(e)){continue}if(t[e].hasOwnProperty("ajaxOptions")){t[e].cacheable=true;t[e].events=this._getEvents(t[e]["ajaxOptions"]);t[e].items=[{id:"loading",text:this.message("MIB_MAIN_BUTTONS_LOADING")}]}}},_getEvents:function(t){return{onSubMenuShow:()=>{if(this.subMenuLoaded){return}const e=this.getSubMenu();e.removeMenuItem("loading");const s=e.getMenuItem("loading");this.getSubItems(t).then((t=>{this._setAjaxMode(t);this.subMenuLoaded=true;this.addSubMenu(t);this.showSubMenu()})).catch((t=>{if(s){s.getLayout().text.innerText=t}}))}}},getSubItems:function(t){return new Promise((function(e,s){if(this.progress){s(this.message("MIB_MAIN_BUTTONS_LOADING"));return}if(t.mode==="component"){this.progress=true;BX.ajax.runComponentAction(t.component,t.action,{mode:t.componentMode,signedParameters:t.signedParameters?t.signedParameters:{},data:t.data}).then((t=>{this.progress=false;e(t.data)}))}else{this.progress=true;BX.ajax.runAction(t.action,{data:t.data}).then((t=>{this.progress=false;e(t.data)}))}}))},getMoreMenuArgs:function(){const t=this.getMoreMenuId();const e=this.moreButton;const s=this.getMoreMenuItems();let i;const n=800;if(this.theme==="default"){const t=350;const s=25;i={autoHide:false,compatibleMode:false,offsetLeft:-s,offsetTop:4,cacheable:false,className:"main-buttons-menu-popup main-buttons-more-menu-popup",minWidth:240,maxWidth:t,maxHeight:n,subMenuOptions:{className:"main-buttons-menu-popup main-buttons-more-menu-popup --sub-menu",minWidth:150,maxWidth:t,events:{onFirstShow:this.handleMoreMenuFirstShow.bind(this)}},bindOptions:{position:"bottom",forceTop:true},events:{onClose:this.handleMoreMenuClose.bind(this),onDestroy:this.handleMoreMenuClose.bind(this),onFirstShow:this.handleMoreMenuFirstShow.bind(this),onShow:this.handleMoreMenuShow.bind(this),onBeforeAdjustPosition:this.handleAdjustPosition.bind(this,e)}}}else{const t=this.moreButton.querySelector(".main-buttons-item-text-title");const e=t.offsetWidth;const s=250;const o=e/2-s/2+BX.Main.Popup.getOption("angleLeftOffset");const a=BX.Main.Popup.getOption("angleLeftOffset")-BX.Main.Popup.getOption("angleMinTop");const u=s/2-a;i={autoHide:false,compatibleMode:false,offsetTop:4,offsetLeft:o,minWidth:s,maxWidth:s,maxHeight:n,angle:{position:"top",offset:u},className:"main-buttons-default-menu-popup main-buttons-more-menu-popup",subMenuOptions:{className:"main-buttons-default-menu-popup main-buttons-more-menu-popup --sub-menu",minWidth:null,events:{onFirstShow:this.handleMoreMenuFirstShow.bind(this)}},cacheable:false,bindOptions:{position:"bottom",forceTop:true},events:{onClose:this.handleMoreMenuClose.bind(this),onDestroy:this.handleMoreMenuClose.bind(this),onFirstShow:this.handleMoreMenuFirstShow.bind(this),onShow:this.handleMoreMenuShow.bind(this)}}}if(this.isEditEnabled()){i.className+=" "+this.classEditState}return[t,e,s,i]},getChildMenuArgs:function(t){const e=800;if(this.theme==="default"){const s=25;const i=350;return{autoHide:false,compatibleMode:false,offsetLeft:-s,offsetTop:4,cacheable:false,className:"main-buttons-menu-popup",maxWidth:i,minWidth:t.offsetWidth+s*2+30,maxHeight:e,subMenuOptions:{className:"main-buttons-menu-popup --sub-menu",minWidth:null,events:{onFirstShow:this._onChildMenuFirstShow.bind(this)}},bindOptions:{position:"bottom",forceTop:true},events:{onFirstShow:this._onChildMenuFirstShow.bind(this),onShow:this._onChildMenuShow.bind(this,t),onClose:this._onChildMenuClose.bind(this,t),onDestroy:this._onChildMenuClose.bind(this,t),onBeforeAdjustPosition:this.handleAdjustPosition.bind(this,t)}}}else{const s=250;return{autoHide:false,compatibleMode:false,offsetTop:4,cacheable:false,className:"main-buttons-default-menu-popup",minWidth:Math.min(t.offsetWidth+25*2+30,s),maxWidth:s,maxHeight:e,bindOptions:{position:"bottom",forceTop:true},subMenuOptions:{className:"main-buttons-default-menu-popup --sub-menu",minWidth:null,events:{onFirstShow:this._onChildMenuFirstShow.bind(this)}},events:{onFirstShow:this._onChildMenuFirstShow.bind(this),onShow:this._onChildMenuShow.bind(this,t),onClose:this._onChildMenuClose.bind(this,t),onDestroy:this._onChildMenuClose.bind(this,t)}}}},centerPopupArrow(t,e){const s=e.offsetWidth;const i=t.getPopupContainer().offsetWidth;const n=s/2-i/2;const o=BX.Main.Popup.getOption("angleLeftOffset")-BX.Main.Popup.getOption("angleMinTop");t.setAngle({offset:i/2-o});t.setOffset({offsetLeft:n+BX.Main.Popup.getOption("angleLeftOffset")})},visibleControlMoreButton:function(){const t=this.getHiddenItems();if(!t.length){this.getMoreButton().style.display="none"}else{this.getMoreButton().style.display=""}},createMoreMenu:function(){const t=BX.Main.MenuManager.create(...this.getMoreMenuArgs());if(this.isSettingsEnabled){this.dragAndDropInitInSubmenu()}t.getMenuItems().forEach((function(t){const e=t.getLayout().item;BX.Event.bind(e,"click",BX.delegate(this._onDocumentClick,this))}),this);return t},createChildMenu:function(t){const e=this.getMenuItems(t);if(e.length){const s=BX.Main.MenuManager.create(this.getChildMenuId(),t,e,this.getChildMenuArgs(t));if(!this.isEditEnabled()&&this.isSettingsEnabled){const e=()=>{this.showMoreMenu();this.enableEdit();this.destroyChildMenu();this.showChildMenu(t)};s.getMenuItems().forEach((t=>{const s=t.getLayout().item;s.draggable=true;BX.Event.bind(s,"dragstart",e)}))}return s}return null},showMoreMenu:function(){clearTimeout(this.submenuLeaveTimeout);if(!this.isEditEnabled()){this.closeChildMenu()}let t=this.getMoreMenu();if(t!==null){t.getPopupWindow().show()}else{this.destroyMoreMenu();t=this.createMoreMenu();t.getPopupWindow().show()}this.setMoreMenuShown(true);this.activateItem(this.moreButton);if(this.isEditEnabled()){t.getPopupWindow().setAutoHide(false)}},showChildMenu:function(t){clearTimeout(this.childMenuLeaveTimeout);if(!this.isEditEnabled()){this.closeMoreMenu()}if(!this.isVisibleItem(t)){return}const e=BX.Main.MenuManager.getMenuById(this.getChildMenuId());if(e&&e.bindElement===t){e.getPopupWindow().show();this.destroyItemEditMenu()}else{this.destroyChildMenu(t);const e=this.createChildMenu(t);if(e){e.getPopupWindow().show();this.destroyItemEditMenu()}}},closeMoreMenu:function(){const t=this.getMoreMenu();if(t===null){return}t.getPopupWindow().close();if(!this.isActiveInMoreMenu()){this.deactivateItem(this.moreButton)}this.setMoreMenuShown(false)},closeChildMenu:function(){const t=this.getChildMenu();if(t===null){return}this.closePinHint();t.close()},getMoreMenu:function(){return BX.Main.MenuManager.getMenuById(this.getMoreMenuId())},getChildMenu:function(){return BX.Main.MenuManager.getMenuById(this.getChildMenuId())},destroyMoreMenu:function(){BX.Main.MenuManager.destroy(this.getMoreMenuId())},destroyChildMenu:function(){BX.Main.MenuManager.destroy(this.getChildMenuId())},refreshMoreMenu:function(){const t=this.getMoreMenu();if(t===null){return}const e=this.getMoreMenuArgs();if(BX.Type.isArray(e)){this.destroyMoreMenu();this.createMoreMenu();this.showMoreMenu()}},setMoreMenuShown:function(t){this.isSubmenuShown=false;if(BX.type.isBoolean(t)){this.isSubmenuShown=t}if(this.isSubmenuShown){BX.Dom.addClass(this.moreButton,this.classMenuShown)}else{BX.Dom.removeClass(this.moreButton,this.classMenuShown)}},activateItem:function(t){if(!BX.Type.isDomNode(t)){return}if(!BX.Dom.hasClass(t,this.classItemActive)){BX.Dom.addClass(t,this.classItemActive)}},deactivateItem:function(t){if(!BX.Type.isDomNode(t)){return}if(BX.Dom.hasClass(t,this.classItemActive)){BX.Dom.removeClass(t,this.classItemActive)}},getCurrentSettings:function(){const t={};this.getAllItems().forEach(((e,s)=>{t[e.id]={sort:s,isDisabled:this.isDisabled(e),isPinned:this.isPinned(e)}}));return t},initSaving:function(t){this.sendOptions=this.sendOptions.bind(this);this.optionsToSave=[];this.debouncedSendOptions=BX.debounce(this.sendOptions,5e3);if(BX.Type.isPlainObject(t)){this.ajaxSettings={componentName:t.componentName,signedParams:t.signedParams}}},sendOptions:function(){if(this.optionsToSave.length<=0){return}const t={};this.optionsToSave.forEach((function(e){t[e.name]=e.value}));this.optionsToSave=[];window.removeEventListener("beforeunload",this.sendOptions);BX.removeCustomEvent("SidePanel.Slider:onClose",this.sendOptions);return BX.ajax.runComponentAction(this.ajaxSettings.componentName,"save",{mode:"class",signedParameters:this.ajaxSettings.signedParams,data:{options:t}})},saveOptions:function(t,e){if(this.ajaxSettings){if(this.optionsToSave.length<=0){window.addEventListener("beforeunload",this.sendOptions);BX.addCustomEvent("SidePanel.Slider:onClose",this.sendOptions)}this.optionsToSave.push({name:t,value:e});this.debouncedSendOptions()}else if(this.listContainer.id){BX.userOptions.save("ui",this.listContainer.id,t,e)}},saveSettings:function(){const t=this.getCurrentSettings();const e="settings";if(!BX.Type.isPlainObject(t)){return}if(BX.Type.isDomNode(this.listContainer)){if("id"in this.listContainer){this.saveOptions(e,JSON.stringify(t));this.setHome()}}},resetSettings:function(){let t=null;const e=BX.PopupWindowManager.create(this.listContainer.id+"_reset_popup",null,{content:this.message("MIB_RESET_ALERT"),autoHide:false,overlay:true,closeByEsc:true,closeIcon:true,draggable:{restrict:true},titleBar:this.message("MIB_RESET_SETTINGS"),buttons:[t=new BX.PopupWindowButton({text:this.message("MIB_RESET_BUTTON"),className:"popup-window-button-create",events:{click:()=>{if(BX.Dom.hasClass(t.buttonNode,"popup-window-button-wait")){return}BX.Dom.addClass(t.buttonNode,"popup-window-button-wait");this.handleResetSettings((s=>{if(s){BX.Dom.removeClass(t.buttonNode,"popup-window-button-wait");e.setContent(s)}else{this.saveOptions("settings",JSON.stringify({}));this.saveOptions("firstPageLink","");this.sendOptions().then((function(){window.location.reload()})).catch((function(){window.location.reload()}))}}))}}}),new BX.PopupWindowButtonLink({text:this.message("MIB_CANCEL_BUTTON"),className:"popup-window-button-link-cancel",events:{click:function(){this.popupWindow.close()}}})]});e.show()},handleResetSettings:function(t){const e=[];BX.onCustomEvent("BX.Main.InterfaceButtons:onBeforeResetMenu",[e,this]);let s=new BX.Promise;const i=s;for(let t=0;t<e.length;t++){s=s.then(e[t])}s.then((function(e){t(null,e)}),(function(e){t(e,null)}));i.fulfill()},moveButtonAlias:function(t,e){if(!t||!this.dragItem){return}const s=this.getItemAlias(this.dragItem);const i=this.getItemAlias(t);if(this.isListItem(s)){if(i){if(e){BX.Dom.insertAfter(s,i)}else{this.listContainer.insertBefore(s,i)}}else{this.listContainer.appendChild(s)}}if(this.getMoreMenu()){this.getMoreMenu().getPopupWindow().adjustPosition()}},moveButton:function(t,e){if(!BX.Type.isDomNode(t)||!BX.Type.isDomNode(this.dragItem)){return}if(this.isListItem(t)){if(this.isDisabled(this.dragItem)){this.dragItem.dataset.disabled="false"}if(BX.Type.isDomNode(t)){if(e){BX.Dom.insertAfter(this.dragItem,t)}else{this.listContainer.insertBefore(this.dragItem,t)}}else{this.listContainer.appendChild(this.dragItem)}}if(this.isSubmenuItem(t)){if(e){BX.Dom.insertAfter(this.dragItem,t)}else{this.getMoreMenuContainer().insertBefore(this.dragItem,t)}}},getMoreMenuContainer:function(){const t=this.getMoreMenu();let e=null;if(t!==null){e=t.itemsContainer}return e},findNextSiblingByClass:function(t,e){const s=t;for(;!!t;t=t.nextElementSibling){if(e){if(BX.Dom.hasClass(t,e)&&t!==s){return t}}else{return null}}return null},findChildrenByClassName:function(t,e){let s=null;if(BX.Type.isDomNode(t)&&BX.Type.isStringFilled(e)){s=BX.Buttons.Utils.getByClass(t,e)}return s},initItems:function(){this.getAllItems().forEach((t=>{this.initItem(t)}))},initItem:function(t){if(this.isSettingsEnabled){t.setAttribute("draggable","true");t.setAttribute("tabindex","-1");BX.Event.bind(t,"dragstart",BX.delegate(this._onDragStart,this));BX.Event.bind(t,"dragend",BX.delegate(this._onDragEnd,this));BX.Event.bind(t,"dragenter",BX.delegate(this._onDragEnter,this));BX.Event.bind(t,"dragover",BX.delegate(this._onDragOver,this));BX.Event.bind(t,"dragleave",BX.delegate(this._onDragLeave,this));BX.Event.bind(t,"drop",BX.delegate(this._onDrop,this));t.dataset.link="item-"+BX.Text.getRandom().toLowerCase()}BX.Event.bind(t,"click",this._handleItemClick.bind(this));BX.Event.bind(t,"mouseenter",this.handleItemMouseEnter.bind(this));BX.Event.bind(t,"mouseleave",this.handleItemMouseLeave.bind(this))},dragAndDropInitInSubmenu:function(){const t=this.getMoreMenu();if(!t){return}const e=t.menuItems;e.forEach((t=>{if(this.isSeparator(t.layout.item)||this.isSettings(t.layout.item)||this.isApplySettingsButton(t.layout.item)||this.isResetSettingsButton(t.layout.item)){t.layout.item.draggable=false}else{t.layout.item.draggable=true;t.layout.item.dataset.sortable=true;BX.Event.bind(t.layout.item,"dragstart",BX.delegate(this._onDragStart,this));BX.Event.bind(t.layout.item,"dragenter",BX.delegate(this._onDragEnter,this));BX.Event.bind(t.layout.item,"dragover",BX.delegate(this._onDragOver,this));BX.Event.bind(t.layout.item,"dragleave",BX.delegate(this._onDragLeave,this));BX.Event.bind(t.layout.item,"dragend",BX.delegate(this._onDragEnd,this));BX.Event.bind(t.layout.item,"drop",BX.delegate(this._onDrop,this))}if(BX.Dom.hasClass(t.layout.item,this.classHiddenLabel)||BX.Dom.hasClass(t.layout.item,this.classManage)){BX.Event.bind(t.layout.item,"dragover",BX.delegate(this._onDragOver,this))}}))},getItem:function(t){if(!BX.Type.isDomNode(t)){if(!t||!BX.Type.isDomNode(t.target)){return null}}else{t={target:t}}let e=t.target.closest("."+this.classItem);if(!BX.Type.isDomNode(e)){e=t.target.closest("."+this.classDefaultSubmenuItem+", ."+this.classDefaultSubmenuDelimimeter)}return e},getItemData:function(t){if(!BX.Type.isDomNode(t)){return{}}const e=this.itemData.get(t);if(e){return e}let s;try{s=JSON.parse(t.dataset.item)}catch(t){s={}}this.setItemData(t,s);return s},setItemData(t,e){if(BX.Type.isElementNode(t)&&BX.Type.isPlainObject(e)){e.NODE=t;this.itemData.set(t,e)}},setOpacity:function(t){if(!BX.Type.isDomNode(t)){return}BX.style(t,"opacity",.5)},unsetOpacity:function(t){if(!BX.Type.isDomNode(t)){return}BX.style(t,"opacity","1")},setDragStyles:function(){BX.Dom.addClass(this.listContainer,this.classOnDrag);BX.Dom.addClass(BX(this.getMoreMenuId(true)),this.classOnDrag);this.setOpacity(this.dragItem)},unsetDragStyles:function(){const t=this.getMoreMenu();this.getAllItems().forEach((t=>{this.unsetOpacity(t);BX.Dom.removeClass(t,this.classItemOver)}));if(t&&BX.Type.isArray(t.menuItems)&&t.menuItems.length){t.menuItems.forEach((t=>{this.unsetOpacity(t);BX.Dom.removeClass(t.layout.item,this.classItemOver)}))}BX.Dom.removeClass(this.listContainer,this.classOnDrag);BX.Dom.removeClass(BX(this.getMoreMenuId(true)),this.classOnDrag)},getIconClass:function(t){let e="";if(BX.Type.isDomNode(t)&&"dataset"in t&&"class"in t.dataset&&BX.Type.isStringFilled(t.dataset.class)){e=t.dataset.class}return e},disableItem:function(t){const e=this.getItemAlias(t);if(t&&"dataset"in t){t.dataset.disabled="true";if(e){e.dataset.disabled="true"}}},enableItem:function(t){let e;if(!BX.Type.isDomNode(t)){return}if(this.isSubmenuItem(t)){BX.Dom.removeClass(t,this.classItemDisabled);e=this.getItemAlias(t);if(BX.Type.isDomNode(e)){e.dataset.disabled="false"}}},getAliasLink:function(t){return this.dataValue(t,"link")||""},getItemAlias:function(t){let e=null;if(!BX.Type.isDomNode(t)){return e}const s=this.getAllItems();const i=this.isSubmenuItem(t);const n=this.isListItem(t);if(!i&&!n){return e}if(i){s.forEach((function(s){BX.Dom.hasClass(t,this.getAliasLink(s))&&(e=s)}),this)}if(n){e=BX.Buttons.Utils.getByClass(document,this.getAliasLink(t))}return e},hideItem:function(t){!!t&&BX.Dom.addClass(t,this.classSecret)},showItem:function(t){!!t&&BX.Dom.removeClass(t,this.classSecret)},fakeDragItem:function(){if(!BX.Type.isDomNode(this.dragItem)||!BX.Type.isDomNode(this.overItem)){return}let t=null;if(this.isDragToSubmenu()){t=this.getItemAlias(this.dragItem);if(t!==this.dragItem){this.listContainer.appendChild(this.dragItem);this.dragItem=t;this.showItem(this.dragItem);this.adjustMoreButtonPosition();this.updateMoreMenuItems();this.tmp.moved=false;this.tmp.movetToSubmenu=true;this.setOpacity(this.dragItem)}}if(this.isDragToList()&&!this.tmp.movetToSubmenu){t=this.getItemAlias(this.dragItem);if(t!==this.dragItem){this.hideItem(this.dragItem);this.dragItem=t;this.adjustMoreButtonPosition();this.updateMoreMenuItems();this.setOpacity(this.dragItem)}}this.tmp.movetToSubmenu=false},updateMoreMenuItems:function(){const t=this.getMoreMenu();if(t===null){return}const e=t.menuItems;if(!BX.Type.isArray(e)||!e.length){return}const s=this.getHiddenItems();const i=this.getDisabledItems();const n=i.concat(s);e.forEach((t=>{const e=[].some.call(n,(e=>BX.Dom.hasClass(t.layout.item,this.dataValue(e,"link"))||this.isDisabled(t.layout.item)||this.isSeparator(t.layout.item)||this.isDropzone(t.layout.item)));if(e||(this.isSettings(t.layout.item)||this.isApplySettingsButton(t.layout.item)||this.isResetSettingsButton(t.layout.item)||this.isNotHiddenItem(t.layout.item)||this.isSeparator(t.layout.item)||t.layout.item===this.dragItem)&&!this.isMoreButton(t.layout.item)){this.showItem(t.layout.item)}else{this.hideItem(t.layout.item)}}))},isNotHiddenItem:function(t){return BX.Dom.hasClass(t,this.classSubmenuNoHiddenItem)},getNotHidden:function(){return BX.Buttons.Utils.getByClass(this.getMoreMenuContainer(),this.classSubmenuNoHiddenItem)},setOverStyles:function(t){if(BX.Type.isDomNode(t)&&!BX.Dom.hasClass(t,this.classItemOver)){BX.Dom.addClass(t,this.classItemOver)}},unsetOverStyles:function(t){if(BX.Type.isDomNode(t)&&BX.Dom.hasClass(t,this.classItemOver)){BX.Dom.removeClass(t,this.classItemOver)}},dataValue:function(t,e){let s="";if(BX.Type.isDomNode(t)){const i=BX.data(t,e);if(typeof i!=="undefined"){s=i}}return s},execScript:function(t,e){if(BX.Type.isStringFilled(t)){const s=new Function("event",t);s(e)}},showLicenseWindow:function(){if(!B24.licenseInfoPopup){return}const t=B24.licenseInfoPopup;t.init({B24_LICENSE_BUTTON_TEXT:this.message("MIB_LICENSE_BUY_BUTTON"),B24_TRIAL_BUTTON_TEXT:this.message("MIB_LICENSE_TRIAL_BUTTON"),IS_FULL_DEMO_EXISTS:this.licenseParams.isFullDemoExists,HOST_NAME:this.licenseParams.hostname,AJAX_URL:this.licenseParams.ajaxUrl,LICENSE_ALL_PATH:this.licenseParams.licenseAllPath,LICENSE_DEMO_PATH:this.licenseParams.licenseDemoPath,FEATURE_GROUP_NAME:this.licenseParams.featureGroupName,AJAX_ACTIONS_URL:this.licenseParams.ajaxActionsUrl,B24_FEATURE_TRIAL_SUCCESS_TEXT:this.message("MIB_LICENSE_WINDOW_TRIAL_SUCCESS_TEXT")});t.show("main-buttons",this.message("MIB_LICENSE_WINDOW_HEADER_TEXT"),this.message("MIB_LICENSE_WINDOW_TEXT"))},_handleItemClick:function(t){if(!this.isEditEnabled()){const e=this.getItem(t);this.showChildMenu(e)}},handleEditButtonClick:function(t){t.preventDefault();t.stopPropagation();let e=this.getItem(t);if(!BX.Type.isDomNode(e)){return}if(this.isSubmenuItem(e)){e=this.getItemAlias(e)}const s=this.getItemData(e);const i=this.getItemEditMenu();if(i&&i.popupWindow.isShown()&&this.lastEditNode===e){i.popupWindow.close()}else{this.showItemEditMenu(s,t.target)}this.lastEditNode=e},handleDragButtonClick:function(t){t.preventDefault();t.stopPropagation()},handleItemPinEnter:function(t){const e=this.getChildMenu();if(e){this.showPinHint(t.currentTarget)}},showPinHint:function(t){const e=48;const s=BX.Main.PopupManager.create({id:"main-buttons-pin-hint",closeByEsc:true,padding:15,className:"main-buttons-pin-hint-popup",height:e,cacheable:false,autoHide:true,bindOptions:{forceBindPosition:true},content:this.message("MIB_PIN_HINT"),darkMode:true,events:{onAfterShow:function(e){const s=e.getTarget();const i=BX.Dom.getPosition(t);const n=BX.Dom.getPosition(s.getPopupContainer());if(n.left<i.left+i.width){s.setAngle({position:"top",offset:0});s.setOffset({offsetLeft:20,offsetTop:5});s.adjustPosition()}}}});s.setAngle({position:"left",offset:0});s.setOffset({offsetLeft:t.offsetWidth+5,offsetTop:-t.offsetHeight/2-e/2-2});s.setBindElement(t);s.show();s.adjustPosition()},closePinHint:function(){const t=BX.Main.PopupManager.getPopupById("main-buttons-pin-hint");if(t){t.close()}},handleItemPinLeave:function(t){this.closePinHint()},handleItemPin:function(t,e,s){s.stopPropagation();s.preventDefault();const i=this.createRootItem(t);BX.Dom.addClass(i,"main-buttons-item-insert-animation");BX.Dom.insertBefore(i,e);requestAnimationFrame((()=>{requestAnimationFrame((()=>{BX.Dom.style(i,{width:i.scrollWidth+"px",opacity:1})}))}));const n=()=>{BX.Dom.removeClass(i,"main-buttons-item-insert-animation");BX.Dom.style(i,"width",null);BX.Dom.style(i,"opacity",null);const t=this.getItemData(e);this.recalculateItemsCounters([t]);this.showMoreMenu();this.updateMoreButtonCounter();this.showChildMenu(e);this.saveSettings()};setTimeout(n,300);this.initItem(i);this.pinItem(t);this.destroyMoreMenu();this.destroyChildMenu()},handleItemUnpin:function(t,e){BX.Dom.style(e,{width:e.offsetWidth+"px"});BX.Dom.addClass(e,"main-buttons-item-insert-animation");requestAnimationFrame((()=>{requestAnimationFrame((()=>{BX.Dom.style(e,{width:0,margin:0,opacity:0})}))}));const s=()=>{BX.Dom.remove(e);this.showMoreMenu();this.updateMoreButtonCounter();this.saveSettings()};setTimeout(s,300);this.pinItem(t,false);const i=[];let n="";const o=t["ID"].split(":");o.forEach((t=>{n+=`${n===""?"":":"}${t}`;const e=this.getItemById(n);if(e){i.push(this.getItemData(e))}}));this.destroyMoreMenu();this.recalculateItemsCounters(i)},pinItem:function(t,e=true){const s=t["ID"];const i=s.split(":");let n="";i.forEach(((t,o)=>{n+=`${n===""?"":":"}${t}`;const a=this.getItemById(n);if(!a){return}const u=this.getItemData(a);let r=u["ITEMS"];let l=n;const h=i.slice(o+1);const m=[u];while(BX.Type.isArrayFilled(h)&&BX.Type.isArrayFilled(r)){l=l+":"+h.shift();for(let t=0;t<r.length;t++){const i=r[t];if(i["ID"]===s){i["IS_PINNED"]=e;for(let t=m.length-1;t>=0;t--){const s=m[t];const i=t===0;if(e){const t=s["ITEMS"].some((t=>{const e=t["IS_PINNED"]===true;const s=t["IS_DISBANDED"]===true;const i=t["IS_DELIMITER"]===true;return!e&&!s&&!i}));if(!t){s["IS_DISBANDED"]=true;if(i){a.dataset.disbanded=true}}}else{if(i){a.dataset.disbanded=false}s["IS_DISBANDED"]=false}const n=s["ITEMS"].some((t=>t["IS_ACTIVE"]===true&&t["IS_PINNED"]!==true&&t["IS_DELIMITER"]!==true));if(n){s["IS_ACTIVE"]=true;if(i){this.activateItem(a)}}else{s["IS_ACTIVE"]=false;if(i){this.deactivateItem(a)}}}return}else if(i["ID"]===l){r=i["ITEMS"];l=i["ID"];m.push(i);break}}}}))},getParentItem:function(t){const e=t.split(":");let s="";for(let i=0;i<e.length;i++){s+=`${s===""?"":":"}${e[i]}`;const n=this.getItemById(s);if(!n){continue}const o=this.getItemData(n);let a=o["ITEMS"];let u=s;const r=e.slice(i+1);let l=null;while(BX.Type.isArrayFilled(r)&&BX.Type.isArrayFilled(a)){u=u+":"+r.shift();for(let e=0;e<a.length;e++){const s=a[e];if(s["ID"]===t){return l===null?o:l}else if(s["ID"]===u){a=s["ITEMS"];u=s["ID"];l=s;break}}}}return null},_onDragStart:function(t){const e=this.getVisibleItems();const s=BX.Type.isArray(e)?e.length:null;this.dragItem=this.getItem(t);if(!BX.Type.isDomNode(this.dragItem)){return}if(s===1&&this.isListItem(this.dragItem)){t.preventDefault();BX.onCustomEvent(window,"BX.Main.InterfaceButtons:onHideLastVisibleItem",[this.dragItem,this]);return}if(this.isMoreButton(this.dragItem)||this.isSeparator(this.dragItem)||this.isNotHiddenItem(this.dragItem)||BX.Dom.attr(this.dragItem,"data-parent-item-id")||BX.Dom.attr(this.dragItem,"data-has-child")){t.preventDefault();return}this.onDragStarted=true;this.closeChildMenu();this.destroyItemEditMenu();if(this.isListItem(this.dragItem)){this.showMoreMenu()}this.setDragStyles();if(!this.isEditEnabled()){this.enableEdit()}},_onDragEnd:function(t){t.preventDefault();const e=this.getItem(t);this.onDragStarted=false;if(!BX.Type.isDomNode(e)){return}this.unsetDragStyles();this.refreshMoreMenu();if(!this.isEditEnabled()){this.closeMoreMenu()}const s=BX.findNextSibling(this.dragItem,(t=>this.isVisibleItem(t)));const i=BX.findPreviousSibling(this.dragItem,(t=>this.isVisibleItem(t)));if(BX.Dom.hasClass(i,this.classHiddenLabel)||this.isDisabled(i)&&this.isSubmenuItem(i)||this.isDisabled(s)&&this.isSubmenuItem(s)){this.disableItem(this.dragItem);this.refreshMoreMenu()}if(this.isEditEnabled()){this.enableEdit()}else{this.disableEdit()}this.updateMoreButtonCounter();this.saveSettings();this.dragItem=null;this.overItem=null;this.tmp.moved=false},updateMoreButtonCounter:function(){let t=this.getHiddenItems();const e=this.getDisabledItems();t=t.concat(e);let s=0;if(BX.Type.isArray(t)){t.forEach((t=>{const e=this.getItemData(t);const i=BX.Type.isNumber(e["COUNTER"])&&e["COUNTER"]>0?e["COUNTER"]:0;s+=i}))}if(BX.Type.isNumber(s)){this.setMoreButtonCounter(s)}},_onDragEnter:function(t){const e=this.getItem(t);if(BX.Type.isDomNode(e)&&this.isNotHiddenItem(e)){this.setOverStyles(e)}},_onDragOver:function(t){t.preventDefault();this.overItem=this.getItem(t);if(!BX.Type.isDomNode(this.overItem)||!BX.Type.isDomNode(this.dragItem)||this.overItem===this.dragItem||this.isNotHiddenItem(this.overItem)||BX.Dom.attr(this.overItem,"data-parent-item-id")||BX.Dom.attr(this.overItem,"data-has-child")){return}this.fakeDragItem();const e=this.isNext(t);const s=this.isGoodPosition(t);if(e&&s){let t;let e=false;if(this.isListItem(this.overItem)){t=this.findNextSiblingByClass(this.overItem,this.classItem);if(t===null&&this.getLastVisibleItem()===this.overItem){t=this.overItem;e=true}}else{t=this.findNextSiblingByClass(this.overItem,this.classSubmenuItem);if(this.isSettings(t)||this.isApplySettingsButton(t)||this.isResetSettingsButton(t)){return}if(t===null&&this.getItemAlias(this.getLastDisabledItem())===this.overItem){t=this.overItem;e=true}}if(BX.Type.isDomNode(t)){this.moveButton(t,e);this.moveButtonAlias(t,e);this.adjustMoreButtonPosition();this.updateMoreMenuItems()}}else if(!e&&s&&!BX.Dom.hasClass(this.overItem,this.classHiddenLabel)){this.moveButton(this.overItem);this.moveButtonAlias(this.overItem);this.adjustMoreButtonPosition();this.updateMoreMenuItems()}},_onDragLeave:function(t){const e=this.getItem(t);if(BX.Type.isDomNode(e)){this.unsetOverStyles(t.target)}},_onDrop:function(t){const e=this.getItem(t);if(!BX.Type.isDomNode(e)){return}if(this.isNotHiddenItem(e)||this.isDisabled(e)){this.disableItem(this.dragItem);this.adjustMoreButtonPosition()}const s=this.getItemAlias(this.dragItem);if(this.isListItem(s)){s.dataset.disabled="false"}this.unsetDragStyles();t.preventDefault()},handleMoreMenuFirstShow:function(t){const e=t.getTarget();BX.Event.bind(e.getPopupContainer(),"mouseenter",this.handleMoreMenuMouseEnter.bind(this));BX.Event.bind(e.getPopupContainer(),"mouseleave",this.handleMoreMenuMouseLeave.bind(this))},handleMoreMenuMouseEnter:function(){clearTimeout(this.submenuLeaveTimeout)},handleMoreMenuMouseLeave:function(){this.tryCloseMoreMenuOnTimeout()},tryCloseMoreMenuOnTimeout:function(){clearTimeout(this.submenuLeaveTimeout);if(!this.isEditEnabled()){this.submenuLeaveTimeout=setTimeout((()=>{this.closeMoreMenu()}),500)}},handleMoreMenuShow:function(t){BX.Event.EventEmitter.emit("BX.Main.InterfaceButtons:onMenuShow");BX.Event.EventEmitter.emit(this,"BX.Main.InterfaceButtons:onMoreMenuShow",{event:t});setTimeout((()=>{if(!this.isEditEnabled()){t.getTarget().setAutoHide(true)}}),500)},handleMoreMenuClose:function(){BX.Event.EventEmitter.emit(this,"BX.Main.InterfaceButtons:onMoreMenuClose");this.setMoreMenuShown(false);if(this.isEditEnabled()){this.activateItem(this.moreButton)}else{if(!this.isActiveInMoreMenu()){this.deactivateItem(this.moreButton)}}this.destroyItemEditMenu()},_onChildMenuFirstShow:function(t){const e=t.getTarget();BX.Event.bind(e.getPopupContainer(),"mouseenter",this._onChildMenuMouseEnter.bind(this));BX.Event.bind(e.getPopupContainer(),"mouseleave",this._onChildMenuMouseLeave.bind(this))},_onChildMenuMouseEnter:function(){clearTimeout(this.childMenuLeaveTimeout)},_onChildMenuMouseLeave:function(){this.tryCloseChildMenuOnTimeout()},tryCloseChildMenuOnTimeout:function(){if(this.isEditEnabled()){return}clearTimeout(this.childMenuLeaveTimeout);this.childMenuLeaveTimeout=setTimeout((()=>{this.closeChildMenu()}),500)},_onChildMenuShow:function(t,e){BX.Dom.addClass(t,this.classMenuShown);BX.Event.EventEmitter.emit("BX.Main.InterfaceButtons:onMenuShow");BX.Event.EventEmitter.emit(this,"BX.Main.InterfaceButtons:onSubMenuShow",{item:t,event:e});if(this.theme!=="default"){this.centerPopupArrow(e.getTarget(),t)}setTimeout((()=>{e.getTarget().setAutoHide(true)}),500)},_onChildMenuClose:function(t){BX.Event.EventEmitter.emit(this,"BX.Main.InterfaceButtons:onSubMenuClose");BX.Dom.removeClass(t,this.classMenuShown);this.closePinHint()},handleAdjustPosition:function(t,e){const s=25;const i=BX.Dom.getPosition(t);const n=e.getTarget();if(e.left<i.left-s){const t=n.getPopupContainer().offsetWidth;const o=i.right-t+s;if(o>0){e.left=o;BX.Dom.addClass(n.getPopupContainer(),"--left-handed")}}else{BX.Dom.removeClass(n.getPopupContainer(),"--left-handed")}},_onResizeHandler:function(){this.adjustMoreButtonPosition();this.updateMoreMenuItems();this.closeChildMenu();if(!this.isSettingsEnabled){this.visibleControlMoreButton()}},handleMoreButtonClick:function(t){t.preventDefault();this.showMoreMenu()},handleMoreButtonMouseEnter:function(t){if(this.enableItemMouseEnter){clearTimeout(this.menuShowTimeout);this.menuShowTimeout=setTimeout((()=>{this.showMoreMenu()}),100)}clearTimeout(this.submenuLeaveTimeout)},handleMoreButtonMouseLeave:function(){clearTimeout(this.menuShowTimeout);this.tryCloseMoreMenuOnTimeout()},handleItemMouseEnter:function(t){if(!this.enableItemMouseEnter){return}if(this.onDragStarted){return}const e=this.getItem(t);clearTimeout(this.childMenuLeaveTimeout);clearTimeout(this.menuShowTimeout);this.menuShowTimeout=setTimeout((()=>{this.showChildMenu(e)}),100);BX.Dom.addClass(e,this.classItemOver)},handleItemMouseLeave:function(t){clearTimeout(this.menuShowTimeout);if(!this.enableItemMouseEnter){return}if(this.onDragStarted){return}const e=this.getItem(t);BX.Dom.removeClass(e,this.classItemOver);this.tryCloseChildMenuOnTimeout()},handleMoreMenuItemMouseEnter:function(t){if(this.isEditEnabled()){t.preventDefault()}},getSettingsResetButton:function(){return BX.Buttons.Utils.getByClass(this.getMoreMenuContainer(),this.classSettingsResetButton)},isDisabled:function(t){let e=false;if(BX.Type.isDomNode(t)){e=this.dataValue(t,"disabled")==="true"||BX.Dom.hasClass(t,this.classItemDisabled)}return e},isPinned:function(t){let e=false;if(BX.Type.isDomNode(t)){e=this.getItemData(t)["IS_PINNED"]===true}return e},isSettings:function(t){let e=false;if(BX.Type.isDomNode(t)){e=BX.Dom.hasClass(t,this.classSettingMenuItem)}return e},isLocked:function(t){let e=false;if(BX.Type.isDomNode(t)){e=this.dataValue(t,"locked")==="true"||BX.Dom.hasClass(t,this.classItemLocked)}return e},isDropzone:function(t){return BX.Dom.hasClass(t,this.classDropzone)},isNext:function(t){const e=this.dragItem.getBoundingClientRect();const s=this.overItem.getBoundingClientRect();const i=getComputedStyle(this.dragItem);const n=parseInt(i.marginRight.replace("px",""));let o=null;if(this.isListItem(this.overItem)){o=t.clientX>s.left-n&&t.clientX>e.right}if(this.isSubmenuItem(this.overItem)){o=t.clientY>e.top}return o},isGoodPosition:function(t){const e=this.overItem;if(!BX.Type.isDomNode(e)){return false}let s;const i=e.getBoundingClientRect();if(this.isListItem(e)){s=this.isNext(t)&&t.clientX>=i.left+i.width/2||!this.isNext(t)&&t.clientX<=i.left+i.width/2}if(this.isSubmenuItem(e)){s=this.isNext(t)&&t.clientY>=i.top+i.height/2||!this.isNext(t)&&t.clientY<=i.top+i.height/2}return s},isSubmenuItem:function(t){return BX.Dom.hasClass(t,this.classSubmenuItem)},isVisibleItem:function(t){if(!BX.Type.isDomNode(t)){return false}return t.offsetTop===0},isMoreButton:function(t){let e=false;if(BX.Type.isDomNode(t)&&BX.Dom.hasClass(t,this.classItemMore)){e=true}return e},isListItem:function(t){let e=false;if(BX.Type.isDomNode(t)&&BX.Dom.hasClass(t,this.classItem)){e=true}return e},isSublink:function(t){let e=false;if(BX.Type.isDomNode(t)){e=BX.Dom.hasClass(t,this.classItemSublink)}return e},isSeparator:function(t){let e=false;if(BX.Type.isDomNode(t)){e=BX.Dom.hasClass(t,this.classSeparator)}return e},isDragToSubmenu:function(){return!this.isSubmenuItem(this.dragItem)&&this.isSubmenuItem(this.overItem)},isDragToList:function(){return this.isSubmenuItem(this.dragItem)&&!this.isSubmenuItem(this.overItem)}}}if(typeof BX.Main.interfaceButtonsManager==="undefined"){BX.Main.interfaceButtonsManager={data:{},init:function(t){let e=null;if(!BX.Type.isPlainObject(t)||!("containerId"in t)){throw"BX.Main.interfaceButtonsManager: containerId not set in params Object"}e=BX(t.containerId);if(BX.Type.isDomNode(e)){this.data[t.containerId]=new BX.Main.interfaceButtons(e,t)}else{BX(BX.delegate((function(){e=BX(t.containerId);if(!BX.Type.isDomNode(e)){throw"BX.Main.interfaceButtonsManager: container is not dom node"}this.data[t.containerId]=new BX.Main.interfaceButtons(e,t)}),this))}},getById:function(t){let e=null;if(BX.type.isString(t)&&BX.Type.isStringFilled(t)){try{e=this.data[t]}catch(t){}}return e},getObjects:function(){return this.data}}}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:91:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.js?16992579501940";s:6:"source";s:76:"/bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	'use strict';

	BX.namespace('BX.Buttons');

	/**
	 * BX.Main.interfaceButtons Utils
	 * @type {{getByClass: BX.Buttons.Utils.getByClass, getByTag: BX.Buttons.Utils.getByTag, getBySelector: BX.Buttons.Utils.getBySelector}}
	 */
	BX.Buttons.Utils = {
		/**
		 * Gets elements by className
		 * @param {HTMLElement|HTMLDocument} rootElement
		 * @param {string} className
		 * @param {boolean} [all = false] Gets all elements
		 * @returns {HTMLElement|Array}
		 */
		getByClass: function(rootElement, className, all)
		{
			var result = [];

			if (className)
			{
				result = (rootElement || document.body).getElementsByClassName(className);

				if (!all)
				{
					result = result.length ? result[0] : null;
				}
				else
				{
					result = [].slice.call(result);
				}
			}

			return result;
		},

		/**
		 * Gets elements by by element tag name
		 * @param {HTMLElement|HTMLDocument} rootElement
		 * @param {string} tag
		 * @param {boolean} [all = false] Gets all elements
		 * @returns {HTMLElement|Array}
		 */
		getByTag: function(rootElement, tag, all)
		{
			var result = [];

			if (tag)
			{
				result = (rootElement || document.body).getElementsByTagName(tag);

				if (!all)
				{
					result = result.length ? result[0] : null;
				}
				else
				{
					result = [].slice.call(result);
				}
			}

			return result;
		},

		/**
		 * Gets elements by css selector
		 * @param {HTMLElement|HTMLDocument} rootElement
		 * @param {string} selector
		 * @param {boolean} [all = false] Gets all elements
		 * @returns {HTMLElement|Array}
		 */
		getBySelector: function(rootElement, selector, all)
		{
			var result = [];

			if (selector)
			{
				if (!all)
				{
					result = (rootElement || document.body).querySelector(selector);
				}
				else
				{
					result = (rootElement || document.body).querySelectorAll(selector);
					result = [].slice.call(result);
				}
			}

			return result;
		}
	}
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:95:"/bitrix/components/bitrix/bizproc.workflow.edit/templates/.default/script.min.js?16992579531804";s:6:"source";s:76:"/bitrix/components/bitrix/bizproc.workflow.edit/templates/.default/script.js";s:3:"min";s:80:"/bitrix/components/bitrix/bizproc.workflow.edit/templates/.default/script.min.js";s:3:"map";s:80:"/bitrix/components/bitrix/bizproc.workflow.edit/templates/.default/script.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Bizproc.WorkflowEditComponent");if(typeof BX.Bizproc.WorkflowEditComponent.Globals!=="undefined"){return}BX.Bizproc.WorkflowEditComponent.Globals={};BX.Bizproc.WorkflowEditComponent.Globals.init=function(o){this.documentTypeSigned=String(o.documentTypeSigned)};BX.Bizproc.WorkflowEditComponent.Globals.onAfterSliderClose=function(o,e){var t=o.getData();if(t.get("upsert")){var a=t.get("upsert");for(var r in a){e[r]=a[r]}}if(t.get("delete")){var n=t.get("delete");for(var i in n){delete e[n[i]]}}};BX.Bizproc.WorkflowEditComponent.Globals.showGlobalVariables=function(){var o=this;BX.Bizproc.Globals.Manager.Instance.showGlobals(BX.Bizproc.Globals.Manager.Instance.mode.variable,String(this.documentTypeSigned)).then(function(e){o.onAfterSliderClose(e,arWorkflowGlobalVariables)})};BX.Bizproc.WorkflowEditComponent.Globals.showGlobalConstants=function(){var o=this;BX.Bizproc.Globals.Manager.Instance.showGlobals(BX.Bizproc.Globals.Manager.Instance.mode.constant,String(this.documentTypeSigned)).then(function(e){o.onAfterSliderClose(e,arWorkflowGlobalConstants)})}})();function BPImportToClipboard(){var o=JSON.stringify({template:rootActivity.Serialize(),parameters:arWorkflowParameters,variables:arWorkflowVariables,constants:arWorkflowConstants});BX.clipboard.copy(encodeURIComponent(o))}function BPExportFromString(o){try{var e=JSON.parse(decodeURIComponent(o))}catch(o){e={}}if(e.parameters&&BX.type.isPlainObject(e.parameters)){arWorkflowParameters=e.parameters}if(e.variables&&BX.type.isPlainObject(e.variables)){arWorkflowVariables=e.variables}if(e.constants&&BX.type.isPlainObject(e.constants)){arWorkflowConstants=e.constants}if(e.template&&BX.type.isPlainObject(e.template)){arWorkflowTemplate=e.template;ReDraw()}}
/* End */
;
; /* Start:"a:4:{s:4:"full";s:81:"/bitrix/activities/bitrix/emptyblockactivity/emptyblockactivity.js?16992579522411";s:6:"source";s:66:"/bitrix/activities/bitrix/emptyblockactivity/emptyblockactivity.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
/////////////////////////////////////////////////////////////////////////////////////
// WhileActivity
/////////////////////////////////////////////////////////////////////////////////////
EmptyBlockActivity = function()
{
	var ob = new BizProcActivity();
	ob.Type = 'EmptyBlockActivity';

	ob.BizProcActivityDraw = ob.Draw;
	ob.Draw = function (container)
	{
		if(ob.childActivities.length == 0 )
		{
			ob.childActivities = [new SequenceActivity()];
			ob.childActivities[0].parentActivity = ob;
		}

		ob.container = container.appendChild(document.createElement('DIV'));
		if(!jsUtils.IsIE())
			ob.container.className = 'parallelcontainer';

		ob.BizProcActivityDraw(ob.container);
		ob.activityContent = null;

		//ob.div.className = 'parallelcontainer';
		ob.div.style.position = 'relative';
		ob.div.style.top = '12px';



		ob.hideContainer = ob.container.appendChild(document.createElement('DIV'));
		ob.hideContainer.style.background = '#FFFFFF';
		ob.hideContainer.style.border = '1px #CCCCCC dashed';
		ob.hideContainer.style.width = '250px';
		ob.hideContainer.style.color = '#AAAAAA';
		ob.hideContainer.style.padding = '13px 0px 3px 0px';
		ob.hideContainer.style.cursor = 'pointer';
		ob.hideContainer.innerHTML = BPMESS['PARA_MIN'];
		ob.hideContainer.onclick = ob.OnHideClick;

		ob.childsContainer = ob.container.appendChild(_crt(1, 3));
		ob.childsContainer.rows[0].cells[0].width = '15%';
		ob.childsContainer.rows[0].cells[1].width = '70%';
		ob.childsContainer.rows[0].cells[2].width = '15%';
		ob.childsContainer.rows[0].cells[1].style.border = '2px #dfdfdf dashed';
		ob.childsContainer.id = ob.Name;

		//ob.childsContainer.style.background = '#FFFFFF';
		if(ob.Properties['_DesMinimized'] == 'Y')
		{
			ob.childsContainer.style.display = 'none';		
		}
		else
		{
			ob.hideContainer.style.display = 'none';
		}


		ob.childsContainer.rows[0].cells[1].style.padding = '10px';

		ob.childActivities[0].Draw(ob.childsContainer.rows[0].cells[1]);
	}


	ob.CheckFields = function ()
	{
		return true;
	}

	ob.OnHideClick = function ()
	{
		if(ob.Properties['_DesMinimized'] == 'Y')
		{
			ob.Properties['_DesMinimized'] = 'N';
			ob.childsContainer.style.display = 'table';
			ob.hideContainer.style.display = 'none';
		}
		else
		{
			ob.Properties['_DesMinimized'] = 'Y';
			ob.childsContainer.style.display = 'none';
			ob.hideContainer.style.display = 'block';
		}
	}


	return ob;
}

/* End */
;
; /* Start:"a:4:{s:4:"full";s:75:"/bitrix/activities/bitrix/approveactivity/approveactivity.js?16992579521249";s:6:"source";s:60:"/bitrix/activities/bitrix/approveactivity/approveactivity.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
////////////////////////////////////////////////////////////////////////////////////////
// ApproveActivity
////////////////////////////////////////////////////////////////////////////////////////

ApproveActivity = function()
{
	var ob = new ParallelActivity();
	ob.Type = 'ApproveActivity';
	ob.__parallelActivityInitType = 'SequenceActivity';

	ob.DrawParallelActivity = ob.Draw;

	ob.Draw = function (d)
	{
		var act = _crt(1, 4);
		act.style.fontSize = '11px';

		act.rows[0].cells[1].style.background = 'url('+ob.Icon+') 2px 2px no-repeat';
		act.rows[0].cells[1].style.height = '24px';
		act.rows[0].cells[1].style.width = '24px';

		act.rows[0].cells[2].align = 'left';
		act.rows[0].cells[2].innerHTML = HTMLEncode(ob['Properties']['Title']);

		act.rows[0].cells[0].width = '33';
		act.rows[0].cells[0].align = 'left';
		act.rows[0].cells[0].innerHTML = '&nbsp;<span style="color: #007700">'+BPMESS['APPR_YES']+'</span>';
		act.rows[0].cells[3].align = 'right';
		act.rows[0].cells[3].innerHTML = '<span style="color: #770000">'+BPMESS['APPR_NO']+'</span>&nbsp;';

		ob.activityContent = act;
		ob.activityHeight = '30px';
		ob.activityWidth = '200px';
		ob.DrawParallelActivity(d);
	}

	return ob;
}

/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/activities/bitrix/ifelsebranchactivity/ifelsebranchactivity.min.js?16992579522200";s:6:"source";s:70:"/bitrix/activities/bitrix/ifelsebranchactivity/ifelsebranchactivity.js";s:3:"min";s:74:"/bitrix/activities/bitrix/ifelsebranchactivity/ifelsebranchactivity.min.js";s:3:"map";s:74:"/bitrix/activities/bitrix/ifelsebranchactivity/ifelsebranchactivity.map.js";}"*/
IfElseBranchActivity=function(){var e=new SequenceActivity;e.Type="IfElseBranchActivity";e.iHead=1;e.Draw=function(i){e.container=i;e.childsContainer=i.appendChild(_crt(1+e.iHead+e.childActivities.length*2,1));e.childsContainer.className="seqactivitycontainer";e.childsContainer.id=e.Name;e.childsContainer.style.height="100%";var t=e.childsContainer.rows[0].cells[0].appendChild(document.createElement("DIV"));t.className="activity";t.style.margin="0px auto";t.style.textAlign="center";t.style.width="190px";t.style.height="20px";t.style.marginTop="7px";t.style.margin="5px";t.innerHTML='<div style="background: url(/bitrix/images/bizproc/cond_bg.gif);"><div style="background: url(/bitrix/images/bizproc/cond_r.gif) right top no-repeat;"><div style="background: url(/bitrix/images/bizproc/cond_l.gif) left top no-repeat; height: 23px; overflow-y: hidden;"><div style="padding-top: 5px; font-size: 12px; height: 23px; overflow-y: hidden; padding-right: 5px;"></div></div></div></div>';t.ondblclick=e.OnSettingsClick;var n=t.childNodes[0].childNodes[0].childNodes[0].childNodes[0].appendChild(_crt(1,2));n.rows[0].cells[0].title=e.Properties["Title"];n.rows[0].cells[0].width="100%";n.rows[0].cells[0].style.fontSize="11px";var l=n.rows[0].cells[0].appendChild(document.createElement("DIV"));l.innerHTML=BX.util.htmlspecialchars(e.Properties["Title"]);l.style.overflow="hidden";l.style.width="165px";l.style.whiteSpace="nowrap";l.style.textOverflow="ellipsis";var r=n.rows[0].cells[1].appendChild(document.createElement("IMG"));n.rows[0].cells[1].width="1%";n.rows[0].cells[1].vAlign="top";r.width="12";r.height="12";r.src="/bitrix/images/bizproc/act_button_sett_gray.gif";r.onclick=e.Settings;r.style.cursor="pointer";e.CreateLine(0);for(var c in e.childActivities){if(!e.childActivities.hasOwnProperty(c))continue;e.childActivities[c].Draw(e.childsContainer.rows[e.iHead+c*2+1].cells[0]);e.CreateLine(parseInt(c)+1)}e.drawEditorComment(t)};return e};IfElseBranchActivity.changeConditionTypeHandler=function(e){Array.from(e.options).forEach(function(e){var i=document.getElementById(e.getAttribute("data-id"));i.style.display=e.selected?"":"none"})};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:76:"/bitrix/activities/bitrix/ifelseactivity/ifelseactivity.min.js?1699257952220";s:6:"source";s:58:"/bitrix/activities/bitrix/ifelseactivity/ifelseactivity.js";s:3:"min";s:62:"/bitrix/activities/bitrix/ifelseactivity/ifelseactivity.min.js";s:3:"map";s:62:"/bitrix/activities/bitrix/ifelseactivity/ifelseactivity.map.js";}"*/
IfElseActivity=function(){var t=new ParallelActivity;t.Type="IfElseActivity";t.allowSort=true;t.childActivities=[];t.__parallelActivityInitType="IfElseBranchActivity";return t};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:86:"/bitrix/activities/bitrix/eventdrivenactivity/eventdrivenactivity.min.js?1699257952577";s:6:"source";s:68:"/bitrix/activities/bitrix/eventdrivenactivity/eventdrivenactivity.js";s:3:"min";s:72:"/bitrix/activities/bitrix/eventdrivenactivity/eventdrivenactivity.min.js";s:3:"map";s:72:"/bitrix/activities/bitrix/eventdrivenactivity/eventdrivenactivity.map.js";}"*/
EventDrivenActivity=function(){var t=new SequentialWorkflowActivity;t.Type="EventDrivenActivity";t.DrawSequentialWorkflowActivity=t.Draw;t.Draw=function(i){if(t.parentActivity.Type=="StateActivity")t.DrawSequentialWorkflowActivity(i);else t.DrawSequenceActivity(i)};t.AfterSDraw=function(){if(t.parentActivity.Type=="StateActivity"&&t.childsContainer.rows.length>2){t.childsContainer.rows[0].style.display="none";t.childsContainer.rows[1].style.display="none"}};t.SetError=function(i,e){t.parentActivity.SetError(i,e)};return t};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:98:"/bitrix/activities/bitrix/statefinalizationactivity/statefinalizationactivity.min.js?1699257952173";s:6:"source";s:80:"/bitrix/activities/bitrix/statefinalizationactivity/statefinalizationactivity.js";s:3:"min";s:84:"/bitrix/activities/bitrix/statefinalizationactivity/statefinalizationactivity.min.js";s:3:"map";s:84:"/bitrix/activities/bitrix/statefinalizationactivity/statefinalizationactivity.map.js";}"*/
StateFinalizationActivity=function(){var t=new SequentialWorkflowActivity;t.Type="StateFinalizationActivity";return t};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:102:"/bitrix/activities/bitrix/stateinitializationactivity/stateinitializationactivity.min.js?1699257952179";s:6:"source";s:84:"/bitrix/activities/bitrix/stateinitializationactivity/stateinitializationactivity.js";s:3:"min";s:88:"/bitrix/activities/bitrix/stateinitializationactivity/stateinitializationactivity.min.js";s:3:"map";s:88:"/bitrix/activities/bitrix/stateinitializationactivity/stateinitializationactivity.map.js";}"*/
StateInitializationActivity=function(){var t=new SequentialWorkflowActivity;t.Type="StateInitializationActivity";return t};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:79:"/bitrix/activities/bitrix/foreachactivity/foreachactivity.min.js?16992579521748";s:6:"source";s:60:"/bitrix/activities/bitrix/foreachactivity/foreachactivity.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
ForEachActivity=function(){var i=new BizProcActivity;i.Type="ForEachActivity";i.BizProcActivityDraw=i.Draw;i.Draw=function(e){if(i.childActivities.length==0){i.childActivities=[new SequenceActivity];i.childActivities[0].parentActivity=i}i.container=e.appendChild(document.createElement("DIV"));if(!jsUtils.IsIE())i.container.className="parallelcontainer";i.BizProcActivityDraw(i.container);i.activityContent=null;i.div.style.position="relative";i.div.style.top="12px";i.hideContainer=i.container.appendChild(document.createElement("DIV"));i.hideContainer.style.background="#FFFFFF";i.hideContainer.style.border="1px #CCCCCC dashed";i.hideContainer.style.width="250px";i.hideContainer.style.color="#AAAAAA";i.hideContainer.style.padding="13px 0px 3px 0px";i.hideContainer.style.cursor="pointer";i.hideContainer.innerHTML=BPMESS["PARA_MIN"];i.hideContainer.onclick=i.OnHideClick;i.childsContainer=i.container.appendChild(_crt(1,3));i.childsContainer.rows[0].cells[0].width="15%";i.childsContainer.rows[0].cells[1].width="70%";i.childsContainer.rows[0].cells[2].width="15%";i.childsContainer.rows[0].cells[1].style.border="2px #dfdfdf dashed";i.childsContainer.id=i.Name;if(i.Properties["_DesMinimized"]=="Y"){i.childsContainer.style.display="none"}else{i.hideContainer.style.display="none"}i.childsContainer.rows[0].cells[1].style.padding="10px";i.childActivities[0].Draw(i.childsContainer.rows[0].cells[1])};i.CheckFields=function(){return true};i.OnHideClick=function(){if(i.Properties["_DesMinimized"]=="Y"){i.Properties["_DesMinimized"]="N";i.childsContainer.style.display="table";i.hideContainer.style.display="none"}else{i.Properties["_DesMinimized"]="Y";i.childsContainer.style.display="none";i.hideContainer.style.display="block"}};return i};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:72:"/bitrix/activities/bitrix/listenactivity/listenactivity.js?1699257952373";s:6:"source";s:58:"/bitrix/activities/bitrix/listenactivity/listenactivity.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
////////////////////////////////////////////////////////////////////////////////////////
// ListenActivity
////////////////////////////////////////////////////////////////////////////////////////

ListenActivity = function()
{
	var ob = new ParallelActivity();
	ob.Type = 'ListenActivity';
	ob.__parallelActivityInitType = 'EventDrivenActivity';

	return ob;
}

/* End */
;
; /* Start:"a:4:{s:4:"full";s:81:"/bitrix/activities/bitrix/parallelactivity/parallelactivity.min.js?16992579526110";s:6:"source";s:62:"/bitrix/activities/bitrix/parallelactivity/parallelactivity.js";s:3:"min";s:66:"/bitrix/activities/bitrix/parallelactivity/parallelactivity.min.js";s:3:"map";s:66:"/bitrix/activities/bitrix/parallelactivity/parallelactivity.map.js";}"*/
ParallelActivity=function(){var e=new BizProcActivity;e.Type="ParallelActivity";e.childActivities=[];e.__parallelActivityInitType="SequenceActivity";e.allowSort=false;function i(e){return e.ctrlKey==true||e.metaKey==true}function t(e,i){const t=i.nextElementSibling;const n=i.parentNode;e.replaceWith(i);n.insertBefore(e,t)}e.copyBranch=function(i){e.createBranch(e.childActivities[i],i)};e.addBranch=function(){var i=e.childsContainer.rows[2].cells.length-1;e.createBranch(e.__parallelActivityInitType,i)};e.createBranch=function(i,t){var n;var l;var r=CreateActivity(i);r.parentActivity=e;e.childActivities.push([]);for(n=e.childActivities.length-1;n>t;n--)e.childActivities[n]=e.childActivities[n-1];e.childActivities[t]=r;for(n=0;n<e.childsContainer.rows.length;n++){l=e.childsContainer.rows[n].insertCell(t);l.align="center";l.vAlign="top"}e.DrawVLine(t);r.Draw(e.childsContainer.rows[2].cells[t]);e.RefreshDelButton()};e.delBranch=function(i){var t=this.parentNode.parentNode.ind;e.RemoveChild(e.childActivities[t])};e.DrawVLine=function(i){e.childsContainer.rows[0].className="trLine";e.childsContainer.rows[3].className="trLine";e.childsContainer.rows[1].cells[i].style.background="url(/bitrix/images/bizproc/act_line_bg.gif) 50% top repeat-y";e.childsContainer.rows[2].cells[i].style.background="url(/bitrix/images/bizproc/act_line_bg.gif) 50% top repeat-y";e.childsContainer.rows[2].cells[i].vAlign="top";var t=e.childsContainer.rows[1].cells[i];t.height="20";t.vAlign="bottom";var n=t.appendChild(document.createElement("DIV"));n.style.marginTop="14px";n.style.display="none";var l=n.appendChild(document.createElement("IMG"));l.src="/bitrix/images/bizproc/del_br.gif";l.height="14";l.width="14";l.style.cursor="pointer";l.onclick=e.delBranch;l.title=BPMESS["PARA_DEL"];if(e.allowSort){e.drawMoveElement(i,t)}};e.RefreshDelButton=function(){var i;var t=e.childActivities.length;for(i=0;i<t;i++){if(e.childActivities.length>2)e.childsContainer.rows[1].cells[i].childNodes[0].style.display="block";else e.childsContainer.rows[1].cells[i].childNodes[0].style.display="none";e.childsContainer.rows[1].cells[i].ind=i}};e.OnHideClick=function(){if(e.Properties["_DesMinimized"]=="Y"){e.Properties["_DesMinimized"]="N";e.childsContainer.style.display="table";e.hideContainer.style.display="none"}else{e.Properties["_DesMinimized"]="Y";e.childsContainer.style.display="none";e.hideContainer.style.display="block"}};e.BizProcActivityDraw=e.Draw;e.Draw=function(i){if(e.childActivities.length==0){e.childActivities=[CreateActivity(e.__parallelActivityInitType),CreateActivity(e.__parallelActivityInitType)];e.childActivities[0].parentActivity=e;e.childActivities[1].parentActivity=e}e.container=i.appendChild(document.createElement("DIV"));if(!jsUtils.IsIE())e.container.className="parallelcontainer";if(!e.activityContent){var t=_crt(1,3);t.style.fontSize="11px";t.rows[0].cells[0].style.background="url("+(e.Icon?e.Icon:"/bitrix/images/bizproc/act_icon.gif")+") 2px 2px no-repeat";t.rows[0].cells[0].style.height="24px";t.rows[0].cells[0].style.width="24px";t.rows[0].cells[1].align="left";t.rows[0].cells[1].innerHTML=HTMLEncode(e["Properties"]["Title"]);t.rows[0].cells[2].style.background="url(/bitrix/images/bizproc/add_br.gif) left center no-repeat";t.rows[0].cells[2].style.width="16px";t.rows[0].cells[2].style.cursor="pointer";t.rows[0].cells[2].title=BPMESS["PARA_ADD"];t.rows[0].cells[2].onclick=e.addBranch;e.activityContent=t}e.BizProcActivityDraw(e.container);e.activityContent=null;e.div.style.position="relative";e.div.style.top="12px";e.hideContainer=e.container.appendChild(document.createElement("DIV"));e.hideContainer.style.background="#FFFFFF";e.hideContainer.style.border="1px #CCCCCC dotted";e.hideContainer.style.width="250px";e.hideContainer.style.color="#AAAAAA";e.hideContainer.style.padding="13px 0px 3px 0px";e.hideContainer.style.cursor="pointer";e.hideContainer.innerHTML=BPMESS["PARA_MIN"];e.hideContainer.onclick=e.OnHideClick;e.childsContainer=e.container.appendChild(_crt(4,e.childActivities.length));e.childsContainer.id=e.Name;e.childsContainer.style.background="#FFFFFF";if(e.Properties["_DesMinimized"]=="Y"){e.childsContainer.style.display="none"}else{e.hideContainer.style.display="none"}for(var n in this.childActivities){if(!this.childActivities.hasOwnProperty(n))continue;e.DrawVLine(n);e.childActivities[n].Draw(e.childsContainer.rows[2].cells[n])}e.RefreshDelButton()};e.ActivityRemoveChild=e.RemoveChild;e.RemoveChild=function(i){var t,n;for(t=0;t<e.childActivities.length;t++){if(e.childActivities[t].Name==i.Name){e.ActivityRemoveChild(i);if(e.childsContainer){e.childsContainer.rows[0].deleteCell(t);e.childsContainer.rows[1].deleteCell(t);e.childsContainer.rows[2].deleteCell(t);e.childsContainer.rows[3].deleteCell(t);e.RefreshDelButton()}break}}};e.BizProcActivityRemoveResources=e.RemoveResources;e.RemoveResources=function(){e.BizProcActivityRemoveResources();if(e.container&&e.container.parentNode){e.container.parentNode.removeChild(e.container);e.container=null}};e.drawMoveElement=function(i,t){var n=t.appendChild(document.createElement("DIV"));n.className="move-thread";var l=n.appendChild(document.createElement("DIV"));l.className="to-left";l.onclick=e.moveToLeft;l.title=BPMESS["PARA_MOVE_LEFT"];var r=n.appendChild(document.createElement("DIV"));r.className="to-right";r.onclick=e.moveToRight;r.title=BPMESS["PARA_MOVE_RIGHT"]};e.moveToRight=function(t){var n=this.parentNode.parentNode.ind;if(n===e.childActivities.length){return}if(i(t)){e.copyBranch(n)}else{e.swapBranch(n,n+1)}BPTemplateIsModified=true;return false};e.moveToLeft=function(t){var n=this.parentNode.parentNode.ind;if(n===0){return}if(i(t)){e.copyBranch(n)}else{e.swapBranch(n-1,n)}BPTemplateIsModified=true;return false};e.swapBranch=function(i,n){var l=e.childActivities[i];e.childActivities[i]=e.childActivities[n];e.childActivities[n]=l;for(var r=1;r<3;r++){e.childsContainer.rows[r].cells[i].ind=n;e.childsContainer.rows[r].cells[n].ind=i;t(e.childsContainer.rows[r].cells[i],e.childsContainer.rows[r].cells[n])}};return e};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:74:"/bitrix/activities/bitrix/delayactivity/delayactivity.min.js?1699257952181";s:6:"source";s:56:"/bitrix/activities/bitrix/delayactivity/delayactivity.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
DelayActivity=function(){var i=new BizProcActivity;i.Type="DelayActivity";i.CheckFields=function(){return!!i.Properties["TimeoutDuration"]||!!i.Properties["TimeoutTime"]};return i};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:117:"/bitrix/activities/bitrix/requestinformationoptionalactivity/requestinformationoptionalactivity.min.js?16992579521095";s:6:"source";s:98:"/bitrix/activities/bitrix/requestinformationoptionalactivity/requestinformationoptionalactivity.js";s:3:"min";s:102:"/bitrix/activities/bitrix/requestinformationoptionalactivity/requestinformationoptionalactivity.min.js";s:3:"map";s:102:"/bitrix/activities/bitrix/requestinformationoptionalactivity/requestinformationoptionalactivity.map.js";}"*/
RequestInformationOptionalActivity=function(){var l=new ParallelActivity;l.Type="RequestInformationOptionalActivity";l.__parallelActivityInitType="SequenceActivity";l.DrawParallelActivity=l.Draw;l.Draw=function(t){var e=_crt(1,4);e.style.fontSize="11px";e.rows[0].cells[1].style.background="url("+(l.Icon?l.Icon:"/bitrix/images/bizproc/act_icon.gif")+") 2px 2px no-repeat";e.rows[0].cells[1].style.height="24px";e.rows[0].cells[1].style.width="24px";e.rows[0].cells[2].align="left";e.rows[0].cells[2].innerHTML=HTMLEncode(l["Properties"]["Title"]);e.rows[0].cells[2].style.overflow="hidden";e.rows[0].cells[2].style.lineHeight="14px";e.rows[0].cells[0].width="33";e.rows[0].cells[0].align="left";e.rows[0].cells[0].innerHTML='&nbsp;<span style="color: #007700">'+BPMESS["BPRIOA_OK"]+"</span>";e.rows[0].cells[3].align="right";e.rows[0].cells[3].innerHTML='<span style="color: #770000">'+BPMESS["BPRIOA_CANCEL"]+"</span>&nbsp;";l.activityContent=e;l.activityHeight="30px";l.activityWidth="200px";l.DrawParallelActivity(t)};return l};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:81:"/bitrix/activities/bitrix/sequenceactivity/sequenceactivity.min.js?16992579527262";s:6:"source";s:62:"/bitrix/activities/bitrix/sequenceactivity/sequenceactivity.js";s:3:"min";s:66:"/bitrix/activities/bitrix/sequenceactivity/sequenceactivity.min.js";s:3:"map";s:66:"/bitrix/activities/bitrix/sequenceactivity/sequenceactivity.map.js";}"*/
var _SequenceActivityCurClick=null;function _SequenceActivityClick(i,e,t){const r=t?arAllActivities[i]["PRESETS"].find((i=>i["ID"]===t)):null;const n=r?r["PROPERTIES"]:{};const a={Properties:{Title:r&&r["NAME"]||HTMLEncode(arAllActivities[i]["NAME"]),...n},Type:arAllActivities[i]["CLASS"],Children:[]};_SequenceActivityCurClick.AddActivity(CreateActivity(a),e)}function _SequenceActivityMyActivityClick(i,e){if(arUserParams&&BX.type.isArray(arUserParams["SNIPPETS"])&&arUserParams["SNIPPETS"][i]){_SequenceActivityCurClick.AddActivity(CreateActivity(arUserParams["SNIPPETS"][i]),e)}}SequenceActivity=function(){var i=new BizProcActivity;i.Type="SequenceActivity";i.childsContainer=null;i.iHead=0;i.LineMouseOver=function(i){this.parentNode.style.backgroundImage="url(/bitrix/images/bizproc/arr_over.gif)"};i.LineMouseOut=function(i){this.parentNode.style.backgroundImage="url(/bitrix/images/bizproc/arr.gif)"};i.OnClick=function(e){_SequenceActivityCurClick=i;var t=[];var r,n;for(r in arAllActGroups){n=[];for(var a in arAllActivities){if(!arAllActivities.hasOwnProperty(a))continue;if(arAllActivities[a]["EXCLUDED"]||!arAllActivities[a]["CATEGORY"])continue;var l=arAllActivities[a]["CATEGORY"]["ID"];if(arAllActivities[a]["CATEGORY"]["OWN_ID"])l=arAllActivities[a]["CATEGORY"]["OWN_ID"];if(l!=r)continue;if(a=="setstateactivity"&&rootActivity.Type==i.Type)continue;n.push({ICON:"url("+arAllActivities[a]["ICON"]+")",TEXT:'<img src="'+(arAllActivities[a]["ICON"]?arAllActivities[a]["ICON"]:"/bitrix/images/bizproc/act_icon.gif")+'" align="left" style="margin-right: 7px;margin-left: 0px">'+"<b>"+HTMLEncode(arAllActivities[a]["NAME"])+"</b><br>"+HTMLEncode(arAllActivities[a]["DESCRIPTION"]),ONCLICK:"_SequenceActivityClick('"+a+"', "+this.ind+");"});const e=arAllActivities[a]["PRESETS"];if(BX.Type.isArrayFilled(e)){e.forEach((i=>{n.push({ICON:"url("+arAllActivities[a]["ICON"]+")",TEXT:'<img src="'+(arAllActivities[a]["ICON"]?arAllActivities[a]["ICON"]:"/bitrix/images/bizproc/act_icon.gif")+'" align="left" style="margin-right: 7px;margin-left: 0px">'+"<b>"+HTMLEncode(i["NAME"])+"</b><br>"+HTMLEncode(i["DESCRIPTION"]||arAllActivities[a]["DESCRIPTION"]),ONCLICK:"_SequenceActivityClick('"+a+"', "+this.ind+", '"+i["ID"]+"');"})}))}}if(r==="rest"&&BX.getClass("BX.rest.Marketplace")){n.push({ICON:"url(/bitrix/images/bizproc/act_icon_plus.png)",TEXT:'<img src="/bitrix/images/bizproc/act_icon_plus.png" align="left" style="margin-right: 7px;margin-left: 0px">'+"<b>"+HTMLEncode(BPMESS["BPSA_MARKETPLACE_ADD_TITLE_2"])+"</b><br>"+HTMLEncode(BPMESS["BPSA_MARKETPLACE_ADD_DESCR_3"]),ONCLICK:"BX.rest.Marketplace.open({}, 'auto_pb'); if(window.jsPopup_WFAct) {window.jsPopup_WFAct.PopupHide();}"})}if(n.length>0)t.push({TEXT:HTMLEncode(arAllActGroups[r]),MENU:n})}if(arUserParams&&BX.type.isArray(arUserParams["SNIPPETS"])){n=[];for(var c in arUserParams["SNIPPETS"]){if(!arUserParams["SNIPPETS"].hasOwnProperty(c)){continue}var o=arUserParams["SNIPPETS"][c]["Icon"];if(!o){o="/bitrix/images/bizproc/act_icon.gif"}var s=arUserParams["SNIPPETS"][c]["Properties"]["Title"];n.push({ICON:"url("+o+")",TEXT:'<img src="'+o+'" align="left" style="margin-right: 7px;margin-left: 0px">'+"<b>"+HTMLEncode(s)+"</b>",ONCLICK:"_SequenceActivityMyActivityClick('"+c+"', "+this.ind+");"})}if(n.length>0)t.push({TEXT:HTMLEncode(BPMESS["BPSA_MY_ACTIVITIES_1"]),MENU:n})}if(window.jsPopup_WFAct)window.jsPopup_WFAct.PopupHide();else window.jsPopup_WFAct=new PopupMenu("PopupWFAct",3e4);window.jsPopup_WFAct.ShowMenu(this,t)};i.lastDrop=false;i.ondragging=function(e,t,r){if(!i.childsContainer)return false;for(var n=0;n<=i.childActivities.length;n++){var a=i.childsContainer.rows[n*2+i.iHead].cells[0].childNodes[0];var l=BX.pos(a);if(l.left<t&&t<l.right&&l.top<r&&r<l.bottom){a.onmouseover();i.lastDrop=a;return}}if(i.lastDrop){i.lastDrop.onmouseout();i.lastDrop=false}};i.h1id=DragNDrop.AddHandler("ondragging",i.ondragging);i.ondrop=function(e,t,r){if(!i.childsContainer)return false;if(i.lastDrop){var n;if(DragNDrop.obj.parentActivity&&(r.ctrlKey==false&&r.metaKey==false)){var a,l=-1,c=DragNDrop.obj.parentActivity;for(a=0;a<c.childActivities.length;a++){if(c.childActivities[a].Name==DragNDrop.obj.Name){l=a;break}}if(c.Name!=i.Name||l!=i.lastDrop.ind&&l+1!=i.lastDrop.ind){var o=i,s=false;while(o){if(DragNDrop.obj.Name==o.Name){s=true;break}o=o.parentActivity}if(s){alert(BPMESS["BPSA_ERROR_MOVE_1"])}else{c.childsContainer.deleteRow(l*2+1+c.iHead);c.childsContainer.deleteRow(l*2+1+c.iHead);for(var d=l;d<c.childActivities.length-1;d++)c.childActivities[d]=c.childActivities[d+1];c.childActivities.pop();for(d=0;d<=c.childActivities.length;d++)c.childsContainer.rows[d*2+c.iHead].cells[0].childNodes[0].ind=d;n=DragNDrop.obj;i.AddActivity(n,i.lastDrop.ind)}}}else{n=CreateActivity(DragNDrop.obj);i.AddActivity(n,i.lastDrop.ind)}i.lastDrop.onmouseout();i.lastDrop=false}};i.h2id=DragNDrop.AddHandler("ondrop",i.ondrop);i.ActivityRemoveChild=i.RemoveChild;i.RemoveChild=function(e){var t,r;for(t=0;t<i.childActivities.length;t++){if(i.childActivities[t].Name==e.Name){if(i.childsContainer){i.childsContainer.rows[t*2+1+i.iHead].cells[0].childNodes[0].onmouseover=null;i.childsContainer.rows[t*2+1+i.iHead].cells[0].childNodes[0].onmouseout=null;i.childsContainer.rows[t*2+1+i.iHead].cells[0].childNodes[0].onclick=null}i.ActivityRemoveChild(e);if(i.childsContainer){i.childsContainer.deleteRow(t*2+1+i.iHead);i.childsContainer.deleteRow(t*2+1+i.iHead);for(r=0;r<=i.childActivities.length;r++)i.childsContainer.rows[r*2+i.iHead].cells[0].childNodes[0].ind=r}break}}};i.RemoveResources=function(e){DragNDrop.RemoveHandler("ondragging",i.h1id);DragNDrop.RemoveHandler("ondrop",i.h2id);if(i.childsContainer&&i.childsContainer.parentNode){i.childsContainer.parentNode.removeChild(i.childsContainer);i.childsContainer=null}};i.AddActivity=function(e,t){var r;for(r=i.childActivities.length;r>t;r--)i.childActivities[r]=i.childActivities[r-1];i.childActivities[t]=e;e.parentActivity=i;var n=i.childsContainer.insertRow(t*2+1+i.iHead).insertCell(-1);n.align="center";n.vAlign="center";e.Draw(n);n=i.childsContainer.insertRow(t*2+2+i.iHead).insertCell(-1);n.align="center";n.vAlign="center";i.CreateLine(t+1);for(r=0;r<=i.childActivities.length;r++)i.childsContainer.rows[r*2+i.iHead].cells[0].childNodes[0].ind=r;BPTemplateIsModified=true};i.CreateLine=function(e){i.childsContainer.rows[e*2+i.iHead].cells[0].style.height="40px";i.childsContainer.rows[e*2+i.iHead].cells[0].style.background="url(/bitrix/images/bizproc/arr.gif) no-repeat scroll 50% 50%";var t=i.childsContainer.rows[e*2+i.iHead].cells[0].appendChild(document.createElement("IMG"));t.src="/bitrix/images/1.gif";t.width="28";t.height="21";t.onmouseover=i.LineMouseOver;t.onmouseout=i.LineMouseOut;t.onclick=i.OnClick;t.ind=e};i.ActivityDraw=i.Draw;i.Draw=function(e){i.childsContainer=e.appendChild(_crt(1+i.childActivities.length*2+i.iHead,1));i.childsContainer.className="seqactivitycontainer";i.childsContainer.id=i.Name;i.CreateLine(0);for(var t in i.childActivities){if(!i.childActivities.hasOwnProperty(t))continue;i.childActivities[t].Draw(i.childsContainer.rows[t*2+1+i.iHead].cells[0]);i.CreateLine(parseInt(t)+1)}if(i.AfterSDraw)i.AfterSDraw()};return i};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:102:"/bitrix/activities/bitrix/sequentialworkflowactivity/sequentialworkflowactivity.min.js?169925795211430";s:6:"source";s:82:"/bitrix/activities/bitrix/sequentialworkflowactivity/sequentialworkflowactivity.js";s:3:"min";s:86:"/bitrix/activities/bitrix/sequentialworkflowactivity/sequentialworkflowactivity.min.js";s:3:"map";s:86:"/bitrix/activities/bitrix/sequentialworkflowactivity/sequentialworkflowactivity.map.js";}"*/
SequentialWorkflowActivity=function(){var e=new SequenceActivity;e.Type="SequentialWorkflowActivity";e.swfWorkspaceDiv=null;e.swfToolBoxDiv=null;e.Table=null;e.hSnippid1=false;e.onScroll=function(){var t=BX("bx-panel");if(!t)return;var i=0;if(BX.hasClass(t,"bx-panel-fixed")){var l=BX.pos(t);i=l.height}var r=BX.GetWindowInnerSize();var o=BX.pos(e.swfWorkspaceDiv);if(o.height>r.innerHeight){var s=BX.pos(e.Table.rows[0].cells[2]);var a=BX.GetWindowScrollPos();if(a.scrollTop>s.top-i){e.swfToolboxDiv.style.position="fixed";e.swfToolboxDiv.style.top=i+"px";e.swfToolboxDiv.style.overflowY="auto";e.swfToolboxDiv.style.height=r.innerHeight-i+"px";e.swfToolboxDiv.style.width="200px";e.swfToolboxDiv.style.left=s.left-a.scrollLeft+0+"px"}else if(a.scrollTop<s.top-i){e.swfToolboxDiv.style.position="static"}if(a.scrollTop+r.innerHeight>s.bottom){e.swfToolboxDiv.style.height=s.bottom-a.scrollTop-i+"px"}}else{e.swfToolboxDiv.style.position="static"}};e.UpdateButtonPanel=function(){if(BX.UI.ButtonPanel&&BX.UI.ButtonPanel.pinner){BX.UI.ButtonPanel.pinner.onChange()}};e.DrawSequenceActivity=e.Draw;e.Draw=function(t){requestAnimationFrame((()=>{e.UpdateButtonPanel()}));if(!window.dlgSnippetsSettings){window.dlgSnippetsSettings=new BX.CDialog({content:'<table width="100%"><tr><td align="right" width="40%">'+BPMESS["SEQWF_SNIP_NAME"]+'</td><td width="60%"><input type="hidden" id="snippsid" value=""><input size="40" id="snippstitle" value=""></td></tr><tr><td align="right" width="40%"></td><td width="60%" style="height:100px"></td></tr><tr><td align="right" width="40%"></td><td width="60%"><input type="button" id="snippsdel" value="'+BPMESS["SEQWF_SNIP_DEL_1"]+'"></td></tr></table>',title:BPMESS["SEQWF_SNIP_TITLE_1"],height:200,width:400,buttons:[{title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",action:function(){var e=window.__lastSnippet;var t=e._ind;arUserParams["SNIPPETS"][t]["Properties"]["Title"]=BX("snippstitle").value;e.childNodes[0].rows[0].cells[1].innerHTML=HTMLEncode(document.getElementById("snippstitle").value);this.parentWindow.Close();BCPSaveUserParams()}},BX.CDialog.prototype.btnCancel]});setTimeout((function(){BX("snippsdel").onclick=function(){if(confirm(BPMESS["SEQWF_CONF_1"])){var e=window.__lastSnippet;var t=e._ind;arUserParams["SNIPPETS"].splice(t,1);var i=e.parentNode;BX.remove(e);for(var l=1;l<i.childNodes.length;l++)i.childNodes[l]._ind=l-1;window.dlgSnippetsSettings.Close();BCPSaveUserParams()}}}),1e3)}e.Table=t.appendChild(_crt(1,3));{window.onscroll=e.onScroll;window.onresize=e.onScroll}e.hSnippid1=DragNDrop.AddHandler("ondragging",e.ondragging2);e.hSnippid2=DragNDrop.AddHandler("ondrop",e.ondrop2);e.swfWorkspaceDiv=e.Table.rows[0].cells[0].appendChild(document.createElement("DIV"));e.swfWorkspaceDiv.className="swfworkspace";if(parseInt(t.clientHeight)>50)e.swfWorkspaceDiv.style.height=parseInt(t.clientHeight)+"px";e.ShowActivities(e.Table.rows[0].cells[2]);e._table=e.swfWorkspaceDiv.appendChild(_crt(3,1));e.Table.rows[0].cells[1].style.width="0px";e.Table.rows[0].cells[1].innerHTML='<img src="/bitrix/images/1.gif" width="0">';e.Table.rows[0].cells[2].style.width="200px";e.Table.rows[0].cells[0].vAlign="top";e.Table.rows[0].cells[2].vAlign="top";e.Table.rows[0].cells[2].align="left";e.Table.rows[0].cells[2].appendChild(document.createElement("DIV")).style.width="200px";var i=e._table.rows[0].cells[0].appendChild(document.createElement("DIV"));i.style.margin="0px auto";i.style.textAlign="center";i.style.width="120px";i.innerHTML='<div style="background: url(/bitrix/images/bizproc/beg_bg.gif);"><div style="background: url(/bitrix/images/bizproc/beg_r.gif) right top no-repeat;"><div style="background: url(/bitrix/images/bizproc/beg_l.gif) left top no-repeat; height: 23px;"><div style="padding-top: 3px; font-size: 12px; color:#194d0b;">'+BPMESS["SEQWF_BEG"]+"</div></div></div></div>";e.DrawActivities();var l=e._table.rows[2].cells[0].appendChild(document.createElement("DIV"));l.style.margin="0px auto";l.style.textAlign="center";l.style.width="120px";l.innerHTML='<div style="background: url(/bitrix/images/bizproc/beg_bg.gif);"><div  style="background: url(/bitrix/images/bizproc/beg_r.gif) right top no-repeat;"><div style="background: url(/bitrix/images/bizproc/beg_l.gif) left top no-repeat; height: 23px;"><div style="padding-top: 3px; font-size: 12px; color:#194d0b;">'+BPMESS["SEQWF_END"]+"</div></div></div></div>"};e.DrawActivities=function(){while(e._table.rows[1].cells[0].childNodes.length>0)e._table.rows[1].cells[0].removeChild(e._table.rows[1].cells[0].childNodes[0]);e.DrawSequenceActivity(e._table.rows[1].cells[0])};e.DrawGroup=function(t){var i=e.swfToolboxDiv.childNodes.length;var l=e.swfToolboxDiv.appendChild(document.createElement("DIV"));if(!arUserParams["TOOLBOX_GROUPS"])arUserParams["TOOLBOX_GROUPS"]=[];if(arUserParams["TOOLBOX_GROUPS"][i]==true)l.className="swftoolboxgroupopened";else l.className="swftoolboxgroupclosed";l.swftoolboxid=i;l.onclick=function(t){requestAnimationFrame((()=>{e.UpdateButtonPanel()}));if(this.className=="swftoolboxgroupclosed"){this.className="swftoolboxgroupopened";arUserParams["TOOLBOX_GROUPS"][this.swftoolboxid]=true}else{this.className="swftoolboxgroupclosed";arUserParams["TOOLBOX_GROUPS"][this.swftoolboxid]=false}BCPSaveUserParams()};var r=l.appendChild(document.createElement("DIV"));r.className="swftoolboxgroupheader";r.innerHTML='<div class="t"><div class="tr"><div class="tl"><div class="imarr"></div><div class="swftoolboxgrheadtext" title="'+HTMLEncode(t)+'">'+HTMLEncode(t)+"</div></div></div></div>";var o=l.appendChild(document.createElement("DIV"));o.className="swftoolboxgrouplist";return o};e.DrawGroupItem=function(e,t,i,l){var r,o,s;r=e.appendChild(document.createElement("DIV"));r.onclick=function(e){BX.PreventDefault(e)};if(t["NAME"]!==undefined)r.activityTemplate={Properties:{Title:t["NAME"]},Type:t["CLASS"],Children:[],Icon:t["ICON"]};else r.activityTemplate=t;var a=r.appendChild(_crt(1,3));a.rows[0].style.height="30px";a.rows[0].cells[0].style.width="30px";a.rows[0].cells[0].style.minWidth="30px";if(!r.activityTemplate["Icon"]&&arAllActivities[r.activityTemplate["Type"].toLowerCase()])r.activityTemplate["Icon"]=arAllActivities[r.activityTemplate["Type"].toLowerCase()]["ICON"];if(r.activityTemplate["Icon"])a.rows[0].cells[0].style.background="url("+r.activityTemplate["Icon"]+") 3px 3px no-repeat";else a.rows[0].cells[0].style.background="url(/bitrix/images/bizproc/act_icon.gif) 3px 3px no-repeat";a.rows[0].cells[0].style.cursor="pointer";a.rows[0].cells[1].style.cursor="pointer";a.rows[0].cells[1].style.fontSize="11px";a.rows[0].cells[1].innerHTML=HTMLEncode(r.activityTemplate["Properties"]["Title"]);a.rows[0].cells[1].align="left";if(i){a.rows[0].cells[2].style.width="14px";a.rows[0].cells[2].style.cursor="pointer";a.rows[0].cells[2].innerHTML='<img src="/bitrix/themes/.default/public/popup/pencil.gif" hspace="2">';a.rows[0].cells[2].onmousedown=function(e){return BX.PreventDefault(e)};r._ind=l;a.rows[0].cells[2].onclick=function(e){window.__lastSnippet=this.parentNode.parentNode.parentNode.parentNode;BX("snippstitle").value=r.activityTemplate["Properties"]["Title"];BX("snippsid").value=l;window.dlgSnippetsSettings.Show();return BX.PreventDefault(e)}}a.insertRow(-1);a.rows[1].insertCell(-1).innerHTML='<table width="100%" style="border-collapse: collapse" cellpadding="0" cellspacing="0" border="0"><tr><td width="5"></td><td style="border-bottom: 1px #EBEBEB solid; height: 1px; font-size: 1px;"><img src="/bitrix/images/1.gif" width="1" height="1"></td><td width="5"></td></tr></table>';a.rows[1].cells[0].colSpan="3";r.onmousedown=function(e){if(!e)e=window.event;var t=DragNDrop.StartDrag(e,this.activityTemplate);t.innerHTML=this.innerHTML;t.style.width=this.parentNode.offsetWidth+"px"}};e.DrawMarketplaceItem=function(e){var t,i,l;t=e.appendChild(document.createElement("DIV"));t.onclick=function(e){BX.PreventDefault(e);BX.rest.Marketplace.open({},"auto_pb")};var r=t.appendChild(_crt(1,3));r.rows[0].style.height="30px";r.rows[0].cells[0].style.width="30px";r.rows[0].cells[0].style.background="url(/bitrix/images/bizproc/act_icon_plus.png) 3px 3px no-repeat";r.rows[0].cells[0].style.cursor="pointer";r.rows[0].cells[1].style.cursor="pointer";r.rows[0].cells[1].style.fontSize="11px";r.rows[0].cells[1].innerHTML=HTMLEncode(BPMESS["SEQWF_MARKETPLACE_ADD"]);r.rows[0].cells[1].align="left";r.insertRow(-1);r.rows[1].insertCell(-1).innerHTML='<table width="100%" style="border-collapse: collapse" cellpadding="0" cellspacing="0" border="0"><tr><td width="5"></td><td style="border-bottom: 1px #EBEBEB solid; height: 1px; font-size: 1px;"><img src="/bitrix/images/1.gif" width="1" height="1"></td><td width="5"></td></tr></table>';r.rows[1].cells[0].colSpan="3"};e.ShowActivities=function(t){e.swfToolboxDiv=t.appendChild(document.createElement("DIV"));if(parseInt(t.clientHeight)>50)e.swfToolboxDiv.style.height=parseInt(t.clientHeight)+"px";e.swfToolboxDiv.style.overflowX="hidden";e.swfToolboxDiv.className="swftoolbox";var i,l;for(i in arAllActGroups){l=null;for(var r in arAllActivities){if(!arAllActivities.hasOwnProperty(r))continue;if(arAllActivities[r]["EXCLUDED"]||!arAllActivities[r]["CATEGORY"])continue;var o=arAllActivities[r]["CATEGORY"]["ID"];if(arAllActivities[r]["CATEGORY"]["OWN_ID"])o=arAllActivities[r]["CATEGORY"]["OWN_ID"];if(o!=i)continue;if(r=="setstateactivity"&&rootActivity.Type==e.Type)continue;if(l===null)l=e.DrawGroup(arAllActGroups[i]);e.DrawGroupItem(l,arAllActivities[r]);const t=arAllActivities[r]["PRESETS"];if(BX.Type.isArrayFilled(t)){t.forEach((t=>{const i={Properties:{Title:t["NAME"],...t["PROPERTIES"]},Type:arAllActivities[r]["CLASS"],Children:[],Icon:arAllActivities[r]["ICON"]};e.DrawGroupItem(l,i)}))}}if(i==="rest"&&BX.getClass("BX.rest.Marketplace")){if(l===null){l=e.DrawGroup(arAllActGroups[i])}e.DrawMarketplaceItem(l)}}var s=e.DrawGroup(BPMESS["SEQWF_SNIP_1"]);e.divSnippets=s;var a=s.appendChild(document.createElement("DIV"));a.style.padding="4px";var n=a.appendChild(document.createElement("DIV"));n.style.padding="7px 5px 7px 5px";n.style.textAlign="center";n.style.color="#AAAAAA";n.style.border="1px dashed #DDDDDD";n.innerHTML=BPMESS["SEQWF_SNIP_DD_1"];e.drdrop=n;arUserParams["SNIPPETS"]=arUserParams["SNIPPETS"]||[];for(var p in arUserParams["SNIPPETS"]){if(!arUserParams["SNIPPETS"].hasOwnProperty(p))continue;e.DrawGroupItem(e.divSnippets,arUserParams["SNIPPETS"][p],true,p)}};e.lastDrop2=false;e.ondragging2=function(t,i,l){var r=BX.pos(e.drdrop);if(r.left<i&&i<r.right&&r.top<l&&l<r.bottom){e.drdrop.style.border="1px dashed #333333";e.lastDrop2=true;return}if(e.lastDrop2){e.drdrop.style.border="1px dashed #DDDDDD";e.lastDrop2=false}};e.ondrop2=function(t,i,l){if(e.lastDrop2){var r=CreateActivity(DragNDrop.obj);e.DrawGroupItem(e.divSnippets,r,true,arUserParams["SNIPPETS"].length);arUserParams["SNIPPETS"].push(r.Serialize());BCPSaveUserParams();e.drdrop.style.border="1px dashed #DDDDDD";e.lastDrop2=false}};e.RemoveResourcesSequenceActivity=e.RemoveResources;e.RemoveResources=function(){requestAnimationFrame((()=>{e.UpdateButtonPanel()}));if(e.hSnippid1){DragNDrop.RemoveHandler("ondragging",e.hSnippid1);DragNDrop.RemoveHandler("ondrop",e.hSnippid2);e.hSnippid1=false}e.RemoveResourcesSequenceActivity();if(e.Table){e.Table.parentNode.removeChild(e.Table);e.Table=null}};return e};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:76:"/bitrix/activities/bitrix/setstateactivity/setstateactivity.js?1699257952315";s:6:"source";s:62:"/bitrix/activities/bitrix/setstateactivity/setstateactivity.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
/////////////////////////////////////////////////////////////////////////////////////
// SetStateActivity
/////////////////////////////////////////////////////////////////////////////////////
SetStateActivity = function()
{
	var ob = new BizProcActivity();
	ob.Type = 'SetStateActivity';


	return ob;
}

/* End */
;
; /* Start:"a:4:{s:4:"full";s:75:"/bitrix/activities/bitrix/stateactivity/stateactivity.min.js?16992579529603";s:6:"source";s:56:"/bitrix/activities/bitrix/stateactivity/stateactivity.js";s:3:"min";s:60:"/bitrix/activities/bitrix/stateactivity/stateactivity.min.js";s:3:"map";s:60:"/bitrix/activities/bitrix/stateactivity/stateactivity.map.js";}"*/
StateActivity=function(){var e=new BizProcActivity;e.Type="StateActivity";e.Draw=function(i){e.main=i.appendChild(document.createElement("TABLE"));e.main.cellPadding=0;e.main.width="220";e.main.cellSpacing=0;e.main.style.fontSize="12px";e.main.style.textAlign="left";var t=e.main.insertRow(-1);t.id=e.Name;var n=t.insertCell(-1);n.width="5";n.style.background="url(/bitrix/images/bizproc/stat_hl.gif)";var r=t.insertCell(-1);r.noWrap="nowrap";r.style.background="url(/bitrix/images/bizproc/stat_hbg.gif)";r.style.height="24px";n=t.insertCell(-1);n.width="5";n.style.background="url(/bitrix/images/bizproc/stat_hr.gif)";var a=r.appendChild(document.createElement("TABLE"));a.width="100%";a.cellPadding=0;a.cellSpacing=0;a.style.fontSize="12px";t=a.insertRow(-1);n=t.insertCell(-1);var l=n.appendChild(document.createElement("DIV"));l.innerHTML="<b>"+HTMLEncode(e["Properties"]["Title"])+"</b>";l.style.padding="5px";l.style.marginLeft="5px";l.style.width="160px";l.style.overflow="hidden";l.style.whiteSpace="nowrap";l.title=e["Properties"]["Title"];l.align="left";l.classList.add("bizproc-StateActivity-title");l.onmousedown=function(i){var t=DragNDrop.StartDrag(i,e);t.innerHTML=e.main.innerHTML;t.style.width=e.main.offsetWidth+"px"};e.lastDrop=false;if(!e.h1id){e.h1id=DragNDrop.AddHandler("ondragging",e.ondragging);e.h2id=DragNDrop.AddHandler("ondrop",e.ondrop)}n=t.insertCell(-1);n.className="statset";n.onclick=e.OnSettingsClick;n=t.insertCell(-1);n.className="statdel";n.onclick=e.OnRemoveClick;t=e.main.insertRow(-1);n=t.insertCell(-1);n.style.background="url(/bitrix/images/bizproc/stat_l.gif) left top repeat-y";var o=t.insertCell(-1);n=t.insertCell(-1);n.style.background="url(/bitrix/images/bizproc/stat_r.gif) right top repeat-y";o.style.backgroundColor="#ffffff";o.style.padding="5px";e.commandTable=o.appendChild(_crt(1,1));e.commandTable.cellPadding="4";e.commandTable.rows[0].cells[0].align="left";e.commandTable.rows[0].cells[0].style.fontSize="12px";var c=e.commandTable.rows[0].cells[0].appendChild(jsUtils.CreateElement("A",{href:"javascript:void(0)"}));c.onclick=e.ShowAddMenu;c.style.textDecoration="none";c.innerHTML=BPMESS["STATEACT_ADD"]+' <img src="/bitrix/images/bizproc/add.gif" border="0">';for(var d=0;d<e.childActivities.length;d++){var s,p=e.commandTable.insertRow(-1),v=p.insertCell(-1),m;if(e.childActivities[d]["Type"]=="EventDrivenActivity"){s=e.childActivities[d].childActivities[0]["Properties"]["Title"];if(e.childActivities[d].childActivities[0].Type!="DelayActivity")m="cmd";else m="delay"}else{if(e.childActivities[d]["Properties"]["Title"])s=e.childActivities[d]["Properties"]["Title"];if(e.childActivities[d].Type=="StateFinalizationActivity")m="fin";else m="init"}p.id=e.childActivities[d].Name;var A=v.appendChild(document.createElement("TABLE")),h=A.insertRow(-1),y=h.insertCell(-1);A.style.fontSize="12px";A.width="100%";y.width=12;y.height=12;y.style.background="url(/bitrix/images/bizproc/state"+m+".gif) center center no-repeat";y=h.insertCell(-1);y.innerHTML=HTMLEncode(s);y.onclick=e.clickrow;y.title=BPMESS["STATEACT_EDITBP"];y=h.insertCell(-1);y.width=20;y.height=12;y.style.background="url(/bitrix/images/bizproc/state_set.gif) center center no-repeat";y.title=BPMESS["STATEACT_SETT"];y.onclick=e.settings;y=h.insertCell(-1);y.width=12;y.height=12;y.style.background="url(/bitrix/images/bizproc/state_del.gif) center center no-repeat";y.title=BPMESS["STATEACT_DEL"];y.onclick=e.remove;v.style.borderTop="1px solid #e5e5e5";v.style.fontSize="12px";v.style.cursor="pointer";v.onmouseover=function(e){this.style.backgroundColor="#f7f7f7"};v.onmouseout=function(e){this.style.backgroundColor="#FFFFFF"}}t=e.main.insertRow(-1);n=t.insertCell(-1);n.width="5";n.style.background="url(/bitrix/images/bizproc/stat_bl.gif)";n=t.insertCell(-1);n.style.background="url(/bitrix/images/bizproc/stat_b.gif)";n.height="5";n=t.insertCell(-1);n.width="5";n.style.background="url(/bitrix/images/bizproc/stat_br.gif)"};e.ondragging=function(i,t,n){var r=e.main;var a=BX.pos(r);if(a.left<t&&t<a.right&&a.top<n&&n<a.bottom){e.lastDrop=r;r.style.opacity=".25";return}if(e.lastDrop){r.style.opacity="";e.lastDrop=false}};e.ondrop=function(i,t,n){if(e.lastDrop){e.lastDrop.style.opacity="";e.lastDrop=false;if(e!==DragNDrop.obj&&e.parentActivity.ReplaceChild){e.parentActivity.ReplaceChild(e,DragNDrop.obj)}}};e.reDraw=function(){var i=e.main.parentNode;i.removeChild(e.main);e.Draw(i)};e.OnRemoveClick=function(){e.parentActivity.RemoveChild(e)};e.remove=function(i){var t=this.parentNode.parentNode.parentNode.parentNode.parentNode.id;for(var n in e.childActivities){if(!e.childActivities.hasOwnProperty(n)){continue}if(e.childActivities[n]["Name"]==t){e.commandTable.deleteRow(parseInt(n)+1);e.RemoveChild(e.childActivities[n]);e.parentActivity.DrawLines();break}}};e.settings=function(i){var t=this.parentNode.parentNode.parentNode.parentNode.parentNode.id;for(var n in e.childActivities){if(!e.childActivities.hasOwnProperty(n)){continue}if(e.childActivities[n]["Name"]==t){if(e.childActivities[n].Type=="EventDrivenActivity")e.childActivities[n].childActivities[0].Settings();else e.childActivities[n].Settings();break}}};e.clickrow=function(i){var t=this.parentNode.parentNode.parentNode.parentNode.parentNode.id;for(var n in e.childActivities){if(!e.childActivities.hasOwnProperty(n)){continue}if(e.childActivities[n]["Name"]==t){e.SequentialShow(e.childActivities[n]);break}}};e.HideRows=function(){for(var i=0;i<e.parentActivity.__l.length;i++)for(var t=0;t<5;t++)e.parentActivity.__l[i][t].style.display="none"};e.SequentialShow=function(i){rootActivity._redrawObject=i;e.parentActivity.Table.style.display="none";e.HideRows();e.__header=e.parentActivity.Table.parentNode.appendChild(document.createElement("DIV"));e.__header.style.fontSize="12px";var t=e.__header.appendChild(document.createElement("A"));t.href="javascript:void(0)";t.onclick=e.SequentialHide;t.innerHTML=HTMLEncode(e.Properties["Title"]);var n=e.__header.appendChild(document.createElement("span"));n.innerHTML=" - "+(i.Type!="EventDrivenActivity"?HTMLEncode(i.Properties["Title"]):HTMLEncode(i.childActivities[0].Properties["Title"]));e.__seq=e.parentActivity.Table.parentNode.appendChild(document.createElement("DIV"));e.__footer=e.parentActivity.Table.parentNode.appendChild(document.createElement("DIV"));var r=e.__footer.appendChild(jsUtils.CreateElement("INPUT",{type:"button",value:BPMESS["STATEACT_BACK_1"]}));r.onclick=e.SequentialHide;r.style.margin="15px";if(document.getElementById("bizprocsavebuttons"))document.getElementById("bizprocsavebuttons").style.display="none";i.Draw(e.__seq)};e.SequentialHide=function(){try{e.parentActivity.Table.style.display="table"}catch(i){e.parentActivity.Table.style.display="block"}e.__header.parentNode.removeChild(e.__header);e.__seq.parentNode.removeChild(e.__seq);e.__footer.parentNode.removeChild(e.__footer);if(document.getElementById("bizprocsavebuttons"))document.getElementById("bizprocsavebuttons").style.display="block";rootActivity._redrawObject=null;arWorkflowTemplate=rootActivity.Serialize();ReDraw()};e.AddInitialize=function(){var i=e.commandTable.insertRow(1);var t=i.insertCell(-1);t.innerHTML="";var n=CreateActivity("StateInitializationActivity");e.childActivities.push(n);n.parentActivity=e;e.SequentialShow(n)};e.AddCommand=function(){var i=CreateActivity("EventDrivenActivity");var t=CreateActivity("HandleExternalEventActivity");i.childActivities.push(t);t.parentActivity=i;var n=e.commandTable.insertRow(1);var r=n.insertCell(-1);r.innerHTML="";e.childActivities.push(i);i.parentActivity=e;t.Settings()};e.AddDelayActivity=function(){var i=CreateActivity("EventDrivenActivity");var t=CreateActivity("DelayActivity");i.childActivities.push(t);t.parentActivity=i;var n=e.commandTable.insertRow(1);var r=n.insertCell(-1);r.innerHTML="";e.childActivities.push(i);i.parentActivity=e;t.Settings()};e.AddFinilize=function(){var i=e.commandTable.insertRow(1);var t=i.insertCell(-1);t.innerHTML="";var n=CreateActivity("StateFinalizationActivity");e.childActivities.push(n);n.parentActivity=e;e.SequentialShow(n)};e.ShowAddMenu=function(i){e.menu=new PopupMenu("state_float_menu");e.menu.Create(2e3);if(e.menu.IsVisible())return;var t=false,n=false;for(var r=0;r<e.childActivities.length;r++){if(e.childActivities[r].Type=="StateInitializationActivity")t=true;if(e.childActivities[r].Type=="StateFinalizationActivity")n=true}e.menuItems=new Array;e.menuItems.push({ID:"2",TEXT:BPMESS["STATEACT_MENU_COMMAND"],ONCLICK:"__StateActivityAdd('command', '"+e.Name+"')"});e.menuItems.push({ID:"3",TEXT:BPMESS["STATEACT_MENU_DELAY"],ONCLICK:"__StateActivityAdd('delay', '"+e.Name+"')"});if(!t)e.menuItems.push({ID:"1",TEXT:BPMESS["STATEACT_MENU_INIT_1"],ONCLICK:"__StateActivityAdd('init', '"+e.Name+"')"});if(!n)e.menuItems.push({ID:"5",TEXT:BPMESS["STATEACT_MENU_FIN_1"],ONCLICK:"__StateActivityAdd('finish', '"+e.Name+"')"});e.menu.SetItems(e.menuItems);e.menu.BuildItems();var a=jsUtils.GetRealPos(this);a["bottom"]+=1;e.menu.PopupShow(a)};e.RemoveResources=function(){DragNDrop.RemoveHandler("ondragging",e.h1id);DragNDrop.RemoveHandler("ondrop",e.h2id);e.main.parentNode.removeChild(e.main)};return e};__StateActivityAdd=function(e,i){var t;for(var n=0;n<rootActivity.childActivities.length;n++){if(rootActivity.childActivities[n]["Name"]==i){t=rootActivity.childActivities[n];switch(e){case"init":t.AddInitialize();break;case"command":t.AddCommand();break;case"delay":t.AddDelayActivity();break;case"finish":t.AddFinilize();break}if(BX.type.isFunction(t.reDraw)){t.reDraw()}break}}};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:105:"/bitrix/activities/bitrix/statemachineworkflowactivity/statemachineworkflowactivity.min.js?16992579526811";s:6:"source";s:86:"/bitrix/activities/bitrix/statemachineworkflowactivity/statemachineworkflowactivity.js";s:3:"min";s:90:"/bitrix/activities/bitrix/statemachineworkflowactivity/statemachineworkflowactivity.min.js";s:3:"map";s:90:"/bitrix/activities/bitrix/statemachineworkflowactivity/statemachineworkflowactivity.map.js";}"*/
StateMachineWorkflowActivity=function(){var e=new BizProcActivity;e.classname="StateMachineWorkflowActivity";e.Table=null;e.__l=[];e.SerializeStateMachineWorkflowActivity=e.Serialize;e.Serialize=function(){if(e.childActivities.length>0)e.Properties["InitialStateName"]=e.childActivities[0]["Name"];return e.SerializeStateMachineWorkflowActivity()};e.LineMouseOver=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#ee0000";l.style.zIndex=parseInt(l.style.zIndex)+1e3}};e.LineMouseOut=function(e){var t=this.id;t=t.substring(0,t.length-2);for(var i=1;i<=3;i++){var l=document.getElementById(t+"."+i);l.style.backgroundColor="#afb8d2";l.style.zIndex=parseInt(l.style.zIndex)-1e3}};e.DrawLines=function(){var t,i;for(t=0;t<e.__l.length;t++)for(i=0;i<e.__l[t].length;i++)e.__l[t][i].parentNode.removeChild(e.__l[t][i]);e.__l=[];e.StatusArrows=[];e.FindSetState(false,e);var l=[],r=e.StatusArrows,s,o={};for(t=0;t<r.length;t++){s=r[t][0]+"|"+r[t][1];if(!(s in o)){o[s]=true;l.push(r[t])}}var a=0,n=0,c=0;for(t=0;t<l.length;t++){var p=ActGetRealPos(document.getElementById(l[t][0]));var d=ActGetRealPos(document.getElementById(l[t][1]));if(p===false||d===false||p["left"]<=0||d["left"]<=0)continue;var h=e.Table.parentNode;var f=h.appendChild(document.createElement("IMG"));f.style.position="absolute";f.style.zIndex=14+t*10;f.width="8";f.height="8";var u=h.appendChild(document.createElement("IMG"));u.style.position="absolute";u.style.zIndex=15+t*10;u.width="8";u.height="8";var y=h.appendChild(document.createElement("DIV"));y.style.position="absolute";y.style.backgroundColor="#afb8d2";y.style.zIndex=11+t*10;y.style.height="2px";y.id=l[t][0]+"-"+l[t][1]+".1";y.onmouseover=e.LineMouseOver;y.onmouseout=e.LineMouseOut;var g=h.appendChild(document.createElement("DIV"));g.style.position="absolute";g.style.backgroundColor="#afb8d2";g.style.zIndex=12+t*10;g.style.width="2px";g.id=l[t][0]+"-"+l[t][1]+".2";g.onmouseover=e.LineMouseOver;g.onmouseout=e.LineMouseOut;var v=h.appendChild(document.createElement("DIV"));v.style.position="absolute";v.style.backgroundColor="#afb8d2";v.style.zIndex=13+t*10;v.style.height="2px";v.id=l[t][0]+"-"+l[t][1]+".3";v.onmouseover=e.LineMouseOver;v.onmouseout=e.LineMouseOut;var m=v.appendChild(document.createElement("IMG"));m.width="1";m.height="1";m=y.appendChild(document.createElement("IMG"));m.width="1";m.height="1";p["right"]=p["right"]+10;p["left"]=p["left"]-10;var b,x=-50,w=12,A=-1;if(p["right"]<d["left"]){++n;x+=n%6*6;b=d["left"]-p["right"];y.style.left=p["right"]+"px";y.style.width=b/2+x+"px";g.style.left=p["right"]+b/2+x+"px";v.style.left=p["right"]+b/2+x+"px";f.src="/bitrix/images/bizproc/arr_l1.gif";f.style.left=p["right"]-2+"px";f.style.top=p["top"]+w-3+"px";u.src="/bitrix/images/bizproc/arr_r1.gif";u.style.left=d["left"]+"px";u.style.top=d["top"]+w-3+"px"}else if(p["left"]===d["left"]){b=150;var T=BX.findParent(document.getElementById(l[t][0]),{attr:"data-column"});if(T&&T.getAttribute("data-column")==="2"){++c;x+=c%10*10;f.src="/bitrix/images/bizproc/arr_l1.gif";f.style.left=p["right"]-2+"px";f.style.top=p["top"]+w-3+"px";y.style.left=p["right"]+"px";y.style.width=b/2+x+"px";g.style.left=p["right"]+b/2+x+"px";v.style.left=d["right"]+"px";u.src="/bitrix/images/bizproc/arr_l2.gif";u.style.left=d["right"]-8+"px";u.style.top=d["top"]+w-3+"px";A=1}else{++a;x+=a%10*10;y.style.left=p["left"]-b/2+x+"px";y.style.width=b/2-x+"px";g.style.left=p["left"]-b/2+x+"px";v.style.left=p["left"]-b/2+x+"px";f.src="/bitrix/images/bizproc/arr_l2.gif";f.style.left=p["left"]-6+"px";f.style.top=p["top"]+w-3+"px";u.src="/bitrix/images/bizproc/arr_r1.gif";u.style.left=d["left"]+"px";u.style.top=d["top"]+w-3+"px"}}else{++n;x=n%6*6-50;b=p["left"]-d["right"];y.style.left=d["right"]+b/2-x+"px";y.style.width=b/2+x+"px";g.style.left=d["right"]+b/2-x+"px";v.style.left=d["right"]+"px";f.src="/bitrix/images/bizproc/arr_r2.gif";f.style.left=p["left"]-6+"px";f.style.top=p["top"]+w-3+"px";u.src="/bitrix/images/bizproc/arr_l2.gif";u.style.left=d["right"]-8+"px";u.style.top=d["top"]+w-3+"px"}y.style.top=p["top"]+w+"px";if(p["top"]<d["top"]){g.style.top=p["top"]+w+"px";g.style.height=d["top"]-p["top"]+"px"}else{g.style.top=d["top"]+w+"px";g.style.height=p["top"]-d["top"]+"px"}v.style.top=d["top"]+Math.floor((d["bottom"]-d["top"])/2)+"px";v.style.width=b/2+A*x+2+"px";e.__l.push([f,y,g,v,u])}};e.FindSetState=function(t,i){if(i.Type=="SetStateActivity"){if(i.Properties["TargetStateName"])e.StatusArrows.push([t,i.Properties["TargetStateName"]])}else{for(var l=0;l<i.childActivities.length;l++){if(i.Type=="StateActivity")t=i.childActivities[l].Name;e.FindSetState(t,i.childActivities[l])}}};e.Draw=function(t){e.statediv=t;e.Table=t.appendChild(_crt(e.childActivities.length+1,3));e.Table.onresize=function(){};var i;for(i=0;i<e.childActivities.length;i++){e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[0].setAttribute("data-column",1);e.Table.rows[i].cells[2].align="left";e.Table.rows[i].cells[2].setAttribute("data-column",2);e.childActivities[i].Draw(e.Table.rows[i].cells[i%2*2])}i=e.childActivities.length;e.Table.rows[i].cells[0].align="right";e.Table.rows[i].cells[0].width="350px";e.Table.rows[i].cells[1].width="150px";e.Table.rows[i].cells[2].align="left";var l=jsUtils.CreateElement("INPUT",{type:"button",value:BPMESS["STM_ADD_STATUS_1"]});l.style.marginBottom="20px";e.Table.rows[i].cells[i%2*2].appendChild(l);e.Table.rows[i].cells[(i+1)%2*2].innerHTML="&nbsp";l.onclick=e.AddStatus;e.ReCheckPosition(true)};e.AddStatus=function(t){var i=e.childActivities.length;var l=CreateActivity("StateActivity");e.childActivities.push(l);l.parentActivity=e;l.Draw(e.Table.rows[i].cells[i%2*2]);var r=e.Table.insertRow(-1);r.insertCell(-1).align="right";r.insertCell(-1).align="center";r.insertCell(-1).align="left";i++;e.Table.rows[i].cells[i%2*2].appendChild(this);l.Settings()};e.RemoveChildStateMachine=e.RemoveChild;e.RemoveChild=function(t){e.RemoveChildStateMachine(t);e.Table.parentNode.removeChild(e.Table);e.Draw(e.statediv)};e.ReplaceChild=function(t,i){var l=e.childActivities.indexOf(t);var r=e.childActivities.indexOf(i);if(l<0||r<0){return}e.childActivities[l]=i;e.childActivities[r]=t;BPTemplateIsModified=true;e.RemoveResources();e.Draw(e.statediv)};e.RemoveResourcesActivity=e.RemoveResources;e.RemoveResources=function(){e.RemoveResourcesActivity();if(e.Table){e.Table.parentNode.removeChild(e.Table);e.Table=null}};e.ReCheckPosition=function(t){if(e.Table.style.display=="none")return;var i=ActGetRealPos(e.Table);if(t||e.__lpos!=i["left"]||e.__rpos!=i["right"]){e.__lpos=i["left"];e.__rpos=i["right"];e.DrawLines()}setTimeout((function(){e.ReCheckPosition.call(e)}),1e3)};return e};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:98:"/bitrix/activities/bitrix/handleexternaleventactivity/handleexternaleventactivity.js?1699257952348";s:6:"source";s:84:"/bitrix/activities/bitrix/handleexternaleventactivity/handleexternaleventactivity.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
/////////////////////////////////////////////////////////////////////////////////////
// HandleExternalEventActivity
/////////////////////////////////////////////////////////////////////////////////////
HandleExternalEventActivity = function()
{
	var ob = new BizProcActivity();
	ob.Type = 'HandleExternalEventActivity';


	return ob;
}

/* End */
;
; /* Start:"a:4:{s:4:"full";s:75:"/bitrix/activities/bitrix/whileactivity/whileactivity.min.js?16992579521978";s:6:"source";s:56:"/bitrix/activities/bitrix/whileactivity/whileactivity.js";s:3:"min";s:60:"/bitrix/activities/bitrix/whileactivity/whileactivity.min.js";s:3:"map";s:60:"/bitrix/activities/bitrix/whileactivity/whileactivity.map.js";}"*/
WhileActivity=function(){var i=new BizProcActivity;i.Type="WhileActivity";i.BizProcActivityDraw=i.Draw;i.Draw=function(e){if(i.childActivities.length==0){i.childActivities=[new SequenceActivity];i.childActivities[0].parentActivity=i}i.container=e.appendChild(document.createElement("DIV"));if(!jsUtils.IsIE())i.container.className="parallelcontainer";i.BizProcActivityDraw(i.container);i.activityContent=null;i.div.style.position="relative";i.div.style.top="12px";i.hideContainer=i.container.appendChild(document.createElement("DIV"));i.hideContainer.style.background="#FFFFFF";i.hideContainer.style.border="1px #CCCCCC dashed";i.hideContainer.style.width="250px";i.hideContainer.style.color="#AAAAAA";i.hideContainer.style.padding="13px 0px 3px 0px";i.hideContainer.style.cursor="pointer";i.hideContainer.innerHTML=BPMESS["PARA_MIN"];i.hideContainer.onclick=i.OnHideClick;i.childsContainer=i.container.appendChild(_crt(1,3));i.childsContainer.rows[0].cells[0].width="15%";i.childsContainer.rows[0].cells[1].width="70%";i.childsContainer.rows[0].cells[2].width="15%";i.childsContainer.rows[0].cells[1].style.border="2px #dfdfdf dashed";i.childsContainer.id=i.Name;if(i.Properties["_DesMinimized"]=="Y"){i.childsContainer.style.display="none"}else{i.hideContainer.style.display="none"}i.childsContainer.rows[0].cells[1].style.padding="10px";i.childActivities[0].Draw(i.childsContainer.rows[0].cells[1])};i.CheckFields=function(){return true};i.OnHideClick=function(){if(i.Properties["_DesMinimized"]=="Y"){i.Properties["_DesMinimized"]="N";i.childsContainer.style.display="table";i.hideContainer.style.display="none"}else{i.Properties["_DesMinimized"]="Y";i.childsContainer.style.display="none";i.hideContainer.style.display="block"}};return i};WhileActivity.changeConditionTypeHandler=function(i){Array.from(i.options).forEach(function(i){var e=document.getElementById(i.getAttribute("data-id"));e.style.display=i.selected?"":"none"})};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js?16992580961189";s:6:"source";s:70:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.js";s:3:"min";s:74:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js";s:3:"map";s:74:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.map.js";}"*/
(function(){"use strict";BX.namespace("BX.UI");var t=function(){this.layout={container:null}};t.prototype={init:function(t){this.layout.container=BX(t.containerId);this.isFrame=t.isFrame||false;this.hasHints=t.hasHints||false;this.pinnerContainer=t.pinnerContainer||false;this.pinner=new BX.UI.Pinner(this.layout.container,{fixBottom:this.isFrame,fullWidth:this.isFrame,anchorBottom:this.pinnerContainer});if(this.hasHints){BX.UI.Hint.init(this.layout.container)}t.buttons.forEach(this.initButton,this)},getContainer:function(){return this.layout.container},hide:function(){if(!this.layout.container){return}this.layout.container.classList.add("ui-button-panel-wrapper-hide")},show:function(){this.layout.container.classList.remove("ui-button-panel-wrapper-hide")},initButton:function(t){if(!t.ID){return}t.node=BX(t.ID);if(!t.node){return}BX.bind(t.node,"click",this.onButtonClick.bind(this,t))},onButtonClick:function(t,n){BX.onCustomEvent(this,"button-click",[t]);if(t.WAIT){BX.addClass(BX(t.ID),"ui-btn-wait")}if(this.isFrame&&(t.TYPE==="close"||t.TYPE==="cancel")){n.preventDefault();top.BX.SidePanel.Instance.close()}}};BX.UI.ButtonPanel=new t})();
/* End */
;; /* /bitrix/components/bitrix/main.interface.buttons/templates/.default/script.min.js?169925794962259*/
; /* /bitrix/components/bitrix/main.interface.buttons/templates/.default/utils.js?16992579501940*/
; /* /bitrix/components/bitrix/bizproc.workflow.edit/templates/.default/script.min.js?16992579531804*/
; /* /bitrix/activities/bitrix/emptyblockactivity/emptyblockactivity.js?16992579522411*/
; /* /bitrix/activities/bitrix/approveactivity/approveactivity.js?16992579521249*/
; /* /bitrix/activities/bitrix/ifelsebranchactivity/ifelsebranchactivity.min.js?16992579522200*/
; /* /bitrix/activities/bitrix/ifelseactivity/ifelseactivity.min.js?1699257952220*/
; /* /bitrix/activities/bitrix/eventdrivenactivity/eventdrivenactivity.min.js?1699257952577*/
; /* /bitrix/activities/bitrix/statefinalizationactivity/statefinalizationactivity.min.js?1699257952173*/
; /* /bitrix/activities/bitrix/stateinitializationactivity/stateinitializationactivity.min.js?1699257952179*/
; /* /bitrix/activities/bitrix/foreachactivity/foreachactivity.min.js?16992579521748*/
; /* /bitrix/activities/bitrix/listenactivity/listenactivity.js?1699257952373*/
; /* /bitrix/activities/bitrix/parallelactivity/parallelactivity.min.js?16992579526110*/
; /* /bitrix/activities/bitrix/delayactivity/delayactivity.min.js?1699257952181*/
; /* /bitrix/activities/bitrix/requestinformationoptionalactivity/requestinformationoptionalactivity.min.js?16992579521095*/
; /* /bitrix/activities/bitrix/sequenceactivity/sequenceactivity.min.js?16992579527262*/
; /* /bitrix/activities/bitrix/sequentialworkflowactivity/sequentialworkflowactivity.min.js?169925795211430*/
; /* /bitrix/activities/bitrix/setstateactivity/setstateactivity.js?1699257952315*/
; /* /bitrix/activities/bitrix/stateactivity/stateactivity.min.js?16992579529603*/
; /* /bitrix/activities/bitrix/statemachineworkflowactivity/statemachineworkflowactivity.min.js?16992579526811*/
; /* /bitrix/activities/bitrix/handleexternaleventactivity/handleexternaleventactivity.js?1699257952348*/
; /* /bitrix/activities/bitrix/whileactivity/whileactivity.min.js?16992579521978*/
; /* /bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js?16992580961189*/

//# sourceMappingURL=page_b2a0c763e6d7370619176947c3966366.map.js