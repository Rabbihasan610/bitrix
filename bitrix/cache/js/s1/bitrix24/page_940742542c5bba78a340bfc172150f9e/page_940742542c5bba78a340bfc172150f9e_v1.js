
; /* Start:"a:4:{s:4:"full";s:83:"/bitrix/components/bitrix/crm.router/templates/.default/script.min.js?1699257961719";s:6:"source";s:65:"/bitrix/components/bitrix/crm.router/templates/.default/script.js";s:3:"min";s:69:"/bitrix/components/bitrix/crm.router/templates/.default/script.min.js";s:3:"map";s:69:"/bitrix/components/bitrix/crm.router/templates/.default/script.map.js";}"*/
(function(n,e){"use strict";var o=e.Reflection.namespace("BX.Crm.Component");var i=function(){function n(){babelHelpers.classCallCheck(this,n)}babelHelpers.createClass(n,null,[{key:"bindAnchors",value:function n(e,o){var i=this;var t=[];o.forEach(function(n){t.push(i.prependRootsToRuleConditions(e,n))});BX.SidePanel.Instance.bindAnchors({rules:t})}},{key:"prependRootsToRuleConditions",value:function n(o,i){var t=e.Runtime.clone(i);if(!e.Type.isArrayFilled(t.condition)){return t}var r=[];t.condition.forEach(function(n){if(e.Type.isRegExp(n)){n=n.toString()}o.forEach(function(e){r.push(e+n)})});t.condition=r;return t}}]);return n}();o.Router=i})(this.window=this.window||{},BX);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:96:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.min.js?16992580965071";s:6:"source";s:77:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.js";s:3:"min";s:81:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.min.js";s:3:"map";s:81:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.map.js";}"*/
(function(){BX.namespace("BX.UI.SidePanel");if(BX.UI.SidePanel.Wrapper){return}function t(t){}t.prototype.init=function(t){this.container=BX(t.containerId);this.isCloseAfterSave=t.isCloseAfterSave||false;this.isReloadGridAfterSave=t.isReloadGridAfterSave||false;this.isReloadPageAfterSave=t.isReloadPageAfterSave||false;this.skipNotification=t.skipNotification||false;this.useLinkTargetsReplacing=t.useLinkTargetsReplacing||false;this.notification=t.notification||{};var e=BX.SidePanel.Instance.getPreviousSlider(BX.SidePanel.Instance.getSliderByWindow(window));this.parentWindow=e?e.getWindow():top;this.initEditableTitle(t);if(this.isReloadGridAfterSave){if(this.getParam("reloadGridAfterSave")){this.reloadGridOnParentPage()}this.setParam("reloadGridAfterSave",true)}if(this.isCloseAfterSave){if(this.getParam("closeAfterSave")){var i;if(this.notification.content&&top.BX&&!this.getParam("skipNotification")){i=function(){top.BX.loadExt("ui.notification").then(function(){top.BX.UI.Notification.Center.notify(this.notification)}.bind(this))}.bind(this)}else if(this.isReloadPageAfterSave){i=function(){this.parentWindow.location.reload()}.bind(this)}BX.SidePanel.Instance.close(false,i)}if(this.skipNotification){this.setParam("skipNotification",true)}this.setParam("closeAfterSave",true)}if(this.useLinkTargetsReplacing){this.initLinkTargetsReplacing()}};t.prototype.initEditableTitle=function(t){if(!t.title||!t.title.selector||!t.title.defaultTitle){return}var i=this.container.querySelector(t.title.selector);if(!i){return}var n=i.querySelector('input[type="text"]');if(!n){return}i.style.display="none";e.init({dataContainer:i,dataNode:n,defaultTitle:t.title.defaultTitle})};t.prototype.initLinkTargetsReplacing=function(){this.replaceLinkTargets();if(!window.MutationObserver){return}var t=new MutationObserver(this.domMutationHandler.bind(this));t.observe(this.container,{childList:true,subtree:true})};t.prototype.domMutationHandler=function(t){t.forEach(function(t){for(var e=0;e<t.addedNodes.length;++e){var i=t.addedNodes.item(e);if(!i){continue}this.replaceLinkTargets(i)}},this)};t.prototype.replaceLinkTargets=function(t){if(!t){t=document.body}var e=[];if(t.tagName==="A"){e=[t]}else if(t.nodeName!=="#text"){e=BX.convert.nodeListToArray(t.querySelectorAll("a"))}if(e.length===0){return}BX.convert.nodeListToArray(e).filter(function(t){return!t.target}).forEach(function(t){t.target="_top"})};t.prototype.setParam=function(t,e){var i=BX.SidePanel.Instance.getSliderByWindow(window);if(i){i.getData().set(t,e)}};t.prototype.getParam=function(t){var e=BX.SidePanel.Instance.getSliderByWindow(window);if(e){return e.getData().get(t)}return undefined};t.prototype.removeParam=function(t){var e=BX.SidePanel.Instance.getSliderByWindow(window);if(e){e.getData().delete(t)}};t.prototype.reloadGridOnParentPage=function(){var t=this.parentWindow;var e=BX.type.isString(this.isReloadGridAfterSave)?this.isReloadGridAfterSave:null;if(!t.BX.Main||!t.BX.Main.gridManager){return}if(e==="all"){t.BX.Main.gridManager.data.forEach(function(t){t.instance.reload()});return}if(!e&&t.BX.Main.gridManager.data){var i=t.BX.Main.gridManager.data;e=i.length>0?i[0].id:null}if(!e){return}var n=t.BX.Main.gridManager.getById(e);if(!n){return}n.instance.reload()};var e={isInit:false,init:function(t){this.dataNode=t.dataNode;this.titleNode=document.querySelector(".ui-side-panel-wrap-title-name");this.inputNode=document.querySelector(".ui-side-panel-wrap-title-input");this.buttonNode=document.querySelector(".ui-side-panel-wrap-title-edit-button");this.initialTitle=this.titleNode.textContent;this.defaultTitle=t.defaultTitle;BX.bind(this.dataNode,"bxchange",this.onDataNodeChange.bind(this));BX.bind(this.buttonNode,"click",this.startEdit.bind(this));BX.bind(this.inputNode,"keyup",this.onKeyUp.bind(this));BX.bind(this.inputNode,"blur",this.endEdit.bind(this));this.isInit=true;if(!t.disabled){this.enable()}if(!this.dataNode.value){this.dataNode.value=this.defaultTitle}},enable:function(t){t=t||false;if(!this.isInit){return}this.changeDisplay(this.buttonNode,!t);this.titleNode.textContent=!t?this.dataNode.value?this.dataNode.value:this.defaultTitle:this.initialTitle},disable:function(){this.enable(true)},onDataNodeChange:function(){this.titleNode.textContent=this.dataNode.value},onKeyUp:function(t){t=t||window.event;if(t.keyCode===10||t.keyCode===13){this.endEdit();t.preventDefault();return false}},getTitle:function(){var t=this.dataNode.value;if(!t){t=this.titleNode.textContent}return t},startEdit:function(){this.inputNode.value=this.getTitle();this.changeDisplay(this.titleNode,false);this.changeDisplay(this.buttonNode,false);this.changeDisplay(this.inputNode,true);this.inputNode.focus()},endEdit:function(){this.dataNode.value=this.inputNode.value;this.titleNode.textContent=this.inputNode.value;this.changeDisplay(this.inputNode,false);this.changeDisplay(this.buttonNode,true);this.changeDisplay(this.titleNode,true)},changeDisplay:function(t,e){return t.style.display=e?"":"none"}};BX.UI.SidePanel.Wrapper=new t})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:84:"/bitrix/components/bitrix/ui.toolbar/templates/.default/script.min.js?16992580966985";s:6:"source";s:65:"/bitrix/components/bitrix/ui.toolbar/templates/.default/script.js";s:3:"min";s:69:"/bitrix/components/bitrix/ui.toolbar/templates/.default/script.min.js";s:3:"map";s:69:"/bitrix/components/bitrix/ui.toolbar/templates/.default/script.map.js";}"*/
(function(){"use strict";BX.namespace("BX.UI");BX.UI.ToolbarManager={toolbars:{},create:function(t){var e=new BX.UI.Toolbar(t);if(this.get(e.getId())){throw new Error("The toolbar instance with the same 'id' already exists.")}this.toolbars[e.getId()]=e;return e},getDefaultToolbar:function(){return this.get("default-toolbar")},get:function(t){return t in this.toolbars?this.toolbars[t]:null}};BX.UI.Toolbar=function(t){t=BX.type.isPlainObject(t)?t:{};this.titleMinWidth=BX.type.isNumber(t.titleMinWidth)?t.titleMinWidth:158;this.titleMaxWidth=BX.type.isNumber(t.titleMaxWidth)?t.titleMaxWidth:"";this.filterMinWidth=BX.type.isNumber(t.filterMinWidth)?t.filterMinWidth:300;this.filterMaxWidth=BX.type.isNumber(t.filterMaxWidth)?t.filterMaxWidth:748;this.id=BX.Type.isStringFilled(t.id)?t.id:BX.Text.getRandom();this.toolbarContainer=t.target;if(!BX.Type.isDomNode(this.toolbarContainer)){throw new Error('BX.UI.Toolbar: "target" parameter is required.')}this.titleContainer=this.toolbarContainer.querySelector(".ui-toolbar-title-box");this.filterContainer=this.toolbarContainer.querySelector(".ui-toolbar-filter-box");this.filterButtons=this.toolbarContainer.querySelector(".ui-toolbar-filter-buttons");this.rightButtons=this.toolbarContainer.querySelector(".ui-toolbar-right-buttons");this.afterTitleButtons=this.toolbarContainer.querySelector(".ui-toolbar-after-title-buttons");if(!this.filterContainer){this.filterMinWidth=0;this.filterMaxWidth=0}this.buttons=Object.create(null);this.buttonIds=BX.Type.isArray(t.buttonIds)?t.buttonIds:[];if(!this.buttonIds.length){return}this.buttonIds.forEach(function(t){var e=BX.UI.ButtonManager.createByUniqId(t);if(e){e.getContainer().originalWidth=e.getContainer().offsetWidth;if(!e.getIcon()&&!BX.Type.isStringFilled(e.getDataSet()["toolbarCollapsedIcon"])){if(e.getColor()===BX.UI.ButtonColor.PRIMARY){e.setDataSet({toolbarCollapsedIcon:BX.UI.ButtonIcon.ADD})}else{console.warn('BX.UI.Toolbar: the button "'+e.getText()+'" '+"doesn't have an icon for collapsed mode. "+'Use the "data-toolbar-collapsed-icon" attribute.')}}this.buttons[t]=e}else{console.warn('BX.UI.Toolbar: the button "'+t+"\" wasn't initialized.")}},this);this.windowWidth=document.body.offsetWidth;this.reduceItemsWidth();window.addEventListener("resize",function(){if(this.isWindowIncreased()){this.increaseItemsWidth()}else{this.reduceItemsWidth()}}.bind(this))};BX.UI.Toolbar.prototype={getButtons:function(){return this.buttons},getButton:function(t){return t in this.buttons?this.buttons[t]:null},getId:function(){return this.id},isWindowIncreased:function(){var t=this.windowWidth;var e=document.body.offsetWidth;this.windowWidth=e;return e>t},getContainerSize:function(){return this.toolbarContainer.offsetWidth},getInnerTotalWidth:function(){return this.toolbarContainer.scrollWidth},reduceItemsWidth:function(){if(this.getInnerTotalWidth()<=this.getContainerSize()){return}var t=Object.values(this.getButtons());for(var e=t.length-1;e>=0;e--){var i=t[e];if(!i.getIcon()&&!BX.Type.isStringFilled(i.getDataSet()["toolbarCollapsedIcon"])){continue}if(i.isCollapsed()){continue}i.setCollapsed(true);if(!i.getIcon()){i.setIcon(i.getDataSet()["toolbarCollapsedIcon"])}if(this.getInnerTotalWidth()<=this.getContainerSize()){return}}},increaseItemsWidth:function(){var t=Object.values(this.getButtons());for(var e=0;e<t.length;e++){var i=t[e];var o=i.getContainer();if(!i.isCollapsed()){continue}var n=this.titleMinWidth+this.filterMinWidth+(this.afterTitleButtons?this.afterTitleButtons.offsetWidth:0)+(this.filterButtons?this.filterButtons.offsetWidth:0)+(this.rightButtons?this.rightButtons.offsetWidth:0)+(o.originalWidth-o.offsetWidth);if(n>this.getContainerSize()){break}i.setCollapsed(false);if(i.getIcon()===i.getDataSet()["toolbarCollapsedIcon"]){i.setIcon(null)}}}};BX.UI.Toolbar.Star=function(){this.initialized=false;this.currentPageInMenu=false;this.starContNode=null;BX.ready(function(){this.init()}.bind(this));BX.addCustomEvent("onFrameDataProcessed",function(){this.init()}.bind(this))};BX.UI.Toolbar.Star.prototype={init:function(){this.starContNode=document.getElementById("uiToolbarStar");if(!this.starContNode){return false}if(this.initialized){return false}this.initialized=true;var t=this.starContNode.getAttribute("data-bx-url");if(!BX.type.isNotEmptyString(t)){t=document.location.pathname+document.location.search}t=BX.Uri.removeParam(t,["IFRAME","IFRAME_TYPE"]);top.BX.addCustomEvent("BX.Bitrix24.LeftMenuClass:onSendMenuItemData",function(t){this.processMenuItemData(t)}.bind(this));top.BX.addCustomEvent("BX.Bitrix24.LeftMenuClass:onStandardItemChangedSuccess",function(t){this.onStandardItemChangedSuccess(t)}.bind(this));top.BX.onCustomEvent("UI.Toolbar:onRequestMenuItemData",[{currentFullPath:t,context:window}]);return true},processMenuItemData:function(t){if(t.context&&t.context!==window){return}this.currentPageInMenu=t.currentPageInMenu;if(BX.type.isNotEmptyObject(t.currentPageInMenu)){BX.addClass(this.starContNode,"ui-toolbar-star-active")}this.starContNode.title=BX.message(this.starContNode.classList.contains("ui-toolbar-star-active")?"UI_TOOLBAR_DELETE_PAGE_FROM_LEFT_MENU":"UI_TOOLBAR_ADD_PAGE_TO_LEFT_MENU");if(BX.type.isDomNode(this.currentPageInMenu)&&this.currentPageInMenu.getAttribute("data-type")!=="standard"){this.starContNode.title=BX.message("UI_TOOLBAR_STAR_TITLE_DEFAULT_PAGE");BX.bind(this.starContNode,"click",function(){this.showMessage(BX.message("UI_TOOLBAR_STAR_TITLE_DEFAULT_PAGE_DELETE_ERROR"))}.bind(this));return true}BX.bind(this.starContNode,"click",function(){var t=document.getElementById("pagetitle").innerText;var e=this.starContNode.getAttribute("data-bx-title-template");if(BX.type.isNotEmptyString(e)){t=e.replace(/#page_title#/i,t)}var i=this.starContNode.getAttribute("data-bx-url");if(!BX.type.isNotEmptyString(i)){i=document.location.pathname+document.location.search}i=BX.Uri.removeParam(i,["IFRAME","IFRAME_TYPE"]);top.BX.onCustomEvent("UI.Toolbar:onStarClick",[{isActive:BX.hasClass(this.starContNode,"ui-toolbar-star-active"),context:window,pageTitle:t,pageLink:i}])}.bind(this))},onStandardItemChangedSuccess:function(t){if(!BX.type.isBoolean(t.isActive)||!this.starContNode){return}if(t.context&&t.context!==window){return}if(t.isActive){this.showMessage(BX.message("UI_TOOLBAR_ITEM_WAS_ADDED_TO_LEFT"));this.starContNode.title=BX.message("UI_TOOLBAR_DELETE_PAGE_FROM_LEFT_MENU");BX.addClass(this.starContNode,"ui-toolbar-star-active")}else{this.showMessage(BX.message("UI_TOOLBAR_ITEM_WAS_DELETED_FROM_LEFT"));this.starContNode.title=BX.message("UI_TOOLBAR_ADD_PAGE_TO_LEFT_MENU");BX.removeClass(this.starContNode,"ui-toolbar-star-active")}},showMessage:function(t){var e=BX.PopupWindowManager.create("left-menu-message",this.starContNode,{content:t,darkMode:true,offsetTop:2,offsetLeft:0,angle:true,events:{onPopupClose:function(){if(e){e.destroy();e=null}}},autoHide:true});e.show();setTimeout(function(){if(e){e.destroy();e=null}},3e3)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:90:"/bitrix/components/bitrix/crm.type.detail/templates/.default/script.min.js?169925796222677";s:6:"source";s:70:"/bitrix/components/bitrix/crm.type.detail/templates/.default/script.js";s:3:"min";s:74:"/bitrix/components/bitrix/crm.type.detail/templates/.default/script.min.js";s:3:"map";s:74:"/bitrix/components/bitrix/crm.type.detail/templates/.default/script.map.js";}"*/
(function(e,t,i,n,s,r,a,o){"use strict";var l,c,d,u,h,f,m,y;function p(e,t){var i=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=v(e))||t&&e&&typeof e.length==="number"){if(i)e=i;var n=0;var s=function e(){};return{s:s,n:function t(){if(n>=e.length)return{done:true};return{done:false,value:e[n++]}},e:function e(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r=true,a=false,o;return{s:function t(){i=i.call(e)},n:function e(){var t=i.next();r=t.done;return t},e:function e(t){a=true;o=t},f:function e(){try{if(!r&&i["return"]!=null)i["return"]()}finally{if(a)throw o}}}}function v(e,t){if(!e)return;if(typeof e==="string")return g(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor)i=e.constructor.name;if(i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return g(e,t)}function g(e,t){if(t==null||t>e.length)t=e.length;for(var i=0,n=new Array(t);i<t;i++){n[i]=e[i]}return n}var b=t.Reflection.namespace("BX.Crm.Component");var C=null;var S=function(){function e(i){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"isProgress",false);babelHelpers.defineProperty(this,"tabs",new Map);babelHelpers.defineProperty(this,"isRestricted",false);if(t.Type.isPlainObject(i)){this.type=i.type;this.isNew=!this.type.isSaved();this.form=i.form;this.container=i.container;this.errorsContainer=i.errorsContainer;this.presets=i.presets;this.relations=i.relations;this.isRestricted=Boolean(i.isRestricted)}this.buttonsPanel=document.getElementById("ui-button-panel");this.saveButton=document.getElementById("ui-button-panel-save");this.cancelButton=document.getElementById("ui-button-panel-cancel");this.deleteButton=document.getElementById("ui-button-panel-remove");C=this}babelHelpers.createClass(e,[{key:"init",value:function e(){this.bindEvents();this.fillTabs();if(!this.type.getId()){this.enablePresetsView()}else{this.disablePresetsView();var i=document.querySelector('[data-role="preset-selector-container"]');if(i){t.Dom.addClass(i,"crm-type-hidden")}}t.Dom.removeClass(document.querySelector("body"),"crm-type-hidden");this.initRelations();this.initCustomSections()}},{key:"bindEvents",value:function e(){var i=this;t.Event.bind(this.saveButton,"click",(function(e){i.save(e)}),{passive:false});if(this.deleteButton){t.Event.bind(this.deleteButton,"click",(function(e){i["delete"](e)}))}var n=this.getBooleanFieldNodeByName("isUseInUserfieldEnabled");if(n){t.Event.bind(n,"click",this.disableLinkedUserFieldsIfNotAvailable.bind(this))}this.form.querySelectorAll('[data-name*="linkedUserFields"]').forEach((function(e){t.Event.bind(e,"click",i.enableUserFieldIfAnyLinkedChecked.bind(i))}))}},{key:"enablePresetsView",value:function e(){t.Dom.addClass(document.querySelector("body"),"crm-type-settings-presets");var i=this.container.querySelector(".crm-type-tab-current");if(i){t.Dom.removeClass(i,"crm-type-tab-current")}var n=this.container.querySelector('[data-tab="presets"]');if(n){t.Dom.addClass(n,"crm-type-tab-current")}var s=document.querySelector('[data-role="preset-selector-container"]');if(s){t.Dom.addClass(s,"crm-type-hidden")}t.Dom.removeClass(document.getElementById("pagetitle"),"crm-type-hidden");t.Dom.addClass(this.buttonsPanel,"crm-type-hidden");this.hideErrors()}},{key:"disablePresetsView",value:function e(){t.Dom.removeClass(document.querySelector("body"),"crm-type-settings-presets");var i=document.querySelector('[data-role="tab-common"]');if(i){i.click()}var n=document.querySelector('[data-role="preset-selector-container"]');if(n){t.Dom.removeClass(n,"crm-type-hidden")}t.Dom.addClass(document.getElementById("pagetitle"),"crm-type-hidden");t.Dom.removeClass(this.buttonsPanel,"crm-type-hidden")}},{key:"disableLinkedUserFieldsIfNotAvailable",value:function e(){var t=this;var i=this.getBooleanFieldNodeByName("isUseInUserfieldEnabled");if(!this.isBooleanFieldChecked(i)){this.form.querySelectorAll('[data-name*="linkedUserFields"]').forEach((function(e){t.setBooleanFieldCheckedState(e,false)}))}}},{key:"enableUserFieldIfAnyLinkedChecked",value:function e(){var t=this;var i=this.getBooleanFieldNodeByName("isUseInUserfieldEnabled");if(!this.isBooleanFieldChecked(i)){this.form.querySelectorAll('[data-name*="linkedUserFields"]').forEach((function(e){if(t.isBooleanFieldChecked(e)){t.setBooleanFieldCheckedState(i,true)}}))}}},{key:"getLoader",value:function e(){if(!this.loader){this.loader=new n.Loader({size:150})}return this.loader}},{key:"startProgress",value:function e(){this.isProgress=true;if(!this.getLoader().isShown()){this.getLoader().show(this.form)}this.hideErrors()}},{key:"stopProgress",value:function e(){var i=this;this.isProgress=false;this.getLoader().hide();setTimeout((function(){t.Dom.removeClass(i.saveButton,"ui-btn-wait");t.Dom.removeClass(i.cancelButton,"ui-btn-wait");if(i.deleteButton){t.Dom.removeClass(i.deleteButton,"ui-btn-wait")}}),200)}},{key:"save",value:function e(t){var i=this;if(this.isRestricted){a.Router.Instance.showFeatureSlider();this.stopProgress();return}t.preventDefault();if(!this.form){return}if(this.isProgress){return}if(!this.type){return}this.startProgress();this.type.setTitle(this.form.querySelector('[name="title"]').value);r.TypeModel.getBooleanFieldNames().forEach((function(e){var t=i.getBooleanFieldNodeByName(e);if(t){i.type.data[e]=i.isBooleanFieldChecked(t)}}));var n={};this.form.querySelectorAll('[data-name*="linkedUserFields"]').forEach((function(e){var t=e.dataset.name.substr("linkedUserFields[".length).replace("]","");n[t]=i.isBooleanFieldChecked(e)}));this.type.setLinkedUserFields(n);this.type.setRelations({parent:this.parentRelationsController.getData(),child:this.childRelationsController.getData()});if(this.customSectionController){var s=this.customSectionController.getData();this.type.setCustomSectionId(s.customSectionId);this.type.setCustomSections(s.customSecions)}this.type.save().then((function(e){i.stopProgress();i.afterSave(e);i.isNew=false}))["catch"]((function(e){i.showErrors(e);i.stopProgress()}))}},{key:"collectEntityTypeIds",value:function e(t){var i=[];var n=this.container.querySelectorAll('[data-role="'.concat(t,'"]'));Array.from(n).forEach((function(e){if(e.checked){i.push(e.dataset.entityTypeId)}}));return i}},{key:"afterSave",value:function e(t){this.addDataToSlider("response",t);if(t.data.hasOwnProperty("urlTemplates")){a.Router.Instance.setUrlTemplates(t.data.urlTemplates)}var i=this.getSlider();if(i){i.close()}else if(this.isNew){location.href=a.Router.Instance.getTypeDetailUrl(this.type.getEntityTypeId())}this.emitTypeUpdatedEvent({isUrlChanged:t.data.isUrlChanged===true})}},{key:"getSlider",value:function e(){if(t.Reflection.getClass("BX.SidePanel")){return BX.SidePanel.Instance.getSliderByWindow(window)}return null}},{key:"getToolbarComponent",value:function e(){if(t.Reflection.getClass("BX.Crm.ToolbarComponent")){return BX.Crm.ToolbarComponent.Instance}return null}},{key:"emitTypeUpdatedEvent",value:function e(t){var i=this.getToolbarComponent();if(i){i.emitTypeUpdatedEvent(t)}}},{key:"addDataToSlider",value:function e(i,n){if(t.Type.isString(i)&&t.Type.isPlainObject(n)){var s=this.getSlider();if(s){s.data.set(i,n)}}}},{key:"showErrors",value:function e(i){var n="";i.forEach((function(e){n+=e}));if(t.Type.isDomNode(this.errorsContainer)){this.errorsContainer.innerText=n;this.errorsContainer.parentNode.style.display="block"}else{console.error(n)}}},{key:"hideErrors",value:function e(){if(t.Type.isDomNode(this.errorsContainer)){this.errorsContainer.parentNode.style.display="none";this.errorsContainer.innerText=""}}},{key:"delete",value:function e(i){var n=this;i.preventDefault();if(!this.form){return}if(this.isProgress){return}if(!this.type){return}s.MessageBox.confirm(t.Loc.getMessage("CRM_TYPE_DETAIL_DELETE_CONFIRM"),(function(){return new Promise((function(e){n.startProgress();n.type["delete"]().then((function(e){n.stopProgress();var i=t.Type.isObject(e.data)&&e.data.isUrlChanged===true;n.emitTypeUpdatedEvent({isUrlChanged:i});var s=n.getSlider();if(s){s.close()}else{var r=a.Router.Instance.getTypeListUrl();if(r){location.href=r.toString()}}}))["catch"]((function(t){n.showErrors(t);n.stopProgress();e()}))}))}),null,(function(e){n.stopProgress();e.close()}))}},{key:"fillTabs",value:function e(){var t=this;if(this.container){this.container.querySelectorAll(".crm-type-tab").forEach((function(e){if(e.dataset.tab){t.tabs.set(e.dataset.tab,e)}}))}}},{key:"showTab",value:function e(t){var i=this;Array.from(this.tabs.keys()).forEach((function(e){if(e===t){i.tabs.get(e).classList.add("crm-type-tab-current")}else{i.tabs.get(e).classList.remove("crm-type-tab-current")}}))}},{key:"applyPreset",value:function e(i){var n=this;this.disablePresetsView();var s=document.querySelector('[data-role="crm-type-preset-selector"]');var r=this.container.querySelector('[data-role="preset"].crm-type-preset-active');if(r){var a=this.getPresetById(r.dataset.presetId);if(a&&a.data.title&&this.form.querySelector('[name="title"]').value===a.data.title){this.form.querySelector('[name="title"]').value=""}}var o=this.container.querySelectorAll('[data-role="preset"]');o.forEach((function(e){t.Dom.removeClass(e,"crm-type-preset-active");if(e.dataset.presetId===i){t.Dom.addClass(e,"crm-type-preset-active");var r=n.getPresetById(i);if(r){n.updateInputs(r.data);if(s){s.textContent=t.Text.encode(r.fields.title)}}}}))}},{key:"getPresetById",value:function e(t){var i=p(this.presets),n;try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s.fields.id===t){return s}}}catch(e){i.e(e)}finally{i.f()}}},{key:"updateInputs",value:function e(t){var i=this;if(this.form.querySelector('[name="title"]').value.length<=0){this.form.querySelector('[name="title"]').value=t.title||""}r.TypeModel.getBooleanFieldNames().forEach((function(e){var n=i.getBooleanFieldNodeByName(e);if(n){i.setBooleanFieldCheckedState(n,t[e])}}));this.disableLinkedUserFieldsIfNotAvailable()}},{key:"toggleBooleanField",value:function e(i){var n=this.getBooleanFieldNodeByName(i);if(!n){return}if(n.nodeName==="INPUT"){n.checked=!n.checked}else{t.Dom.toggleClass(n,"crm-type-field-button-item-active")}}},{key:"getBooleanFieldNodeByName",value:function e(t){return this.container.querySelector('[data-name="'+t+'"]')}},{key:"isBooleanFieldChecked",value:function e(i){if(i.nodeName==="INPUT"){return i.checked}return t.Dom.hasClass(i,"crm-type-field-button-item-active")}},{key:"setBooleanFieldCheckedState",value:function e(i,n){if(i.nodeName==="INPUT"){i.checked=n;return}if(n){t.Dom.addClass(i,"crm-type-field-button-item-active")}else{t.Dom.removeClass(i,"crm-type-field-button-item-active")}}},{key:"initRelations",value:function e(){this.parentRelationsController=new k({switcher:BX.UI.Switcher.getById("crm-type-relation-parent-switcher"),container:this.container.querySelector('[data-role="crm-type-relation-parent-items"]'),typeSelectorContainer:this.container.querySelector('[data-role="crm-type-relation-parent-items-selector"]'),tabsContainer:this.container.querySelector('[data-role="crm-type-relation-parent-items-tabs"]'),tabsCheckbox:this.container.querySelector('[data-name="isRelationParentShowChildrenEnabled"]'),tabsSelectorContainer:this.container.querySelector('[data-role="crm-type-relation-parent-items-tabs-selector"]'),relations:this.relations.parent});this.childRelationsController=new k({switcher:BX.UI.Switcher.getById("crm-type-relation-child-switcher"),container:this.container.querySelector('[data-role="crm-type-relation-child-items"]'),typeSelectorContainer:this.container.querySelector('[data-role="crm-type-relation-child-items-selector"]'),tabsContainer:this.container.querySelector('[data-role="crm-type-relation-child-items-tabs"]'),tabsCheckbox:this.container.querySelector('[data-name="isRelationChildShowChildrenEnabled"]'),tabsSelectorContainer:this.container.querySelector('[data-role="crm-type-relation-child-items-tabs-selector"]'),relations:this.relations.child})}},{key:"initCustomSections",value:function e(){this.customSectionController=new I({switcher:BX.UI.Switcher.getById("crm-type-custom-section-switcher"),container:this.container.querySelector('[data-role="crm-type-custom-section-container"]'),selectorContainer:this.container.querySelector('[data-role="crm-type-custom-section-selector"]'),customSections:this.type.getCustomSections()||[]})}}],[{key:"handleLeftMenuClick",value:function e(t){if(C){C.showTab(t)}}},{key:"handlePresetClick",value:function e(t){if(C){C.applyPreset(t)}}},{key:"handleHideDescriptionClick",value:function e(t){t.parentNode.style.display="none"}},{key:"handleBooleanFieldClick",value:function e(t){if(C){C.toggleBooleanField(t)}}},{key:"handlePresetSelectorClick",value:function e(){if(C){C.enablePresetsView()}}}]);return e}();b.TypeDetail=S;var k=function(){function e(t){babelHelpers.classCallCheck(this,e);this.switcher=t.switcher;this.container=t.container;this.typeSelectorContainer=t.typeSelectorContainer;this.tabsContainer=t.tabsContainer;this.tabsCheckbox=t.tabsCheckbox;this.tabsSelectorContainer=t.tabsSelectorContainer;this.relations=t.relations;this.initSelectors();this.adjustInitialState();this.bindEvents();this.adjust()}babelHelpers.createClass(e,[{key:"initSelectors",value:function e(){var t=[];var i=[];var n=[];var s=[];this.relations.forEach((function(e){var r={id:e.entityTypeId,entityId:"crmType",title:e.title,tabs:"recents"};if(e.isChecked){i.push(r);if(e.isChildrenListEnabled){s.push(r)}else{n.push(r)}}else{t.push(r)}}));this.typeSelector=new o.TagSelector({dialogOptions:{enableSearch:false,multiple:false,items:t,selectedItems:i,dropdownMode:true,height:200,showAvatars:false},events:{onAfterTagAdd:this.adjust.bind(this),onAfterTagRemove:this.adjust.bind(this)}});this.typeSelector.renderTo(this.typeSelectorContainer);this.tabsSelector=new o.TagSelector({dialogOptions:{enableSearch:false,multiple:false,items:n,selectedItems:s,dropdownMode:true,height:200,showAvatars:false}});this.tabsSelector.renderTo(this.tabsSelectorContainer)}},{key:"adjustInitialState",value:function e(){var t=this.typeSelector.getDialog().getSelectedItems();if(t.length>0){this.switcher.check(true)}this.tabsCheckbox.checked=this.tabsSelector.getDialog().getSelectedItems().length>0}},{key:"bindEvents",value:function e(){i.EventEmitter.subscribe(this.switcher,"toggled",this.adjust.bind(this));t.Event.bind(this.tabsCheckbox,"click",this.adjust.bind(this))}},{key:"adjust",value:function e(){var i=this;if(!this.switcher.isChecked()){t.Dom.addClass(this.container,"crm-type-hidden")}else{t.Dom.removeClass(this.container,"crm-type-hidden")}var n=this.typeSelector.getDialog().getSelectedItems();if(n.length>0){t.Dom.removeClass(this.tabsContainer,"crm-type-hidden")}else{t.Dom.addClass(this.tabsContainer,"crm-type-hidden")}if(this.tabsCheckbox.checked){t.Dom.removeClass(this.tabsSelectorContainer,"crm-type-hidden")}else{t.Dom.addClass(this.tabsSelectorContainer,"crm-type-hidden")}this.tabsSelector.getDialog().getItems().forEach((function(e){if(!i.isItemSelected(e,n)){e.deselect();i.tabsSelector.getDialog().removeItem(e);i.tabsSelector.removeTag({id:e.getId(),entityId:e.getEntityId()})}}));n.forEach((function(e){var t={id:e.getId(),entityId:e.getEntityId(),title:e.getTitle(),tabs:"recents"};var n=i.tabsSelector.getDialog().getItem(t);if(!n){var s=i.tabsSelector.getDialog().addItem(t);s.select()}}))}},{key:"isItemSelected",value:function e(t,i){return i.filter((function(e){return t.id===e.id})).length>0}},{key:"getData",value:function e(){var t=this;var i=[];if(!this.switcher.isChecked()){return[]}var n=this.tabsCheckbox.checked;var s=this.typeSelector.getDialog().getSelectedItems();s.forEach((function(e){var s={entityTypeId:e.getId(),isChildrenListEnabled:false};if(n&&t.isItemSelected(e,t.tabsSelector.getDialog().getSelectedItems())){s.isChildrenListEnabled=true}i.push(s)}));return i}}]);return e}();var I=function(){function e(i){babelHelpers.classCallCheck(this,e);this.switcher=i.switcher;this.container=i.container;this.selectorContainer=i.selectorContainer;if(t.Type.isArray(i.customSections)){this.customSections=i.customSections}else{this.customSections=[]}this.initSelector();this.settingsContainer=t.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['<div class="crm-type-hidden crm-type-custom-sections-settings-container">\n\t\t\t<div class="crm-type-relation-subtitle">',"</div>\n\t\t</div>"])),t.Loc.getMessage("CRM_TYPE_DETAIL_CUSTOM_SECTION_LIST"));this.container.append(this.settingsContainer);this.adjustInitialState();this.bindEvents();this.adjust()}babelHelpers.createClass(e,[{key:"initSelector",value:function e(){var i=[];var n=[];this.customSections.forEach((function(e){var t={id:e.id,entityId:"custom-section",title:e.title,tabs:"recents"};i.push(t);if(e.isSelected){n.push(t)}}));this.selector=new o.TagSelector({showCreateButton:true,createButtonCaption:t.Loc.getMessage("CRM_COMMON_ACTION_CONFIG"),multiple:false,dialogOptions:{enableSearch:false,multiple:false,items:i,selectedItems:n,dropdownMode:true,height:200,showAvatars:false,recentTabOptions:{stub:false}}});this.selector.subscribe("onCreateButtonClick",this.onCreateButtonClick.bind(this));this.selector.renderTo(this.selectorContainer)}},{key:"showSelector",value:function e(){t.Dom.removeClass(this.selectorContainer,"crm-type-hidden")}},{key:"hideSelector",value:function e(){t.Dom.addClass(this.selectorContainer,"crm-type-hidden")}},{key:"adjustInitialState",value:function e(){var t=this.selector.getDialog().getSelectedItems();if(t.length>0){this.switcher.check(true)}}},{key:"bindEvents",value:function e(){i.EventEmitter.subscribe(this.switcher,"toggled",this.adjust.bind(this))}},{key:"onCreateButtonClick",value:function e(){this.hideSelector();this.showSectionsList()}},{key:"renderSectionsConfig",value:function e(){var i=this;if(!this.sectionsListContainer){this.sectionsListContainer=t.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['<div class="crm-type-custom-sections-list-container"></div>'])));this.settingsContainer.append(this.sectionsListContainer)}this.renderSectionsList(this.sectionsListContainer);if(!this.addSectionItemButton){this.addSectionItemButton=t.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['<div class="crm-type-custom-section-add-item-container">\n\t\t\t\t<span class="crm-type-custom-section-add-item-button" onclick="','">',"</span>\n\t\t\t</div>"])),(function(){i.sectionsListContainer.append(i.renderSectionItem())}),t.Loc.getMessage("CRM_COMMON_ACTION_CREATE"));this.settingsContainer.append(this.addSectionItemButton)}if(!this.buttonsContainer){this.settingsContainer.append(t.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['<hr class="crm-type-custom-sections-line">']))));this.buttonsContainer=t.Tag.render(h||(h=babelHelpers.taggedTemplateLiteral(['<div class="crm-type-custom-sections-buttons-container"></div>'])));this.settingsContainer.append(this.buttonsContainer)}if(!this.saveButton){this.saveButton=t.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['<span class="ui-btn ui-btn-primary" onclick="','">',"</span>"])),this.onSaveConfigHandler.bind(this),t.Loc.getMessage("CRM_COMMON_ACTION_SAVE"));this.buttonsContainer.append(this.saveButton)}if(!this.cancelButton){this.cancelButton=t.Tag.render(m||(m=babelHelpers.taggedTemplateLiteral(['<span class="ui-btn ui-btn-light-border" onclick="','">',"</span>"])),this.onCancelConfigHandler.bind(this),t.Loc.getMessage("CRM_COMMON_ACTION_CANCEL"));this.buttonsContainer.append(this.cancelButton)}}},{key:"onSaveConfigHandler",value:function e(i){i.preventDefault();var n=this.getSelectedSection();var s=[];Array.from(this.sectionsListContainer.children).forEach((function(e){var t=e.querySelector('[name="id"]');var i=e.querySelector('[name="value"]');if(!t||!i){return}var r=t.value;var a=i.value;var o=false;if(n&&n.id===r){o=true}if(a){s.push({id:r,title:a,isSelected:o})}}));this.customSections=s;t.Dom.clean(this.selectorContainer);this.initSelector();this.showSelector();this.hideSectionsList()}},{key:"onCancelConfigHandler",value:function e(t){t.preventDefault();this.showSelector();this.hideSectionsList()}},{key:"renderSectionsList",value:function e(i){var n=this;t.Dom.clean(i);this.customSections.forEach((function(e){i.append(n.renderSectionItem(e))}));i.append(this.renderSectionItem())}},{key:"renderSectionItem",value:function e(i){var n=this;var s=new T(i);var r=t.Tag.render(y||(y=babelHelpers.taggedTemplateLiteral(['<div style="margin-bottom: 10px;" class="ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-row">\n\t\t\t<input type="hidden" name="id" value="','" />\n\t\t\t<input class="ui-ctl-element" name="value" type="text" value="','">\n\t\t\t<div class="crm-type-custom-section-remove-item" onclick="','"></div>\n\t\t</div>'])),s.getId(),t.Text.encode(s.getValue()),(function(e){e.preventDefault();n.sectionsListContainer.removeChild(s.getNode())}));s.setNode(r);return r}},{key:"showSectionsList",value:function e(){this.renderSectionsConfig();t.Dom.removeClass(this.settingsContainer,"crm-type-hidden")}},{key:"hideSectionsList",value:function e(){t.Dom.clean(this.sectionsListContainer);t.Dom.addClass(this.settingsContainer,"crm-type-hidden")}},{key:"adjust",value:function e(){if(!this.switcher.isChecked()){t.Dom.addClass(this.container,"crm-type-hidden")}else{t.Dom.removeClass(this.container,"crm-type-hidden")}}},{key:"getSelectedSection",value:function e(){var t=this.selector.getDialog().getSelectedItems();if(t.length>0){return{id:t[0].getId(),title:t[0].getTitle()}}return null}},{key:"getData",value:function e(){var t={};t.customSectionId=0;if(this.switcher.isChecked()){var i=this.getSelectedSection();if(i){t.customSectionId=i.id}}t.customSecions=this.customSections;return t}}]);return e}();var T=function(){function e(){var i=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;babelHelpers.classCallCheck(this,e);this.id=i?i.id:"new_"+t.Text.getRandom();this.value=i?i.title:""}babelHelpers.createClass(e,[{key:"setNode",value:function e(t){this.node=t}},{key:"getId",value:function e(){return this.id}},{key:"getNode",value:function e(){return this.node}},{key:"getInput",value:function e(){var t=this.getNode();if(!t){return null}if(t instanceof HTMLInputElement){return t}return t.querySelector("input")}},{key:"getValue",value:function e(){var t=this.getInput();if(t&&t.value){return t.value}return this.value||""}}]);return e}()})(this.window=this.window||{},BX,BX.Event,BX,BX.UI.Dialogs,BX.Crm.Models,BX.Crm,BX.UI.EntitySelector);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:98:"/bitrix/components/bitrix/ui.sidepanel.wrappermenu/templates/.default/script.min.js?16992580966351";s:6:"source";s:79:"/bitrix/components/bitrix/ui.sidepanel.wrappermenu/templates/.default/script.js";s:3:"min";s:83:"/bitrix/components/bitrix/ui.sidepanel.wrappermenu/templates/.default/script.min.js";s:3:"map";s:83:"/bitrix/components/bitrix/ui.sidepanel.wrappermenu/templates/.default/script.map.js";}"*/
(function(){"use strict";BX.namespace("BX.UI");BX.UI.DropdownMenu=function(e){this.container=e.container;this.items=[]};BX.UI.DropdownMenu.prototype={init:function(){var e=this.container.querySelectorAll(".ui-sidepanel-menu-item");for(var t=0;t<e.length;t++){var i={};i.id=t;i.container=null;i.link=null;i.button=null;i.submenu=null;i.container=e[t];i.link=i.container.querySelector(".ui-sidepanel-menu-link");i.operativeItem=i.link.getAttribute("bx-operative")==="Y";this.items.push(i);if(i.container.classList.contains("ui-sidepanel-menu-active")){i.activeItem=true}if(i.container.querySelector(".ui-sidepanel-menu-notice-icon")){i.noticeItem=true}}this.loadData()},loadData:function(){for(var e=0;e<this.items.length;e++){this.addItem(this.items[e])}},addItem:function(e){var t=new BX.UI.DropdownMenuItem(e);t.menu=this;this.items[e.id]=t},resetItems:function(){for(var e=0;e<this.items.length;e++){if(this.items[e].activeItem){this.items[e].reset()}}},resetSubItems:function(){for(var e=0;e<this.items.length;e++){this.items[e].resetSubItems()}}};var e=new WeakMap;BX.UI.DropdownMenuItem=function(t){this.container=t.container;this.link=t.link;this.button=null;this.activeItem=t.activeItem?t.activeItem:null;this.noticeItem=t.noticeItem?t.noticeItem:null;this.operativeItem=t.operativeItem?t.operativeItem:null;this.submenu=null;this.subItems=[];this.submenuOpen=false;this.newBadge=null;this.counter=null;this.addItem=null;this.init();e.set(this.container,this)};BX.UI.DropdownMenuItem.getItemByNode=function(t){if(BX.Dom.hasClass(t,"ui-sidepanel-menu-link")){return e.get(t.parentNode)}return e.get(t)};BX.UI.DropdownMenuItem.prototype={init:function(){if(this.isSubmenuExist()){this.submenu=this.container.querySelector(".ui-sidepanel-submenu");this.button=this.getToggleButton();this.link.appendChild(this.button)}var e=this.container.querySelectorAll(".ui-sidepanel-submenu-item"),t=false;for(var i=0;i<e.length;i++){var n={};n.id=i;n.container=e[i];this.subItems.push(n);if(n.container.classList.contains("ui-sidepanel-submenu-active")){n.activeSubItem=true;t=true}}this.loadData();if(this.isSubmenuExist()&&(this.activeItem===true&&this.operativeItem===true||t===true)){this.showSubmenu();this.setNewToggleButtonName()}this.loadData();this.addEvents()},loadData:function(){for(var e=0;e<this.subItems.length;e++){this.addSubItem(this.subItems[e])}},activate:function(){this.activeItem=true;this.container.classList.add("ui-sidepanel-menu-active")},reset:function(){this.activeItem=null;this.container.classList.remove("ui-sidepanel-menu-active")},addNoticeIcon:function(){this.noticeItem=true;if(!this.container.querySelector(".ui-sidepanel-menu-notice-icon")){this.container.children[0].appendChild(this.getNoticeIcon())}},removeNoticeIcon:function(){this.noticeItem=null;if(this.container.querySelector(".ui-sidepanel-menu-notice-icon")){this.container.querySelector(".ui-sidepanel-menu-notice-icon").remove()}},getNoticeIcon:function(){this.noticeIcon=document.createElement("span");this.noticeIcon.className="ui-sidepanel-menu-notice-icon";return this.noticeIcon},showSubmenu:function(){this.submenuOpen=true;this.submenu.style.height=this.getSubmenuHeight()},hideSubmenu:function(){this.submenuOpen=false;this.submenu.style.height=0},getSubmenuHeight:function(){var e=0;for(var t=0;t<this.subItems.length;t++){e=e+(this.subItems[t].getHeight()+6-3)}return e+"px"},addEvents:function(){this.link.addEventListener("click",this.setActiveHandler.bind(this))},setActiveHandler:function(e){this.menu.resetItems();this.activate();if(this.link.getAttribute("bx-operative")!=="Y"){this.link.classList.add("ui-sidepanel-menu-disable-active-state")}else{this.link.classList.remove("ui-sidepanel-menu-disable-active-state")}if(this.isSubmenuExist()){if(!this.submenuOpen){this.showSubmenu();this.setNewToggleButtonName();this.menu.resetSubItems();e&&e.preventDefault()}else{this.hideSubmenu();this.setDefaultToggleButtonName();this.menu.resetSubItems();e&&e.preventDefault()}}else{if(this.link.classList.contains("ui-sidepanel-menu-disable-active-state")){this.link.classList.remove("ui-sidepanel-menu-disable-active-state")}this.menu.resetSubItems()}},isSubmenuExist:function(){if(this.container.querySelector(".ui-sidepanel-submenu")){return true}return false},getToggleButton:function(){this.buttonContainer=document.createElement("div");this.buttonContainer.className="ui-sidepanel-toggle-btn";this.setDefaultToggleButtonName();return this.buttonContainer},setNewToggleButtonName:function(){this.buttonContainer.innerHTML=BX.message("UI_SIDEPANEL_MENU_BUTTON_CLOSE")},setDefaultToggleButtonName:function(){this.buttonContainer.innerHTML=BX.message("UI_SIDEPANEL_MENU_BUTTON_OPEN")},getNewItemBadge:function(){this.itemBadgeNewContainer=document.createElement("div");this.itemBadgeNewContainer.className="ui-sidepanel-badge-new";return this.itemBadgeNewContainer},getCounter:function(){this.counterContainer=document.createElement("span");this.counterContainer.className="ui-sidepanel-counter";return this.counterContainer},getAddItem:function(){this.addItemContainer=document.createElement("a");this.addItemContainer.className="ui-sidepanel-add-item";this.setAddItemName();return this.addItemContainer},setAddItemName:function(){this.addItemContainer.innerHTML=BX.message("UI_SIDEPANEL_MENU_ADD_ITEM")},addSubItem:function(e){var t=new BX.UI.DropdownMenuSubItem(e);t.subMenu=this;this.subItems[e.id]=t},resetSubItems:function(){for(var e=0;e<this.subItems.length;e++){if(this.subItems[e].activeSubItem){this.subItems[e].reset()}}}};BX.UI.DropdownMenuSubItem=function(e){this.container=e.container;this.id=e.id;this.activeSubItem=e.activeSubItem?e.activeSubItem:null;this.subMenu=null;this.init()};BX.UI.DropdownMenuSubItem.prototype={init:function(){this.addEvents()},activate:function(){this.activeSubItem=true;this.container.classList.add("ui-sidepanel-submenu-active")},reset:function(){this.activeSubItem=null;this.container.classList.remove("ui-sidepanel-submenu-active")},addEvents:function(){this.container.addEventListener("click",function(){if(this.activeSubItem){return}if(!this.activeSubItem&&!this.activeItem){this.subMenu.menu.resetItems()}this.subMenu.menu.resetSubItems();this.subMenu.resetSubItems();this.activate()}.bind(this))},getHeight:function(){return this.container.offsetHeight}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js?16992580961189";s:6:"source";s:70:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.js";s:3:"min";s:74:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js";s:3:"map";s:74:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.map.js";}"*/
(function(){"use strict";BX.namespace("BX.UI");var t=function(){this.layout={container:null}};t.prototype={init:function(t){this.layout.container=BX(t.containerId);this.isFrame=t.isFrame||false;this.hasHints=t.hasHints||false;this.pinnerContainer=t.pinnerContainer||false;this.pinner=new BX.UI.Pinner(this.layout.container,{fixBottom:this.isFrame,fullWidth:this.isFrame,anchorBottom:this.pinnerContainer});if(this.hasHints){BX.UI.Hint.init(this.layout.container)}t.buttons.forEach(this.initButton,this)},getContainer:function(){return this.layout.container},hide:function(){if(!this.layout.container){return}this.layout.container.classList.add("ui-button-panel-wrapper-hide")},show:function(){this.layout.container.classList.remove("ui-button-panel-wrapper-hide")},initButton:function(t){if(!t.ID){return}t.node=BX(t.ID);if(!t.node){return}BX.bind(t.node,"click",this.onButtonClick.bind(this,t))},onButtonClick:function(t,n){BX.onCustomEvent(this,"button-click",[t]);if(t.WAIT){BX.addClass(BX(t.ID),"ui-btn-wait")}if(this.isFrame&&(t.TYPE==="close"||t.TYPE==="cancel")){n.preventDefault();top.BX.SidePanel.Instance.close()}}};BX.UI.ButtonPanel=new t})();
/* End */
;; /* /bitrix/components/bitrix/crm.router/templates/.default/script.min.js?1699257961719*/
; /* /bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.min.js?16992580965071*/
; /* /bitrix/components/bitrix/ui.toolbar/templates/.default/script.min.js?16992580966985*/
; /* /bitrix/components/bitrix/crm.type.detail/templates/.default/script.min.js?169925796222677*/
; /* /bitrix/components/bitrix/ui.sidepanel.wrappermenu/templates/.default/script.min.js?16992580966351*/
; /* /bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js?16992580961189*/

//# sourceMappingURL=page_940742542c5bba78a340bfc172150f9e.map.js