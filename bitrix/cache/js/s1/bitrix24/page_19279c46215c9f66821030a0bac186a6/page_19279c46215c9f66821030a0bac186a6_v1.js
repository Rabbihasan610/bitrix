
; /* Start:"a:4:{s:4:"full";s:96:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.min.js?16992580965071";s:6:"source";s:77:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.js";s:3:"min";s:81:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.min.js";s:3:"map";s:81:"/bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.map.js";}"*/
(function(){BX.namespace("BX.UI.SidePanel");if(BX.UI.SidePanel.Wrapper){return}function t(t){}t.prototype.init=function(t){this.container=BX(t.containerId);this.isCloseAfterSave=t.isCloseAfterSave||false;this.isReloadGridAfterSave=t.isReloadGridAfterSave||false;this.isReloadPageAfterSave=t.isReloadPageAfterSave||false;this.skipNotification=t.skipNotification||false;this.useLinkTargetsReplacing=t.useLinkTargetsReplacing||false;this.notification=t.notification||{};var e=BX.SidePanel.Instance.getPreviousSlider(BX.SidePanel.Instance.getSliderByWindow(window));this.parentWindow=e?e.getWindow():top;this.initEditableTitle(t);if(this.isReloadGridAfterSave){if(this.getParam("reloadGridAfterSave")){this.reloadGridOnParentPage()}this.setParam("reloadGridAfterSave",true)}if(this.isCloseAfterSave){if(this.getParam("closeAfterSave")){var i;if(this.notification.content&&top.BX&&!this.getParam("skipNotification")){i=function(){top.BX.loadExt("ui.notification").then(function(){top.BX.UI.Notification.Center.notify(this.notification)}.bind(this))}.bind(this)}else if(this.isReloadPageAfterSave){i=function(){this.parentWindow.location.reload()}.bind(this)}BX.SidePanel.Instance.close(false,i)}if(this.skipNotification){this.setParam("skipNotification",true)}this.setParam("closeAfterSave",true)}if(this.useLinkTargetsReplacing){this.initLinkTargetsReplacing()}};t.prototype.initEditableTitle=function(t){if(!t.title||!t.title.selector||!t.title.defaultTitle){return}var i=this.container.querySelector(t.title.selector);if(!i){return}var n=i.querySelector('input[type="text"]');if(!n){return}i.style.display="none";e.init({dataContainer:i,dataNode:n,defaultTitle:t.title.defaultTitle})};t.prototype.initLinkTargetsReplacing=function(){this.replaceLinkTargets();if(!window.MutationObserver){return}var t=new MutationObserver(this.domMutationHandler.bind(this));t.observe(this.container,{childList:true,subtree:true})};t.prototype.domMutationHandler=function(t){t.forEach(function(t){for(var e=0;e<t.addedNodes.length;++e){var i=t.addedNodes.item(e);if(!i){continue}this.replaceLinkTargets(i)}},this)};t.prototype.replaceLinkTargets=function(t){if(!t){t=document.body}var e=[];if(t.tagName==="A"){e=[t]}else if(t.nodeName!=="#text"){e=BX.convert.nodeListToArray(t.querySelectorAll("a"))}if(e.length===0){return}BX.convert.nodeListToArray(e).filter(function(t){return!t.target}).forEach(function(t){t.target="_top"})};t.prototype.setParam=function(t,e){var i=BX.SidePanel.Instance.getSliderByWindow(window);if(i){i.getData().set(t,e)}};t.prototype.getParam=function(t){var e=BX.SidePanel.Instance.getSliderByWindow(window);if(e){return e.getData().get(t)}return undefined};t.prototype.removeParam=function(t){var e=BX.SidePanel.Instance.getSliderByWindow(window);if(e){e.getData().delete(t)}};t.prototype.reloadGridOnParentPage=function(){var t=this.parentWindow;var e=BX.type.isString(this.isReloadGridAfterSave)?this.isReloadGridAfterSave:null;if(!t.BX.Main||!t.BX.Main.gridManager){return}if(e==="all"){t.BX.Main.gridManager.data.forEach(function(t){t.instance.reload()});return}if(!e&&t.BX.Main.gridManager.data){var i=t.BX.Main.gridManager.data;e=i.length>0?i[0].id:null}if(!e){return}var n=t.BX.Main.gridManager.getById(e);if(!n){return}n.instance.reload()};var e={isInit:false,init:function(t){this.dataNode=t.dataNode;this.titleNode=document.querySelector(".ui-side-panel-wrap-title-name");this.inputNode=document.querySelector(".ui-side-panel-wrap-title-input");this.buttonNode=document.querySelector(".ui-side-panel-wrap-title-edit-button");this.initialTitle=this.titleNode.textContent;this.defaultTitle=t.defaultTitle;BX.bind(this.dataNode,"bxchange",this.onDataNodeChange.bind(this));BX.bind(this.buttonNode,"click",this.startEdit.bind(this));BX.bind(this.inputNode,"keyup",this.onKeyUp.bind(this));BX.bind(this.inputNode,"blur",this.endEdit.bind(this));this.isInit=true;if(!t.disabled){this.enable()}if(!this.dataNode.value){this.dataNode.value=this.defaultTitle}},enable:function(t){t=t||false;if(!this.isInit){return}this.changeDisplay(this.buttonNode,!t);this.titleNode.textContent=!t?this.dataNode.value?this.dataNode.value:this.defaultTitle:this.initialTitle},disable:function(){this.enable(true)},onDataNodeChange:function(){this.titleNode.textContent=this.dataNode.value},onKeyUp:function(t){t=t||window.event;if(t.keyCode===10||t.keyCode===13){this.endEdit();t.preventDefault();return false}},getTitle:function(){var t=this.dataNode.value;if(!t){t=this.titleNode.textContent}return t},startEdit:function(){this.inputNode.value=this.getTitle();this.changeDisplay(this.titleNode,false);this.changeDisplay(this.buttonNode,false);this.changeDisplay(this.inputNode,true);this.inputNode.focus()},endEdit:function(){this.dataNode.value=this.inputNode.value;this.titleNode.textContent=this.inputNode.value;this.changeDisplay(this.inputNode,false);this.changeDisplay(this.buttonNode,true);this.changeDisplay(this.titleNode,true)},changeDisplay:function(t,e){return t.style.display=e?"":"none"}};BX.UI.SidePanel.Wrapper=new t})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:98:"/bitrix/components/bitrix/bizproc.globalfield.edit/templates/.default/script.min.js?16992579525294";s:6:"source";s:79:"/bitrix/components/bitrix/bizproc.globalfield.edit/templates/.default/script.js";s:3:"min";s:83:"/bitrix/components/bitrix/bizproc.globalfield.edit/templates/.default/script.min.js";s:3:"map";s:83:"/bitrix/components/bitrix/bizproc.globalfield.edit/templates/.default/script.map.js";}"*/
(function(e,t,i,r,l){"use strict";var n;function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){babelHelpers.defineProperty(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var a=t.Reflection.namespace("BX.Bizproc.Component");var u=function(){function e(i){babelHelpers.classCallCheck(this,e);babelHelpers.defineProperty(this,"correspondenceModeToIdName",{constant:"Constant",variable:"Variable"});if(!t.Type.isPlainObject(i)){return}this.oldProperty=i.property;this.documentType=i.documentType;this.signedDocumentType=i.signedDocumentType;this.mode=i.mode;this.availableTypes=i.types;this.visibilityNames=i.visibilityNames;this.inputValueId=i.inputValueId;this.multipleNode=i.multipleNode;this.saveButtonNode=i.saveButtonNode;this.form=i.form;this.slider=i.slider}babelHelpers.createClass(e,[{key:"init",value:function e(){this.sliderDict=this.slider?this.slider.getData():null;this.editInputValue(this.oldProperty["Type"],this.oldProperty);t.Event.bind(this.saveButtonNode,"click",this.saveHandler.bind(this))}},{key:"editInputValue",value:function e(i,r){var l=t.Runtime.clone(r);var o={Type:i!==null&&i!==void 0?i:"string",Multiple:false,Default:"",Placeholder:t.Loc.getMessage("BIZPROC_GLOBALFIELD_EDIT_TMP_EMPTY")};if(this.availableTypes[o.Type]===undefined){o.Type=Object.keys(this.availableTypes)[0]}if(!t.Type.isPlainObject(r)){l=o}else{if(t.Type.isString(r["Multiple"])){l["Multiple"]=r["Multiple"]==="Y"}l=s(s({},o),l)}this.multipleNode.value=l["Multiple"]?"Y":"N";if(l.Type==="select"&&r.Options===undefined){var a;l.Options=(a=this.oldProperty.Options)!==null&&a!==void 0?a:{}}var u=BX.Bizproc.FieldType.renderControl(this.documentType,l,"VALUE",l["Default"],"public");u.className="ui-ctl ui-ctl-textbox ui-ctl-w100";u.id=this.inputValueId;var p=document.getElementById(this.inputValueId);if(p){p.replaceWith(u)}if(l.Type!=="select"&&document.getElementById("bizproc_globEditComponent")){document.getElementById("bizproc_globEditComponent").remove();this.oldProperty.Options={}}else if(l.Type==="select"&&!document.getElementById("bizproc_globEditComponent")){var d=t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['<div class="ui-ctl ui-ctl-w100" id="bizproc_globEditComponent"></div>'])));var c=BX.Bizproc.FieldType.createControlOptions(l,this.setSelectOptionFromForm.bind(this));c.className="ui-form-label";t.Dom.append(c,d);d.getElementsByTagName("textarea")[0].className="ui-ctl-element ui-ctl-textarea ui-ctl-resize-y ui-ctl-w100";t.Dom.style(d.getElementsByTagName("textarea")[0],"paddingTop","6px");d.getElementsByTagName("button")[0].className="ui-btn ui-btn-xs ui-btn-light-border";u.before(d)}if(l["Type"]==="user"){return}if(u.getElementsByTagName("a").length>0){var m=u.getElementsByTagName("a")[0];t.Event.bind(m,"click",(function(){var e=document.getElementsByName("VALUE[]");var i=t.Runtime.clone(e[e.length-1]);if(l["Type"]!=="date"&&l["Type"]!=="datetime"){var r=e[e.length-1].parentNode;if(r){r.remove()}t.Dom.insertBefore(i,m.parentNode)}}))}}},{key:"setSelectOptionFromForm",value:function e(t){this.oldProperty.Options=t;this.editInputValue("select",{Options:t,Type:"select",Multiple:this.multipleNode.value})}},{key:"saveHandler",value:function e(){var r=this;var n=this.form.elements;var o=t.Type.isStringFilled(this.oldProperty["id"])?this.oldProperty["id"]:"";var a={Name:n["NAME"].value,Description:n["DESCRIPTION"].value,Type:n["TYPE"].value,Options:"",Default:this.getValues(n),Visibility:n["VISIBILITY"].value,Multiple:n["MULTIPLE"].value,Required:"N"};if(!this.validateName(a.Name)){return true}if(!t.Type.isStringFilled(o)){var u=new Date;o=this.correspondenceModeToIdName[this.mode]+u.getTime().toString()}if(this.oldProperty.Options){a.Options=this.oldProperty.Options}var p=this;l.Globals.Manager.Instance.upsertGlobalsAction(o,a,this.signedDocumentType,this.mode).then((function(e){if(e.data&&e.data.error){i.MessageBox.alert(e.data.error,(function(){t.Dom.removeClass(p.saveButtonNode,"ui-btn-wait");return true}))}else{p.sliderDict.set(o,s(s({},a),{},{VisibilityName:r.visibilityNames[a.Visibility]}));p.slider.close()}}));return true}},{key:"getValues",value:function e(i){if(i["VALUE"]){return i["VALUE"].value}if(i["VALUE[]"]){var r=i["VALUE[]"];var l=[];if(t.Type.isElementNode(r)){if(r.tagName!=="SELECT"){return r.value}for(var n in Object.keys(r.selectedOptions)){l.push(r.selectedOptions[n].value)}return l}for(var o in r){if(r.hasOwnProperty(o)){l.push(r[o].value)}}return l}}},{key:"validateName",value:function e(r){var l=this;if(!r){i.MessageBox.alert(BX.Loc.getMessage("BIZPROC_GLOBALFIELD_EDIT_TMP_EMPTY_NAME"),(function(){t.Dom.removeClass(l.saveButtonNode,"ui-btn-wait");return true}));return false}return true}}]);return e}();a.GlobalFieldEditComponent=u})(this.window=this.window||{},BX,BX.UI.Dialogs,BX,BX.Bizproc);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:89:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js?16992580961189";s:6:"source";s:70:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.js";s:3:"min";s:74:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js";s:3:"map";s:74:"/bitrix/components/bitrix/ui.button.panel/templates/.default/script.map.js";}"*/
(function(){"use strict";BX.namespace("BX.UI");var t=function(){this.layout={container:null}};t.prototype={init:function(t){this.layout.container=BX(t.containerId);this.isFrame=t.isFrame||false;this.hasHints=t.hasHints||false;this.pinnerContainer=t.pinnerContainer||false;this.pinner=new BX.UI.Pinner(this.layout.container,{fixBottom:this.isFrame,fullWidth:this.isFrame,anchorBottom:this.pinnerContainer});if(this.hasHints){BX.UI.Hint.init(this.layout.container)}t.buttons.forEach(this.initButton,this)},getContainer:function(){return this.layout.container},hide:function(){if(!this.layout.container){return}this.layout.container.classList.add("ui-button-panel-wrapper-hide")},show:function(){this.layout.container.classList.remove("ui-button-panel-wrapper-hide")},initButton:function(t){if(!t.ID){return}t.node=BX(t.ID);if(!t.node){return}BX.bind(t.node,"click",this.onButtonClick.bind(this,t))},onButtonClick:function(t,n){BX.onCustomEvent(this,"button-click",[t]);if(t.WAIT){BX.addClass(BX(t.ID),"ui-btn-wait")}if(this.isFrame&&(t.TYPE==="close"||t.TYPE==="cancel")){n.preventDefault();top.BX.SidePanel.Instance.close()}}};BX.UI.ButtonPanel=new t})();
/* End */
;; /* /bitrix/components/bitrix/ui.sidepanel.wrapper/templates/.default/template.min.js?16992580965071*/
; /* /bitrix/components/bitrix/bizproc.globalfield.edit/templates/.default/script.min.js?16992579525294*/
; /* /bitrix/components/bitrix/ui.button.panel/templates/.default/script.min.js?16992580961189*/

//# sourceMappingURL=page_19279c46215c9f66821030a0bac186a6.map.js