; /* /bitrix/js/landing/bxdom.js?16992580171560*/
; /* /bitrix/js/landing/typedef.min.js?169925801936*/
; /* /bitrix/js/landing/ui/editor_config.js?1699258021443*/
; /* /bitrix/js/landing/ui/style_factory.min.js?16992580211806*/
; /* /bitrix/js/landing/ui/field_factory.js?169925802110035*/
; /* /bitrix/js/landing/ui/card/block_preview_card.min.js?16992580213777*/
; /* /bitrix/js/landing/ui/card/field_group.min.js?1699258021774*/
; /* /bitrix/js/landing/ui/card/image_preview_card.min.js?16992580211553*/
; /* /bitrix/js/landing/ui/card/add_your_first_block.js?1699258021770*/
; /* /bitrix/js/landing/ui/card/base_image_library_card.min.js?16992580214171*/
; /* /bitrix/js/landing/ui/card/unsplash_card.min.js?16992580212529*/
; /* /bitrix/js/landing/ui/card/google_images_card.min.js?16992580213828*/
; /* /bitrix/js/landing/ui/card/uploader_card.js?1699258021800*/
; /* /bitrix/js/landing/ui/card/loader.min.js?1699258021617*/
; /* /bitrix/js/landing/ui/card/link_card.js?1699258021771*/
; /* /bitrix/js/landing/ui/card/landing_preview.min.js?1699258021805*/
; /* /bitrix/js/landing/ui/card/block_html_preview.js?1699258021990*/
; /* /bitrix/js/landing/ui/card/tab_card.min.js?16992580212439*/
; /* /bitrix/js/landing/ui/card/dynamic_fields_group.min.js?1699258021633*/
; /* /bitrix/js/landing/ui/card/add_page_card.min.js?16992580212627*/
; /* /bitrix/js/landing/ui/tool/color_picker.min.js?16992580213735*/
; /* /bitrix/js/landing/ui/tool/auto-font-scale.min.js?16992580211240*/
; /* /bitrix/js/landing/ui/tool/auto-font-scale-entry.min.js?16992580212175*/
; /* /bitrix/js/landing/ui/tool/suggests.min.js?16992580211716*/
; /* /bitrix/js/landing/ui/tool/font-manager.min.js?16992580212719*/
; /* /bitrix/js/landing/ui/adapter/css-property.min.js?1699258022408*/
; /* /bitrix/js/landing/ui/button/plus_button.js?1699258022662*/
; /* /bitrix/js/landing/ui/button/editor_action_button.min.js?1699258022760*/
; /* /bitrix/js/landing/ui/button/ai_text_button.min.js?1699258022342*/
; /* /bitrix/js/landing/ui/button/design_button.min.js?1699258022299*/
; /* /bitrix/js/landing/ui/button/color_button.min.js?16992580222396*/
; /* /bitrix/js/landing/ui/button/block_card_action.min.js?1699258022418*/
; /* /bitrix/js/landing/ui/button/create_link.min.js?1699258022733*/
; /* /bitrix/js/landing/ui/button/create_table.min.js?16992580223459*/
; /* /bitrix/js/landing/ui/button/paste_table.min.js?1699258022932*/
; /* /bitrix/js/landing/ui/button/delete_element_table.min.js?1699258022826*/
; /* /bitrix/js/landing/ui/button/align_table.min.js?16992580221082*/
; /* /bitrix/js/landing/ui/button/style_table.min.js?16992580224266*/
; /* /bitrix/js/landing/ui/button/copy_table.min.js?1699258022893*/
; /* /bitrix/js/landing/ui/button/delete_table.min.js?1699258022599*/
; /* /bitrix/js/landing/ui/button/change_tag.min.js?16992580221933*/
; /* /bitrix/js/landing/ui/button/text_background_color.min.js?1699258022531*/
; /* /bitrix/js/landing/ui/button/create_page.min.js?1699258022624*/
; /* /bitrix/js/landing/ui/panel/base_button_panel.min.js?1699258022874*/
; /* /bitrix/js/landing/ui/panel/editor_panel.js?169925802221505*/
; /* /bitrix/js/landing/ui/panel/small_editor_panel.js?16992580211474*/
; /* /bitrix/js/landing/ui/panel/edit_content_panel.min.js?16992580212855*/
; /* /bitrix/js/landing/ui/panel/preview_panel.js?16992580214501*/
; /* /bitrix/js/landing/ui/panel/unsplash_panel.min.js?16992580213305*/
; /* /bitrix/js/landing/ui/panel/image_panel.min.js?16992580213651*/
; /* /bitrix/js/landing/ui/panel/url_list.min.js?169925802211600*/
; /* /bitrix/js/landing/ui/panel/top_panel.min.js?169925802111370*/
; /* /bitrix/js/landing/ui/panel/card_action.js?16992580222386*/
; /* /bitrix/js/landing/ui/panel/link_panel.min.js?16992580214116*/
; /* /bitrix/js/landing/ui/panel/google_fonts_panel.min.js?169925802113021*/
; /* /bitrix/js/landing/ui/panel/google_images_settings_panel.min.js?16992580212137*/
; /* /bitrix/js/landing/ui/panel/catalog_panel.min.js?16992580227011*/
; /* /bitrix/js/landing/ui/panel/status_panel.min.js?16992580211461*/
; /* /bitrix/js/landing/ui/panel/detail_page_panel.min.js?16992580214359*/
; /* /bitrix/js/landing/ui/field/dropdown_field.min.js?16992580224296*/
; /* /bitrix/js/landing/ui/field/dropdown_preview_field.min.js?16992580222746*/
; /* /bitrix/js/landing/ui/field/unit_field.min.js?16992580222463*/
; /* /bitrix/js/landing/ui/field/range_field.min.js?16992580228326*/
; /* /bitrix/js/landing/ui/field/button_group_field.min.js?16992580222697*/
; /* /bitrix/js/landing/ui/field/dropdown_inline.min.js?16992580222393*/
; /* /bitrix/js/landing/ui/field/dnd_list.min.js?16992580229052*/
; /* /bitrix/js/landing/ui/field/sortable_list.min.js?16992580222604*/
; /* /bitrix/js/landing/ui/field/position_field.min.js?16992580221930*/
; /* /bitrix/js/landing/ui/field/checkbox_field.min.js?16992580222746*/
; /* /bitrix/js/landing/ui/field/radio_field.min.js?1699258022469*/
; /* /bitrix/js/landing/ui/field/multiselect_field.min.js?16992580225813*/
; /* /bitrix/js/landing/ui/field/filter_field.min.js?16992580221673*/
; /* /bitrix/js/landing/ui/field/font_field.min.js?16992580225233*/
; /* /bitrix/js/landing/ui/field/html_field.min.js?16992580221233*/
; /* /bitrix/js/landing/ui/field/embed_field.min.js?16992580223108*/
; /* /bitrix/js/landing/ui/field/embed_bg_field.min.js?1699258022939*/
; /* /bitrix/js/landing/ui/field/date_field.min.js?16992580221896*/
; /* /bitrix/js/landing/ui/field/block_source_field.min.js?16992580221561*/
; /* /bitrix/js/landing/ui/field/dynamic_image_field.min.js?16992580221947*/
; /* /bitrix/js/landing/ui/field/dynamic_dropdown_field.min.js?1699258022430*/
; /* /bitrix/js/landing/ui/field/pages_field.min.js?16992580221478*/
; /* /bitrix/js/landing/ui/field/click_action_field.min.js?16992580222334*/
; /* /bitrix/js/landing/ui/field/color_field.min.js?16992580222119*/
; /* /bitrix/js/landing/ui/style_node.js?169925802210232*/
; /* /bitrix/js/landing/events/block_event.min.js?1699258017520*/
; /* /bitrix/js/landing/group.min.js?1699258017576*/
; /* /bitrix/js/landing/block.js?1699258018145888*/
; /* /bitrix/js/landing/card.js?16992580182792*/
; /* /bitrix/js/landing/node.min.js?16992580172544*/
; /* /bitrix/js/landing/node/text.min.js?169925801717809*/
; /* /bitrix/js/landing/node/link.min.js?16992580173900*/
; /* /bitrix/js/landing/node/img.min.js?16992580176006*/
; /* /bitrix/js/landing/node/ul.js?16992580175944*/
; /* /bitrix/js/landing/node/map.min.js?16992580172472*/
; /* /bitrix/js/landing/node/component.min.js?1699258017491*/
; /* /bitrix/js/landing/node/icon.min.js?16992580171728*/
; /* /bitrix/js/landing/node/embed.min.js?16992580172431*/
; /* /bitrix/js/landing/client/unsplash.min.js?16992580171537*/
; /* /bitrix/js/landing/client/google_images.min.js?16992580171041*/
; /* /bitrix/js/landing/client/google_fonts.min.js?16992580171141*/
; /* /bitrix/js/landing/mediaservice/base_mediaservice.min.js?16992580172709*/
; /* /bitrix/js/landing/mediaservice/youtube_mediaservice.min.js?16992580173285*/
; /* /bitrix/js/landing/mediaservice/rutube_mediaservice.min.js?1699258017971*/
; /* /bitrix/js/landing/mediaservice/vk_mediaservice.min.js?16992580173055*/
; /* /bitrix/js/landing/mediaservice/vimeo_mediaservice.min.js?16992580172897*/
; /* /bitrix/js/landing/mediaservice/vine_mediaservice.min.js?16992580171047*/
; /* /bitrix/js/landing/mediaservice/instagram_mediaservice.min.js?16992580171215*/
; /* /bitrix/js/landing/mediaservice/google_maps_search_mediaservice.min.js?16992580171169*/
; /* /bitrix/js/landing/mediaservice/google_maps_place_mediaservice.min.js?1699258017828*/
; /* /bitrix/js/landing/mediaservice/facebook_page_plugin_service.min.js?16992580172767*/
; /* /bitrix/js/landing/mediaservice/facebook_post_embed_service.min.js?16992580171228*/
; /* /bitrix/js/landing/mediaservice/facebook_video_embed_service.min.js?16992580171239*/
; /* /bitrix/js/landing/mediaservice/service_factory.min.js?1699258017847*/
; /* /bitrix/js/landing/error_manager.min.js?16992580222325*/
; /* /bitrix/js/landing/external/webfontloader/webfontloader_landing.min.js?169925801712558*/

; /* Start:"a:4:{s:4:"full";s:42:"/bitrix/js/landing/bxdom.js?16992580171560";s:6:"source";s:27:"/bitrix/js/landing/bxdom.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function(window) {

	var debug = 0 ? console.log.bind(console, '[BXDOM]') : function() {};

	var raf = (
		window.requestAnimationFrame
		|| window.webkitRequestAnimationFrame
		|| window.mozRequestAnimationFrame
		|| window.msRequestAnimationFrame
		|| function(cb) { return setTimeout(cb, 16); }
	);

	var BXDOM = function()
	{
		this.reads = [];
		this.writes = [];
		this.raf = raf.bind(window);
		debug('initialized', this);
	};

	BXDOM.prototype = {
		constructor: BXDOM,

		read: function(fn, ctx)
		{
			debug('read');
			this.reads.push(!ctx ? fn : fn.bind(ctx));
			scheduleFlush(this);
		},

		write: function(fn, ctx)
		{
			debug('write');
			this.writes.push(!ctx ? fn : fn.bind(ctx));
			scheduleFlush(this);
		},

		catch: null
	};

	function scheduleFlush(dom) {
		if (!dom.scheduled)
		{
			dom.scheduled = true;
			dom.raf(flush.bind(null, dom));
			debug('flush scheduled');
		}
	}

	function flush(dom) {
		debug('flush');

		var writes = dom.writes;
		var reads = dom.reads;
		var error;

		try {
			debug('flushing reads', reads.length);
			runTasks(reads);
			debug('flushing writes', writes.length);
			runTasks(writes);
		} catch (e) { error = e; }

		dom.scheduled = false;

		if (reads.length || writes.length)
		{
			scheduleFlush(dom);
		}

		if (error)
		{
			debug('task errored', error.message);
			if (dom.catch) dom.catch(error);
			else throw error;
		}
	}

	function runTasks(tasks) {
		debug('run tasks');
		var task;

		while (task = tasks.shift())
		{
			task();
		}
	}

	BX.DOM = (BX.DOM || new BXDOM());

})(window);
/* End */
;
; /* Start:"a:4:{s:4:"full";s:46:"/bitrix/js/landing/typedef.min.js?169925801936";s:6:"source";s:29:"/bitrix/js/landing/typedef.js";s:3:"min";s:33:"/bitrix/js/landing/typedef.min.js";s:3:"map";s:33:"/bitrix/js/landing/typedef.map.js";}"*/

/* End */
;
; /* Start:"a:4:{s:4:"full";s:52:"/bitrix/js/landing/ui/editor_config.js?1699258021443";s:6:"source";s:38:"/bitrix/js/landing/ui/editor_config.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	/**
	 * Sets p tag as default paragraph tag (div by default)
	 */
	document.execCommand("defaultParagraphSeparator", false, "p");

	/**
	 * Allows setts styles as css properties
	 */
	document.execCommand("styleWithCSS", false, true);


	if (top !== window)
	{
		parent.document.addEventListener("keydown", function(event) {
			parent.BX.onCustomEvent(parent.document, "iframe:keydown", [event]);
		});
	}
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/landing/ui/style_factory.min.js?16992580211806";s:6:"source";s:38:"/bitrix/js/landing/ui/style_factory.js";s:3:"min";s:42:"/bitrix/js/landing/ui/style_factory.min.js";s:3:"map";s:42:"/bitrix/js/landing/ui/style_factory.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Factory");BX.Landing.UI.Factory.StyleFactory=function(e){this.frame=!!e.frame?e.frame:null;this.postfix=typeof e.postfix==="string"?e.postfix:""};function e(e,t,n,l,i){l=!!l?l:"";if(!!t&&typeof t==="object"){var o=Object.keys(t);t=o.map((function(e){return t[e]}))}else if(typeof t==="string"){t=[t]}t.forEach((function(t){n.forEach((function(n){if(t+l!==n.value+l){e.classList.remove(n.value+l)}if(i){e.style[i]=null;[].slice.call(e.querySelectorAll("*")).forEach((function(e){e.style[i]=null}))}}));e.classList.add(t+l)}))}BX.Landing.UI.Factory.StyleFactory.prototype={createField:function(t){var n=null;var l={title:t.title,selector:t.selector,contentRoot:BX.Landing.PageObject.getStylePanelContent(),style:t.style,format:e,frame:this.frame,property:t.property,pseudoElement:t.pseudoElement,pseudoClass:t.pseudoClass,items:t.items,postfix:this.postfix,onChange:t.onChange,onReset:t.onReset,help:t.help,attrKey:t.attrKey};if(t.type==="slider"||t.type==="range-slider"){n=new BX.Landing.UI.Field.Range(Object.assign(l,{type:t.type==="range-slider"?"multiple":null}))}if(t.type==="buttons"){n=new BX.Landing.UI.Field.ButtonGroup(Object.assign(l,{multiple:t.multiple===true}))}if(t.type==="display"){n=new BX.Landing.UI.Field.ButtonGroup(Object.assign(l,{multiple:true,className:"landing-ui-display-button-group"}))}if(t.type==="palette"){n=new BX.Landing.UI.Field.ColorPalette(l)}if(t.type==="color"){n=new BX.Landing.UI.Field.ColorField(Object.assign(l,{block:t.block,styleNode:t.styleNode,subtype:t.subtype}))}if(t.type==="list"&&t.style!=="font-family"){n=new BX.Landing.UI.Field.Dropdown(l)}if(t.style==="font-family"){n=new BX.Landing.UI.Field.Font(Object.assign(l,{styleNode:t.styleNode}))}return n}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:54:"/bitrix/js/landing/ui/field_factory.js?169925802110035";s:6:"source";s:38:"/bitrix/js/landing/ui/field_factory.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Factory");

	var isFunction = BX.Landing.Utils.isFunction;
	var assign = BX.Landing.Utils.assign;


	BX.Landing.UI.Factory.FieldFactory = function(params)
	{
		this.uploadParams = params.uploadParams || {};
		this.linkOptions = params.linkOptions || {};
		this.selector = params.selector;
		this.onChangeHandler = isFunction(params.onChange) ? params.onChange : (function() {});
		this.onValueChangeHandler = isFunction(params.onValueChange) ? params.onValueChange : (function() {});
	};


	BX.Landing.UI.Factory.FieldFactory.prototype = {
		create: function(options)
		{
			if (options.type === "text")
			{
				return new BX.Landing.UI.Field.Text({
					title: options.name,
					selector: this.selector,
					content: options.value,
					placeholder: options.placeholder,
					description: options.description,
					textOnly: true,
					onInput: options.onInput,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "date")
			{
				return new BX.Landing.UI.Field.Date({
					title: options.name,
					selector: this.selector,
					content: options.value,
					placeholder: options.placeholder,
					description: options.description,
					textOnly: true,
					onInput: options.onInput,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					time: options.time,
					format: options.format,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "html")
			{
				return new BX.Landing.UI.Field.Html({
					title: options.name,
					selector: this.selector,
					content: options.value,
					placeholder: options.placeholder,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (!options.type || options.type === "list" || options.type === "dropdown")
			{
				return new BX.Landing.UI.Field.Dropdown({
					title: options.name,
					selector: this.selector,
					items: options.items,
					content: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					disabled: BX.Text.toBoolean(options.disabled),
					dependency: options.dependency,
					hint: options.hint
				});
			}

			if (options.type === "image")
			{
				return new BX.Landing.UI.Field.Image({
					title: options.name,
					selector: this.selector,
					content: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					uploadParams: this.uploadParams,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "icon")
			{
				options.value = BX.Landing.Utils.isPlainObject(options.value) ? options.value : {};
				return new BX.Landing.UI.Field.Icon({
					title: options.name,
					selector: this.selector,
					content: {
						type: "icon",
						src: "",
						alt: "",
						classList: "classList" in options.value ? options.value.classList : []
					},
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "link")
			{
				return new BX.Landing.UI.Field.Link({
					title: options.name,
					selector: this.selector,
					content: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					options: this.linkOptions,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "url")
			{
				options = assign({}, options, {
					title: options.name,
					content: options.value,
					selector: this.selector,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					options: this.linkOptions,
					textOnly: true,
					disabled: BX.Text.toBoolean(options.disabled)
				});

				return new BX.Landing.UI.Field.LinkUrl(options);
			}

			if (options.type === "dynamic_source")
			{

				options = assign({}, options, {
					title: options.name,
					content: options.value,
					selector: this.selector,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					options: this.linkOptions,
					textOnly: true,
					currentPageOnly: options.currentPageOnly,
					allowedTypes: [
						'block'
					],
					disableCustomURL: true,
					disallowType: true,
					customPlaceholder: BX.Landing.Loc.getMessage('LANDING_BLOCK__BLOCK_SOURCE_PLACEHOLDER'),
					panelTitle: BX.Landing.Loc.getMessage('LANDING_BLOCK__BLOCK_SOURCE_PLACEHOLDER'),
					disabled: BX.Text.toBoolean(options.disabled)
				});

				return new BX.Landing.UI.Field.LinkUrl(options);
			}

			if (options.type === "slider" || options.type === "range-slider")
			{
				return new BX.Landing.UI.Field.Range({
					title: options.name,
					selector: this.selector,
					items: options.items,
					content: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					frame: window,
					type: options.type === "range-slider" ? "multiple" : null,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "palette")
			{
				return new BX.Landing.UI.Field.ColorPalette({
					title: options.name,
					selector: this.selector,
					items: options.items,
					content: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			// todo: need save Backward compatibility for "pallette"?
			if (options.type === "color")
			{
				return new BX.Landing.UI.Field.ColorField({
					title: options.name,
					selector: this.selector,
					subtype: options.subtype,
					// items: options.items,
					content: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					// property: options.property,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "catalog-view")
			{
				return new BX.Landing.UI.Field.DragAndDropList({
					title: options.name,
					selector: this.selector,
					items: options.items,
					value: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "sortable-list")
			{
				return new BX.Landing.UI.Field.SortableList({
					title: options.name,
					selector: this.selector,
					items: options.items,
					value: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "position")
			{
				return new BX.Landing.UI.Field.Position({
					title: options.name,
					selector: this.selector,
					items: options.items,
					value: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					mode: options.mode,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "checkbox")
			{
				return new BX.Landing.UI.Field.Checkbox({
					title: options.name,
					selector: this.selector,
					items: options.items,
					value: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					compact: options.compact,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "radio")
			{
				return new BX.Landing.UI.Field.Radio({
					title: options.name,
					selector: this.selector,
					items: options.items,
					value: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					compact: options.compact,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "multiselect")
			{
				return new BX.Landing.UI.Field.MultiSelect({
					title: options.name,
					selector: this.selector,
					items: options.items,
					value: options.value,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}

			if (options.type === "filter")
			{
				return new BX.Landing.UI.Field.Filter({
					title: options.name,
					selector: this.selector,
					items: options.items,
					value: options.value,
					html: options.html,
					filterId: options.filterId,
					onChange: this.onChangeHandler,
					onValueChange: this.onValueChangeHandler,
					attribute: options.attribute,
					attrKey: options.attrKey,
					property: options.property,
					disabled: BX.Text.toBoolean(options.disabled)
				});
			}
		}
	};

})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:67:"/bitrix/js/landing/ui/card/block_preview_card.min.js?16992580213777";s:6:"source";s:48:"/bitrix/js/landing/ui/card/block_preview_card.js";s:3:"min";s:52:"/bitrix/js/landing/ui/card/block_preview_card.min.js";s:3:"map";s:52:"/bitrix/js/landing/ui/card/block_preview_card.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");var e=BX.Landing.Utils.addClass;var i=BX.Landing.Utils.append;var a=BX.Landing.Utils.create;BX.Landing.UI.Card.BlockPreviewCard=function(t){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.layout.classList.add("landing-ui-card-block-preview");this.mode=typeof t.mode==="string"?t.mode:"img";this.title=typeof t.title==="string"?t.title:"";this.appExpired=typeof t.app_expired==="boolean"?t.app_expired:false;this.repoId=t.repo_id||null;this.imageSrc=typeof t.image==="string"?t.image:"/bitrix/images/landing/empty-preview.png";this.code=typeof t.code==="string"?t.code:"";this.favorite=t.favorite;this.favoriteMy=t.favoriteMy;this.isNew=typeof t.isNew==="boolean"?t.isNew:false;this.imageContainer=BX.create("div",{props:{className:"landing-ui-card-block-preview-image-container"}});this.body.appendChild(this.imageContainer);this.header.innerText=this.title;this.layout.dataset.code=this.code;this.requiresUpdates=t.requires_updates;if(this.isNew){this.title=BX.create("span",{props:{className:"landing-ui-new-inline"},text:BX.Landing.Loc.getMessage("LANDING_BLOCKS_LIST_PREVIEW_NEW")}).outerHTML+"&nbsp;"+this.title;this.header.innerHTML=this.title}if(this.repoId||this.favorite||this.appExpired){this.labels=BX.create("div",{props:{className:"landing-ui-card-labels"}});BX.insertAfter(this.labels,this.getHeader())}if(this.repoId||this.appExpired){var s=BX.create("div",{props:{className:"landing-ui-card-label landing-ui-card-label-repo"},text:BX.Landing.Loc.getMessage("LANDING_BLOCKS_LIST_PREVIEW_MARKET"),dataset:{hint:BX.Landing.Loc.getMessage("LANDING_BLOCKS_LIST_PREVIEW_MARKET_HINT"),hintNoIcon:"Y"}});BX.append(s,this.labels);BX.UI.Hint.init(this.labels)}if(this.favorite){if(this.favoriteMy){BX.append(BX.create("div",{props:{className:"landing-ui-card-label landing-ui-card-label-my"},text:BX.Landing.Loc.getMessage("LANDING_BLOCKS_LIST_PREVIEW_MY_NEW")}),this.labels)}BX.append(BX.create("div",{props:{className:"landing-ui-card-label landing-ui-card-label-favorite"},text:BX.Landing.Loc.getMessage("LANDING_BLOCKS_LIST_PREVIEW_FAVORITE")}),this.labels);var n=this.code.split("@").length===2?this.code.split("@")[1]:false;if(n&&this.favoriteMy){BX.Runtime.loadExtension("ui.dialogs.messagebox").then((()=>{const e=this.getRemoveButton();e.onclick=e=>{e.stopPropagation();BX.UI.Dialogs.MessageBox.show({message:BX.Landing.Loc.getMessage("LANDING_BLOCKS_LIST_PREVIEW_DELETE_MSG"),buttons:BX.UI.Dialogs.MessageBoxButtons.YES_CANCEL,onYes:()=>BX.Landing.Backend.getInstance().action("Landing::unFavoriteBlock",{blockId:n}).then((()=>{const e=BX.Landing.Main.getInstance();e.removeBlockFromList(this.code);return true})).catch((function(e){console.log("error",e);return false}))})};BX.append(e,this.getBody())}))}}if(this.appExpired){this.addWarning(BX.Landing.Loc.getMessage("LANDING_BLOCKS_LIST_PREVIEW_EXPIRED"));this.onClickHandler=function(){}}if(this.mode==="background"){this.imageContainer.style.backgroundImage="url("+this.imageSrc+")"}else{var r=this.imageSrc||"/bitrix/images/landing/empty-preview.png";this.image=BX.create("img",{props:{src:r},attrs:{style:"opacity: "+(this.imageSrc?1:.6)}});this.imageContainer.appendChild(this.image)}if(this.requiresUpdates){e(this.layout,"landing-ui-requires-update");var o=a("div",{props:{className:"landing-ui-requires-update-overlay"},children:[a("div",{props:{className:"landing-ui-requires-update-overlay-footer"},html:BX.Landing.Loc.getMessage("LANDING_BLOCK_REQUIRES_UPDATE_MESSAGE")})]});i(o,this.imageContainer);this.onClickHandler=function(){}}};BX.Landing.UI.Card.BlockPreviewCard.prototype={constructor:BX.Landing.UI.Card.BlockPreviewCard,__proto__:BX.Landing.UI.Card.BaseCard.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:59:"/bitrix/js/landing/ui/card/field_group.min.js?1699258021774";s:6:"source";s:41:"/bitrix/js/landing/ui/card/field_group.js";s:3:"min";s:45:"/bitrix/js/landing/ui/card/field_group.min.js";s:3:"map";s:45:"/bitrix/js/landing/ui/card/field_group.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");BX.Landing.UI.Card.FieldGroup=function(i){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.items=i.items;this.layout.classList.add("landing-ui-card-field-group");this.fields=new BX.Landing.Collection.BaseCollection;this.init()};BX.Landing.UI.Card.FieldGroup.createItem=function(){return BX.create("div",{props:{className:"landing-ui-card-field-group-item"}})};BX.Landing.UI.Card.FieldGroup.prototype={constructor:BX.Landing.UI.Card.FieldGroup,__proto__:BX.Landing.UI.Card.BaseCard.prototype,init:function(){this.items.forEach(function(i){var a=BX.Landing.UI.Card.FieldGroup.createItem();a.appendChild(i.layout);this.body.appendChild(a);this.fields.add(a)},this)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:67:"/bitrix/js/landing/ui/card/image_preview_card.min.js?16992580211553";s:6:"source";s:48:"/bitrix/js/landing/ui/card/image_preview_card.js";s:3:"min";s:52:"/bitrix/js/landing/ui/card/image_preview_card.min.js";s:3:"map";s:52:"/bitrix/js/landing/ui/card/image_preview_card.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");BX.Landing.UI.Card.ImagePreview=function(i){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.title="title"in i?i.title:"";this.imageSrc=("image"in i?i.image:"").replace("http:","");this.code="code"in i?i.code:"";this.clickHandler="onClick"in i?i.onClick:"";this.credit="credit"in i?i.credit:null;this.dimensions="dimensions"in i?i.dimensions:{width:0,height:0};this.layout.classList.add("landing-ui-card-image-preview");this.imageContainer=BX.Landing.UI.Card.ImagePreview.createImageContainer();this.header.innerText=this.title;this.layout.dataset.code=this.code;if(this.credit){this.creditLayout=BX.create("div",{props:{className:"landing-ui-card-image-preview-credit"},children:[BX.create("a",{props:{className:"landing-ui-card-image-preview-credit-link"},attrs:{href:this.credit.link,target:"_blank",rel:"nofollow",title:BX.Landing.Loc.getMessage("LANDING_UNSPLASH_CREDIT_LABEL")+" "+this.credit.name},text:this.credit.name})]});this.layout.appendChild(this.creditLayout)}if(this.imageSrc){this.imageContainer.style.backgroundImage="url("+this.imageSrc+")";this.body.appendChild(this.imageContainer)}};BX.Landing.UI.Card.ImagePreview.createImageContainer=function(){return BX.create("div",{props:{className:"landing-ui-card-image-preview-container"}})};BX.Landing.UI.Card.ImagePreview.prototype={constructor:BX.Landing.UI.Card.ImagePreview,__proto__:BX.Landing.UI.Card.BaseCard.prototype,onClick:function(){this.clickHandler(this)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/card/add_your_first_block.js?1699258021770";s:6:"source";s:50:"/bitrix/js/landing/ui/card/add_your_first_block.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Card");


	BX.Landing.UI.Card.AddYourFirstBlock = function(data)
	{
		BX.Landing.UI.Card.BaseCard.apply(this, arguments);
		this.layout.classList.add("landing-ui-card-add-first-block");
		this.subheader = BX.create("div", {props: {className: "landing-ui-card-add-first-block-subheader"}});
		this.layout.insertBefore(this.subheader, this.body);
	};

	BX.Landing.UI.Card.AddYourFirstBlock.prototype = {
		constructor: BX.Landing.UI.Card.AddYourFirstBlock,
		__proto__: BX.Landing.UI.Card.BaseCard.prototype,

		/**
		 * @inheritDoc
		 */
		show: function()
		{
			BX.Landing.Utils.Show(this.layout);
		},


		/**
		 * @inheritDoc
		 */
		hide: function()
		{
			BX.Landing.Utils.Hide(this.layout);
		}
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:72:"/bitrix/js/landing/ui/card/base_image_library_card.min.js?16992580214171";s:6:"source";s:53:"/bitrix/js/landing/ui/card/base_image_library_card.js";s:3:"min";s:57:"/bitrix/js/landing/ui/card/base_image_library_card.min.js";s:3:"map";s:57:"/bitrix/js/landing/ui/card/base_image_library_card.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");var i=BX.Landing.Utils.addClass;var e=BX.Landing.Utils.removeClass;var t=BX.Landing.Utils.slice;var a=BX.Landing.Utils.Show;var r=BX.Landing.Utils.Hide;BX.Landing.UI.Card.Library=function(i){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.layout.classList.add("landing-ui-card-library");this.searchLabel=!!i.searchLabel?i.searchLabel:"";this.searchPlaceholder=!!i.searchPlaceholder?i.searchPlaceholder:"";this.serchTipsList=!!i.searchTips?i.searchTips:[];this.onChangeHandler=typeof i.onChange==="function"?i.onChange:function(){};this.search=BX.create("div",{props:{className:"landing-ui-card-library-search"}});this.searchField=this.createSearchField();this.searchTips=this.createSearchTips();if(i.description){this.description=BX.create("div",{props:{className:"landing-ui-card-library-description"},html:i.description});this.searchField.layout.insertBefore(this.description,this.searchField.input)}this.search.appendChild(this.searchField.layout);this.search.appendChild(this.searchTips.layout);this.body.appendChild(this.search);this.loader=new BX.Loader({target:this.body});this.imageList=BX.create("div",{props:{className:"landing-ui-card-library-list"}});this.body.appendChild(this.imageList);this.bottomLoader=new BX.Loader({target:this.body,mode:"inline",offset:{left:"calc(50% - 55px)"}});this.loadMore=BX.create("div",{props:{className:"landing-ui-card-library-load-more"}});this.loadMoreButton=this.createLoadMoreButton();this.loadMore.hidden=true;this.loadMore.dataset.isShown="false";this.loadMore.appendChild(this.loadMoreButton.layout);this.body.appendChild(this.loadMore)};BX.Landing.UI.Card.Library.prototype={constructor:BX.Landing.UI.Card.Library,__proto__:BX.Landing.UI.Card.BaseCard.prototype,onSearchInput:function(i){},onTipsChange:function(i){this.searchField.setValue(i)},onLoadMore:function(){},onChange:function(i){this.onChangeHandler(i)},renderItems:function(e){e.forEach((function(e){var t=new BX.Landing.UI.Card.ImagePreview(e);this.imageList.appendChild(t.layout);requestAnimationFrame((function(){i(t.layout,"landing-ui-show")}))}),this)},showEmptyResult:function(){if(!this.empty){this.empty=BX.create("div",{props:{className:"landing-ui-card-library-empty"},html:BX.Landing.Loc.getMessage("LANDING_IMAGES_PANEL_EMPTY_RESULT")});BX.insertAfter(this.empty,this.imageList)}return a(this.empty)},hideEmptyResult:function(){if(this.empty){return r(this.empty)}},showError:function(){if(!this.error){this.error=BX.create("div",{props:{className:"landing-ui-card-library-error"},html:BX.Landing.Loc.getMessage("LANDING_IMAGES_PANEL_ERROR")||"Error"});BX.insertAfter(this.error,this.imageList)}this.hideEmptyResult();this.hideLoadMore();this.hideBottomLoader();this.hideLoadMore();this.hideLoader();this.clearItems();return a(this.error)},hideError:function(){if(this.error){return r(this.error)}},clearItems:function(){this.imageList.innerHTML=""},createLoadMoreButton:function(){return new BX.Landing.UI.Button.BaseButton("load_more",{text:BX.Landing.Loc.getMessage("LANDING_IMAGE_LIBRARY_LOAD_MORE"),className:"landing-ui-card-library-load-more-button",onClick:this.onLoadMore.bind(this)})},createSearchTips:function(){return new BX.Landing.UI.Field.ButtonGroup({items:this.serchTipsList,className:"landing-ui-card-library-search-tips",onChange:this.onTipsChange.bind(this)})},createSearchField:function(){var i=new BX.Landing.UI.Field.Unit({onInput:this.onSearchInput.bind(this),className:"landing-ui-card-library-search-field",placeholder:BX.Landing.Loc.getMessage("SEARCH_FIELD_PLACEHOLDER"),title:this.searchLabel,skipPasteControl:true});i.input.type="text";i.input.min=null;i.input.max=null;i.enableTextOnly();return i},showLoader:function(){t(this.imageList.children).forEach((function(i){e(i,"landing-ui-show")}));this.loader.show()},hideLoader:function(){this.loader.hide()},showBottomLoader:function(){this.bottomLoader.show()},hideBottomLoader:function(){this.bottomLoader.hide()},showLoadMore:function(){BX.Landing.Utils.Show(this.loadMore)},hideLoadMore:function(){BX.Landing.Utils.Hide(this.loadMore)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/card/unsplash_card.min.js?16992580212529";s:6:"source";s:43:"/bitrix/js/landing/ui/card/unsplash_card.js";s:3:"min";s:47:"/bitrix/js/landing/ui/card/unsplash_card.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/card/unsplash_card.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");var t=BX.Landing.Utils.getFileExtension;function e(t){return BX.util.add_url_param(t,{utm_source:"bitrix",utm_medium:"referral",utm_campaign:"api-credit"})}function i(t,i){return{image:t.urls.small,credit:{name:t.user.name,link:e(t.user.links.html)},dimensions:{width:t.width,height:t.height},onClick:i.onPictureChange.bind(i,t)}}function n(t,e){return t.map(function(t){return i(t,e)})}BX.Landing.UI.Card.Unsplash=function(t){BX.Landing.UI.Card.Library.apply(this,arguments);this.state="popular";this.page=1;this.query="";this.onSearchWithDebounce=BX.debounce(this.onSearchWithDebounce,1e3,this);this.showPopular()};BX.Landing.UI.Card.Unsplash.prototype={constructor:BX.Landing.UI.Card.Unsplash,__proto__:BX.Landing.UI.Card.Library.prototype,onLoadMore:function(){if(this.state==="popular"){this.appendPopular()}if(this.state==="search"){this.appendSearch()}},appendSearch:function(){this.state="search";this.page+=1;this.showBottomLoader();this.hideLoadMore();var t=BX.Landing.Client.Unsplash.getInstance();t.search(this.query,this.page).then(function(t){this.hideBottomLoader();this.showLoadMore();this.renderItems(n(t,this))}.bind(this))},appendPopular:function(){this.state="popular";this.page+=1;this.query="";var t=BX.Landing.Client.Unsplash.getInstance();var e=this;this.showBottomLoader();this.hideLoadMore();t.popular(this.page).then(function(t){e.hideBottomLoader();e.showLoadMore();e.renderItems(n(t,e))})},onSearchInput:function(t){var e=t.getValue();if(!!e&&e.length){this.state="search";this.query=e;this.page=1;this.showLoader();this.onSearchWithDebounce(e);this.hideEmptyResult();return}if(this.state!=="popular"){this.showPopular()}},onSearchWithDebounce:function(t){var e=BX.Landing.Client.Unsplash.getInstance();e.search(t).then(function(t){this.hideLoader();this.clearItems();if(t.length===0){this.hideLoadMore();this.showEmptyResult();return}this.renderItems(n(t,this))}.bind(this))},showPopular:function(){this.state="popular";this.page=1;this.query="";var t=BX.Landing.Client.Unsplash.getInstance();this.showLoader();this.hideEmptyResult();t.popular().then(function(t){this.hideLoader();this.clearItems();if(t.length===0){this.hideLoadMore();this.showEmptyResult();return}this.showLoadMore();this.renderItems(n(t,this))}.bind(this))},onPictureChange:function(e){BX.Landing.Client.Unsplash.getInstance().download(e).then(function(i){this.onChange({link:i,ext:t(i),name:e.id+"."+t(i)})}.bind(this))}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:67:"/bitrix/js/landing/ui/card/google_images_card.min.js?16992580213828";s:6:"source";s:48:"/bitrix/js/landing/ui/card/google_images_card.js";s:3:"min";s:52:"/bitrix/js/landing/ui/card/google_images_card.min.js";s:3:"map";s:52:"/bitrix/js/landing/ui/card/google_images_card.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");var t=BX.Landing.Utils.create;var i=BX.Landing.Utils.append;var e=BX.Landing.Utils.prepend;var n=BX.Landing.Utils.remove;var t=BX.Landing.Utils.create;function s(t,i){return{image:t.link,credit:{},dimensions:{width:t.image.width,height:t.image.height},onClick:i.onPictureChange.bind(i,t.link)}}function r(t,i){return t.map(function(t){return s(t,i)})}BX.Landing.UI.Card.Google=function(t){BX.Landing.UI.Card.Library.apply(this,arguments);this.page=1;this.query="";this.loader=new BX.Loader({target:this.body,offset:{top:"12%"}});this.client=BX.Landing.Client.Google.getInstance();this.onSearchWithDebounce=BX.debounce(this.onSearchWithDebounce,1e3,this);this.showPopular()};BX.Landing.UI.Card.Google.prototype={constructor:BX.Landing.UI.Card.Google,__proto__:BX.Landing.UI.Card.Library.prototype,onLoadMore:function(){this.appendSearch()},appendSearch:function(){this.page+=1;this.state="search";this.showBottomLoader();this.hideLoadMore();this.hideError();this.client.search(this.query,this.page).then(function(t){this.hideBottomLoader();this.showLoadMore();this.renderItems(r(t,this))}.bind(this)).catch(this.showError.bind(this))},showPopular:function(){this.hideError();this.showLoader();this.query="Nature";this.state="popular";this.onSearchWithDebounce("Nature");if(BX.Landing.Client.Google.allowKeyChange){this.showSettingsButton()}else{this.hideSettingsButton()}},showSettingsButton:function(){if(!this.settingsButton){this.settingsButton=BX.create("a",{props:{className:"ui-btn ui-btn-xs ui-btn-light-border ui-btn-icon-setting landing-google-settings-button"},html:BX.Landing.Loc.getMessage("LANDING_GOOGLE_IMAGES_CHANGE_KEY_BUTTON"),events:{click:this.onSettingsClick.bind(this)}});this.body.appendChild(this.settingsButton)}this.settingsButton.hidden=false},hideSettingsButton:function(){if(this.settingsButton){this.settingsButton.hidden=true}},onSettingsClick:function(t){t.preventDefault();if(BX.Landing.Client.Google.allowKeyChange){BX.Landing.UI.Panel.GoogleImagesSettings.getInstance().show().then(function(){this.showPopular();this.searchField.input.innerHTML=""}.bind(this))}},onSearchInput:function(t){this.hideError();var i=t.getValue();if(!!i&&i.length){this.query=i;this.page=1;this.state="search";this.showLoader();this.onSearchWithDebounce(i);return}if(this.state!=="popular"){this.showPopular()}},onSearchWithDebounce:function(t){this.hideError();this.client.search(t).then(function(t){this.hideLoader();this.clearItems();this.hideEmptyResult();if(t.length===0){this.showEmptyResult();this.hideLoadMore();return}this.renderItems(r(t,this));this.showLoadMore();if(BX.Landing.Client.Google.allowKeyChange){this.showSettingsButton()}else{this.hideSettingsButton()}}.bind(this)).catch(this.showError.bind(this))},onPictureChange:function(t){var i=BX.util.add_url_param("/bitrix/tools/landing/proxy.php",{sessid:BX.bitrix_sessid(),url:t});this.onChange({link:i,ext:BX.util.getExtension(t),name:BX.Landing.Utils.getFileName(t)})},createKeyError:function(){return t("div",{props:{className:"ui-alert ui-alert-warning"},children:[t("span",{props:{className:"ui-alert-message"},html:BX.Landing.Loc.getMessage("LANDING_IMAGES_PANEL_KEY_ERROR")})]})},createError:function(){return t("div",{props:{className:"ui-alert ui-alert-danger"},children:[t("span",{props:{className:"ui-alert-message"},html:BX.Landing.Loc.getMessage("LANDING_IMAGES_PANEL_GOOGLE_ERROR")})]})},hideError:function(){BX.Landing.UI.Card.Library.prototype.hideError.call(this);if(this.error){n(this.error)}},showError:function(){if(!BX.Landing.Client.Google.key){this.error=this.createKeyError()}else{this.error=this.createError()}BX.insertAfter(this.error,this.imageList);BX.Landing.UI.Card.Library.prototype.showError.call(this)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/landing/ui/card/uploader_card.js?1699258021800";s:6:"source";s:43:"/bitrix/js/landing/ui/card/uploader_card.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Card");


	/**
	 * Implements interface for works with uploader
	 *
	 * @extends {BX.Landing.UI.Card.Library}
	 *
	 * @param {object} data
	 *
	 * @constructor
	 */
	BX.Landing.UI.Card.Uploader = function(data)
	{
		BX.Landing.UI.Card.Library.apply(this, arguments);
		this.layout.classList.add("landing-ui-card-library-uploader");
		this.iframe = BX.create("iframe", {props: {className: "landing-ui-card-library-uploader-iframe"}});
		this.iframe.src = "/bitrix/tools/landing/uploader.php";
		this.imageList.appendChild(this.iframe);
		BX.remove(this.search);
		BX.remove(this.loadMore);
	};

	BX.Landing.UI.Card.Uploader.prototype = {
		constructor: BX.Landing.UI.Card.Uploader,
		__proto__: BX.Landing.UI.Card.Library.prototype
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:54:"/bitrix/js/landing/ui/card/loader.min.js?1699258021617";s:6:"source";s:36:"/bitrix/js/landing/ui/card/loader.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");BX.Landing.UI.Card.Loader=function(){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.layout.classList.add("landing-ui-loader");this.inner=BX.create("div",{props:{className:"landing-ui-loader-inner"},html:'<svg class="main-grid-loader-circular" viewBox="25 25 50 50">\n'+'    <circle class="main-grid-loader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>\n'+"</svg>"});this.body.appendChild(this.inner)};BX.Landing.UI.Card.Loader.prototype={constructor:BX.Landing.UI.Card.Loader,__proto__:BX.Landing.UI.Card.BaseCard.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:53:"/bitrix/js/landing/ui/card/link_card.js?1699258021771";s:6:"source";s:39:"/bitrix/js/landing/ui/card/link_card.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Card");


	/**
	 * @extends {BX.Landing.UI.Card.BaseCard}
	 * @param {object} data
	 * @constructor
	 */
	BX.Landing.UI.Card.Link = function(data)
	{
		BX.Landing.UI.Card.BaseCard.apply(this, arguments);
		this.layout.classList.add("landing-ui-card-link");

		if (!!data && typeof data === "object" && "child" in data && data.child)
		{
			this.layout.classList.add("landing-ui-card-link-child");
		}

		this.body.appendChild((new BX.Landing.UI.Button.BaseButton(data.button.id.toString(), {
			text: data.button.text,
			onClick: data.button.onChange
		})).layout);
	};

	BX.Landing.UI.Card.Link.prototype = {
		constructor: BX.Landing.UI.Card.Link,
		__proto__: BX.Landing.UI.Card.BaseCard.prototype
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/card/landing_preview.min.js?1699258021805";s:6:"source";s:45:"/bitrix/js/landing/ui/card/landing_preview.js";s:3:"min";s:49:"/bitrix/js/landing/ui/card/landing_preview.min.js";s:3:"map";s:49:"/bitrix/js/landing/ui/card/landing_preview.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");BX.Landing.UI.Card.LandingPreviewCard=function(i){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.layout.classList.add("landing-ui-card-landing-preview");this.onClickHandler=typeof i.onClick==="function"?i.onClick:function(){};if(!!i.preview&&typeof i.preview==="string"){this.body.style.backgroundImage="url("+i.preview+")"}else{this.body.hidden=true}if(!!i.description&&typeof i.description==="string"){this.footer=BX.create("div",{props:{className:"landing-ui-card-footer"},text:i.description})}};BX.Landing.UI.Card.LandingPreviewCard.prototype={constructor:BX.Landing.UI.Card.LandingPreviewCard,__proto__:BX.Landing.UI.Card.BaseCard.prototype,onClick:function(){this.onClickHandler()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/card/block_html_preview.js?1699258021990";s:6:"source";s:48:"/bitrix/js/landing/ui/card/block_html_preview.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Card");


	/**
	 * Implements interface of block html preview
	 * @extends {BX.Landing.UI.Card.BaseCard}
	 * @param {object} data
	 * @constructor
	 */
	BX.Landing.UI.Card.BlockHTMLPreview = function(data)
	{
		BX.Landing.UI.Card.BaseCard.apply(this, arguments);
		this.layout.classList.add("landing-ui-card-block-html-preview");
		this.onClickHandler = typeof data.onClick === "function" ? data.onClick : (function() {});
		this.block = BX.clone(document.querySelector("#block"+data.content+".block-wrapper"));

		[].slice.call(this.block.querySelectorAll(".landing-ui-panel")).forEach(BX.remove);

		this.body.appendChild(this.block);
		this.layout.addEventListener("click", this.onClick.bind(this));
	};


	BX.Landing.UI.Card.BlockHTMLPreview.prototype = {
		constructor: BX.Landing.UI.Card.BlockHTMLPreview,
		__proto__: BX.Landing.UI.Card.BaseCard.prototype,

		onClick: function()
		{
			this.onClickHandler();
		}
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/landing/ui/card/tab_card.min.js?16992580212439";s:6:"source";s:38:"/bitrix/js/landing/ui/card/tab_card.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");var a=BX.Landing.Utils.addClass;var i=BX.Landing.Utils.removeClass;var t=BX.Landing.Utils.hasClass;var n=BX.Landing.Utils.append;var e=BX.Landing.Utils.create;var r=BX.Landing.Utils.data;var s=BX.Landing.Utils.slice;var d=BX.Landing.Utils.Show;var c=BX.Landing.Utils.Hide;var h=BX.Landing.Collection.BaseCollection;BX.Landing.UI.Card.TabCard=function(i){BX.Landing.UI.Card.BaseCard.apply(this,arguments);a(this.layout,"landing-ui-card-tabs");this.fields=new h;this.tabs=[];this.headersArea=e("div",{props:{className:"landing-ui-card-tabs-headers"}});this.tabsArea=e("div",{props:{className:"landing-ui-card-tabs-tabs"}});n(this.headersArea,this.layout);n(this.tabsArea,this.layout);i.tabs.forEach(this.addTab,this);this.render();var t=i.tabs.find(function(a){return a.active===true});if(!t){t=i.tabs[0]}this.activateTab(t.id)};BX.Landing.UI.Card.TabCard.prototype={constructor:BX.Landing.UI.Card.TabCard,__proto__:BX.Landing.UI.Card.BaseCard.prototype,addTab:function(a){this.tabs.push({id:a.id,name:a.name,fields:a.fields.map(function(a){return a.layout})});a.fields.forEach(function(a){this.fields.push(a)},this)},render:function(){this.headersArea.innerHTML="";this.tabsArea.innerHTML="";this.tabs.forEach(function(a,i){n(this.createHeader({id:a.id,name:a.name}),this.headersArea);n(this.createTab({id:a.id,fields:a.fields}),this.tabsArea)},this)},createHeader:function(a){return e("div",{props:{className:"landing-ui-card-tabs-headers-item"},text:a.name,attrs:{"data-id":a.id},events:{click:this.onHeaderClick.bind(this)}})},onHeaderClick:function(a){a.preventDefault();if(!this.isActive(a.currentTarget)){this.activateTab(r(a.currentTarget,"data-id"))}},isActive:function(a){return t(a,"landing-ui-active")},activateTab:function(t){s(this.headersArea.children).forEach(function(a){i(a,"landing-ui-active")});s(this.tabsArea.children).forEach(function(a){i(a,"landing-ui-active");c(a)});var n=this.getHeader(t);var e=this.getTab(t);if(n){a(n,"landing-ui-active")}if(e){d(e).then(function(){a(e,"landing-ui-active")})}},createTab:function(a){return e("div",{props:{className:"landing-ui-card-tabs-tabs-item landing-ui-hide"},children:a.fields,attrs:{"data-id":a.id}})},getHeader:function(a){return s(this.headersArea.children).find(function(i){return r(i,"data-id")===a})},getTab:function(a){return s(this.tabsArea.children).find(function(i){return r(i,"data-id")===a})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:68:"/bitrix/js/landing/ui/card/dynamic_fields_group.min.js?1699258021633";s:6:"source";s:50:"/bitrix/js/landing/ui/card/dynamic_fields_group.js";s:3:"min";s:54:"/bitrix/js/landing/ui/card/dynamic_fields_group.min.js";s:3:"map";s:54:"/bitrix/js/landing/ui/card/dynamic_fields_group.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");BX.Landing.UI.Card.DynamicFieldsGroup=function(a){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.layout.classList.add("landing-ui-card-dynamic-fields-group");this.fields=new BX.Landing.Collection.BaseCollection;a.items.forEach(function(a){var i=BX.Landing.UI.Card.FieldGroup.createItem();i.appendChild(a.layout);this.body.appendChild(i);this.fields.add(a)},this)};BX.Landing.UI.Card.DynamicFieldsGroup.prototype={constructor:BX.Landing.UI.Card.DynamicFieldsGroup,__proto__:BX.Landing.UI.Card.BaseCard.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/card/add_page_card.min.js?16992580212627";s:6:"source";s:43:"/bitrix/js/landing/ui/card/add_page_card.js";s:3:"min";s:47:"/bitrix/js/landing/ui/card/add_page_card.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/card/add_page_card.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Card");BX.Landing.UI.Card.AddPageCard=function(e){BX.Landing.UI.Card.BaseCard.apply(this,arguments);this.layout.classList.add("landing-ui-card-add-page");this.cache=new BX.Cache.MemoryCache;this.onSaveHandler=e.onSave||function(){};this.siteId=e.siteId;var t=BX.create("span",{props:{className:"landing-ui-card-add-page-icon"}});var a=BX.create("span",{props:{className:"landing-ui-card-add-page-text"},text:BX.Landing.Loc.getMessage("LANDING_LINK_PLACEHOLDER_NEW_PAGE")});var n=BX.create("div",{props:{className:"landing-ui-card-add-page-inner"},children:[t,a]});this.body.appendChild(n);BX.bind(this.layout,"click",this.onLayoutClick.bind(this))};BX.Landing.UI.Card.AddPageCard.prototype={constructor:BX.Landing.UI.Card.AddPageCard,__proto__:BX.Landing.UI.Card.BaseCard.prototype,onLayoutClick:function(e){e.preventDefault();BX.replace(this.layout,this.getFormLayout());var t=this.getTitleField();t.setValue("");setTimeout(function(){t.enableEdit();t.input.focus()})},getFormLayout:function(){return this.cache.remember("formLayout",function(){var e=BX.create("span",{props:{className:"ui-btn ui-btn-primary ui-btn-sm"},text:BX.Landing.Loc.getMessage("LANDING_LINK_NEW_PAGE_SAVE_BUTTON_LABEL"),events:{click:this.onSaveClick.bind(this)}});var t=BX.create("span",{props:{className:"ui-btn ui-btn-link ui-btn-sm"},text:BX.Landing.Loc.getMessage("LANDING_LINK_NEW_PAGE_CANCEL_BUTTON_LABEL"),events:{click:this.onCancelClick.bind(this)}});var a=BX.create("div",{props:{className:"landing-ui-card-add-page-form-buttons"},children:[e,t]});return BX.create("div",{props:{className:"landing-ui-card-add-page-form"},children:[this.getForm().layout,a]})}.bind(this))},onSaveClick:function(e){e.preventDefault();var t=BX.Landing.Backend.getInstance();var a=this.getTitleField().getValue();var n=BX.translit(a,{change_case:"L",replace_space:"-",replace_other:""});void t.createPage({title:a,code:n,siteId:this.siteId}).then(function(e){this.onSaveHandler(e);BX.replace(this.getFormLayout(),this.layout)}.bind(this))},onCancelClick:function(e){e.preventDefault();BX.replace(this.getFormLayout(),this.layout)},getTitleField:function(){return this.cache.remember("titleField",function(){return new BX.Landing.UI.Field.Text({title:BX.Landing.Loc.getMessage("LANDING_CREATE_PAGE_PANEL_FIELD_PAGE_TITLE"),textOnly:true})})},getForm:function(){return this.cache.remember("form",function(){return new BX.Landing.UI.Form.BaseForm({title:BX.Landing.Loc.getMessage("LANDING_LINK_PLACEHOLDER_NEW_PAGE"),fields:[this.getTitleField()]})}.bind(this))}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/tool/color_picker.min.js?16992580213735";s:6:"source";s:42:"/bitrix/js/landing/ui/tool/color_picker.js";s:3:"min";s:46:"/bitrix/js/landing/ui/tool/color_picker.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/tool/color_picker.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Tool");BX.Landing.UI.Tool.ColorPicker=function(e,t){this.picker=new BX.ColorPicker({bindElement:e.layout,popupOptions:BX.Landing.UI.Tool.ColorPicker.getDefaultPopupOptions(e),onColorSelected:BX.delegate(this.onColorSelected,this),colors:BX.Landing.UI.Tool.ColorPicker.getDefaultColors()});this.button=e;this.onChangeHandler=t;this.pickerWindow=this.picker.getPopupWindow();this.contextDocument=document;this.range=this.contextDocument.createRange();BX.Landing.UI.Tool.ColorPicker.activePickers.add(this)};BX.Landing.UI.Tool.ColorPicker.getDefaultPopupOptions=function(e){return{angle:false,position:{top:0,left:0},zIndex:-678,overlay:{backgroundColor:"#ffffff",opacity:10}}};BX.Landing.UI.Tool.ColorPicker.activePickers=new BX.Landing.Collection.BaseCollection;BX.Landing.UI.Tool.ColorPicker.hideAll=function(){BX.Landing.UI.Tool.ColorPicker.activePickers.forEach((function(e){e.hide()}))};BX.Landing.UI.Tool.ColorPicker.getDefaultColors=function(){return[["#f5f5f5","#eeeeee","#e0e0e0","#9e9e9e","#757575","#616161","#212121"],["#cfd8dc","#b0bec5","#90a4ae","#607d8b","#546e7a","#455a64","#263238"],["#d7ccc8","#bcaaa4","#a1887f","#795548","#6d4c41","#5d4037","#3e2723"],["#ffccbc","#ffab91","#ff8a65","#ff5722","#f4511e","#e64a19","#bf360c"],["#ffe0b2","#ffcc80","#ffb74d","#ff9800","#fb8c00","#f57c00","#e65100"],["#ffecb3","#ffe082","#ffd54f","#ffc107","#ffb300","#ffa000","#ff6f00"],["#fff9c4","#fff59d","#fff176","#ffeb3b","#fdd835","#fbc02d","#f57f17"],["#f0f4c3","#e6ee9c","#dce775","#cddc39","#c0ca33","#afb42b","#827717"],["#dcedc8","#c5e1a5","#aed581","#8bc34a","#7cb342","#689f38","#33691e"],["#c8e6c9","#a5d6a7","#81c784","#4caf50","#43a047","#388e3c","#1b5e20"],["#b2dfdb","#80cbc4","#4db6ac","#009688","#00897b","#00796b","#004d40"],["#b2ebf2","#80deea","#4dd0e1","#00bcd4","#00acc1","#0097a7","#006064"],["#b3e5fc","#81d4fa","#4fc3f7","#03a9f4","#039be5","#0288d1","#01579b"],["#bbdefb","#90caf9","#64b5f6","#2196f3","#1e88e5","#1976d2","#0d47a1"],["#c5cae9","#9fa8da","#7986cb","#3f51b5","#3949ab","#303f9f","#1a237e"],["#d1c4e9","#b39ddb","#9575cd","#673ab7","#5e35b1","#512da8","#311b92"],["#e1bee7","#ce93d8","#ba68c8","#9c27b0","#8e24aa","#7b1fa2","#4a148c"],["#f8bbd0","#f48fb1","#f06292","#e91e63","#d81b60","#c2185b","#880e4f"],["#ffcdd2","#ef9a9a","#e57373","#f44336","#e53935","#d32f2f","#b71c1c"]].map((function(e,t,o){return o.map((function(e){return e[t]}))}))};BX.Landing.UI.Tool.ColorPicker.prototype={adjustPosition:function(e){BX.DOM.read(function(){var t=this.pickerWindow.popupContainer.getBoundingClientRect();var o=this.button.layout.parentNode.getBoundingClientRect();var n=Math.abs(t.width-o.width);var i={};i["left"]=o.left+n/2+"px";i["position"]="fixed";if(e==="fixed"){var c=this.button.layout.getBoundingClientRect();i["top"]=c.bottom+"px"}else{var f=BX.pos(this.button.layout);i["top"]=f.bottom+"px"}if(BX.Landing.Main.getInstance().isControlsExternal()){i["left"]="3px";i["height"]="210px"}BX.DOM.write(function(){for(var e in i){this.pickerWindow.popupContainer.style[e]=i[e]}}.bind(this))}.bind(this))},show:function(e){this.picker.open();this.adjustPosition(e);this.range=this.contextDocument.getSelection().getRangeAt(0)},hide:function(){this.picker.close()},isShown:function(){return this.pickerWindow.isShown()},onColorSelected:function(e,t){this.contextDocument.getSelection().removeAllRanges();this.contextDocument.getSelection().addRange(this.range);if(BX.type.isFunction(this.onChangeHandler)){this.onChangeHandler(e,t)}},setContextDocument:function(e){if(e.nodeType===Node.DOCUMENT_NODE){this.contextDocument=e;if(!this.isShown()){this.range=this.contextDocument.createRange()}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/tool/auto-font-scale.min.js?16992580211240";s:6:"source";s:45:"/bitrix/js/landing/ui/tool/auto-font-scale.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Tool");var t=BX.Landing.Utils.bind;var n=BX.Landing.Utils.slice;var i=BX.Landing.Utils.onCustomEvent;var e=BX.width(window);function o(){return BX.width(window)<1100}function s(){var t=e!==BX.width(window);e=BX.width(window);return t}BX.Landing.UI.Tool.autoFontScale=function(n){this.entries=n.map(this.createEntry,this);t(window,"resize",this.onResize.bind(this,false));t(window,"orientationchange",this.onResize.bind(this,true));i("BX.Landing.Block:init",this.onAddBlock.bind(this));this.adjust(true)};BX.Landing.UI.Tool.autoFontScale.prototype={onResize:function(t){this.adjust(t);clearTimeout(this.falbackTimeoutId);this.falbackTimeoutId=setTimeout(function(){this.adjust(true)}.bind(this),250)},adjust:function(t){if(t===true||s()){var n=o();this.entries.forEach(function(t){if(n){t.adjust()}else{t.resetSize()}})}},createEntry:function(t){return new BX.Landing.UI.Tool.autoFontScaleEntry(t)},addElements:function(t){t.forEach(function(t){var n=this.entries.some(function(n){return n.element===t});if(!n){this.entries.push(this.createEntry(t))}},this)},onAddBlock:function(t){var i=n(t.block.querySelectorAll("h1, h2, h3, h4, h5, [data-auto-font-scale]"));this.addElements(i)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:70:"/bitrix/js/landing/ui/tool/auto-font-scale-entry.min.js?16992580212175";s:6:"source";s:51:"/bitrix/js/landing/ui/tool/auto-font-scale-entry.js";s:3:"min";s:55:"/bitrix/js/landing/ui/tool/auto-font-scale-entry.min.js";s:3:"map";s:55:"/bitrix/js/landing/ui/tool/auto-font-scale-entry.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Tool");var t=BX.Landing.Utils.createRangeFromNode;var e=BX.Landing.Utils.isNumber;var i=BX.Landing.Utils.rect;BX.Landing.UI.Tool.autoFontScaleEntry=function(t){this.element=t;this.minSize=8;this.maxSize=parseInt(BX.style(t,"font-size"));this.maxLetterSpacing=parseFloat(BX.style(t,"letter-spacing"));this.maxLetterSpacing=e(this.maxLetterSpacing)?this.maxLetterSpacing:0;this.minLetterSpacing=0;this.paddings=30;this.changed=false};BX.Landing.UI.Tool.autoFontScaleEntry.prototype={setFontSize:function(t){t=Math.min(Math.max(t,this.minSize),this.maxSize);this.element.style.setProperty("font-size",t+"px","important")},setLetterSpacing:function(t){t=Math.min(Math.max(t,this.minLetterSpacing),this.maxLetterSpacing);this.element.style.setProperty("letterSpacing",t+"px")},resetSize:function(){this.element.style.setProperty("fontSize",null);this.element.style.setProperty("letterSpacing",null);this.element.style.setProperty("display",null)},adjust:function(){if(this.changed||this.getRangeWidth()>this.getParentWidth()){this.changed=true;var t=this.getParentWidth()*this.getFontSizeRatio();var e=this.getParentWidth()*this.getLetterSpacingRatio();this.setFontSize(t-e);this.setLetterSpacing(e)}if(!this.changed&&this.maxSize>40&&BX.width(window)<=600){this.setFontSize(this.getParentWidth()*this.getBaseFontSizeRatio())}},getCurrentSize:function(){return parseInt(BX.style(this.element,"font-size"))},getFontSizeRatio:function(){if(e(this.ratio)){return this.ratio}this.ratio=this.maxSize/this.getRangeWidth();return this.ratio},getLetterSpacingRatio:function(){if(e(this.letterSpacingRatio)){return this.letterSpacingRatio}this.letterSpacingRatio=this.maxLetterSpacing/this.getRangeWidth();return this.letterSpacingRatio},getBaseFontSizeRatio:function(){if(e(this.baseFontSizeRatio)){return this.baseFontSizeRatio}this.baseFontSizeRatio=this.getCurrentSize()/(600-this.paddings);return this.baseFontSizeRatio},getRangeWidth:function(){return i(t(this.element)).width},getParentWidth:function(){return Math.min(i(this.element).width,BX.width(window)-this.paddings)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/landing/ui/tool/suggests.min.js?16992580211716";s:6:"source";s:38:"/bitrix/js/landing/ui/tool/suggests.js";s:3:"min";s:42:"/bitrix/js/landing/ui/tool/suggests.min.js";s:3:"map";s:42:"/bitrix/js/landing/ui/tool/suggests.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Tool");var t=BX.Landing.Utils.isEmpty;var n=BX.Landing.Utils.isNumber;var i=BX.Landing.Utils.bind;var e=BX.Landing.Utils.unbind;var s=BX.Landing.Utils.proxy;var o=BX.Landing.Utils.create;BX.Landing.UI.Tool.Suggest=function(){this.lastElement=null;this.popup=null;this.popupTimeout=0;i(document,"mousedown",s(this.hide,this))};BX.Landing.UI.Tool.Suggest.instance=null;BX.Landing.UI.Tool.Suggest.getInstance=function(){return BX.Landing.UI.Tool.Suggest.instance||(BX.Landing.UI.Tool.Suggest.instance=new BX.Landing.UI.Tool.Suggest)};BX.Landing.UI.Tool.Suggest.prototype={createContent:function(n){var i=[];if(!t(n.name)){i.push(o("div",{props:{className:"landing-ui-field-link-media-help-popup-content-title"},html:n.name||n.title}))}if(!t(n.description)){i.push(o("div",{props:{className:"landing-ui-field-link-media-help-popup-content-content"},html:n.description}))}return o("div",{props:{className:"landing-ui-field-link-media-help-popup-content"},children:i})},show:function(t,e){if(this.popup===null){this.popup=new BX.Main.Popup({id:"landing_suggests_popup",autoHide:false,offsetLeft:-20,offsetTop:11,angle:{offset:74}})}if(!n(e.angleOffset)){e.angleOffset=74}this.popup.setBindElement(t);this.popup.setContent(this.createContent(e));this.lastElement=t;this.popupTimeout=o.apply(this);function o(){return setTimeout(function(){i(t,"mouseleave",s(this.hide,this));this.popup.show();this.popup.setAngle({offset:e.angleOffset,position:"top"})}.bind(this),200)}},hide:function(){if(this.popup&&this.popup.isShown()){e(this.lastElement,"mouseleave",s(this.hide,this));clearTimeout(this.popupTimeout);this.popup.close()}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/tool/font-manager.min.js?16992580212719";s:6:"source";s:42:"/bitrix/js/landing/ui/tool/font-manager.js";s:3:"min";s:46:"/bitrix/js/landing/ui/tool/font-manager.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/tool/font-manager.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Tool");var n=BX.Landing.Utils.slice;var t=BX.Landing.Utils.arrayUnique;var e=BX.Landing.Utils.data;var a=BX.Landing.Utils.isString;var o=BX.Landing.Utils.create;var r=BX.Landing.Utils.append;var i=BX.Landing.Utils.remove;BX.Landing.UI.Tool.FontManager=function(){};BX.Landing.UI.Tool.FontManager.getInstance=function(){return BX.Landing.UI.Tool.FontManager.instance||(BX.Landing.UI.Tool.FontManager.instance=new BX.Landing.UI.Tool.FontManager)};function s(n){return"g-font-"+n.toLowerCase().trim().replace(/ /g,"-")}function d(n,t){n=n.replaceAll("+"," ");var e={serif:'"#font#", serif',"sans-serif":'"#font#", sans-serif',display:'"#font#", cursive',handwriting:'"#font#", cursive',monospace:'"#font#", monospace'};return e[t]?e[t].replace("#font#",n):'"'+n+'"'}BX.Landing.UI.Tool.FontManager.prototype={getLoadedFonts:function(){var t=n(document.head.querySelectorAll('[data-font*="g-font-"]'));return t.map((function(n){return{className:e(n,"data-font"),element:n,CSSDeclaration:document.head.querySelector('[data-id*="'+e(n,"data-font")+'"]'),protected:e(n,"data-protected")||false}}))},getUsedLoadedFonts:function(){var n=[];var t=this.getLoadedFonts().filter((function(n){return!n.protected}));if(t.length){var e=this.getAllUsedFonts();t.forEach((function(t){var a=e.some((function(n){return t.className===n}));if(a){n.push(t)}}))}return n},getAllUsedFonts:function(e){e=e||document.body;var o=n(e.querySelectorAll("*:not(img)"));var r=[];o.forEach((function(n){var t=BX.style(n,"font-family");if(a(t)){t=t.replace(/['|"]/g,"");r.push(s(t.split(",")[0]))}}));return t(r)},isLoaded:function(n){return this.getLoadedFonts().some((function(t){return t.className===n}))},addFont:function(n,t){var e=!!t?t.document:document;return new Promise(function(t){if(!this.isLoaded(n.className)){let s=n.href;if(window.fontsProxyUrl){const n=new URL(s);n.host=window.fontsProxyUrl;s=n.href}var a=o("link",{attrs:{rel:"stylesheet",href:s,"data-font":n.className,media:"async@load"},events:{load:function(){this.media="all";t()},error:function(){t()}}});var i=o("style",{attrs:{"data-id":n.className},text:"."+n.className+" { font-family: "+d(n.family,n.category)+"; }"});r(a,e.head);r(i,e.head)}else{t()}}.bind(this))},getUnusedLoadedFonts:function(){var n=[];var t=this.getLoadedFonts().filter((function(n){return!n.protected}));if(t.length){var e=this.getAllUsedFonts();t.forEach((function(t){var a=e.some((function(n){return t.className===n}));if(!a){n.push(t)}}))}return n},removeUnusedFonts:function(){this.getUnusedLoadedFonts().forEach((function(n){if(n.element){i(n.element)}if(n.CSSDeclaration){i(n.CSSDeclaration)}}))}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/adapter/css-property.min.js?1699258022408";s:6:"source";s:45:"/bitrix/js/landing/ui/adapter/css-property.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Adapter");BX.Landing.UI.Adapter.CSSProperty=function(){};function r(){return BX.browser.IsFirefox()}BX.Landing.UI.Adapter.CSSProperty.get=function(n){if(r()&&n in BX.Landing.UI.Adapter.CSSProperty.map){n=BX.Landing.UI.Adapter.CSSProperty.map[n]}return n};BX.Landing.UI.Adapter.CSSProperty.map={"border-color":r()?"border-bottom-color":"border-color"}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/landing/ui/button/plus_button.js?1699258022662";s:6:"source";s:43:"/bitrix/js/landing/ui/button/plus_button.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Button");


	/**
	 * Implements concrete interface of plus button
	 *
	 * @extends {BX.Landing.UI.Button.BaseButton}
	 *
	 * @param {?string} id
	 * @param {?object} [options]
	 * @constructor
	 */
	BX.Landing.UI.Button.Plus = function(id, options)
	{
		BX.Landing.UI.Button.BaseButton.apply(this, arguments);
		this.buttonClass = "landing-ui-button-plus";
		this.init();
	};


	BX.Landing.UI.Button.Plus.prototype = {
		constructor: BX.Landing.UI.Button.Plus,
		__proto__: BX.Landing.UI.Button.BaseButton.prototype,

		init: function()
		{
			this.layout.classList.add(this.buttonClass);
		}
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:70:"/bitrix/js/landing/ui/button/editor_action_button.min.js?1699258022760";s:6:"source";s:52:"/bitrix/js/landing/ui/button/editor_action_button.js";s:3:"min";s:56:"/bitrix/js/landing/ui/button/editor_action_button.min.js";s:3:"map";s:56:"/bitrix/js/landing/ui/button/editor_action_button.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.EditorAction=function(t,n){BX.Landing.UI.Button.BaseButton.apply(this,arguments);this.layout.classList.add("landing-ui-button-editor-action");this.init()};BX.Landing.UI.Button.EditorAction.prototype={constructor:BX.Landing.UI.Button.EditorAction,__proto__:BX.Landing.UI.Button.BaseButton.prototype,init:function(){this.on("click",this.onClick,this);this.contextDocument=document},onClick:function(t){t.preventDefault();t.stopPropagation();const n=this.contextDocument.execCommand(this.id);BX.Landing.UI.Tool.ColorPicker.hideAll()},setContextDocument:function(t){if(t.nodeType===Node.DOCUMENT_NODE){this.contextDocument=t}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/button/ai_text_button.min.js?1699258022342";s:6:"source";s:46:"/bitrix/js/landing/ui/button/ai_text_button.js";s:3:"min";s:50:"/bitrix/js/landing/ui/button/ai_text_button.min.js";s:3:"map";s:50:"/bitrix/js/landing/ui/button/ai_text_button.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.AiText=function(t,n){BX.Landing.UI.Button.EditorAction.apply(this,arguments)};BX.Landing.UI.Button.AiText.prototype={constructor:BX.Landing.UI.Button.AiText,__proto__:BX.Landing.UI.Button.EditorAction.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/button/design_button.min.js?1699258022299";s:6:"source";s:45:"/bitrix/js/landing/ui/button/design_button.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.Design=function(n,t){BX.Landing.UI.Button.EditorAction.apply(this,arguments)};BX.Landing.UI.Button.Design.prototype={constructor:BX.Landing.UI.Button.Design,__proto__:BX.Landing.UI.Button.EditorAction.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/button/color_button.min.js?16992580222396";s:6:"source";s:44:"/bitrix/js/landing/ui/button/color_button.js";s:3:"min";s:48:"/bitrix/js/landing/ui/button/color_button.min.js";s:3:"map";s:48:"/bitrix/js/landing/ui/button/color_button.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.ColorAction=function(t,o){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.id=t;this.options=o;if(this.id!=="tableBgColor"){this.layout.classList.add("landing-ui-button-editor-action-color")}const n=BX.Landing.UI.Panel.EditorPanel.getInstance().isOutOfFrame()?window.parent:window;this.colorPicker=new n.BX.Landing.UI.Tool.ColorPicker(this,this.onColorSelected.bind(this));BX.Landing.UI.Button.ColorAction.instances.push(this)};BX.Landing.UI.Button.ColorAction.instances=[];BX.Landing.UI.Button.ColorAction.hideAll=function(){BX.Landing.UI.Button.ColorAction.instances.forEach((function(t){t.colorPicker.hide()}))};BX.Landing.UI.Button.ColorAction.prototype={constructor:BX.Landing.UI.Button.ColorAction,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();var o=BX.Landing.UI.Panel.EditorPanel.getInstance().isFixed()?"fixed":"relative";if(!this.colorPicker.isShown()){this.colorPicker.show(o);if(BX.Landing.UI.Button.ChangeTag.menu){BX.Landing.UI.Button.ChangeTag.menu.close()}}else{this.colorPicker.hide()}},onColorSelected:function(t){if(this.id==="tableTextColor"){this.applyColorInTableCells(t)}if(this.id==="tableBgColor"){this.applyBgInTableCells(t)}this.contextDocument.execCommand(this.id,false,t)},applyColorInTableCells:function(t){var o=Array.from(this.options.setTd);o.forEach((function(o){if(o.nodeType===1){o.style.color=t}}));if(this.options.target==="table"){this.options.table.setAttribute("text-color",t)}BX.Landing.Block.Node.Text.currentNode.onChange(true)},prepareOptionsForApplyColorInTableCells:function(t,o){this.options=o;this.applyColorInTableCells(t)},applyBgInTableCells:function(t){var o=Array.from(this.options.setTd);o.forEach((function(o){if(o.nodeType===1){if(!o.classList.contains("landing-table-col-dnd")&&!o.classList.contains("landing-table-row-dnd")&&!o.classList.contains("landing-table-th-select-all")){o.style.setProperty("background-color",t,"important")}}}));if(this.options.target==="table"){this.options.table.setAttribute("bg-color",t)}BX.Landing.Block.Node.Text.currentNode.onChange(true)},setContextDocument:function(t){BX.Landing.UI.Button.EditorAction.prototype.setContextDocument.apply(this,arguments);this.colorPicker.setContextDocument(t)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:67:"/bitrix/js/landing/ui/button/block_card_action.min.js?1699258022418";s:6:"source";s:49:"/bitrix/js/landing/ui/button/block_card_action.js";s:3:"min";s:53:"/bitrix/js/landing/ui/button/block_card_action.min.js";s:3:"map";s:53:"/bitrix/js/landing/ui/button/block_card_action.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.CardAction=function(t,n){BX.Landing.UI.Button.ActionButton.apply(this,arguments);this.layout.classList.add("landing-ui-button-card-action")};BX.Landing.UI.Button.CardAction.prototype={constructor:BX.Landing.UI.Button.ActionButton,__proto__:BX.Landing.UI.Button.ActionButton.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/button/create_link.min.js?1699258022733";s:6:"source";s:43:"/bitrix/js/landing/ui/button/create_link.js";s:3:"min";s:47:"/bitrix/js/landing/ui/button/create_link.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/button/create_link.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.CreateLink=function(t,n){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null};BX.Landing.UI.Button.CreateLink.prototype={constructor:BX.Landing.UI.Button.CreateLink,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();this.textNode=BX.Landing.Block.Node.Text.currentNode;this.textField=BX.Landing.UI.Field.BaseField.currentField;if(!!this.textField&&this.textField.isEditable()){this.textNode=this.textField}const n=BX.Landing.UI.Panel.Link.getInstance();n.setContextDocument(this.contextDocument);n.show(this.textNode)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/button/create_table.min.js?16992580223459";s:6:"source";s:44:"/bitrix/js/landing/ui/button/create_table.js";s:3:"min";s:48:"/bitrix/js/landing/ui/button/create_table.min.js";s:3:"map";s:48:"/bitrix/js/landing/ui/button/create_table.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.CreateTable=function(t,e){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null;this.options=e;this.id=t};BX.Landing.UI.Button.CreateTable.prototype={constructor:BX.Landing.UI.Button.CreateTable,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();var e="rgb(51, 51, 51)";var n="#333333";var a=this.contextDocument.createElement("div");a.classList.add("landing-table-container");var d=this.contextDocument.createElement("table");d.classList.add("landing-table","landing-table-style-1");d.setAttribute("text-color",n);var l=this.contextDocument.createElement("tr");l.classList.add("landing-table-tr");var i=this.contextDocument.createElement("tr");i.classList.add("landing-table-tr");var o=this.contextDocument.createElement("th");o.classList.add("landing-table-th","landing-table-row-dnd");var r=this.contextDocument.createElement("div");r.classList.add("landing-table-row-add");var c=this.contextDocument.createElement("div");c.classList.add("landing-table-row-add-line");var s=this.contextDocument.createElement("div");s.classList.add("landing-table-div-row-dnd");r.appendChild(c);var h=this.contextDocument.createElement("td");h.classList.add("landing-table-th","landing-table-td");var u=this.getCellWidth();h.style.width=u+"px";h.style.color=e;var v=this.contextDocument.createElement("th");v.classList.add("landing-table-th","landing-table-col-dnd");v.style.width=u+"px";var p=this.contextDocument.createElement("div");p.classList.add("landing-table-div-col-dnd");var m=this.contextDocument.createElement("div");m.classList.add("landing-table-col-resize");var g=this.contextDocument.createElement("div");g.classList.add("landing-table-col-add");var b=this.contextDocument.createElement("div");b.classList.add("landing-table-col-add-line");g.appendChild(b);var C=this.contextDocument.createElement("th");C.classList.add("landing-table-th","landing-table-th-select-all");C.style.width="16px";var x=this.contextDocument.createElement("div");x.classList.add("th-tech-icon");l.appendChild(C.cloneNode(true));for(var L=0;L<=3;L++){l.appendChild(v.cloneNode(true))}i.appendChild(o.cloneNode(true));for(var L=0;L<=3;L++){i.appendChild(h.cloneNode(true))}d.appendChild(l.cloneNode(true));for(var L=0;L<=3;L++){d.appendChild(i.cloneNode(true))}a.appendChild(d);var f=this.contextDocument.createElement("div");a.id="new-table";f.appendChild(a);this.contextDocument.execCommand("insertHTML",null,f.innerHTML);var E=this.contextDocument.getElementById("new-table");var D=E.querySelector(".landing-table-th-select-all");if(D.firstChild){D.firstChild.remove()}D.appendChild(x.cloneNode(true));var B=E.querySelectorAll(".landing-table-col-dnd");B.forEach((function(t){if(t.firstChild){t.firstChild.remove()}t.appendChild(p.cloneNode(true));t.appendChild(m.cloneNode(true));t.appendChild(g.cloneNode(true))}));var N=E.querySelectorAll(".landing-table-row-dnd");N.forEach((function(t){if(t.firstChild){t.firstChild.remove()}t.appendChild(r.cloneNode(true));t.appendChild(s.cloneNode(true))}));E.removeAttribute("id");BX.Landing.Block.Node.Text.currentNode.onChange(true)},getCellWidth:function(){var t=250;var e=1e3;var n=57;var a=4;var d=t;var l=BX.Landing.Block.Node.Text.currentNode.node.getBoundingClientRect().width;if(l<e){d=Math.floor((l-n)/a)}return d}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/button/paste_table.min.js?1699258022932";s:6:"source";s:43:"/bitrix/js/landing/ui/button/paste_table.js";s:3:"min";s:47:"/bitrix/js/landing/ui/button/paste_table.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/button/paste_table.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.PasteTable=function(t,n){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null;this.options=n};BX.Landing.UI.Button.PasteTable.prototype={constructor:BX.Landing.UI.Button.PasteTable,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();if(top.window.copiedTable){var n=this.contextDocument.createElement("div");n.appendChild(top.window.copiedTable.cloneNode(true));n.querySelector(".landing-table-container").classList.add("landing-table-pasted");this.contextDocument.execCommand("insertHTML",null,n.innerHTML);var e=this.contextDocument.querySelector(".landing-table-pasted");e.innerHTML="";e.appendChild(top.window.copiedTable.querySelector(".landing-table").cloneNode(true));e.classList.remove("landing-table-pasted")}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:70:"/bitrix/js/landing/ui/button/delete_element_table.min.js?1699258022826";s:6:"source";s:52:"/bitrix/js/landing/ui/button/delete_element_table.js";s:3:"min";s:56:"/bitrix/js/landing/ui/button/delete_element_table.min.js";s:3:"map";s:56:"/bitrix/js/landing/ui/button/delete_element_table.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.DeleteElementTable=function(t,e){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null;this.options=e;this.id=t};BX.Landing.UI.Button.DeleteElementTable.prototype={constructor:BX.Landing.UI.Button.DeleteElementTable,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();if(this.id==="deleteRow"){var e=this.options.setTd[0].parentNode;e.remove()}if(this.id==="deleteCol"){this.options.setTd.forEach((function(t){t.remove()}))}BX.Event.EventEmitter.emit("BX.Landing.TableEditor:onDeleteElementTable");BX.Landing.UI.Panel.EditorPanel.getInstance().hide();BX.Landing.Block.Node.Text.currentNode.onChange(true)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/button/align_table.min.js?16992580221082";s:6:"source";s:43:"/bitrix/js/landing/ui/button/align_table.js";s:3:"min";s:47:"/bitrix/js/landing/ui/button/align_table.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/button/align_table.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.AlignTable=function(t,i){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null;this.options=i;this.id=t};BX.Landing.UI.Button.AlignTable.prototype={constructor:BX.Landing.UI.Button.AlignTable,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();var i=this.id;var n="landing-ui-active";this.options.alignButtons.forEach(function(t){if(t.id===i){t.layout.classList.add(n)}else{t.layout.classList.remove(n)}});if(this.options.table){var e=null;var a=["text-left","text-center","text-right","text-justify"];switch(this.id){case"alignLeft":e="text-left";break;case"alignCenter":e="text-center";break;case"alignRight":e="text-right";break;case"alignJustify":e="text-justify";break}this.options.setTd.forEach(function(t){if(t.nodeType===1){a.forEach(function(i){if(i===e){t.classList.add(i)}else{t.classList.remove(i)}})}})}BX.Landing.Block.Node.Text.currentNode.onChange(true)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/button/style_table.min.js?16992580224266";s:6:"source";s:43:"/bitrix/js/landing/ui/button/style_table.js";s:3:"min";s:47:"/bitrix/js/landing/ui/button/style_table.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/button/style_table.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.StyleTable=function(t,e){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.options=e};BX.Landing.UI.Button.StyleTable.prototype={constructor:BX.Landing.UI.Button.StyleTable,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();var e=this.options.table;var n=[];n.table=e;n.setTd=this.options.setTd;n.target=this.options.target;if(!this.menu){this.menu=new BX.PopupMenuWindow({id:"change-table-style-menu-"+BX.Text.getRandom(),bindElement:this.layout,zIndex:-678,items:[new BX.PopupMenuItem({id:"style1",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_1"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style2",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_2"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style3",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_3"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style4",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_4"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style5",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_5"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style6",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_6"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style7",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_7"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style8",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_8"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style9",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_9"),onclick:this.onChange,table:e,options:n}),new BX.PopupMenuItem({id:"style10",text:BX.Landing.Loc.getMessage("LANDING_TABLE_STYLE_10"),onclick:this.onChange,table:e,options:n})]})}var o=this.menu.menuItems;o.forEach((function(t){t.menuItems=o}));if(e.classList.contains("landing-table-style-1")){o[0].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-2")){o[1].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-3")){o[2].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-4")){o[3].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-5")){o[4].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-6")){o[5].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-7")){o[6].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-8")){o[7].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-9")){o[8].layout.item.style.fontWeight="bold"}if(e.classList.contains("landing-table-style-10")){o[9].layout.item.style.fontWeight="bold"}if(this.menu.popupWindow.isShown()){this.menu.close()}else{this.menu.show()}},onChange:function(t,e){t.stopPropagation();e.menuWindow.close();var n;var o;var s=["landing-table-style-1","landing-table-style-2","landing-table-style-3","landing-table-style-4","landing-table-style-5","landing-table-style-6","landing-table-style-7","landing-table-style-8","landing-table-style-9","landing-table-style-10"];switch(e.id){case"style1":n=s[0];o=0;break;case"style2":n=s[1];o=1;break;case"style3":n=s[2];o=2;break;case"style4":n=s[3];o=3;break;case"style5":n=s[4];o=4;break;case"style6":n=s[5];o=5;break;case"style7":n=s[6];o=6;break;case"style8":n=s[7];o=7;break;case"style9":n=s[8];o=8;break;case"style10":n=s[9];o=9;break}if(n!==undefined){var i=0;e.menuItems.forEach((function(t){if(i===o){t.layout.item.style.fontWeight="bold"}else{t.layout.item.style.fontWeight="normal"}i++}));s.forEach((function(t){if(t===n){e.table.classList.add(t);var s="#cccccc";var i="#333333";if(o>=5){BX.Landing.UI.Button.ColorAction.prototype.prepareOptionsForApplyColorInTableCells(s,e.options.options.options)}else{BX.Landing.UI.Button.ColorAction.prototype.prepareOptionsForApplyColorInTableCells(i,e.options.options.options)}}else{e.table.classList.remove(t)}}))}BX.Landing.Block.Node.Text.currentNode.onChange(true)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/button/copy_table.min.js?1699258022893";s:6:"source";s:42:"/bitrix/js/landing/ui/button/copy_table.js";s:3:"min";s:46:"/bitrix/js/landing/ui/button/copy_table.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/button/copy_table.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.CopyTable=function(t,n){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null;this.options=n};BX.Landing.UI.Button.CopyTable.prototype={constructor:BX.Landing.UI.Button.CopyTable,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();var n=false;if(this.options){BX.Event.EventEmitter.emit("BX.Landing.TableEditor:onCopyTable");top.window.copiedTable=this.options.table.parentElement.cloneNode(true);if(top.window.copiedTable){n=true}}if(n){BX.UI.Notification.Center.notify({content:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPIED")})}else{BX.UI.Notification.Center.notify({content:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_NOT_COPIED")})}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/button/delete_table.min.js?1699258022599";s:6:"source";s:44:"/bitrix/js/landing/ui/button/delete_table.js";s:3:"min";s:48:"/bitrix/js/landing/ui/button/delete_table.min.js";s:3:"map";s:48:"/bitrix/js/landing/ui/button/delete_table.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.DeleteTable=function(t,n){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null;this.options=n};BX.Landing.UI.Button.DeleteTable.prototype={constructor:BX.Landing.UI.Button.DeleteTable,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();this.options.table.parentElement.remove();BX.Landing.UI.Panel.EditorPanel.getInstance().hide();BX.Landing.Block.Node.Text.currentNode.onChange(true)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/button/change_tag.min.js?16992580221933";s:6:"source";s:42:"/bitrix/js/landing/ui/button/change_tag.js";s:3:"min";s:46:"/bitrix/js/landing/ui/button/change_tag.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/button/change_tag.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");var n=BX.Landing.Utils.proxy;BX.Landing.UI.Button.ChangeTag=function(t,e){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.layout.classList.add("landing-ui-button-editor-change-tag");this.onChangeHandler=e.onChange;this.value=e.html;this.onChange=n(this.onChange,this)};BX.Landing.UI.Button.ChangeTag.prototype={constructor:BX.Landing.UI.Button.ChangeTag,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(n){n.preventDefault();n.stopPropagation();if(!this.menu){this.menu=new BX.PopupMenuWindow({id:"change-tag-name-menu-"+BX.Text.getRandom(),bindElement:this.layout,zIndex:-678,items:[new BX.PopupMenuItem({id:"H1",text:"H1",onclick:this.onChange}),new BX.PopupMenuItem({id:"H2",text:"H2",onclick:this.onChange}),new BX.PopupMenuItem({id:"H3",text:"H3",onclick:this.onChange}),new BX.PopupMenuItem({id:"H4",text:"H4",onclick:this.onChange}),new BX.PopupMenuItem({id:"H5",text:"H5",onclick:this.onChange}),new BX.PopupMenuItem({id:"H6",text:"H6",onclick:this.onChange})]});this.activateItem(this.value)}BX.Landing.UI.Button.ChangeTag.menu=this.menu;this.menu.popupWindow.adjustPosition({forceTop:true});if(this.menu.popupWindow.isShown()){this.menu.close()}else{this.menu.show()}BX.Landing.UI.Tool.ColorPicker.hideAll()},activateItem:function(n){if(this.menu){var t=this.menu.menuItems.find(function(n){return n.layout.text.innerHTML.includes("strong")},this);var e=this.menu.menuItems.find(function(t){return t.id===n},this);if(t){t.layout.text.innerHTML=t.layout.text.innerText}if(e){e.layout.text.innerHTML="<strong>"+e.layout.text.innerText+"</strong>";this.layout.innerHTML='<span class="landing-ui-icon-editor-'+e.id.toLowerCase()+'"></span>'}}},onChange:function(n,t){n.stopPropagation();this.activateItem(t.id);t.menuWindow.close();if(this.onChangeHandler){this.onChangeHandler(t.id)}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:71:"/bitrix/js/landing/ui/button/text_background_color.min.js?1699258022531";s:6:"source";s:53:"/bitrix/js/landing/ui/button/text_background_color.js";s:3:"min";s:57:"/bitrix/js/landing/ui/button/text_background_color.min.js";s:3:"map";s:57:"/bitrix/js/landing/ui/button/text_background_color.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.TextBackgroundAction=function(t,n){BX.Landing.UI.Button.ColorAction.apply(this,arguments);this.layout.classList.remove("landing-ui-button-editor-action-color");this.layout.classList.add("landing-ui-button-editor-action-background")};BX.Landing.UI.Button.TextBackgroundAction.prototype={constructor:BX.Landing.UI.Button.TextBackgroundAction,__proto__:BX.Landing.UI.Button.ColorAction.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/button/create_page.min.js?1699258022624";s:6:"source";s:43:"/bitrix/js/landing/ui/button/create_page.js";s:3:"min";s:47:"/bitrix/js/landing/ui/button/create_page.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/button/create_page.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Button");BX.Landing.UI.Button.CreatePage=function(t,n){BX.Landing.UI.Button.EditorAction.apply(this,arguments);this.editPanel=null};BX.Landing.UI.Button.CreatePage.prototype={constructor:BX.Landing.UI.Button.CreatePage,__proto__:BX.Landing.UI.Button.EditorAction.prototype,onClick:function(t){t.preventDefault();t.stopPropagation();const n=this.contextDocument.getSelection().getRangeAt(0);const e=n.toString();const o=BX.Landing.UI.Panel.CreatePage.getInstance();o.setContextDocument(this.contextDocument);o.show({title:e})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:66:"/bitrix/js/landing/ui/panel/base_button_panel.min.js?1699258022874";s:6:"source";s:48:"/bitrix/js/landing/ui/panel/base_button_panel.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");BX.Landing.UI.Panel.BaseButtonPanel=function(t,n){BX.Landing.UI.Panel.BasePanel.apply(this,arguments);this.layout.classList.add(n);this.buttons=new BX.Landing.UI.Collection.ButtonCollection};BX.Landing.UI.Panel.BaseButtonPanel.prototype={constructor:BX.Landing.UI.Panel.BaseButtonPanel,__proto__:BX.Landing.UI.Panel.BasePanel.prototype,addButton:function(t){if(!!t&&t instanceof BX.Landing.UI.Button.BaseButton){if(!this.getButton(t.id)){this.buttons.push(t);this.appendContent(t.layout)}}},prependButton:function(t){if(!!t&&t instanceof BX.Landing.UI.Button.BaseButton){if(!this.getButton(t.id)){this.buttons.unshift(t);this.prependContent(t.layout)}}},removeButton:function(t){var n=this.buttons.get(t);if(!!n){this.buttons.remove(n);BX.remove(n.layout)}},getButton:function(t){return this.buttons.get(t)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:59:"/bitrix/js/landing/ui/panel/editor_panel.js?169925802221505";s:6:"source";s:43:"/bitrix/js/landing/ui/panel/editor_panel.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Panel");

	var proxy = BX.Landing.Utils.proxy;
	var getSelectedElement = BX.Landing.Utils.getSelectedElement;

	/**
	 * Implements interface of editor actions panel.
	 * Implements singleton pattern.
	 *
	 * Not use as constructor
	 *
	 * @extends {BX.Landing.UI.Panel.BaseButtonPanel}
	 *
	 * @param bool outOfFrame - if panel place out of editor window
	 *
	 * @constructor
	 */
	BX.Landing.UI.Panel.EditorPanel = function()
	{
		BX.Landing.UI.Panel.BaseButtonPanel.apply(this, arguments);
		this.layout.classList.add("landing-ui-panel-editor");
		this.position = "absolute";
		this.currentElement = null;
		this.outOfFrame = true;

		this.onKeydown = this.onKeydown.bind(this);
		this.onTabDown = this.onTabDown.bind(this);
		this.onScroll = this.onScroll.bind(this);
	};


	/**
	 * Stores instance of BX.Landing.UI.Panel.EditorPanel
	 * @static
	 * @type {?BX.Landing.UI.Panel.EditorPanel}
	 */
	BX.Landing.UI.Panel.EditorPanel.instance = null;


	/**
	 * Gets instance on BX.Landing.UI.Panel.EditorPanel
	 * @static
	 * @return {BX.Landing.UI.Panel.EditorPanel}
	 */
	BX.Landing.UI.Panel.EditorPanel.getInstance = function()
	{
		if (!BX.Landing.UI.Panel.EditorPanel.instance)
		{
			BX.Landing.UI.Panel.EditorPanel.instance = new BX.Landing.UI.Panel.EditorPanel();
			BX.Landing.UI.Panel.EditorPanel.instance.init();
		}

		return BX.Landing.UI.Panel.EditorPanel.instance;
	};


	var scrollHandler = null;
	var target = null;

	/**
	 * Makes editor as draggable
	 * @param {BX.Landing.UI.Panel.EditorPanel} editor
	 */
	function makeDraggable(editor)
	{
		var dragButton = new BX.Landing.UI.Button.EditorAction("drag", {
			html: "<strong class=\"landing-ui-drag\">&nbsp;</strong>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_DRAG")}
		});

		dragButton.layout.onbxdrag = onDrag.bind(this);
		dragButton.layout.onbxdragstop = onDragEnd.bind(this);

		jsDD.registerObject(dragButton.layout);
		editor.prependButton(dragButton);

		var offsetCalculates;
		var offsetLeft;
		var offsetTop;

		function onDrag(x, y)
		{
			if (!offsetCalculates)
			{
				var pos = BX.pos(jsDD.current_node);
				offsetLeft = Math.max(Math.abs(x - pos.left), 0);
				offsetTop = Math.max(Math.abs(y - pos.top), 0);
				if (editor.currentElement.closest('.landing-ui-panel'))
				{
					offsetTop += BX.Landing.PageObject.getEditorWindow().scrollY;
				}

				offsetCalculates = true;
			}

			BX.DOM.write(function() {
				editor.layout.classList.remove("landing-ui-transition");
				editor.layout.style.top = (y - offsetTop) + "px";
				editor.layout.style.left = (x - offsetLeft) + "px";
			}.bind(this));
		}

		function onDragEnd()
		{
			offsetCalculates = false;
			editor.layout.classList.add("landing-ui-transition");
		}
	}


	/**
	 * Register base editor actions
	 * @param {BX.Landing.UI.Panel.EditorPanel} editor
	 */
	function registerBaseActions(editor)
	{
		editor.addButton(new BX.Landing.UI.Button.EditorAction("bold", {
			html: "<span class=\"landing-ui-icon-editor-bold\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_BOLD")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("italic", {
			html: "<span class=\"landing-ui-icon-editor-italic\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ITALIC")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("underline", {
			html: "<span class=\"landing-ui-icon-editor-underline\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_UNDERLINE")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("strikeThrough", {
			html: "<span class=\"landing-ui-icon-editor-strike\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_STRIKE")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("justifyLeft", {
			html: "<span class=\"landing-ui-icon-editor-left\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_LEFT")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("justifyCenter", {
			html: "<span class=\"landing-ui-icon-editor-center\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_CENTER")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("justifyRight", {
			html: "<span class=\"landing-ui-icon-editor-right\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_RIGHT")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("justifyFull", {
			html: "<span class=\"landing-ui-icon-editor-justify\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_JUSTIFY")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.CreateLink("createLink", {
			html: "<span class=\"landing-ui-icon-editor-link\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_CREATE_LINK")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		var rights = BX.Landing.Env.getInstance().getOptions().rights;
		if (rights && rights.includes('edit'))
		{
			editor.addButton(new BX.Landing.UI.Button.CreatePage("createPage", {
				html: "<span class=\"landing-ui-icon-editor-new-page\"></span>",
				attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_CREATE_PAGE")},
				onClick: proxy(editor.adjustButtonsState, editor)
			}));
		}

		editor.addButton(new BX.Landing.UI.Button.EditorAction("unlink", {
			html: "<span class=\"landing-ui-icon-editor-unlink\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_UNLINK")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("insertUnorderedList", {
			html: "<span class=\"fa fa-list-ul\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_UL")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("insertOrderedList", {
			html: "<span class=\"fa fa-list-ol\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_OL")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.EditorAction("removeFormat", {
			html: "<span class=\"landing-ui-icon-editor-eraser\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_CLEAR")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.ColorAction("foreColor", {
			text: BX.Landing.Loc.getMessage("EDITOR_ACTION_SET_FORE_COLOR"),
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_COLOR")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.TextBackgroundAction("hiliteColor", {
			html: "<span class=\"landing-ui-icon-editor-text-background\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TEXT_BACKGROUND")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.CreateTable("createTable", {
			html: "<span class=\"landing-ui-icon-editor-table\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_CREATE_TABLE")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));

		editor.addButton(new BX.Landing.UI.Button.PasteTable("pasteTable", {
			html: "<span class=\"landing-ui-icon-editor-copy\"></span>",
			attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_PASTE_TABLE")},
			onClick: proxy(editor.adjustButtonsState, editor)
		}));
	}


	var lastPosition = {top: 0, left: 0};
	function adjustAbsolutePosition(editor, node, force)
	{
		var nodeRect = node.getBoundingClientRect();

		var left = nodeRect.left + (nodeRect.width / 2) - (editor.rect.width / 2);
		var top = (nodeRect.top - editor.rect.height - 4);
		var position = 'absolute';
		var windowScope = editor.outOfFrame
			? window.parent
			: window;
		var bodyContent = node.closest('.landing-ui-panel-content-body-content');
		if (bodyContent)
		{
			if (node.classList.contains('landing-ui-field'))
			{
				top += windowScope.pageYOffset;
			}
			else
			{
				top = bodyContent.getBoundingClientRect().top + 5;
				position = 'fixed';
			}
		}
		else if (BX.Landing.Main.getInstance().isControlsExternal())
		{
			top += 71;
		}
		else
		{
			if (
				top <= 5
				&& (
					nodeRect.bottom > windowScope.innerHeight
					|| nodeRect.height > (windowScope.innerHeight / 1.5)
				)
			)
			{
				top = 5;
				position = 'fixed';
			}
			else
			{
				if (top > 5)
				{
					top += windowScope.pageYOffset + 66;
				}
				else
				{
					top = nodeRect.bottom + 4 + windowScope.pageYOffset;
				}
			}
		}

		if ((left + editor.rect.width) > (windowScope.innerWidth - 20))
		{
			left -= ((left + editor.rect.width) - (windowScope.innerWidth - 20));
		}

		left = Math.max(20, left);

		if (lastPosition.top !== top || lastPosition.left !== left || force)
		{
			BX.DOM.write(function() {
				editor.layout.style.position = position;
				editor.layout.style.top = top + "px";
				editor.layout.style.left = left + "px";
			});

			lastPosition.top = top;
			lastPosition.left = left;

			hideButtonsPopups(editor);
		}
	}

	/**
	 * Appends editor to document body
	 * @param {BX.Landing.UI.Panel.EditorPanel} editor
	 */
	function appendToBody(editor)
	{
		if (editor.outOfFrame)
		{
			window.parent.document.body.appendChild(editor.layout);
		}
		else
		{
			window.document.body.appendChild(editor.layout);
		}
	}

	var mouseTarget = null;
	function onMousedown(event)
	{
		mouseTarget = event.target;
	}

	var preventClick = false;
	function onMouseUp(event)
	{
		preventClick = mouseTarget !== event.target
	}

	function onClick(event)
	{
		if (preventClick)
		{
			event.preventDefault();
			event.stopPropagation();
		}
	}

	function closePopup(button)
	{
		if (button.popup)
		{
			button.popup.close();
		}

		if (button.menu)
		{
			button.menu.close();
		}
	}

	function hideButtonsPopups(editor)
	{
		editor.buttons.forEach(closePopup);

		if (editor.additionalButtons)
		{
			editor.additionalButtons.forEach(closePopup);
		}

		BX.Landing.UI.Tool.ColorPicker.hideAll();
	}


	BX.Landing.UI.Panel.EditorPanel.prototype = {
		constructor: BX.Landing.UI.Panel.EditorPanel,
		__proto__: BX.Landing.UI.Panel.BaseButtonPanel.prototype,

		/**
		 * Method for separate init actions from object create
		 */
		init: function()
		{
			makeDraggable(this);
			registerBaseActions(this);
			appendToBody(this);
			this.rect = this.layout.getBoundingClientRect();
		},

		/**
		 * Shows editor
		 * @param {HTMLElement} element - Editable element
		 * @param {?string} [position = "absolute"]
		 * @param {BX.Landing.UI.Button.BaseButton[]} [additionalButtons]
		 * @param {boolean} isTable
		 * @param {array} hideButtons - List base buttons
		 */
		show: function(
			element,
			position,
			additionalButtons,
			isTable,
			hideButtons
		)
		{
			if (!isTable)
			{
				this.showBaseButtons();
			}
			else
			{
				if (hideButtons)
				{
					if (hideButtons.length > 0)
					{
						this.showBaseButtons();
						this.hideBaseButtons(hideButtons);
					}
					else
					{
						this.hideAllBaseButtons();
					}
				}
				else
				{
					this.hideAllBaseButtons();
				}
			}

			this.currentElement = element;
			this.setContextDocument(this.currentElement ? this.currentElement.ownerDocument : document);

			if (this.additionalButtons)
			{
				this.additionalButtons.forEach(function(button) {
					this.buttons.remove(button);
					closePopup(button);
					BX.remove(button.layout);
				}, this);

				this.additionalButtons = null;
			}

			if (additionalButtons)
			{
				this.additionalButtons = additionalButtons;
				this.additionalButtons.forEach(function(button) {
					if (button.insertAfter)
					{
						var prevSibling = this.layout.querySelector("[data-id=\""+button.insertAfter+"\"]");

						if (prevSibling)
						{
							BX.insertAfter(button.layout, prevSibling);
							this.buttons.add(button);
						}
					}
					else
					{
						this.addButton(button);
					}
				}, this);
			}

			if (!this.isShown())
			{
				BX.onCustomEvent("BX.Landing.Editor:enable", [element]);
				this.contextDocument.addEventListener("mousedown", onMousedown, true);
				this.contextDocument.addEventListener("mouseup", onMouseUp, true);
				this.contextDocument.addEventListener("click", onClick, true);
				this.currentElement.addEventListener("click", proxy(this.adjustButtonsState, this), true);

				setTimeout(function() {
					this.layout.classList.add("landing-ui-transition");
				}.bind(this), 100);
			}

			BX.Landing.UI.Panel.BaseButtonPanel.prototype.show.call(this, arguments);

			BX.DOM.write(function() {
				this.rect = this.layout.getBoundingClientRect();
				this.adjustPosition(element, position, true);
			}.bind(this));

			this.onShow(element);
			this.adjustButtonsState();
			this.adjustButtonsContextDocument();
		},

		onShow: function(node)
		{
			target = node;
			scrollHandler = scrollHandler || this.onScroll.bind(null, node);
			this.contextDocument.addEventListener("keydown", this.onKeydown);
			this.contextWindow.addEventListener("resize", scrollHandler);

			try {
				this.contextDocument.addEventListener("scroll", scrollHandler, {passive: true});
			} catch (err) {
				this.contextDocument.addEventListener("scroll", scrollHandler);
			}
		},

		hide: function()
		{
			if (this.isShown())
			{
				BX.onCustomEvent("BX.Landing.Editor:disable", [null]);
				this.contextDocument.removeEventListener("mousedown", onMousedown, true);
				this.contextDocument.removeEventListener("mouseup", onMouseUp, true);
				this.contextDocument.removeEventListener("click", onClick, true);
				this.currentElement.removeEventListener("click", proxy(this.adjustButtonsState, this), true);

				setTimeout(function() {
					this.rect = this.layout.getBoundingClientRect();
					this.layout.classList.remove("landing-ui-transition");
				}.bind(this), 100);
			}

			BX.Landing.UI.Panel.BaseButtonPanel.prototype.hide.call(this, arguments);
			this.onHide();
		},

		onHide: function()
		{
			this.contextDocument.removeEventListener("keydown", this.onKeydown);
			this.contextWindow.removeEventListener("resize", scrollHandler);

			try {
				this.contextDocument.removeEventListener("scroll", scrollHandler, {passive: true});
			} catch (err) {
				this.contextDocument.removeEventListener("scroll", scrollHandler);
			}
		},

		onKeydown: function(event)
		{
			// TAB key
			if (
				event.key === 'Tab'
				&& event.target.nodeName !== "LI"
			)
			{
				event.preventDefault();

				if (!event.shiftKey)
				{
					if (event.code === 'Tab')
					{
						this.onTabDown();
					}
					else
					{
						this.contextDocument.execCommand('indent');
					}
				}
				else
				{
					this.contextDocument.execCommand('outdent');
				}
			}

			// ENTER key
			if (
				event.key === 'Enter'
				&& event.target.nodeName !== "LI"
				&& event.target.nodeName !== "UL"
				&& event.metaKey === true
			)
			{
				event.preventDefault();
				const range = this.contextWindow.getSelection().getRangeAt(0);
				const br = BX.create("br");
				range.deleteContents();
				range.insertNode(br);

				const newRange = this.contextDocument.createRange();
				newRange.setStartAfter(br);
				newRange.collapse(true);

				const sel = this.contextWindow.getSelection();
				sel.removeAllRanges();
				sel.addRange(newRange);
			}

			setTimeout(function() {
				BX.Landing.UI.Panel.EditorPanel.getInstance().adjustPosition(target);
			}, 10);
		},

		onTabDown: function()
		{
			var TAB_COUNT = 10;
			var isAllowedTab = true;
			var parentNode = this.contextWindow.getSelection().focusNode.parentNode.parentNode;
			while (parentNode.tagName === 'DIV')
			{
				parentNode = parentNode.parentNode;
			}
			var countUlTag = 0;
			var parentsNodeArr = [];
			var allowedTagName = ['UL', 'LI', 'BLOCKQUOTE', 'DIV'];
			while (allowedTagName.indexOf(parentNode.tagName) !== -1)
			{
				if (parentNode.tagName !== 'DIV')
				{
					countUlTag++;
					parentsNodeArr.push(parentNode);
				}
				parentNode = parentNode.parentNode;
			}
			if (countUlTag > TAB_COUNT)
			{
				if (parentsNodeArr[parentsNodeArr.length - 1].tagName === 'BLOCKQUOTE')
				{
					var previousElement = parentsNodeArr[parentsNodeArr.length - 1].previousSibling;
					while ((previousElement !== null) && (previousElement.nodeType !== 1))
					{
						previousElement = previousElement.previousSibling;
					}
					var countBlockquote = 0;
					while (previousElement && previousElement.tagName === 'BLOCKQUOTE')
					{
						previousElement = previousElement.firstChild;
						countBlockquote++;
					}
					if ((countUlTag - countBlockquote) > 0)
					{
						isAllowedTab = false;
					}
				}
				else
				{
					for (var i = 1; i < parentsNodeArr.length; i++) {
						if (parentsNodeArr[i].childNodes.length < 2)
						{
							isAllowedTab = false;
							break;
						}
					}
					if (parentsNodeArr[0].firstChild.nextSibling === null)
					{
						isAllowedTab = false;
					}
				}
			}
			if (isAllowedTab)
			{
				this.contextDocument.execCommand('indent');
			}
		},

		onScroll: function()
		{
			BX.Landing.UI.Panel.EditorPanel.getInstance().adjustPosition(target);
		},

		adjustButtonsState: function()
		{
			var getAction = function(value) {
				return (!value ? "de" : "") + "activate";
			};

			var button = function(key) {
				return this.buttons.get(key);
			}.bind(this);

			requestAnimationFrame(function() {
				var format = this.getFormat();
				void (button("bold") && button("bold")[getAction(format.bold)]());
				void (button("italic") && button("italic")[getAction(format.italic)]());
				void (button("underline") && button("underline")[getAction(format.underline)]());
				void (button("strikeThrough") && button("strikeThrough")[getAction(format.strike)]());
				void (button("justifyLeft") && button("justifyLeft")[getAction(format.align === "left")]());
				void (button("justifyCenter") && button("justifyCenter")[getAction(format.align === "center")]());
				void (button("justifyRight") && button("justifyRight")[getAction(format.align === "right")]());
				void (button("justifyFull") && button("justifyFull")[getAction(format.align === "justify")]());
			}.bind(this));
		},

		adjustButtonsContextDocument: function()
		{
			this.buttons.forEach(button => {
				if ('setContextDocument' in button)
				{
					button.setContextDocument(this.contextDocument);
				}
			});
		},

		getFormat: function()
		{
			var element = getSelectedElement(this.contextDocument);
			var format = {};

			if (element)
			{
				var style = getComputedStyle(element);

				switch (style.getPropertyValue("font-weight"))
				{
					case "bold":
					case "bolder":
					case "500":
					case "600":
					case "700":
					case "800":
					case "900":
						format["bold"] = true;
						break;
				}

				if (element.tagName === 'B')
				{
					format["bold"] = true;
				}

				if (style.getPropertyValue("font-style") === "italic")
				{
					format["italic"] = true;
				}

				if (style.getPropertyValue("text-decoration").includes("underline") ||
					style.getPropertyValue("text-decoration-line").includes("underline"))
				{
					format["underline"] = true;
				}

				if (style.getPropertyValue("text-decoration").includes("line-through") ||
					style.getPropertyValue("text-decoration-line").includes("line-through"))
				{
					format["strike"] = true;
				}

				var align = style.getPropertyValue("text-align") || "left";
				if (align.match(/[left|center|rigth|custiffy]/))
				{
					format["align"] = align;
				}

				if (this.currentElement.nodeName === "A" || this.currentElement.closest("a"))
				{
					format["link"] = true;
				}
			}

			return format;
		},

		adjustPosition: function(node, position, force)
		{
			adjustAbsolutePosition(this, node, force);
		},

		isFixed: function()
		{
			return this.position === "fixed-top" || this.position === "fixed-right";
		},

		hideAllBaseButtons: function()
		{
			this.layout.childNodes.forEach(function(button){
				if (button.dataset.id !== 'drag')
				{
					button.hidden = true;
				}
			});
		},

		hideBaseButtons: function(hideButtons)
		{
			this.layout.childNodes.forEach(function(button){
				if (hideButtons.indexOf(button.dataset.id) !== -1)
				{
					button.hidden = true;
				}
			});
		},

		showBaseButtons: function()
		{
			this.layout.childNodes.forEach(button => {
				if (button.dataset.id === 'pasteTable')
				{
					if (top.window.copiedTable)
					{
						button.hidden = false;
					}
					else
					{
						button.hidden = true;
					}
				}
				else
				{
					button.hidden = false;
				}
			});
		},

		isOutOfFrame: function()
		{
			return this.outOfFrame;
		}
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/panel/small_editor_panel.js?16992580211474";s:6:"source";s:49:"/bitrix/js/landing/ui/panel/small_editor_panel.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Panel");


	BX.Landing.UI.Panel.SmallEditorPanel = function()
	{
		BX.Landing.UI.Panel.EditorPanel.apply(this, arguments);
		this.layout.classList.remove("landing-ui-hide");
		this.layout.classList.add("landing-ui-panel-small-content-edit");
	};


	/**
	 * Shows panel for text node
	 * @static
	 * @param {BX.Landing.Block.Node} [node]
	 */
	BX.Landing.UI.Panel.SmallEditorPanel.show = function(node)
	{
		BX.Landing.UI.Panel.SmallEditorPanel.getInstance().show(node);
	};


	/**
	 * Hides panel
	 * @static
	 */
	BX.Landing.UI.Panel.SmallEditorPanel.hide = function()
	{
		BX.Landing.UI.Panel.SmallEditorPanel.getInstance().hide();
	};


	/**
	 * Stores instance of BX.Landing.UI.Panel.SmallEditorPanel
	 * @static
	 * @type {?BX.Landing.UI.Panel.SmallEditorPanel}
	 */
	BX.Landing.UI.Panel.SmallEditorPanel.instance = null;


	/**
	 * Gets instance on BX.Landing.UI.Panel.SmallEditorPanel
	 * @static
	 * @return {BX.Landing.UI.Panel.SmallEditorPanel}
	 */
	BX.Landing.UI.Panel.SmallEditorPanel.getInstance = function()
	{
		if (!BX.Landing.UI.Panel.SmallEditorPanel.instance)
		{
			BX.Landing.UI.Panel.SmallEditorPanel.instance = new BX.Landing.UI.Panel.SmallEditorPanel();
		}

		return BX.Landing.UI.Panel.SmallEditorPanel.instance;
	};


	BX.Landing.UI.Panel.SmallEditorPanel.prototype = {
		constructor: BX.Landing.UI.Panel.SmallEditorPanel,
		__proto__: BX.Landing.UI.Panel.EditorPanel.prototype
	}
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:68:"/bitrix/js/landing/ui/panel/edit_content_panel.min.js?16992580212855";s:6:"source";s:49:"/bitrix/js/landing/ui/panel/edit_content_panel.js";s:3:"min";s:53:"/bitrix/js/landing/ui/panel/edit_content_panel.min.js";s:3:"map";s:53:"/bitrix/js/landing/ui/panel/edit_content_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var t=BX.Landing.UI.Button.SidebarButton;BX.Landing.UI.Panel.ContentEdit=function(t,n){BX.Landing.UI.Panel.Content.apply(this,arguments);this.layout.classList.add("landing-ui-panel-content-edit");this.appendFooterButton(new BX.Landing.UI.Button.BaseButton("save_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_SAVE"),onClick:BX.Type.isFunction(n.onSaveHandler)?n.onSaveHandler:()=>{},className:"landing-ui-button-content-save",attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_SLIDER_SAVE")}}));this.appendFooterButton(new BX.Landing.UI.Button.BaseButton("cancel_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_CANCEL"),onClick:BX.Type.isFunction(n.onCancelHandler)?n.onCancelHandler:()=>{},className:"landing-ui-button-content-cancel",attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_SLIDER_CANCEL")}}))};BX.Landing.UI.Panel.ContentEdit.showedPanel=null;BX.Landing.UI.Panel.ContentEdit.prototype={constructor:BX.Landing.UI.Panel.ContentEdit,__proto__:BX.Landing.UI.Panel.Content.prototype,show:function(){BX.Landing.UI.Panel.ContentEdit.showedPanel=this;if(BX.Landing.UI.Panel.StylePanel.getInstance().isShown()){BX.Landing.UI.Panel.StylePanel.getInstance().hide().then(function(){BX.Landing.UI.Panel.Content.prototype.show.call(this)}.bind(this))}else{BX.Landing.UI.Panel.Content.prototype.show.call(this)}},appendForm:function(n){this.forms.add(n);this.content.appendChild(n.getNode());this.checkReadyToSave();if(n.title){var e=new t(n.code,{text:n.title,empty:!n.fields.length,onClick:function(){this.scrollTo(n.layout);this.highlightItem(n.layout)}.bind(this)});this.sidebarButtons.add(e);this.sidebar.appendChild(e.layout)}n.fields.forEach((function(n){if(n.title){var e=new t(n.selector,{text:n.title,child:true,onClick:function(t){t.preventDefault();t.stopPropagation();this.scrollTo(n.layout);this.highlightItem(n.layout)}.bind(this)});this.sidebarButtons.add(e);this.sidebar.appendChild(e.layout)}}),this)},replaceForm:function(n,e){this.forms.remove(n);this.forms.add(e);this.checkReadyToSave();BX.replace(n.getNode(),e.getNode());var i=this.sidebarButtons.get(n.code);if(i){var a=new t(e.code,{text:e.title,empty:e.type==="dynamicCards"||!e.fields.length,onClick:function(){this.scrollTo(e.layout)}.bind(this)});BX.replace(i.layout,a.layout);this.sidebarButtons.remove(i);this.sidebarButtons.add(a)}},compact:function(t){this.layout.classList[t?"add":"remove"]("landing-ui-panel-content-edit-compact")},highlightItem:function(t){var n="landing-ui-panel-highlight";this.removeHighlights(this.layout,n);BX.Dom.addClass(t,n);setTimeout((()=>{BX.Dom.removeClass(t,n)}),1500)},removeHighlights:function(t,n){var e=t.querySelectorAll("."+n);if(e.length>=1){e.forEach((function(t){BX.Dom.removeClass(t,n)}))}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:59:"/bitrix/js/landing/ui/panel/preview_panel.js?16992580214501";s:6:"source";s:44:"/bitrix/js/landing/ui/panel/preview_panel.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Panel");


	/**
	 * Implements preview panel interface
	 *
	 * @extends {BX.Landing.UI.Panel.Content}
	 *
	 * @inheritDoc
	 * @constructor
	 */
	BX.Landing.UI.Panel.Preview = function(id, data)
	{
		this.size = null;
		this.headerButtons = new BX.Landing.UI.Collection.ButtonCollection();
		this.iframe = BX.Landing.UI.Panel.Preview.createIframe();
		this.iframe.dataset.postfix = "";
		BX.Landing.UI.Panel.Content.apply(this, arguments);

		// Add class names
		this.layout.classList.add("landing-ui-panel-preview");
		this.overlay.classList.add("landing-ui-panel-preview-overlay");

		// Bind on iFrame events
		this.iframe.addEventListener("load", this.onFrameLoad.bind(this));
		this.iframe.style.opacity = 0;

		BX.remove(this.footer);
	};


	BX.Landing.UI.Panel.Preview.createIframe = function()
	{
		return BX.create("iframe", {props: {
			className: "landing-ui-panel-preview-iframe",
			src: BX.util.add_url_param(window.location.toString(), {"landing_mode": "style"})
		}});
	};


	BX.Landing.UI.Panel.Preview.prototype = {
		constructor: BX.Landing.UI.Panel.Preview,
		__proto__: BX.Landing.UI.Panel.Content.prototype,
		superclass: BX.Landing.UI.Panel.Content.prototype,

		init: function()
		{
			// Init super class
			this.superclass.init.call(this);

			// Add desktop button
			this.addHeaderButton(new BX.Landing.UI.Button.BaseButton("desktop_button", {
				className: ["landing-ui-button-desktop", "active"],
				onClick: this.onDesktopSizeChange.bind(this)
			}));

			// Add tablet button
			this.addHeaderButton(new BX.Landing.UI.Button.BaseButton("tablet_button", {
				className: "landing-ui-button-tablet",
				onClick: this.onTabletSizeChange.bind(this)
			}));

			// Add mobile button
			this.addHeaderButton(new BX.Landing.UI.Button.BaseButton("mobile_button", {
				className: "landing-ui-button-mobile",
				onClick: this.onMobileSizeChange.bind(this)
			}));


			// Create custom size field
			this.size = new BX.Landing.UI.Field.Unit({
				selector: "size",
				content: "0",
				unit: "px",
				onInput: this.onSizeInput.bind(this),
				className: "landing-ui-panel-preview-size",
				min: 320,
				max: 12000,
				step: 1
			});

			this.title.appendChild(this.size.layout);

			// Add iFrame to content area of panel
			this.content.appendChild(this.iframe);
		},


		/**
		 * Handles size input event
		 */
		onSizeInput: function(field)
		{
			requestAnimationFrame(function() {
				this.iframe.style.width = field.getValue() + "px";
			}.bind(this));
		},


		/**
		 * Handles iFrame load event
		 */
		onFrameLoad: function()
		{
			this.size.setValue(this.body.getBoundingClientRect().width);
			this.iframe.contentWindow.scrollTo(0, window.scrollY);
			requestAnimationFrame(function() {
				this.iframe.style.opacity = 1;
			}.bind(this));
		},


		/**
		 * Handles desktop size change event
		 */
		onDesktopSizeChange: function()
		{
			this.headerButtons.forEach(function(button) {
				button.layout.classList.remove("active");
			});

			this.headerButtons.get("desktop_button").layout.classList.add("active");
			this.size.setValue(this.body.getBoundingClientRect().width);
			this.iframe.dataset.postfix = "";
		},


		/**
		 * Handles tablet size change event
		 */
		onTabletSizeChange: function()
		{
			this.headerButtons.forEach(function(button) {
				button.layout.classList.remove("active");
			});

			this.headerButtons.get("tablet_button").layout.classList.add("active");
			this.size.setValue(767);
			this.iframe.dataset.postfix = "--md";
		},


		/**
		 * Handles mobile size change event
		 */
		onMobileSizeChange: function()
		{
			this.headerButtons.forEach(function(button) {
				button.layout.classList.remove("active");
			});

			this.headerButtons.get("mobile_button").layout.classList.add("active");
			this.size.setValue(479);
			this.iframe.dataset.postfix = "--sm";
		},


		/**
		 * Shows preview panel
		 */
		show: function()
		{
			this.superclass.show.call(this);
			document.documentElement.style.overflow = "hidden";
			this.iframe.contentWindow.scrollTo(0, window.scrollY);
		},


		/**
		 * Hides preview panel
		 */
		hide: function()
		{
			this.superclass.hide.call(this);
			document.documentElement.style.overflow = null;
		},


		/**
		 * Appends header button
		 * @param {BX.Landing.UI.Button.BaseButton} button
		 */
		addHeaderButton: function(button)
		{
			this.title.appendChild(button.layout);
			this.headerButtons.add(button);
		}
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/panel/unsplash_panel.min.js?16992580213305";s:6:"source";s:45:"/bitrix/js/landing/ui/panel/unsplash_panel.js";s:3:"min";s:49:"/bitrix/js/landing/ui/panel/unsplash_panel.min.js";s:3:"map";s:49:"/bitrix/js/landing/ui/panel/unsplash_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");BX.Landing.UI.Panel.Unsplash=function(n){if(BX.Landing.UI.Panel.Unsplash.instance){return BX.Landing.UI.Panel.Unsplash.instance}BX.Landing.UI.Panel.Content.apply(this,arguments);this.onChangeHandler=null;this.onSearchWithDebounce=BX.debounce(this.onSearchWithDebounce,1e3,this);this.layout.classList.add("landing-ui-panel-unsplash");this.searchContainer=BX.create("div",{props:{className:"landing-ui-panel-unsplash-search-container"}});this.loader=BX.create("div",{props:{className:"landing-ui-panel-unsplash-search-loader-container"}});this.loader.appendChild(BX.create("div",{props:{className:"landing-ui-panel-unsplash-search-loader"}}));(this.searchInputField=new BX.Landing.UI.Field.Unit({onInput:this.onSearchInput.bind(this),className:"landing-ui-panel-unsplash-search-field",placeholder:BX.Landing.Loc.getMessage("UNSPLASH_SEARCH_FIELD_PLACEHOLDER"),title:BX.Landing.Loc.getMessage("UNSPLASH_SEARCH_FIELD_LABEL")})).enableTextOnly();this.searchContainer.appendChild(this.searchInputField.layout);this.content.appendChild(this.searchContainer);this.searchInputField.input.type="text";this.searchInputField.input.min=null;this.searchInputField.input.max=null;this.content.appendChild(this.loader);this.imagesList=BX.create("div",{props:{className:"landing-ui-panel-unsplash-images-list"}});this.content.appendChild(this.imagesList);document.body.appendChild(this.layout);this.makeLayouts()};BX.Landing.UI.Panel.Unsplash.instance=null;BX.Landing.UI.Panel.Unsplash.getInstance=function(){if(!BX.Landing.UI.Panel.Unsplash.instance){BX.Landing.UI.Panel.Unsplash.instance=new BX.Landing.UI.Panel.Unsplash("unsplash")}return BX.Landing.UI.Panel.Unsplash.instance};BX.Landing.UI.Panel.Unsplash.prototype={constructor:BX.Landing.UI.Panel.Unsplash,__proto__:BX.Landing.UI.Panel.Content.prototype,show:function(n){BX.Landing.UI.Panel.Content.prototype.show.call(this);this.onChangeHandler=n},hide:function(){BX.Landing.UI.Panel.Content.prototype.hide.call(this);this.onChangeHandler=null},showLoader:function(){this.imagesList.innerHTML="";this.loader.classList.add(this.classShow)},hideLoader:function(){this.loader.classList.remove(this.classShow)},isLoaderShown:function(){return this.loader.classList.contains(this.classShow)},onSearchInput:function(n){var a=n.getValue();if(!!a&&a.length){this.showLoader();this.onSearchWithDebounce(a)}else{this.makeLayouts()}},onSearchWithDebounce:function(n){var a=new BX.Landing.Client.Unsplash.getInstance;a.search(n).then(function(n){this.hideLoader();this.imagesList.innerHTML="";n.forEach(function(n){var a=new BX.Landing.UI.Card.ImagePreview({image:n.urls.small,onClick:function(){this.onChange(n.urls.full)}.bind(this)});this.imagesList.appendChild(a.layout)},this)}.bind(this))},makeLayouts:function(){var n=new BX.Landing.Client.Unsplash.getInstance;this.showLoader();n.popular().then(function(n){this.hideLoader();this.imagesList.innerHTML="";n.forEach(function(n){var a=new BX.Landing.UI.Card.ImagePreview({image:n.urls.small,onClick:function(){this.onChange(n.urls.full)}.bind(this)});this.imagesList.appendChild(a.layout)},this)}.bind(this))},onChange:function(n){if(typeof this.onChangeHandler==="function"){this.onChangeHandler(n)}this.hide()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/panel/image_panel.min.js?16992580213651";s:6:"source";s:42:"/bitrix/js/landing/ui/panel/image_panel.js";s:3:"min";s:46:"/bitrix/js/landing/ui/panel/image_panel.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/panel/image_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");BX.Landing.UI.Panel.Image=function(n){BX.Landing.UI.Panel.Content.apply(this,arguments);this.layout.classList.add("landing-ui-panel-image");this.onChangeHandler=function(){};this.headerButtonsField=this.createHeaderButtons();this.cards=new BX.Landing.Collection.BaseCollection;this.overlay.classList.add("landing-ui-panel-image");this.title.appendChild(this.headerButtonsField.layout);this.title.innerText=BX.Landing.Loc.getMessage("LANDING_IMAGE_LIBRARY_PANEL_TITLE");if(BX.Landing.Main.isEditorMode()){if(BX.Landing.Main.isExternalControlsEnabled()||window.parent&&window.parent!==top){window.parent.document.body.appendChild(this.layout);return}}this.overlay.parentNode.removeChild(this.overlay);document.body.appendChild(this.overlay);document.body.appendChild(this.layout)};BX.Landing.UI.Panel.Image.getInstance=function(){if(!BX.Landing.UI.Panel.Image.instance){BX.Landing.UI.Panel.Image.instance=new BX.Landing.UI.Panel.Image("image_panel")}return BX.Landing.UI.Panel.Image.instance};BX.Landing.UI.Panel.Image.instance=null;BX.Landing.UI.Panel.Image.prototype={constructor:BX.Landing.UI.Panel.Image,__proto__:BX.Landing.UI.Panel.Content.prototype,onChangeView:function(n){if(n==="unsplash"){this.showUnsplash()}if(n==="google"){this.showGoogle()}if(n==="disk"){this.showUploader()}},showUploader:function(){var n=this.cards.get("uploader");if(!n){n=new BX.Landing.UI.Card.Uploader({id:"uploader"});this.appendCard(n);this.cards.add(n)}this.hideAll();n.show()},showGoogle:function(){var n=this.cards.get("google");if(!n){n=new BX.Landing.UI.Card.Google({id:"google",searchLabel:BX.Landing.Loc.getMessage("GOOGLE_SEARCH_FIELD_LABEL"),searchTips:[{name:"Nature",value:"Nature"},{name:"People",value:"People"},{name:"Buildings",value:"Buildings"},{name:"Sunset",value:"Sunset"}],description:BX.Landing.Loc.getMessage("LANDING_IMAGE_GOOGLE_DESCRIPTION"),onChange:this.onChange.bind(this),params:this.uploadParams});this.appendCard(n);this.cards.add(n)}this.hideAll();n.showPopular();n.show()},showUnsplash:function(){var n=this.cards.get("unsplash");if(!n){n=new BX.Landing.UI.Card.Unsplash({id:"unsplash",searchLabel:BX.Landing.Loc.getMessage("UNSPLASH_SEARCH_FIELD_LABEL"),searchTips:[{name:"Nature",value:"Nature"},{name:"People",value:"People"},{name:"Buildings",value:"Buildings"},{name:"Sunset",value:"Sunset"}],description:BX.Landing.Loc.getMessage("LANDING_IMAGE_UNSPLASH_DESCRIPTION"),onChange:this.onChange.bind(this)});this.appendCard(n);this.cards.add(n)}this.hideAll();n.show()},hideAll:function(){this.cards.forEach((function(n){n.layout.hidden=true}))},createHeaderButtons:function(){return new BX.Landing.UI.Field.ButtonGroup({items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_EDIT_IMAGE_HEADER_BUTTON_UNSPLASH"),value:"unsplash",active:true},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_EDIT_IMAGE_HEADER_BUTTON_GOOGLE"),value:"google"},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_EDIT_IMAGE_HEADER_BUTTON_FROM_DISK"),value:"disk"}],onChange:this.onChangeView.bind(this)})},show:function(n,e,a,i){this.uploadParams=i||{};this.externalLoader=a;this.params=e;this.onChangeView(n);BX.Landing.UI.Panel.Content.prototype.show.call(this);return new Promise(function(n){this.promiseResolve=n}.bind(this))},hide:function(){this.params=null;BX.Landing.UI.Panel.Content.prototype.hide.call(this)},onChange:function(n){this.externalLoader.show();BX.Landing.Utils.urlToBlob(n.link).then((function(e){e.lastModifiedDate=new Date;e.name=(n.name+"").split("?")[0];return e})).then(this.promiseResolve.bind(this));this.hide()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:59:"/bitrix/js/landing/ui/panel/url_list.min.js?169925802211600";s:6:"source";s:39:"/bitrix/js/landing/ui/panel/url_list.js";s:3:"min";s:43:"/bitrix/js/landing/ui/panel/url_list.min.js";s:3:"map";s:43:"/bitrix/js/landing/ui/panel/url_list.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var e=BX.Landing.Utils.addClass;var t=BX.Landing.Utils.removeClass;var n=BX.Landing.Utils.append;var i=BX.Landing.Utils.onCustomEvent;var a=BX.Landing.Utils.setTextContent;var r=BX.Landing.Utils.create;var s=BX.Landing.Utils.style;var o=BX.Landing.Utils.isNumber;var d=BX.Landing.Utils.isString;var c=BX.Landing.Utils.isPlainObject;var l=BX.Landing.Utils.isArray;var h=BX.Landing.Utils.addQueryParams;var u="landing";var g="block";var L="system";var f="crmFormPopup";var p="crmPhone";var I="user";var v=BX.Landing.UI.Button.SidebarButton;BX.Landing.UI.Panel.URLList=function(t,a){BX.Landing.UI.Panel.Content.apply(this,arguments);e(this.layout,"landing-ui-panel-url-list");e(this.overlay,"landing-ui-panel-url-list-overlay");e(this.overlay,"landing-ui-hide");this.overlay.hidden=true;this.overlay.dataset.isShown="false";i("BX.Landing.Block:init",this.refresh.bind(this));i("BX.Landing.Block:remove",this.refresh.bind(this));if(BX.Landing.Main.isEditorMode()){n(this.layout,window.parent.document.body)}else{this.overlay.parentNode.removeChild(this.overlay);document.body.appendChild(this.overlay);n(this.layout,document.body);this.layout.style.marginTop=0;this.overlay.style.marginTop=0}this.loader=new BX.Loader({target:this.content});this.promiseResolve=function(){};this.layout.hidden=true;this.isNeedLoad=true;this.cache=new BX.Cache.MemoryCache};BX.Landing.UI.Panel.URLList.getInstance=function(){if(!BX.Landing.UI.Panel.URLList.instance){BX.Landing.UI.Panel.URLList.instance=new BX.Landing.UI.Panel.URLList("url_list")}return BX.Landing.UI.Panel.URLList.instance};BX.Landing.UI.Panel.URLList.instance=null;BX.Landing.UI.Panel.URLList.prototype={constructor:BX.Landing.UI.Panel.URLList,__proto__:BX.Landing.UI.Panel.Content.prototype,refresh:function(){this.isNeedLoad=true},showLoader:function(){this.loader.show(this.content)},show:function(e,n){this.showOptions=n;BX.Landing.UI.Panel.Content.prototype.show.call(this);this.clear();this.showLoader();if(e===u){t(this.layout,"landing-ui-panel-url-list-blocks");a(this.title,n.panelTitle||BX.Landing.Loc.getMessage("LANDING_LINKS_LANDINGS_TITLE"));this.showSites(n)}else if(e===g){a(this.title,n.panelTitle||BX.Landing.Loc.getMessage("LANDING_LINKS_BLOCKS_TITLE"));this.showBlocks(n)}else if(e===f){a(this.title,n.panelTitle||BX.Landing.Loc.getMessage("LANDING_LINKS_CRM_FORMS_TITLE"));this.showForms(n)}else if(e===p){a(this.title,n.panelTitle||BX.Landing.Loc.getMessage("LANDING_LINKS_CRM_PHONES_TITLE"));this.showPhones(n)}else if(e===I){a(this.title,n.panelTitle||BX.Landing.Loc.getMessage("LANDING_LINKS_CRM_PHONES_USERS"))}return new Promise(function(e){this.promiseResolve=e}.bind(this))},showSites:function(e){let t=e.siteId;void s(this.layout,{width:null});if(!BX.Type.isPlainObject(e.filter)){e.filter={}}var n=BX.Landing.Env.getInstance();if(BX.Type.isNil(e.filter.ID)&&n.getType()==="GROUP"){e.filter.ID=n.getSiteId()}if(e.filter.ID===-1){delete e.filter.ID}e.filter.SPECIAL="N";void BX.Landing.Backend.getInstance().getSites(e).then((n=>{n.forEach((n=>{if(parseInt(n.ID)==t){this.appendSidebarButton(this.createCurrentSiteButton());this.currentSiteButton=new v(n.ID,{text:n.TITLE,onClick:!e.currentSiteOnly?this.onSiteClick.bind(this,n.ID,e.enableAreas):null,child:true,active:true});this.appendSidebarButton(this.currentSiteButton)}}));if(!e.currentSiteOnly){this.appendSidebarButton(new v("my_sites",{text:BX.Landing.Loc.getMessage("LANDING_LINKS_PANEL_MY_SITES")}));n.forEach((n=>{const i=new v(n.ID,{text:n.TITLE,onClick:this.onSiteClick.bind(this,n.ID,e.enableAreas),child:true,active:!this.currentSiteButton});if(!this.currentSiteButton){this.currentSiteButton=i;t=n.ID}this.appendSidebarButton(i)}))}BX.Landing.Backend.getInstance().getLandings({siteId:t},e.filterLanding).then((n=>{const i={currentTarget:this.currentSiteButton.layout};const a=this.onSiteClick.bind(this,t,e.enableAreas,i);if(!e.disableAddPage){this.appendCard(new BX.Landing.UI.Card.AddPageCard({siteId:t,onSave:this.addPageSave.bind(this,a,t)}))}n.forEach((t=>{if(!t.IS_AREA||t.IS_AREA&&e.enableAreas){this.appendCard(new BX.Landing.UI.Card.LandingPreviewCard({title:t.TITLE,description:t.DESCRIPTION,preview:t.PREVIEW,onClick:this.onLandingClick.bind(this,t.ID,t.TITLE)}))}}));this.loader.hide()}))}))},createCurrentSiteButton:function(){return new v("current_site",{text:BX.Landing.Loc.getMessage("LANDING_LINKS_PANEL_CURRENT_SITE")})},showBlocks:function(e){var t=e.landingId;var n=e.siteId;void s(this.layout,{width:"880px"});if(!BX.Type.isPlainObject(e.filter)){e.filter={SPECIAL:"N"}}else{e.filter.SPECIAL="N"}BX.Landing.Backend.getInstance().getSites(e).then(function(e){const t=e.map((function(e){return e.ID}),this);return BX.Landing.Backend.getInstance().getLandings({siteId:t}).then((function(t){return e.reduce((function(e,n,i){const a=t.filter((function(e){return n.ID===e.SITE_ID&&!e.IS_AREA}));e[n.ID]={site:n,landings:a};return e}),{})}))}.bind(this)).then(function(i){let a=null;if(i[n]){this.appendSidebarButton(this.createCurrentSiteButton());i[n].landings.forEach((function(n){const i=parseInt(n.ID)===parseInt(t);if(!e.currentPageOnly||i){const e=this.createLandingSidebarButton(n,i);this.appendSidebarButton(e);if(i){a=e}}}),this)}if(!e.currentPageOnly){Object.keys(i).forEach((function(e){if(parseInt(e)!==parseInt(n)){var t=i[e].site;this.appendSidebarButton(this.createSiteSidebarButton(t));i[e].landings.forEach((function(e){const t=this.createLandingSidebarButton(e);this.appendSidebarButton(t);if(!a){a=t}}),this)}}),this)}if(a){a.layout.click()}}.bind(this))},showForms:function(){void s(this.layout,{width:"500px"});BX.Landing.Backend.getInstance().action("Form::getList").then(function(e){e.forEach(function(e){var t={title:e.NAME,className:"landing-ui-card-form-preview",onClick:this.onFormChange.bind(this,e)};if(e.IS_CALLBACK_FORM==="Y"){t.className+=" landing-ui-card-form-preview--callback"}this.appendCard(new BX.Landing.UI.Card.BaseCard(t))}.bind(this));this.loader.hide()}.bind(this))},onFormChange:function(e){this.hide();this.promiseResolve({id:e.ID,type:"crmFormPopup",name:e.NAME})},showPhones:function(){void s(this.layout,{width:"500px"});BX.Landing.Env.getInstance().getOptions().references.forEach(function(e){this.appendCard(new BX.Landing.UI.Card.BaseCard({title:e.text,className:"landing-ui-card-form-preview",onClick:this.onPhoneChange.bind(this,e)}))}.bind(this));this.loader.hide()},onPhoneChange:function(e){this.hide();this.promiseResolve({id:e.value,type:"crmPhone",name:e.text})},createLandingSidebarButton:function(e,t){return new v(e.ID,{text:e.TITLE,onClick:this.onLandingChange.bind(this,e),child:true,active:t})},createSiteSidebarButton:function(e){return new v(e.ID,{text:e.TITLE,child:false,active:false})},onLandingChange:function(e,t){this.currentSelectedLanding=e;this.sidebarButtons.forEach((function(e){if(e.layout===t.currentTarget){e.activate();return}e.deactivate()}));this.showPreviewLoader().then(this.createIframeIfNeed()).then(this.loadPreviewSrc(this.buildLandingPreviewUrl(e))).then(this.hidePreviewLoader())},buildLandingPreviewUrl:function(e){var t=BX.Landing.Main.getInstance().options.params.sef_url.landing_view;t=t.replace("#site_show#",e.SITE_ID);t=t.replace("#landing_edit#",e.ID);return h(t,{landing_mode:"edit"})},loadPreviewSrc:function(e){return function(){return new Promise(function(t){if(this.previewFrame.src!==e){this.previewFrame.src=e;this.previewFrame.onload=function(){var e=this.previewFrame.contentDocument;BX.Landing.Utils.removePanels(e);[].slice.call(e.querySelectorAll(".landing-main .block-wrapper")).forEach((function(e){e.setAttribute("data-selectable",1);e.classList.add("landing-ui-block-selectable-overlay");e.addEventListener("click",function(t){t.preventDefault();var n=e.closest("[data-landing]");var i=BX.Dom.attr(n,"data-landing");this.onBlockClick(parseInt(e.id.replace("block","")),t,i)}.bind(this))}),this);[].slice.call(e.querySelectorAll(".block-wrapper")).forEach((function(e){if(!e.getAttribute("data-selectable")){e.style.display="none"}}),this);[].slice.call(e.querySelectorAll(".landing-empty")).forEach((function(e){e.style.display="none"}),this);t(this.previewFrame)}.bind(this);return}t(this.previewFrame)}.bind(this))}.bind(this)},showPreviewLoader:function(){if(!this.loader){this.loader=new BX.Loader}if(this.previewFrameWrapper){void s(this.previewFrameWrapper,{opacity:0})}return new Promise(function(e){void this.loader.show(this.content);e()}.bind(this))},hidePreviewLoader:function(){return function(){void s(this.previewFrameWrapper,{opacity:null});return this.loader.hide()}.bind(this)},createIframeIfNeed:function(){return function(){new Promise(function(e){if(!this.previewFrame){this.previewFrame=r("iframe",{});this.previewFrameWrapper=r("div",{attrs:{style:"width: 100%; height: 100%; overflow: hidden;"}});this.previewFrameWrapper.appendChild(this.previewFrame);this.content.innerHTML="";this.content.appendChild(this.previewFrameWrapper);this.showPreviewLoader();requestAnimationFrame(function(){var e=this.content.clientWidth-40;void s(this.previewFrame,{width:"1000px",height:"calc((100vh - 113px) * (100 / "+e/1e3*100+"))",transform:"scale("+e/1e3+") translateZ(0)","transform-origin":"top left",border:"none"})}.bind(this))}e(this.previewFrame)}.bind(this))}.bind(this)},onBlockClick:function(e,t,n){if(t.isTrusted){void BX.Landing.Backend.getInstance().getBlocks({landingId:n}).then(function(t){var n=t.find((function(t){return t.id===e}));if(n){this.onChange({type:g,id:n.id,name:n.name,alias:n.alias})}}.bind(this))}},onLandingClick:function(e,t){this.onChange({type:u,id:e,name:t})},onSystemClick:function(e,t){this.onChange({type:L,id:"_"+e,name:t})},onSiteClick:function(e,t,n){this.sidebarButtons.forEach((function(e){if(e.layout===n.currentTarget||!!n.target&&e.layout===n.target.closest(".landing-ui-button")){this.currentSiteButton=e;e.activate()}else{e.deactivate()}}),this);this.content.innerHTML="";this.showLoader();BX.Landing.Backend.getInstance().getLandings({siteId:e}).then(function(i){var a=this.onSiteClick.bind(this,e,t,n);this.appendCard(new BX.Landing.UI.Card.AddPageCard({siteId:e,onSave:this.addPageSave.bind(this,a,e)}));i.forEach((function(e){if(!e.IS_AREA||e.IS_AREA&&t){this.appendCard(this.createLandingPreview(e))}}),this);this.loader.hide()}.bind(this))},addPageSave:function(e,t){this.cache=new BX.Cache.MemoryCache;var n=BX.Landing.Backend.getInstance();n.cache.delete("landings+["+t+"]");n.cache.delete('landings+["'+t+'"]');n.cache.delete("landing+"+t);e()},createLandingPreview:function(e){return new BX.Landing.UI.Card.LandingPreviewCard({title:e.TITLE,description:e.DESCRIPTION,preview:e.PREVIEW,onClick:this.onLandingClick.bind(this,e.ID,e.TITLE)})},createBlockPreview:function(e){return new BX.Landing.UI.Card.BlockHTMLPreview({content:e.id,onClick:this.onBlockClick.bind(this,e.id,e.name,e.alias)})},getLanding:function(e,t){var n=JSON.stringify(["getLanding"+e,t]);return this.cache.remember(n,function(){return BX.Landing.Backend.getInstance().action("Landing::getList",{params:{filter:{ID:e},get_preview:true}}).then(function(e){return e}.bind(this))}.bind(this))},getBlock:function(e){var t="getBlocks"+e;return this.cache.remember(t,function(){return BX.Landing.Backend.getInstance().action("Block::getById",{block:e,params:{edit_mode:true}}).then(function(e){return e}.bind(this))}.bind(this))},onChange:function(e){this.promiseResolve(e);this.hide()},hide:function(){this.previewFrame=null;return BX.Landing.UI.Panel.Content.prototype.hide.call(this)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/panel/top_panel.min.js?169925802111370";s:6:"source";s:40:"/bitrix/js/landing/ui/panel/top_panel.js";s:3:"min";s:44:"/bitrix/js/landing/ui/panel/top_panel.min.js";s:3:"map";s:44:"/bitrix/js/landing/ui/panel/top_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var t=BX.Landing.Utils.removeClass;var n=BX.Landing.Utils.addClass;var e=BX.Landing.Utils.onCustomEvent;var i=BX.Landing.Utils.bind;var a=BX.Landing.Utils.makeFilterablePopupMenu;var s=BX.Landing.Utils.makeSelectablePopupMenu;var o=BX.Landing.Utils.style;var d=BX.Landing.Utils.encodeDataValue;BX.Landing.UI.Panel.Top=function(t,n){BX.Landing.UI.Panel.BasePanel.apply(this,arguments);this.layout=document.querySelector(".landing-ui-panel-top");this.siteButton=this.layout.querySelector(".landing-ui-panel-top-chain-link-site");this.pageButton=this.layout.querySelector(".landing-ui-panel-top-chain-link-page");this.undoButton=this.layout.querySelector(".landing-ui-panel-top-history-undo");this.redoButton=this.layout.querySelector(".landing-ui-panel-top-history-redo");this.desktopButton=this.layout.querySelector(".landing-ui-button-desktop");this.tabletButton=this.layout.querySelector(".landing-ui-button-tablet");this.mobileButton=this.layout.querySelector(".landing-ui-button-mobile");this.iframeWrapper=document.querySelector(".landing-ui-view-iframe-wrapper");this.iframe=document.querySelector(".landing-ui-view");this.lastActive=this.desktopButton;this.loader=null;this.onDesktopSizeChange=this.onDesktopSizeChange.bind(this);this.onTabletSizeChange=this.onTabletSizeChange.bind(this);this.onMobileSizeChange=this.onMobileSizeChange.bind(this);this.onIframeClick=this.onIframeClick.bind(this);this.onSiteButtonClick=this.onSiteButtonClick.bind(this);this.onPageButtonClick=this.onPageButtonClick.bind(this);this.onUndo=this.onUndo.bind(this);this.onRedo=this.onRedo.bind(this);this.onKeyDown=this.onKeyDown.bind(this);this.adjustHistoryButtonsState=this.adjustHistoryButtonsState.bind(this);i(this.desktopButton,"click",this.onDesktopSizeChange);i(this.tabletButton,"click",this.onTabletSizeChange);i(this.mobileButton,"click",this.onMobileSizeChange);i(this.iframe.contentDocument,"click",this.onIframeClick);i(this.undoButton,"click",this.onUndo);i(this.redoButton,"click",this.onRedo);i(document,"keydown",this.onKeyDown);e(document,"iframe:keydown",this.onKeyDown);e(window,"BX.Landing.History:init",this.adjustHistoryButtonsState);e(window,"BX.Landing.History:update",this.adjustHistoryButtonsState);var a=parseInt(BX.Landing.Main.getInstance().options.sites_count);var s=parseInt(BX.Landing.Main.getInstance().options.pages_count);if(a>1&&this.siteButton){i(this.siteButton,"click",this.onSiteButtonClick)}if(s>1&&this.pageButton){i(this.pageButton,"click",this.onPageButtonClick)}var o=BX.Landing.PageObject.getRootWindow();var d=o.BX.getClass("BX.Landing.History");if(d){o.BX.Landing.History.instance=null}BX.Landing.History.getInstance()};BX.Landing.UI.Panel.Top.instance=null;BX.Landing.UI.Panel.Top.getInstance=function(){var t=BX.Landing.PageObject.getRootWindow();if(!t.BX.Landing.UI.Panel.Top.instance){t.BX.Landing.UI.Panel.Top.instance=new BX.Landing.UI.Panel.Top("top_panel")}return t.BX.Landing.UI.Panel.Top.instance};BX.Landing.UI.Panel.Top.prototype={constructor:BX.Landing.UI.Panel.Top,__proto__:BX.Landing.UI.Panel.BasePanel.prototype,superclass:BX.Landing.UI.Panel.BasePanel.prototype,onKeyDown:function(t){var n=t.keyCode||t.which;if(n===90&&(window.navigator.userAgent.match(/win/i)?t.ctrlKey:t.metaKey)){var e=BX.Landing.PageObject.getRootWindow();var i=e.BX.Reflection.getClass("BX.Landing.UI.Panel.FormSettingsPanel");if(!i||!i.getInstance().isShown()){if(t.shiftKey){t.preventDefault();this.onRedo()}else{t.preventDefault();this.onUndo()}}}},onUndo:function(){if(BX.Landing.History.getInstance().canUndo()&&!this.undoButton.hasAttribute("data-disabled")){this.getLoader().show(this.undoButton);n(this.undoButton,"landing-ui-onload");BX.Landing.History.getInstance().undo().then(function(){this.getLoader().hide();t(this.undoButton,"landing-ui-onload")}.bind(this))}else{this.getLoader().hide();t(this.undoButton,"landing-ui-onload")}},onRedo:function(){if(BX.Landing.History.getInstance().canRedo()&&!this.redoButton.hasAttribute("data-disabled")){this.getLoader().show(this.redoButton);n(this.redoButton,"landing-ui-onload");BX.Landing.History.getInstance().redo().then(function(){this.getLoader().hide();t(this.redoButton,"landing-ui-onload")}.bind(this))}else{this.getLoader().hide();t(this.redoButton,"landing-ui-onload")}},getLoader:function(){if(this.loader===null){this.loader=new BX.Loader({size:23,offset:{top:"3px",left:"1px"}});void o(this.loader.layout.querySelector(".main-ui-loader-svg-circle"),{"stroke-width":"4px"});void o(this.loader.layout.querySelector(".main-ui-loader-svg"),{"margin-top":"-3px"})}return this.loader},adjustHistoryButtonsState:function(t){if(t.canUndo()){this.undoButton.classList.remove("landing-ui-disabled");this.undoButton.removeAttribute("data-disabled")}else{this.undoButton.classList.add("landing-ui-disabled")}if(t.canRedo()){this.redoButton.classList.remove("landing-ui-disabled");this.redoButton.removeAttribute("data-disabled")}else{this.redoButton.classList.add("landing-ui-disabled")}},disableHistory:function(){this.undoButton.classList.add("landing-ui-disabled");this.undoButton.setAttribute("data-disabled","");this.redoButton.classList.add("landing-ui-disabled");this.redoButton.setAttribute("data-disabled","")},enableHistory:function(){this.adjustHistoryButtonsState(BX.Landing.History.getInstance())},disableDevices:function(){this.desktopButton.classList.add("landing-ui-disabled");this.tabletButton.classList.add("landing-ui-disabled");this.mobileButton.classList.add("landing-ui-disabled")},enableDevices:function(){this.desktopButton.classList.remove("landing-ui-disabled");this.tabletButton.classList.remove("landing-ui-disabled");this.mobileButton.classList.remove("landing-ui-disabled")},onDesktopSizeChange:function(){this.lastActive.classList.remove("active");this.lastActive=this.desktopButton;this.desktopButton.classList.add("active");BX.DOM.write(function(){this.iframeWrapper.style.width=null}.bind(this));document.body.setAttribute("data-device","desktop");BX.Landing.Main.getInstance().setDeviceCode("desktop");this.iframeWrapper.dataset.postfix="";BX.Landing.Main.getInstance().enableControls();BX.Landing.Main.getInstance().setNoTouchDevice();BX.Landing.Main.getInstance().makeControlsInternal();BX.Landing.UI.Panel.StylePanel.getInstance().hide();BX.onCustomEvent("BX.Landing.Main:editorSizeChange",["desktop"])},onTabletSizeChange:function(){this.lastActive.classList.remove("active");this.lastActive=this.tabletButton;this.tabletButton.classList.add("active");BX.DOM.write(function(){this.iframeWrapper.style.width="990px"}.bind(this));document.body.setAttribute("data-device","tablet");BX.Landing.Main.getInstance().setDeviceCode("tablet");this.iframeWrapper.dataset.postfix="--md";BX.Landing.Main.getInstance().setTouchDevice();BX.Landing.Main.getInstance().makeControlsInternal();BX.Landing.UI.Panel.StylePanel.getInstance().hide();BX.onCustomEvent("BX.Landing.Main:editorSizeChange",["tablet"])},onMobileSizeChange:function(){this.lastActive.classList.remove("active");this.lastActive=this.mobileButton;this.mobileButton.classList.add("active");BX.DOM.write(function(){this.iframeWrapper.style.width="375px"}.bind(this));document.body.setAttribute("data-device","mobile");BX.Landing.Main.getInstance().setDeviceCode("mobile");this.iframeWrapper.dataset.postfix="--md";BX.Landing.Main.getInstance().setTouchDevice();BX.Landing.Main.getInstance().makeControlsExternal();BX.Landing.UI.Panel.StylePanel.getInstance().hide();BX.onCustomEvent("BX.Landing.Main:editorSizeChange",["mobile"])},onSiteButtonClick:function(t){t.preventDefault();if(!this.siteMenu){var n=new BX.Loader({size:40});this.siteMenu=new BX.PopupMenuWindow({id:"site_list_menu",bindElement:this.siteButton,events:{onPopupClose:function(){this.siteButton.classList.remove("landing-ui-active");this.siteButton.blur()}.bind(this)},menuShowDelay:0,offsetTop:9});this.siteMenu.popupWindow.contentContainer.style.minHeight="60px";this.siteMenu.popupWindow.contentContainer.style.minWidth="160px";n.show(this.siteMenu.popupWindow.contentContainer);var e={siteId:BX.Landing.Main.getInstance().options.site_id,landingId:BX.Landing.Main.getInstance().id,filter:{"=TYPE":BX.Landing.Main.getInstance().options.params.type,SPECIAL:"N"}};BX.Landing.Backend.getInstance().getSites(e).then((function(t){return new Promise((function(n){setTimeout(n.bind(null,t),300)}))})).then(function(t){a(this.siteMenu);s(this.siteMenu);t.forEach((function(t){this.siteMenu.addMenuItem({id:t.ID,text:d(t.TITLE),items:function(){var n=[];var e=BX.Landing.Main.getInstance().options.params.sef_url.site_edit;var i=BX.Landing.Main.getInstance().options.params.sef_url.site_show;n.push({text:BX.Landing.Loc.getMessage("LANDING_ENTITIES_MENU_PAGES_LIST"),href:i.replace("#site_show#",t.ID)});n.push({text:BX.Landing.Loc.getMessage("LANDING_ENTITIES_MENU_EDIT"),href:e.replace("#site_edit#",t.ID)});return n}()})}),this);n.hide()}.bind(this))}this.siteButton.classList.add("landing-ui-active");this.siteMenu.show()},onPageButtonClick:function(t){t.preventDefault();if(!this.pageMenu){var n=new BX.Loader({size:40});this.pageMenu=new BX.PopupMenuWindow({id:"page_list_menu",bindElement:this.pageButton,events:{onPopupClose:function(){this.pageButton.classList.remove("landing-ui-active");this.pageButton.blur()}.bind(this)},menuShowDelay:0,offsetTop:9});this.pageMenu.popupWindow.contentContainer.style.minHeight="60px";this.pageMenu.popupWindow.contentContainer.style.minWidth="160px";n.show(this.pageMenu.popupWindow.contentContainer);var e={siteId:BX.Landing.Main.getInstance().options.site_id,landingId:BX.Landing.Main.getInstance().id,filter:{"=TYPE":BX.Landing.Main.getInstance().options.params.type}};BX.Landing.Backend.getInstance().getLandings({siteId:e.siteId}).then((function(t){return new Promise((function(n){setTimeout(n.bind(null,t),300)}))})).then(function(t){a(this.pageMenu);s(this.pageMenu);t.forEach((function(t){if((t.FOLDER_ID===null||parseInt(t.FOLDER_ID)===0)&&!t.IS_AREA){this.pageMenu.addMenuItem({id:t.ID,text:d(t.TITLE),items:function(){var n=[];var e=BX.Landing.Main.getInstance().options.params.sef_url.landing_edit;var i=BX.Landing.Main.getInstance().options.params.sef_url.landing_view;if(t.FOLDER==="Y"){var a=BX.Landing.Main.getInstance().options.params.sef_url.site_show;n.push({text:BX.Landing.Loc.getMessage("LANDING_ENTITIES_MENU_PAGES_LIST"),href:BX.Landing.Utils.addQueryParams(a.replace("#site_show#",t.SITE_ID),{folderId:t.ID})})}n.push({text:BX.Landing.Loc.getMessage("LANDING_ENTITIES_MENU_PAGES_EDIT"),href:i.replace("#site_show#",t.SITE_ID).replace("#landing_edit#",t.ID)});n.push({text:BX.Landing.Loc.getMessage("LANDING_ENTITIES_MENU_PAGES_SETTINGS"),href:e.replace("#site_show#",t.SITE_ID).replace("#landing_edit#",t.ID)});return n}()})}}),this);requestAnimationFrame((function(){n.hide()}))}.bind(this))}this.pageButton.classList.add("landing-ui-active");this.pageMenu.show()},onIframeClick:function(){if(this.siteMenu){this.siteMenu.close()}if(this.pageMenu){this.pageMenu.close()}},getFormNameLayout:function(){return this.layout.querySelector(".landing-ui-panel-top-form-name")},setFormName:function(t){if(BX.Type.isString(t)){var n=this.getFormNameLayout();if(BX.Type.isDomNode(n)){n.firstElementChild.textContent=t;n.firstElementChild.setAttribute("title",t)}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:57:"/bitrix/js/landing/ui/panel/card_action.js?16992580222386";s:6:"source";s:42:"/bitrix/js/landing/ui/panel/card_action.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI.Panel");


	/**
	 * Implements interface for works with card actions panel
	 *
	 * @extends {BX.Landing.UI.Panel.BaseButtonPanel}
	 *
	 * @inheritDoc
	 * @constructor
	 */
	BX.Landing.UI.Panel.CardAction = function(id, data)
	{
		BX.Landing.UI.Panel.BaseButtonPanel.apply(this, arguments);
		adjustPanelSize(this);
	};


	/**
	 * Gets element rect
	 * @param {HTMLElement} element
	 * @returns {ClientRect|{left, top, width, height}}
	 */
	function rect(element)
	{
		return element.getBoundingClientRect();
	}


	/**
	 * Checks that size is extra small
	 * @param {ClientRect} rect
	 * @return {boolean}
	 */
	function isXS(rect)
	{
		return rect.height < 100;
	}


	/**
	 * @param {ClientRect} cardRect
	 * @param {ClientRect} panelRect
	 * @return {boolean}
	 */
	function isLeft(cardRect, panelRect)
	{
		return cardRect.width < panelRect.width;
	}


	/**
	 * Gets rect diff
	 * @param cardRect
	 * @param panelRect
	 * @return {{width: number, height: number, top: number, right: number, bottom: number, left: number}}
	 */
	function diffRect(cardRect, panelRect)
	{
		return {
			width: Math.abs(cardRect.width - panelRect.width),
			height: Math.abs(cardRect.height - panelRect.height),
			top: Math.abs(cardRect.top - panelRect.top),
			right: Math.abs(cardRect.right - panelRect.right),
			bottom: Math.abs(cardRect.bottom - panelRect.bottom),
			left: Math.abs(cardRect.left - panelRect.left)
		}
	}


	/**
	 * Adjusts panel size
	 * @param panel
	 */
	function adjustPanelSize(panel)
	{
		BX.DOM.read(function() {
			if (panel.layout && panel.layout.parentNode)
			{
				var cardRect = rect(panel.layout.parentNode);
				var sizeClassName = "landing-ui-size-lg";

				if (isXS(cardRect))
				{
					sizeClassName = "landing-ui-size-xs";
				}

				BX.DOM.write(function() {
					panel.layout.classList.add(sizeClassName);

					BX.DOM.read(function() {
						var panelRect = rect(panel.layout);
						var left = "auto";

						if (isLeft(cardRect, panelRect))
						{
							left = -(diffRect(cardRect, panelRect).width / 2)
						}

						BX.DOM.write(function() {
							panel.layout.style.left = left + "px";
						});
					});
				});
			}
		});
	}


	BX.Landing.UI.Panel.CardAction.prototype = {
		constructor: BX.Landing.UI.Panel.CardAction,
		__proto__: BX.Landing.UI.Panel.BaseButtonPanel.prototype
	}
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/panel/link_panel.min.js?16992580214116";s:6:"source";s:41:"/bitrix/js/landing/ui/panel/link_panel.js";s:3:"min";s:45:"/bitrix/js/landing/ui/panel/link_panel.min.js";s:3:"map";s:45:"/bitrix/js/landing/ui/panel/link_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var n=BX.Landing.Utils.attr;var e=BX.Landing.Utils.join;var t=BX.Landing.Utils.random;var i=BX.Landing.Utils.setTextContent;var a=BX.Landing.Utils.isPlainObject;var s=BX.Landing.Utils.isString;var d=BX.Landing.Utils.textToPlaceholders;var l=BX.Landing.Utils.findParent;var o=BX.Landing.Utils.escapeText;BX.Landing.UI.Panel.Link=function(n,e){BX.Landing.UI.Panel.Content.apply(this,arguments);this.layout.classList.add("landing-ui-panel-link");this.overlay.classList.add("landing-ui-panel-link");this.appendFooterButton(new BX.Landing.UI.Button.BaseButton("save_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_SAVE"),onClick:this.save.bind(this),className:"landing-ui-button-content-save"}));this.appendFooterButton(new BX.Landing.UI.Button.BaseButton("cancel_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_CANCEL"),onClick:this.hide.bind(this),className:"landing-ui-button-content-cancel"}));window.parent.document.body.appendChild(this.layout)};BX.Landing.UI.Panel.Link.instance=null;BX.Landing.UI.Panel.Link.getInstance=function(){if(!BX.Landing.UI.Panel.Link.instance){BX.Landing.UI.Panel.Link.instance=new BX.Landing.UI.Panel.Link("link_panel",{title:BX.Landing.Loc.getMessage("LANDING_EDIT_LINK")})}return BX.Landing.UI.Panel.Link.instance};BX.Landing.UI.Panel.Link.prototype={constructor:BX.Landing.UI.Panel.Link,__proto__:BX.Landing.UI.Panel.Content.prototype,show:function(n){var e;this.title.innerHTML=BX.Landing.Loc.getMessage("LANDING_EDIT_LINK");if(!!n&&n instanceof BX.Landing.Block.Node.Link){this.node=n;e=new BX.Landing.UI.Form.BaseForm({title:this.node.manifest.name});this.field=this.node.getField();e.addField(this.field);this.clear();this.appendForm(e);this.checkReadyToSave();BX.Landing.UI.Panel.Content.prototype.show.call(this);BX.Landing.UI.Panel.EditorPanel.getInstance().hide()}if(!!n&&(n instanceof BX.Landing.Block.Node.Text||n instanceof BX.Landing.UI.Field.Text)){this.range=this.contextDocument.getSelection().getRangeAt(0);this.node=n;this.textField=BX.Landing.UI.Field.BaseField.currentField;if(!!this.textField&&this.textField.isEditable()){this.node=this.textField}var t=this.range.cloneContents().querySelector("a");if(!t){t=l(this.range.startContainer,{tagName:"A"})}var i="";var a="";if(t){i=t.getAttribute("href");a=t.getAttribute("target")||"_self"}else{this.title.innerHTML=BX.Landing.Loc.getMessage("LANDING_CREATE_LINK")}e=new BX.Landing.UI.Form.BaseForm({title:""});BX.remove(e.header);var s=[BX.Landing.UI.Field.LinkUrl.TYPE_BLOCK,BX.Landing.UI.Field.LinkUrl.TYPE_PAGE];if(BX.Landing.Main.getInstance().options.params.type==="STORE"){s.push(BX.Landing.UI.Field.LinkUrl.TYPE_CATALOG)}this.field=new BX.Landing.UI.Field.Link({title:BX.Landing.Loc.getMessage("FIELD_LINK_TEXT_LABEL"),content:{text:d(o(t?t.innerText:this.range.toString())),href:o(i),target:o(a)},options:{siteId:BX.Landing.Main.getInstance().options.site_id,landingId:BX.Landing.Main.getInstance().id,filter:{"=TYPE":BX.Landing.Main.getInstance().options.params.type}},allowedTypes:s});e.addField(this.field);this.clear();this.appendForm(e);this.checkReadyToSave();BX.Landing.UI.Panel.Content.prototype.show.call(this)}},save:function(){if(this.field.isChanged()){if(!!this.node&&this.node instanceof BX.Landing.Block.Node.Link){this.node.setValue(this.field.getValue())}else{var d=this.field.getValue();this.contextDocument.getSelection().removeAllRanges();this.contextDocument.getSelection().addRange(this.range);this.node.enableEdit();var l=o(e(d.href,t()));var g=this.contextDocument.getSelection();this.contextDocument.execCommand("createLink",false,l);var r=g.anchorNode.parentElement.parentElement.parentElement.querySelector(e('[href="',l,'"]'));if(r){n(r,"href",d.href);n(r,"target",d.target);if(s(d.text)){if(d.text.includes("{{name}}")){this.field.hrefInput.getPlaceholderData(d.href).then(function(n){r.innerHTML=d.text.replace(new RegExp("{{name}}"),'<span data-placeholder="name">'+n.name+"</span>")}.bind(this))}else{i(r,d.text)}}if(a(d.attrs)){n(r,d.attrs)}}}}this.hide()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:69:"/bitrix/js/landing/ui/panel/google_fonts_panel.min.js?169925802113021";s:6:"source";s:49:"/bitrix/js/landing/ui/panel/google_fonts_panel.js";s:3:"min";s:53:"/bitrix/js/landing/ui/panel/google_fonts_panel.min.js";s:3:"map";s:53:"/bitrix/js/landing/ui/panel/google_fonts_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var e=BX.Landing.Utils.addClass;var t=BX.Landing.Utils.proxy;var n=BX.Landing.Utils.append;var i=BX.Landing.Utils.slice;var s=BX.Landing.Utils.clone;var a=BX.Landing.Utils.bind;var o=["A red flare silhouetted the jagged edge of a wing","I watched the storm, so beautiful yet terrific","Almost before we knew it, we had left the ground","Waves flung themselves at the blue evening","A shining crescent far beneath the flying vessel"];var r=["&#x0423;&#x0442;&#x0440;&#x0435;&#x043D;&#x043D;&#x0435;&#x0435; &#x0441;&#x043E;&#x043B;&#x043D;&#x0446;&#x0435; &#x044F;&#x0440;&#x043A;&#x043E; &#x043E;&#x0441;&#x0432;&#x0435;&#x0442;&#x0438;&#x043B;&#x043E; &#x043F;&#x043E;&#x043B;&#x044F;&#x043D;&#x0443; &#x0438; &#x043B;&#x0435;&#x0441;","&#x041F;&#x0440;&#x0438;&#x043B;&#x0435;&#x0442;&#x0435;&#x0432;&#x0448;&#x0438;&#x0435; &#x043F;&#x0442;&#x0438;&#x0446;&#x044B; &#x0437;&#x0430;&#x043D;&#x044F;&#x043B;&#x0438; &#x0432;&#x0435;&#x0441;&#x044C; &#x0441;&#x043A;&#x0430;&#x043B;&#x0438;&#x0441;&#x0442;&#x044B;&#x0439; &#x0431;&#x0435;&#x0440;&#x0435;&#x0433;","&#x0411;&#x043E;&#x0434;&#x0440;&#x044F;&#x0449;&#x0438;&#x0439; &#x043C;&#x043E;&#x0440;&#x0441;&#x043A;&#x043E;&#x0439; &#x0432;&#x043E;&#x0437;&#x0434;&#x0443;&#x0445; &#x0431;&#x044B;&#x043B; &#x043F;&#x0440;&#x043E;&#x0445;&#x043B;&#x0430;&#x0434;&#x0435;&#x043D; &#x0438; &#x0441;&#x0432;&#x0435;&#x0436;","&#x042D;&#x0442;&#x043E; &#x043B;&#x0443;&#x0447;&#x0448;&#x0435;&#x0435;, &#x0447;&#x0442;&#x043E; &#x043C;&#x043E;&#x0433;&#x043B;&#x043E; &#x0441; &#x043D;&#x0438;&#x043C; &#x043F;&#x0440;&#x043E;&#x0438;&#x0437;&#x043E;&#x0439;&#x0442;&#x0438; &#x0432; &#x043D;&#x043E;&#x0432;&#x043E;&#x043C; &#x0433;&#x043E;&#x0440;&#x043E;&#x0434;&#x0435;","&#x041D;&#x043E;&#x0432;&#x0430;&#x044F; &#x043A;&#x043D;&#x0438;&#x0433;&#x0430; &#x043E;&#x043A;&#x0430;&#x0437;&#x0430;&#x043B;&#x0430;&#x0441;&#x044C; &#x0438;&#x043D;&#x0442;&#x0435;&#x0440;&#x0435;&#x0441;&#x043D;&#x043E;&#x0439; &#x0438; &#x043F;&#x043E;&#x0437;&#x043D;&#x0430;&#x0432;&#x0430;&#x0442;&#x0435;&#x043B;&#x044C;&#x043D;&#x043E;&#x0439;"];var l="&#1576;&#1591;&#1575;&#1576;&#1593; &#1571;&#1581;&#1605;&#1585; &#1575;&#1585;&#1578;&#1587;&#1605;&#1578; &#1589;&#1608;&#1585;&#1577; &#1592;&#1604;&#1610;&#1617;&#1577; &#1604;&#1581;&#1583;&#1608;&#1583; &#1575;&#1604;&#1580;&#1606;&#1575;&#1581; &#1575;&#1604;&#1605;&#1587;&#1606;&#1606;&#1577;.";var h="&#1492;&#1496;&#1489;&#1506; &#1492;&#1488;&#1495;&#1491; &#1513;&#1500;&#1497; &#1493;&#1492;&#1496;&#1489;&#1506; &#1492;&#1488;&#1495;&#1512; &#1495;&#1500;&#1511;&#1493; &#1494;&#1497;&#1499;&#1512;&#1493;&#1503; &#1502;&#1513;&#1493;&#1514;&#1507;.";var u="&#45208;&#45716; &#54253;&#54413;&#51012; &#51648;&#53020;&#48372;&#50520;&#45796;. &#45320;&#47924;&#45208; &#50500;&#47492;&#45796;&#50864;&#47732;&#49436;&#46020; &#50628;&#52397;&#45212; &#54253;&#54413;&#51012;.";var g=new WeakSet;BX.Landing.UI.Panel.GoogleFonts=function(){BX.Landing.UI.Panel.Content.apply(this,["google-fonts-panel",{title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_TITLE")}]);this.pangramIndex=-1;e(this.layout,"landing-ui-panel-google-fonts");e(this.overlay,"landing-ui-panel-google-fonts-overlay");this.client=new BX.Landing.Client.GoogleFonts;var t=BX.Landing.PageObject.getRootWindow();var i=t.document.body.querySelector(".landing-ui-view-container");n(this.layout,i);n(this.overlay,i);this.searchForm=this.createSearchForm();this.categoryForm=this.createCategoryForm();this.languageForm=this.createLanguageForm();n(this.searchForm.layout,this.sidebar);n(this.categoryForm.layout,this.sidebar);n(this.languageForm.layout,this.sidebar);n(this.createListLayout(),this.content);n(this.createPaginationLayout(),this.content);BX.Event.bind(this.getMoreButton(),"click",this.onMoreButtonClick.bind(this))};BX.Landing.UI.Panel.GoogleFonts.getInstance=function(){return BX.Landing.UI.Panel.GoogleFonts.instance||(BX.Landing.UI.Panel.GoogleFonts.instance=new BX.Landing.UI.Panel.GoogleFonts)};BX.Landing.UI.Panel.GoogleFonts.prototype={constructor:BX.Landing.UI.Panel.GoogleFonts,__proto__:BX.Landing.UI.Panel.Content.prototype,superclass:BX.Landing.UI.Panel.Content.prototype,createListLayout:function(){return BX.Dom.create({tag:"div",props:{classList:"landing-ui-panel-fonts-list"}})},getListLayout:function(){return this.content.querySelector(".landing-ui-panel-fonts-list")},createPaginationLayout:function(){return BX.Dom.create({tag:"div",props:{classList:"landing-ui-panel-fonts-pagination"},children:[BX.Dom.create({tag:"span",props:{className:"ui-btn ui-btn-lg ui-btn-light-border"},text:BX.Landing.Loc.getMessage("LANDING_FONTS_PANEL_MORE_BUTTON_LABEL")})]})},getMoreButton:function(){return this.getPaginationLayout().querySelector(".ui-btn")},getPaginationLayout:function(){return this.content.querySelector(".landing-ui-panel-fonts-pagination")},show:function(e){var n=this.superclass.show.call(this);n.then(function(){this.searchForm.fields[0].enableEdit();this.searchForm.fields[0].input.focus()}.bind(this));if(this.isFontsLoaded()){return n.then(t(this.saveResolver,this))}if(e){if(e["hideOverlay"]){this.overlay.style.display="none"}if(e["context"]){this.context=e["context"]}}this.page=0;BX.Dom.hide(this.getMoreButton());return n.then(function(){return this.showLoader()}.bind(this)).then(function(){return this.getFonts()}.bind(this)).then(function(e){return this.applyFilter(e)}.bind(this)).then(function(e){var t=this.paginateList(e);return this.loadFonts(t[this.page]||[])}.bind(this)).then(function(e){return this.renderList(e)}.bind(this)).then(function(){BX.Dom.show(this.getMoreButton());return this.hideLoader()}.bind(this)).then(function(){return this.saveResolver()}.bind(this))},onMoreButtonClick:function(e){e.preventDefault();this.page+=1;void this.showLoader();var t=this.getMoreButton();BX.Dom.addClass(t,"ui-btn-wait");BX.Dom.style(t,"pointer-events","none");var n=false;this.getFonts().then(function(e){return this.applyFilter(e)}.bind(this)).then(function(e){var t=this.paginateList(e);n=t.length-1<=this.page;return this.loadFonts(t[this.page]||[])}.bind(this)).then(function(e){return this.renderList(e)}.bind(this)).then(function(){BX.Dom.removeClass(this.getMoreButton(),"ui-btn-wait");BX.Dom.style(t,"pointer-events",null);if(n){BX.Dom.hide(t)}return this.hideLoader()}.bind(this))},saveResolver:function(){var e=this;return new Promise((function(t){e.resolver=t}))},getFonts:function(){if(this.response){return Promise.resolve(this.response)}return this.client.getList().then(t(this.saveResponse,this))},paginateList:function(e){var t=[];while(e.length){t.push(e.splice(0,21))}return t},saveResponse:function(e){return this.response=e},isFontsLoaded:function(){return!!this.response},showLoader:function(){if(!this.loader){this.loader=new BX.Loader({target:this.body,offset:{left:"134px",top:"-30px"}})}BX.Dom.style(this.sidebar,{transition:"200ms all ease",opacity:.8,"pointer-events":"none"});this.loader.show();return Promise.resolve()},hideLoader:function(){if(this.loader){this.loader.hide()}BX.Dom.style(this.sidebar,{transition:null,opacity:null,"pointer-events":null});return Promise.resolve()},loadFonts:function(e){var t;if(this.context){t=this.context}else{t=BX.Landing.PageObject.getRootWindow()}return new Promise((function(n){if(!BX.Type.isArrayFilled(e)){n(e)}else{WebFont.load({google:{families:e.map((function(e){return e.family.replace(/ /g,"+")}))},context:t,classes:false,active:function(){var t=BX.Landing.PageObject.getRootWindow();if(t.document.fonts){t.document.fonts.ready.then((function(){n(e)}))}else{setTimeout(n,3e3,e)}}})}}))},applyFilter:function(e){var t=this.searchForm.fields[0].getValue();var n=this.languageForm.fields[0].getValue();var i=this.categoryForm.fields[0].getValue();if(!BX.Type.isArrayFilled(i)){i=this.categoryForm.fields[0].items.map((function(e){return e.value}))}return e.filter((function(e){return n.every((function(t){return e.subsets.indexOf(t)!==-1}))&&i.some((function(t){return t===e.category}))&&(!BX.Type.isStringFilled(t)||String(e.family).toLowerCase().includes(String(t).toLowerCase()))}))},createListItem:function(e){var t=this.languageForm.fields[0].getValue();var n="";var i="ltr";var s="left";this.pangramIndex+=1;this.pangramIndex=this.pangramIndex>4?0:this.pangramIndex;if(t.includes("latin")){n=o[this.pangramIndex]}if(t.includes("cyrillic")){n=r[this.pangramIndex]}if(t.includes("arabic")){i="rtl";s="right";n=l}if(t.includes("hebrew")){i="rtl";s="right";n=h}if(t.includes("korean")){n=u}return'<div class="landing-ui-font-preview">'+'<div class="landing-ui-font-preview-font-name">'+e.family+"</div>"+'<div class="landing-ui-font-preview-font-button">'+'<span class="ui-btn ui-btn-xs ui-btn-light-border ui-btn-round">'+BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_SELECT_BUTTON")+"</span>"+"</div>"+'<div style="font-family: '+e.family+"; direction: "+i+"; text-align: "+s+';" class="landing-ui-font-preview-pangram" contenteditable="true" onpaste="return false;">'+n+"</div>"+"</div>"},onFilterChange:function(){void this.showLoader();this.page=0;var e=false;this.getFonts().then(function(e){return this.applyFilter(e)}.bind(this)).then(function(t){var n=this.paginateList(t);e=n.length<=1;return this.loadFonts(n[this.page]||[])}.bind(this)).then(function(t){this.content.scrollTop=0;void this.hideLoader();if(e){BX.Dom.hide(this.getMoreButton())}else{BX.Dom.show(this.getMoreButton())}return this.renderList(t,true)}.bind(this))},renderList:function(e,t){return this.renderItems(e,t)},renderItems:function(e,t){if(!t){this.getListLayout().insertAdjacentHTML("beforeend",e.map(this.createListItem,this).join(""))}else{if(!BX.Type.isArrayFilled(e)&&BX.Type.isStringFilled(this.searchForm.fields[0].getValue())){this.getListLayout().innerHTML="";BX.Dom.append(this.getEmptyStub(),this.getListLayout())}else{this.getListLayout().innerHTML=e.map(this.createListItem,this).join("")}}i(this.getListLayout().children).forEach(this.initItem(e),this)},getEmptyStub:function(){return BX.Dom.create({tag:"div",props:{className:"landing-ui-fonts-panel-empty-stub"},text:BX.Landing.Loc.getMessage("LANDING_FONTS_PANEL_EMPTY_STUB")})},initItem:function(e){return function(t,n){if(!g.has(t)){const a=t.querySelector(".landing-ui-font-preview-font-button");BX.Event.bind(a,"click",this.onFontSelect.bind(this,e[n-this.page*21]));g.add(t);var i=t.querySelector(".landing-ui-font-preview-pangram");if(i){var s=i.innerText;BX.Event.bind(i,"blur",(function(){if(!BX.Type.isStringFilled(i.innerText)){i.innerText=s}}))}}}},getListItems:function(){return i(this.content.querySelectorAll(".landing-ui-font-preview.cell"))},createSearchForm:function(){var e=BX.Runtime.debounce(this.onFilterChange,500,this);return new BX.Landing.UI.Form.StyleForm({title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_SEARCH_TITLE"),fields:[new BX.Landing.UI.Field.Text({selector:"searchQuery",textOnly:true,onValueChange:function(){void this.showLoader();e()}.bind(this),placeholder:BX.Loc.getMessage("LANDING_GOOGLE_FONT_SEARCH_PLACEHOLDER")})]})},createLanguageForm:function(){var e=new BX.Landing.UI.Form.StyleForm({title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_FORM_TITLE")});var n=new BX.Landing.UI.Factory.FieldFactory({onValueChange:t(this.onFilterChange,this)});var i=window.location.host.includes(".ru");e.addField(n.create({type:"radio",items:[{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_CYRILLIC"),value:"cyrillic",checked:i},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_LATIN"),value:"latin",checked:!i},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_ARABIC"),value:"arabic"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_HEBREW"),value:"hebrew"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_LANGUAGE_KOREAN"),value:"korean"}]}));return e},createCategoryForm:function(){var e=new BX.Landing.UI.Form.StyleForm({title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_FORM_TITLE")});var n=new BX.Landing.UI.Factory.FieldFactory({onValueChange:t(this.onFilterChange,this)});e.addField(n.create({type:"checkbox",items:[{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_SANS_SERIF_2"),value:"sans-serif"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_SERIF_2"),value:"serif"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_DISPLAY"),value:"display"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_HANDWRITING"),value:"handwriting"},{name:BX.Landing.Loc.getMessage("LANDING_GOOGLE_FONT_PANEL_CATEGORY_MONOSPACE"),value:"monospace"}]}));return e},onFontSelect:function(e){this.selectedFont=e;this.onApply()},onApply:function(){if(this.resolver){var e=s(this.selectedFont);e.subset=this.languageForm.fields[0].getValue();this.hide().then(this.resolver.bind(null,e))}},onCancel:function(){this.hide()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:78:"/bitrix/js/landing/ui/panel/google_images_settings_panel.min.js?16992580212137";s:6:"source";s:59:"/bitrix/js/landing/ui/panel/google_images_settings_panel.js";s:3:"min";s:63:"/bitrix/js/landing/ui/panel/google_images_settings_panel.min.js";s:3:"map";s:63:"/bitrix/js/landing/ui/panel/google_images_settings_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");BX.Landing.UI.Panel.GoogleImagesSettings=function(){BX.Landing.UI.Panel.Content.apply(this,["google_images_settings",{title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_IMAGES_KEY_PANEL_TITLE"),footer:[new BX.Landing.UI.Button.BaseButton("save_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_SAVE"),onClick:this.onSaveClick.bind(this),className:"landing-ui-button-content-save",attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_SLIDER_SAVE")}}),new BX.Landing.UI.Button.BaseButton("cancel_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_CANCEL"),onClick:this.onCancelClick.bind(this),className:"landing-ui-button-content-cancel",attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_SLIDER_CANCEL")}})]}]);this.layout.style.width="496px";this.layout.style.zIndex="600";this.overlay.style.zIndex="599";this.settingsForm=new BX.Landing.UI.Form.BaseForm;this.keyField=new BX.Landing.UI.Field.Text({title:BX.Landing.Loc.getMessage("LANDING_GOOGLE_IMAGES_KEY_FIELD_TITLE"),textOnly:true,description:BX.Landing.Loc.getMessage("LANDING_GOOGLE_IMAGES_GET_KEY_GUIDE"),content:BX.Landing.Client.Google.key});this.settingsForm.addField(this.keyField);this.appendForm(this.settingsForm);document.body.appendChild(this.layout)};BX.Landing.UI.Panel.GoogleImagesSettings.getInstance=function(){return BX.Landing.UI.Panel.GoogleImagesSettings.instance||(BX.Landing.UI.Panel.GoogleImagesSettings.instance=new BX.Landing.UI.Panel.GoogleImagesSettings)};BX.Landing.UI.Panel.GoogleImagesSettings.prototype={constructor:BX.Landing.UI.Panel.GoogleImagesSettings,__proto__:BX.Landing.UI.Panel.Content.prototype,superclass:BX.Landing.UI.Panel.Content.prototype,show:function(){this.superclass.show.call(this);return new Promise(function(n){this.resolver=n}.bind(this))},onSaveClick:function(){var n=this.keyField.getValue();this.resolver(n);BX.Landing.Backend.getInstance().action("Utils::saveSettings",{settings:{google_images_key:n}});BX.Landing.Client.Google.key=n;this.hide()},onCancelClick:function(){this.hide()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/panel/catalog_panel.min.js?16992580227011";s:6:"source";s:44:"/bitrix/js/landing/ui/panel/catalog_panel.js";s:3:"min";s:48:"/bitrix/js/landing/ui/panel/catalog_panel.min.js";s:3:"map";s:48:"/bitrix/js/landing/ui/panel/catalog_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var t=BX.Landing.Utils.addClass;var i=BX.Landing.Utils.create;var n=BX.Landing.Utils.append;var e=BX.Landing.Utils.debounce;var a=BX.Landing.Utils.trim;var s=BX.Landing.Utils.bind;var l=BX.Landing.Utils.proxy;var o=BX.Landing.Utils.setTextContent;var r=BX.Landing.Utils.htmlToElement;var c=BX.Landing.Utils.remove;var h=BX.Landing.Utils.style;var d=BX.Landing.Utils.isArray;var g=BX.Landing.Utils.prepend;var u=BX.Landing.Utils.data;var L=BX.Landing.Utils.encodeDataValue;var p="section";var C="element";var y="all";BX.Landing.UI.Panel.Catalog=function(i){BX.Landing.UI.Panel.Content.apply(this,arguments);this.searchContainer=this.createSearchContainer();this.listContainer=this.createListContainer();this.searchField=this.createSearchField();this.typeSwitcher=this.createTypeSwitcher();this.iBlockSwitcher=this.createIblockSwitcher();this.resolver=function(){};this.iblocks=null;t(this.layout,"landing-ui-panel-catalog");t(this.overlay,"landing-ui-panel-catalog");o(this.title,BX.Landing.Loc.getMessage("LANDING_STYLE_PANEL_CATALOG_TITLE"));if(!this.getIblocks()||this.getIblocks().length>1){n(this.iBlockSwitcher.layout,this.searchContainer)}else{void h(this.listContainer,{"margin-top":"94px"})}n(this.searchField.layout,this.searchContainer);n(this.typeSwitcher.layout,this.searchContainer);n(this.searchContainer,this.content);n(this.listContainer,this.content);if(BX.Landing.Main.isExternalControlsEnabled()){n(this.layout,parent.document.body)}else{n(this.layout,document.body);this.layout.style.marginTop=0;this.overlay.style.display="none"}};BX.Landing.UI.Panel.Catalog.TYPE_CATALOG_ALL=y;BX.Landing.UI.Panel.Catalog.TYPE_CATALOG_SECTION=p;BX.Landing.UI.Panel.Catalog.TYPE_CATALOG_ELEMENT=C;BX.Landing.UI.Panel.Catalog.getInstance=function(){return BX.Landing.UI.Panel.Catalog.instance||(BX.Landing.UI.Panel.Catalog.instance=new BX.Landing.UI.Panel.Catalog("catalog_panel"))};BX.Landing.UI.Panel.Catalog.prototype={constructor:BX.Landing.UI.Panel.Catalog,__proto__:BX.Landing.UI.Panel.Content.prototype,superClass:BX.Landing.UI.Panel.Content.prototype,search:function(t){var i={query:a(t.replace("&nbsp;","")),type:this.typeSwitcher.getValue(),iblock:this.iBlockSwitcher.getValue()};var n={action:"Utils::catalogSearch"};return BX.Landing.Backend.getInstance().action("Utils::catalogSearch",i,n)},createTypeSwitcher:function(){var i=new BX.Landing.UI.Field.ButtonGroup({items:[{name:BX.Landing.Loc.getMessage("LANDING_STYLE_PANEL_CATALOG_SEARCH_TYPE_ALL"),value:y},{name:BX.Landing.Loc.getMessage("LANDING_STYLE_PANEL_CATALOG_SEARCH_TYPE_ELEMENTS"),value:C},{name:BX.Landing.Loc.getMessage("LANDING_STYLE_PANEL_CATALOG_SEARCH_TYPE_SECTIONS"),value:p}],content:y,onChange:this.onSearchTypeChange.bind(this)});t(i.layout,"landing-ui-panel-catalog-switch");return i},getIblocks:function(){if(d(this.iblocks)){return this.iblocks}return[{name:"",value:""}]},createIblockSwitcher:function(){var i=new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_STYLE_PANEL_CATALOG_IBLOCK_SWITCHER"),items:this.getIblocks(),content:d(this.getIblocks())?this.getIblocks()[0].value:"",onChange:this.onIblockChange.bind(this)});t(i.layout,"landing-ui-panel-catalog-iblock-switch");return i},onIblockChange:function(){this.onSearch()},createSearchField:function(){return new BX.Landing.UI.Field.Text({placeholder:BX.Landing.Loc.getMessage("LANDING_STYLE_PANEL_CATALOG_SEARCH_PLACEHOLDER"),textOnly:true,onValueChange:e(this.onSearch,200,this)})},createSearchContainer:function(){return i("div",{props:{className:"landing-ui-panel-catalog-search-container"}})},createListContainer:function(){return i("div",{props:{className:"landing-ui-panel-catalog-list-container"}})},onSearchTypeChange:function(){this.onSearch()},renderResponse:function(t){var i=this.listContainer.querySelector(".landing-ui-panel-catalog-list");if(i){c(i)}this.body.scrollTop=0;n(r('<div class="landing-ui-panel-catalog-list">'+t.map((function(t){if(t.subType===p&&!t.image){t.image="/bitrix/images/landing/folder.svg"}var i=t.chain.reduce((function(t,i){if(i){t.push(L(i))}return t}),[]);return"<div class='landing-ui-panel-catalog-list-row landing-ui-panel-catalog-list-row-"+t.subType+"'>"+"<div class='landing-ui-panel-catalog-list-row-left'>"+"<div class='landing-ui-panel-catalog-list-cell-preview' style=\"background-image: url('"+t.image+"')\"></div>"+"</div>"+"<div class='landing-ui-panel-catalog-list-row-right'>"+"<div class='landing-ui-panel-catalog-list-cell-name'>"+"<div>"+L(t.name)+"</div>"+"</div>"+"<div class='landing-ui-panel-catalog-list-cell-chain'>"+"<div>"+(i?i.join("&nbsp;/&nbsp;"):"")+"</div>"+"</div>"+"</div>"+"</div>"})).join("")+"</div>"),this.listContainer);return t},initResponseItems:function(t){var i=this.listContainer.querySelector(".landing-ui-panel-catalog-list");t.forEach((function(t,n){s(i.children[n],"click",this.onItemClick.bind(this,t))}),this);return t},show:function(t,i){this.superClass.show.call(this);this.iblocks=t||null;this.entityTypes=i;this.onSearch();this.adjustIblockSwitcher();this.adjustEntityTypes();this.adjustSearchPlaceholder();return new Promise(function(t){this.resolver=t}.bind(this))},adjustSearchPlaceholder:function(){var t=this.getEntityTypes();if(t.length===1&&t[0]===p){u(this.searchField.input,{"data-placeholder":BX.Landing.Loc.getMessage("LANDING_STYLE_PANEL_CATALOG_SEARCH_SECTION_PLACEHOLDER")})}},getEntityTypes:function(){if(d(this.entityTypes)&&this.entityTypes.length>0){return this.entityTypes}return[y,C,p]},adjustEntityTypes:function(){this.typeSwitcher.buttons.forEach((function(t){t.layout.hidden=!this.getEntityTypes().includes(t.id)}),this);this.typeSwitcher.setValue(this.getEntityTypes()[0])},adjustIblockSwitcher:function(){c(this.iBlockSwitcher.layout);this.iBlockSwitcher=this.createIblockSwitcher();g(this.iBlockSwitcher.layout,this.searchContainer);if(!this.getIblocks()||this.getIblocks().length<2){void h(this.iBlockSwitcher.layout,{display:"none"});void h(this.loaderContainer,{top:"182px"});void h(this.listContainer,{"margin-top":"94px"})}else{void h(this.iBlockSwitcher.layout,{display:null});void h(this.loaderContainer,{top:null});void h(this.listContainer,{"margin-top":null})}},onSearch:function(){this.showLoader();clearTimeout(this.searchTimeout);this.searchTimeout=setTimeout(function(){this.search(this.searchField.getValue()).then(l(this.renderResponse,this)).then(l(this.initResponseItems,this)).then(function(){this.hideLoader()}.bind(this))}.bind(this),500)},showLoader:function(){if(!this.loader){this.loader=new BX.Loader({offset:{top:"-70px"}});this.loaderContainer=i("div",{props:{className:"landing-ui-panel-catalog-loader-container"},children:[this.loader.layout]});n(this.loaderContainer,this.listContainer);this.loader.show()}this.loaderContainer.hidden=false},hideLoader:function(){if(this.loaderContainer){this.loaderContainer.hidden=true}},onItemClick:function(t){this.resolver(t);this.hide()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/panel/status_panel.min.js?16992580211461";s:6:"source";s:43:"/bitrix/js/landing/ui/panel/status_panel.js";s:3:"min";s:47:"/bitrix/js/landing/ui/panel/status_panel.min.js";s:3:"map";s:47:"/bitrix/js/landing/ui/panel/status_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");var n=BX.Landing.Utils.addClass;var t;var e=new Date;var a=[["s","sago"],["i","iago"],["H","Hago"],["d","dago"],["m100","mago"],["m","mago"]];BX.Landing.UI.Panel.StatusPanel=function(t){BX.Landing.UI.Panel.BasePanel.apply(this,arguments);n(this.layout,"landing-ui-panel-status");if(!!document.body.querySelector(".landing-edit-mode")){parent.document.body.appendChild(this.layout)}this.runInterval();this.updateTime()};BX.Landing.UI.Panel.StatusPanel.setLastModified=function(n){e=new Date(n*1e3)};BX.Landing.UI.Panel.StatusPanel.getInstance=function(){return BX.Landing.UI.Panel.StatusPanel.instance||(BX.Landing.UI.Panel.StatusPanel.instance=new BX.Landing.UI.Panel.StatusPanel)};BX.Landing.UI.Panel.StatusPanel.prototype={constructor:BX.Landing.UI.Panel.StatusPanel,__proto__:BX.Landing.UI.Panel.BasePanel.prototype,runInterval:function(){clearInterval(t);t=setInterval(this.updateTime.bind(this),10*1e3)},updateTime:function(){let n=e.getTime();let t=(new Date).getTime();if(n>t){this.setContent(BX.Landing.Loc.getMessage("LANDING_PAGE_STATUS_UPDATED_NOW"));return}this.setContent([BX.Landing.Loc.getMessage("LANDING_PAGE_STATUS_UPDATED"),BX.date.format(a,n/1e3,t/1e3)].join(" "))},update:function(){this.show().then(function(){this.runInterval();e=new Date;this.setContent(BX.Landing.Loc.getMessage("LANDING_PAGE_STATUS_UPDATED_NOW"))}.bind(this))}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:67:"/bitrix/js/landing/ui/panel/detail_page_panel.min.js?16992580214359";s:6:"source";s:48:"/bitrix/js/landing/ui/panel/detail_page_panel.js";s:3:"min";s:52:"/bitrix/js/landing/ui/panel/detail_page_panel.min.js";s:3:"map";s:52:"/bitrix/js/landing/ui/panel/detail_page_panel.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Panel");BX.Landing.UI.Panel.DetailPage=function(n,e){BX.Landing.UI.Panel.URLList.apply(this,arguments);this.layout.classList.add("landing-ui-panel-detail-page");this.overlay.classList.add("landing-ui-panel-detail-page");this.cache=new BX.Cache.MemoryCache;document.body.appendChild(this.layout)};BX.Landing.UI.Panel.DetailPage.instance=null;BX.Landing.UI.Panel.DetailPage.getInstance=function(){if(!BX.Landing.UI.Panel.DetailPage.instance){BX.Landing.UI.Panel.DetailPage.instance=new BX.Landing.UI.Panel.DetailPage("detail_page_panel",{title:BX.Landing.Loc.getMessage("LANDING_BLOCK__DETAIL_PAGE_PANEL_TITLE")})}return BX.Landing.UI.Panel.DetailPage.instance};BX.Landing.UI.Panel.DetailPage.prototype={constructor:BX.Landing.UI.Panel.DetailPage,__proto__:BX.Landing.UI.Panel.URLList.prototype,getSources:function(){return this.cache.remember("sources",function(){var n=BX.Landing.PageObject.getRootWindow();return n.BX.Landing.Main.getInstance().options.sources})},onSourceClick:function(n){this.sidebarButtons.forEach(function(e){if(e.id===n.id){e.activate();return}e.deactivate()});this.content.innerHTML="";this.showLoader();this.content.appendChild(BX.create("div",{props:{className:"ui-alert ui-alert-warning landing-ui-panel-list-description"},children:[BX.create("span",{props:{className:"ui-alert-message"},html:BX.Landing.Loc.getMessage("LANDING_BLOCK__DETAIL_PAGE_LIST_DESCRIPTION")})]}));BX.Landing.Backend.getInstance().getDynamicTemplates(n.id).then(function(n){n.forEach(function(n){this.appendCard(this.createTemplatePreview(n))},this);this.loader.hide()}.bind(this))},createTemplatePreview:function(n){return new BX.Landing.UI.Card.LandingPreviewCard({title:n.TITLE,description:n.DESCRIPTION,preview:n.PREVIEW2X,onClick:this.onTemplateClick.bind(this,n)})},onTemplateClick:function(n){this.loader.show();var e=BX.Landing.Backend.getInstance();e.action("Utils::checkMultiFeature",{code:["create_page","publication_page"]}).then(function(t){if(!t||t==="false"){var i=BX.Landing.PageObject.getRootWindow();i.BX.Landing.PaymentAlertShow({message:BX.Landing.Loc.getMessage("LANDING_PUBLIC_PAGE_REACHED")});this.loader.hide()}else{e.action("Landing::addByTemplate",{siteId:e.getSiteId(),code:n.ID,fields:{ID:e.getLandingId()}}).then(function(e){this.loader.hide();this.onChange({type:"landing",id:e,name:n.TITLE});var t=this.sidebarButtons.getActive();if(t){var i=t.id;var a=BX.Landing.Env.getInstance();var s=a.getOptions();var o=s.sources.find(function(n){return n.id===i});if(o){o.default.detail="#landing"+e}a.setOptions(s)}}.bind(this))}}.bind(this))},showSourcesButtons:function(){this.appendSidebarButton(new BX.Landing.UI.Button.SidebarButton("templates",{text:BX.Landing.Loc.getMessage("LANDING_BLOCK__DETAIL_PAGE_PANEL_TEMPLATES")}));this.getSources().forEach(function(n){if(n.settings.detailPage){this.appendSidebarButton(new BX.Landing.UI.Button.SidebarButton(n.id,{text:n.name,child:true,onClick:this.onSourceClick.bind(this,n)}))}},this)},showSitesButtons:function(){this.appendSidebarButton(new BX.Landing.UI.Button.SidebarButton("my_sites",{text:BX.Landing.Loc.getMessage("LANDING_LINKS_PANEL_MY_SITES")}));return BX.Landing.Backend.getInstance().getSites().then(function(n){n.forEach(function(n){this.appendSidebarButton(new BX.Landing.UI.Button.SidebarButton(n.ID,{text:n.TITLE,onClick:this.onSiteClick.bind(this,n.ID,false),child:true}))},this)}.bind(this))},showCreatePageButton:function(){this.appendSidebarButton(new BX.Landing.UI.Button.SidebarButton("feedback_button",{className:"landing-ui-button-sidebar-feedback",text:BX.Landing.Loc.getMessage("LANDING_BLOCK__DETAIL_PAGE_PANEL_ADD_PAGE_BUTTON"),onClick:function(){var n=BX.Landing.Main.getInstance().options;var e=n.params.sef_url.site_show;var t=n.site_id;var i=e.replace("#site_show#",t)+"#createPage";window.open(i,"_blank")}}))},buildSidebar:function(){return Promise.all([this.showSourcesButtons(),this.showSitesButtons().then(function(){this.showCreatePageButton()}.bind(this))])},show:function(n){BX.Landing.UI.Panel.Content.prototype.show.call(this);this.clear();this.showLoader();this.buildSidebar();var e=this.sidebarButtons.find(function(e){return e.id===n.source});if(e){e.layout.click()}return new Promise(function(n){this.promiseResolve=n}.bind(this))}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/field/dropdown_field.min.js?16992580224296";s:6:"source";s:45:"/bitrix/js/landing/ui/field/dropdown_field.js";s:3:"min";s:49:"/bitrix/js/landing/ui/field/dropdown_field.min.js";s:3:"map";s:49:"/bitrix/js/landing/ui/field/dropdown_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var t=BX.Landing.Utils.setTextContent;var i=BX.Landing.Utils.escapeText;var e=BX.Landing.Utils.data;var n=BX.Landing.Utils.offsetTop;var s=BX.Landing.Utils.offsetLeft;BX.Landing.UI.Field.Dropdown=function(i){this.items="items"in i&&i.items?i.items:{};BX.Landing.UI.Field.BaseField.apply(this,arguments);this.setEventNamespace("BX.Landing.UI.Field.Dropdown");this.subscribeFromOptions(BX.Landing.UI.Component.fetchEventsFromOptions(i));this.onChangeHandler=typeof i.onChange==="function"?i.onChange:function(){};this.frame=typeof i.frame==="object"?i.frame:null;this.layout.classList.add("landing-ui-field-dropdown");this.popup=null;this.input.addEventListener("click",this.onInputClick.bind(this));this.classForTextNode=i.classForTextNode;document.addEventListener("click",this.onDocumentClick.bind(this));var n=BX.Landing.PageObject.getRootWindow();n.document.addEventListener("click",this.onDocumentClick.bind(this));if(i.hint){var s=this.layout.querySelector(".landing-ui-field-header");if(s){BX.Dom.append(top.BX.UI.Hint.createNode(i.hint),s)}}if(BX.type.isPlainObject(this.items)){var o=Object.keys(this.items);this.items=o.map((function(t){return{name:this.items[t],value:t}}),this)}if(BX.Type.isArrayFilled(this.items)){t(this.input,this.items[0].name,this.classForTextNode);e(this.input,"value",this.items[0].value)}else{t(this.input,BX.Landing.Loc.getMessage("LANDING_DROPDOWN_NOT_FILLED"));e(this.input,"value","")}if(this.content!==""){setTimeout((()=>{this.emit("onInit",this.items[this.content])}),0);this.setValue(this.content)}};BX.Landing.UI.Field.Dropdown.prototype={constructor:BX.Landing.UI.Field.Dropdown,__proto__:BX.Landing.UI.Field.BaseField.prototype,onInputClick:function(t){t.stopPropagation();if(!this.popup||!this.contentRoot&&this.popupRoot&&!this.popupRoot.contains(this.popup.popupWindow.popupContainer)){var e=[];this.items.forEach((function(t){if(t.hidden!==true){e.push(t)}}));var o;if(this.options.maxHeight){o=this.options.maxHeight}else{o=196}e=e.map((function(t){if(t.delimiter){return{delimiter:t.delimiter}}return{html:t.html,text:!t.html?i(t.name):undefined,onclick:function(){this.onItemClick(t)}.bind(this),className:t.className}}),this);this.popup=new BX.PopupMenuWindow({id:"dropdown_"+ +new Date,bindElement:this.input,bindOptions:{forceBindPosition:true},targetContainer:this.contentRoot,maxHeight:o,items:e,events:{onPopupClose:function(){this.input.classList.remove("landing-ui-active");this.layout.classList.remove("landing-ui-active")}.bind(this)},className:this.options.className,angle:true});if(!this.contentRoot){this.popupRoot=this.layout.parentElement.parentElement.parentElement;this.popupRoot.appendChild(this.popup.popupWindow.popupContainer);this.popupRoot.style.position="relative"}}this.layout.classList.add("landing-ui-active");this.input.classList.add("landing-ui-active");if(this.popup.popupWindow.isShown()){this.popup.close()}else{this.popup.show()}var p=this.input.getBoundingClientRect();if(!this.contentRoot){var a=s(this.input,this.popupRoot);var u=n(this.input,this.popupRoot);this.popup.popupWindow.popupContainer.style.top=u+p.height+"px";this.popup.popupWindow.popupContainer.style.left=a+"px"}this.popup.popupWindow.popupContainer.style.width=p.width+"px"},onItemClick:function(i){t(this.input,i.name,this.classForTextNode);e(this.input,"value",i.value);this.popup.close();this.onChangeHandler(i.value,this.items,this.postfix,this.property);this.onValueChangeHandler(this);BX.fireEvent(this.input,"input");this.emit("onChange",i)},getValue:function(){var t=this.input.dataset.value;if(t!=="undefined"&&typeof t!=="undefined"){return t}if(BX.Type.isArrayFilled(this.items)){return this.items[0].value}},setValue:function(i,n){this.items.forEach((function(s){if(i==s.value){t(this.input,s.name,this.classForTextNode);e(this.input,"value",s.value);if(n){setTimeout((()=>{this.emit("onInit",s)}),0)}}}),this)},onFrameLoad:function(){const t=this.frame.document.querySelector(this.selector);if(t){const i=this.items.find((i=>t.classList.contains(i.value)));if(i){this.setValue(i.value,true)}}},isChanged:function(){return this.content!=this.getValue()},onDocumentClick:function(){if(this.popup){this.popup.close()}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:72:"/bitrix/js/landing/ui/field/dropdown_preview_field.min.js?16992580222746";s:6:"source";s:53:"/bitrix/js/landing/ui/field/dropdown_preview_field.js";s:3:"min";s:57:"/bitrix/js/landing/ui/field/dropdown_preview_field.min.js";s:3:"map";s:57:"/bitrix/js/landing/ui/field/dropdown_preview_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.DropdownPreview=function(i){this.items="items"in i&&i.items?i.items:{};BX.Landing.UI.Field.BaseField.apply(this,arguments);this.layout.classList.add("landing-ui-field-dropdown");this.layout.classList.add("landing-ui-field-dropdown-preview");this.frame=typeof i.frame==="object"?i.frame:null;this.format=typeof i.format==="function"?i.format:function(){};this.postfix=typeof i.postfix==="string"?i.postfix:"";this.property=typeof i.property==="string"?i.property:"";this.changeHandler=typeof i.onChange==="function"?i.onChange:function(){};this.elements=[];this.setValue(this.items[0].value,true);this.input.innerText=this.items[0].name;this.input.addEventListener("click",this.onInputClick.bind(this));this.onFrameLoad()};BX.Landing.UI.Field.DropdownPreview.CreateSelect=function(){return BX.create("select",{props:{className:"landing-ui-field-input landing-ui-field-dropdown"}})};BX.Landing.UI.Field.DropdownPreview.prototype={constructor:BX.Landing.UI.Field.DropdownPreview,__proto__:BX.Landing.UI.Field.BaseField.prototype,superClass:BX.Landing.UI.Field.BaseField,onInputClick:function(i){i.preventDefault();if(!this.popup){var t=this;var e=this.items.map(function(i){return{text:i.name,className:"landing-ui-field-dropdown-preview-item",menuShowDelay:0,subMenuOffsetX:10,items:[{text:'<div class="landing-ui-field-dropdown-preview-item-preview '+i.value+'">Text</div>',className:"landing-ui-field-dropdown-preview-item-child"}],onclick:function(){this.close();t.onChange(i)}}});this.popup=new BX.PopupMenuWindow({id:this.selector+this.property,bindElement:this.input,items:e,zIndex:9e3,angle:false,bindOptions:{forceBindPosition:true},events:{onPopupClose:function(){this.input.classList.remove("landing-ui-active")}.bind(this)}});this.input.parentNode.appendChild(this.popup.popupWindow.popupContainer)}this.input.classList.add("landing-ui-active");var n=BX.pos(this.input,this.input.parentNode);this.popup.popupWindow.popupContainer.style.top=n.bottom+"px";this.popup.popupWindow.popupContainer.style.left="0px";this.popup.popupWindow.popupContainer.style.right=""},onFrameLoad:function(){this.elements=[].slice.call(this.frame.document.querySelectorAll(this.selector));if(this.elements.length){this.items.some(function(i){if(this.elements[0].classList.contains(i.value)){this.setValue(i.value,true)}},this)}},onChange:function(i,t){this.setValue(i.value);this.input.innerText=i.name;if(!t){this.changeHandler(this.getValue(),this.items,this.postfix,this.property);BX.fireEvent(this.layout,"input")}},setValue:function(i){this.input.dataset.value=i},getValue:function(){return this.input.dataset.value}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/field/unit_field.min.js?16992580222463";s:6:"source";s:41:"/bitrix/js/landing/ui/field/unit_field.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.Unit=function(t){BX.Landing.UI.Field.Text.apply(this,arguments);this.layout.classList.add("landing-ui-field-unit");this.unit=BX.Landing.UI.Field.Unit.createUnit();this.onInputHandler=typeof t.onInput==="function"?t.onInput:function(){};this.input.addEventListener("keydown",this.onInputKeydown.bind(this));this.input.addEventListener("input",BX.debounce(this.onInputInput,200,this));this.input.addEventListener("input",this.onInputInputWithoutDebounce.bind(this));this.input.value=t.content;this.input.placeholder=this.placeholder;this.items=t.items;this.unit.innerText=typeof t.unit==="string"?t.unit:"";this.input.min=typeof t.min==="number"?t.min:0;this.input.max=typeof t.max==="number"?t.max:Infinity;this.input.step=typeof t.step==="number"?t.step:1;this.frame=typeof t.frame==="object"?t.frame:null;this.selector=typeof t.selector==="string"?t.selector:null;this.property=typeof t.property==="string"?t.property:null;this.postfix=typeof t.postfix==="string"?t.postfix:"";this.format=typeof t.format==="function"?t.format:function(){};this.elements=null;if(this.frame){this.onFrameLoad()}this.layout.appendChild(this.unit);this.enableTextOnly()};BX.Landing.UI.Field.Unit.createUnit=function(){return BX.create("div",{props:{className:"landing-ui-field-unit-unit"}})};BX.Landing.UI.Field.Unit.prototype={constructor:BX.Landing.UI.Field.Unit,__proto__:BX.Landing.UI.Field.Text.prototype,onFrameLoad:function(){this.elements=[].slice.call(this.frame.document.querySelectorAll(this.selector));if(this.elements.length){var t=parseFloat(BX.style(this.elements[0],this.property));t=t===t?t:0;this.setValue(t)}},onInputInput:function(){this.onInputHandler(this)},onInputInputWithoutDebounce:function(){if(!!this.elements){this.elements.forEach(function(t){this.format(t,this.getValue(),this.items)},this)}},onInputKeydown:function(t){if(t.keyCode===13){t.preventDefault()}},createInput:function(){return BX.create("input",{props:{className:"landing-ui-field-input",type:"number"}})},setValue:function(t){this.input.value=t;BX.fireEvent(this.input,"input")},getValue:function(){return this.input.value},enableEdit:function(){if(this!==BX.Landing.UI.Field.BaseField.currentField&&BX.Landing.UI.Field.BaseField.currentField!==null){BX.Landing.UI.Field.BaseField.currentField.disableEdit()}BX.Landing.UI.Field.BaseField.currentField=this;this.input.focus()},disableEdit:function(){}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/field/range_field.min.js?16992580228326";s:6:"source";s:42:"/bitrix/js/landing/ui/field/range_field.js";s:3:"min";s:46:"/bitrix/js/landing/ui/field/range_field.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/field/range_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.Range=function(t){this.items=BX.type.isArray(t.items)?t.items:[];this.values=new BX.Landing.Collection.BaseCollection;this.isMultiple=typeof t.type==="string"&&t.type==="multiple";this.inputInner=this.createInputInner();this.container=BX.create("div",{props:{className:"landing-ui-field-range-container"}});this.output=this.createOutput();this.sliderFrom=null;this.sliderTo=this.createSlider();this.sliderValue=this.createValue();this.elements=[];this.frame=typeof t.frame==="object"?t.frame:null;this.format=typeof t.format==="function"?t.format:function(){};this.postfix=typeof t.postfix==="string"?t.postfix:"";this.changeHandler=typeof t.onChange==="function"?t.onChange:function(){};this.onValueChangeHandler=t.onValueChange?t.onValueChange:function(){};this.dragStartHandler=typeof t.onDragStart==="function"?t.onDragStart:function(){};this.dragEndHandler=typeof t.onDragEnd==="function"?t.onDragEnd:function(){};var e=BX.Landing.PageObject.getRootWindow();this.jsDD=this.frame?e.jsDD:window.jsDD;this.value=null;this.valueFrom=null;this.valueTo=null;BX.Landing.UI.Field.BaseField.apply(this,arguments);this.layout.classList.add("landing-ui-field-range");this.stepPercent=100/this.values.length;if(this.content===null||this.content===undefined||this.content===""){if(this.isMultiple){this.content={from:this.items[0].value,to:this.items[this.items.length-1].value}}else{this.content=this.items[0].value;this.value=this.items[0].value}}var i=function(t){this.jsDD.stopDrag(t)}.bind(this);BX.Event.bind(window,"mouseup",i);BX.Event.bind(e,"mouseup",i);BX.Event.bind(window.top,"mouseup",i);this.setValue(this.content,true)};BX.Landing.UI.Field.Range.prototype={constructor:BX.Landing.UI.Field.Range,__proto__:BX.Landing.UI.Field.BaseField.prototype,init:function(){this.input.appendChild(this.inputInner);this.input.appendChild(this.sliderValue);this.layout.appendChild(this.container);this.container.appendChild(this.input);if(!this.isMultiple){this.container.appendChild(this.output)}if(this.isMultiple){this.sliderFrom=this.createSlider();this.inputInner.appendChild(this.sliderFrom)}this.inputInner.appendChild(this.sliderTo);this.items.forEach((function(t,e){this.values.add({value:t.value,valuePercent:this.valueToPercent(e),left:this.valueToLeftPercent(t.value),name:t.name})}),this);if(this.isMultiple){this.sliderFrom.onbxdragstart=this.onDragStart.bind(this);this.sliderFrom.onbxdrag=this.onDrag.bind(this);this.sliderFrom.onbxdragstop=this.onDragEnd.bind(this);this.jsDD.registerObject(this.sliderFrom)}this.sliderTo.onbxdragstart=this.onDragStart.bind(this);this.sliderTo.onbxdrag=this.onDrag.bind(this);this.sliderTo.onbxdragstop=this.onDragEnd.bind(this);this.jsDD.registerObject(this.sliderTo);if(this.isMultiple){requestAnimationFrame(function(){this.sliderFrom.style.transform="translateX(-"+this.values[this.values.length-1].valuePercent+"%)";this.sliderFrom.style.left=this.values[this.values.length-1].valuePercent+"%"}.bind(this))}if(this.frame){this.onFrameLoad()}},createOutput:function(){this.outputInput=BX.create("div",{props:{className:"landing-ui-field-range-output-input"},text:"0"});return BX.create("div",{props:{className:"landing-ui-field-range-output"},children:[this.outputInput,BX.create("div",{props:{className:"landing-ui-field-range-output-arrows"},children:[BX.create("div",{props:{className:"landing-ui-field-range-output-arrows-up"},events:{click:this.onArrowUpClick.bind(this)}}),BX.create("div",{props:{className:"landing-ui-field-range-output-arrows-down"},events:{click:this.onArrowDownClick.bind(this)}})]})]})},onArrowUpClick:function(){var t=!!this.value?this.values.length-1:0;var e;this.values.forEach((function(e,i){if(e.value===this.value){t=i}}),this);e=this.values[t+1]?this.values[t+1]:this.values[t];this.setValue(e.value)},onArrowDownClick:function(){var t=0;var e;this.values.forEach((function(e,i){if(e.value==this.value){t=i}}),this);e=this.values[t-1]?this.values[t-1]:this.values[t];this.setValue(e.value)},onFrameLoad:function(){this.elements=[].slice.call(this.frame.document.querySelectorAll(this.selector));if(this.elements.length){const t=this.elements[0];if(this.isMultiple){const e=this.values.find((function(e){return t.classList.contains(e.value)}));const i=this.values.find((function(i){return t.classList.contains(i.value)&&i.value!==e}));this.setValue({from:!!e?e.value:null,to:!!i?i.value:null},true)}else{const e=this.values.find((function(e){return t.classList.contains(e.value)}));this.setValue(!!e?e.value:null,true)}}},getStartXOffset:function(){var t=parseFloat(this.jsDD.current_node.style.left)*(this.inputInner.getBoundingClientRect().width/100);return this.jsDD.current_node.getBoundingClientRect().left+window.pageXOffset-(t===t?t:0)},onDragStart:function(){this.offset=this.getStartXOffset();this.dragStartHandler()},onDrag:function(t){t=(t-this.offset)/this.inputInner.getBoundingClientRect().width*100;t=t<0?0:t>100?100:t;var e=t;var i;var n=parseFloat(this.jsDD.current_node.style.left);n=n===n?n:0;if(t>this.lastPos){e+=this.stepPercent/2;i=this.values.filter((function(t){return e>=t.valuePercent&&t.valuePercent>n}),this);i=i[i.length-1]}else{e-=this.stepPercent/2;i=this.values.filter((function(t){return e<=t.valuePercent&&t.valuePercent<n}),this);i=i[0]}if(i){if(this.isMultiple){if(this.jsDD.current_node===this.sliderFrom){this.valueFrom=i.value}if(this.jsDD.current_node===this.sliderTo){this.valueTo=i.value}this.setValue({from:this.valueFrom,to:this.valueTo})}else{this.setValue(i.value)}}this.lastPos=t},onChange:function(){this.changeHandler(this.getValue(),this.items,this.postfix,this.property);this.onValueChangeHandler(this)},onDragEnd:function(){this.dragEndHandler()},getValue:function(){var t;if(this.isMultiple){t={from:this.toPercent<this.fromPercent?this.valueTo:this.valueFrom,to:this.toPercent>this.fromPercent?this.valueTo:this.valueFrom}}else{t=this.value}return t},setValue:function(t,e){if(t&&typeof t==="object"){var i=this.values.filter((function(e){return e.value==t.from}));var n=this.values.filter((function(e){return e.value==t.to}));i=i.length?i[0]:this.values[0];n=n.length?n[0]:this.values[this.values.length-1];if(i){requestAnimationFrame(function(){this.sliderFrom.style.transform="translateX(-"+i.valuePercent+"%)";this.sliderFrom.style.left=i.valuePercent+"%"}.bind(this));this.valueFrom=i.value;this.fromPercent=i.valuePercent}if(n){requestAnimationFrame(function(){this.sliderTo.style.transform="translateX(-"+n.valuePercent+"%)";this.sliderTo.style.left=n.valuePercent+"%"}.bind(this));this.valueTo=n.value;this.toPercent=n.valuePercent}this.updateValuePosition(i.valuePercent,n.valuePercent)}else if(t){var s=this.values.filter((function(e){return e.value==t}));s=s.length?s[0]:null;if(s){requestAnimationFrame(function(){this.sliderTo.style.transform="translateX(-"+s.valuePercent+"%)";this.sliderTo.style.left=s.valuePercent+"%"}.bind(this));this.value=t;this.updateValuePosition(s.valuePercent)}}if(!e){this.onChange()}},updateValuePosition:function(t,e){if(typeof t!=="number"&&typeof e!=="number"){t=0;e=100}if(typeof t==="number"&&typeof e!=="number"){e=t;t=0}requestAnimationFrame(function(){this.sliderValue.style.left=Math.min(t,e)+"%";this.sliderValue.style.right=100-Math.max(t,e)+"%"}.bind(this));var i=this.values.filter((function(t){return t.valuePercent==e}));i=i.length?i[0]:null;this.outputInput.innerText=!!i?i.name:0;BX.Dom.attr(this.outputInput,"title",BX.Text.encode(this.outputInput.innerText))},createInputInner:function(){return BX.create("div",{props:{className:"landing-ui-field-range-input-inner"}})},createValue:function(){return BX.create("div",{props:{className:"landing-ui-field-range-value"}})},createSlider:function(){return BX.create("div",{props:{className:"landing-ui-field-range-input-slider"}})},createInput:function(){return BX.create("div",{props:{className:"landing-ui-field-input landing-ui-field-range-input"}})},valueToPercent:function(t){return t/(this.items.length-1)*100},valueToLeftPercent:function(t){return t/this.inputInner.getBoundingClientRect().width*100},isChanged:function(){if(this.isMultiple){return JSON.stringify(this.content)!==JSON.stringify(this.getValue())}return this.content!=this.getValue()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:68:"/bitrix/js/landing/ui/field/button_group_field.min.js?16992580222697";s:6:"source";s:49:"/bitrix/js/landing/ui/field/button_group_field.js";s:3:"min";s:53:"/bitrix/js/landing/ui/field/button_group_field.min.js";s:3:"map";s:53:"/bitrix/js/landing/ui/field/button_group_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var t=BX.Landing.Utils.isArray;BX.Landing.UI.Field.ButtonGroup=function(t){this.items="items"in t&&t.items?t.items:[];BX.Landing.UI.Field.BaseField.apply(this,arguments);this.layout.classList.add("landing-ui-field-button-group");this.frame=typeof t.frame==="object"?t.frame:null;this.format=typeof t.format==="function"?t.format:function(){};this.postfix=typeof t.postfix==="string"?t.postfix:"";this.property=typeof t.property==="string"?t.property:"";this.multiple=typeof t.multiple==="boolean"?t.multiple:false;this.changeHandler=typeof t.onChange==="function"?t.onChange:function(){};this.elements=[];this.buttons=new BX.Landing.UI.Collection.ButtonCollection;this.value=this.getValue();this.onButtonClick=this.onButtonClick.bind(this);this.input.innerHTML="";this.items.forEach((function(t){var e=this.createButtonByItem(t);this.buttons.add(e);this.input.appendChild(e.layout)}),this);if(this.content){this.setValue(this.content,true)}if(this.frame){this.onFrameLoad()}};BX.Landing.UI.Field.ButtonGroup.prototype={constructor:BX.Landing.UI.Field.ButtonGroup,__proto__:BX.Landing.UI.Field.BaseField.prototype,superClass:BX.Landing.UI.Field.BaseField,onFrameLoad:function(){this.elements=[].slice.call(this.frame.document.querySelectorAll(this.selector));if(this.elements.length){this.deactivateAll();this.items.some((t=>{if(this.elements[0].classList.contains(t.value)){this.buttons.getByValue(t.value).activate();return!this.multiple}}))}},createButtonByItem:function(t){return new BX.Landing.UI.Button.BaseButton(t.id||t.value,{html:t.name,active:t.active,attrs:{value:t.value,title:t.title?BX.Landing.Utils.escapeText(t.title):null},onClick:this.onButtonClick})},onButtonClick:function(t){var e=this.buttons.getByNode(t.currentTarget);var i=e.layout.value;if(this.multiple){if(e.isActive()){e.deactivate()}else{e.activate()}}else{this.deactivateAll();e.activate()}this.onChange(i)},onChange:function(t){if(!this.multiple){this.changeHandler(t,this.items,this.postfix,this.property)}else{this.elements.forEach((function(e){e.classList.toggle(t)}),this);this.changeHandler()}this.onValueChangeHandler(this)},isChanged:function(){return this.value!==this.getValue()},setValue:function(e,i){this.deactivateAll();if(this.multiple){e=t(e)?e:[e];e.forEach((function(t){var e=this.buttons.getByValue(t);if(e){e.activate()}}),this)}else{var n=this.buttons.getByValue(e);if(n){n.activate()}}if(!i){this.onChange(e)}},deactivateAll:function(){this.buttons.forEach((function(t){t.deactivate()}))},getValue:function(){var t=this.buttons.getActive();if(t){return t.layout.value}return null}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:65:"/bitrix/js/landing/ui/field/dropdown_inline.min.js?16992580222393";s:6:"source";s:46:"/bitrix/js/landing/ui/field/dropdown_inline.js";s:3:"min";s:50:"/bitrix/js/landing/ui/field/dropdown_inline.min.js";s:3:"map";s:50:"/bitrix/js/landing/ui/field/dropdown_inline.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.DropdownInline=function(t){this.items="items"in t&&t.items?t.items:{};this.id=t.id?t.id:"";BX.Landing.UI.Field.BaseField.apply(this,arguments);this.setEventNamespace("BX.Landing.UI.Field.DropdownInline");this.subscribeFromOptions(BX.Landing.UI.Component.fetchEventsFromOptions(t));this.popup=null;this.input.addEventListener("click",this.onInputClick.bind(this));this.layout.classList.add("landing-ui-field-dropdown-inline");if(BX.type.isPlainObject(this.items)){var i=Object.keys(this.items);this.items=i.map((function(t){return{name:this.items[t],value:t}}),this)}if(this.items.length===0){this.items.push({});this.items[0].name="";this.items[0].value=""}this.input.innerText=this.items[0].name;this.input.dataset.value=this.items[0].value;this.setValue(this.content,this.options.skipInitialEvent)};BX.Landing.UI.Field.DropdownInline.prototype={constructor:BX.Landing.UI.Field.DropdownInline,__proto__:BX.Landing.UI.Field.BaseField.prototype,onInputClick:function(){if(!this.popup){this.popup=new BX.PopupMenuWindow({id:this.selector+"_dropdown_popup_"+this.id,bindElement:this.input,bindOptions:{forceBindPosition:true},targetContainer:this.contentRoot,items:this.items.map((function(t){return{text:t.name,onclick:function(){this.onItemClick(t)}.bind(this)}}),this)});if(!this.contentRoot){this.layout.appendChild(this.popup.popupWindow.popupContainer)}}this.popup.show();if(!this.contentRoot){var t=BX.pos(this.input,this.layout);this.popup.popupWindow.popupContainer.style.top=t.bottom+"px";this.popup.popupWindow.popupContainer.style.left=t.left+"px"}},closePopup:function(){if(this.popup){this.popup.close()}},onItemClick:function(t){this.input.innerText=t.name;this.input.dataset.value=t.value;this.popup.close();BX.fireEvent(this.input,"input");this.emit("onChange");this.emit("onItemClick")},getValue:function(){return typeof this.input.dataset.value!=="undefined"?this.input.dataset.value:this.items[0].value},setValue:function(t,i){this.items.forEach((function(n){if(t===n.value){this.input.innerText=n.name;this.input.dataset.value=n.value;if(!i){this.emit("onChange")}}}),this)},setItems:function(t){if(BX.type.isArray(t)){this.items=BX.clone(t);this.popup=null;this.input.innerText=this.items[0].name;this.input.dataset.value=this.items[0].value}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:58:"/bitrix/js/landing/ui/field/dnd_list.min.js?16992580229052";s:6:"source";s:39:"/bitrix/js/landing/ui/field/dnd_list.js";s:3:"min";s:43:"/bitrix/js/landing/ui/field/dnd_list.min.js";s:3:"map";s:43:"/bitrix/js/landing/ui/field/dnd_list.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var t=BX.Landing.Utils.addClass;var e=BX.Landing.Utils.removeClass;var i=BX.Landing.Utils.hasClass;var n=BX.Landing.Utils.isBoolean;var a=BX.Landing.Utils.isArray;var s=BX.Landing.Utils.create;var o=BX.Landing.Utils.append;var r=BX.Landing.Utils.insertAfter;var l=BX.Landing.Utils.insertBefore;var h=BX.Landing.Utils.attr;var d=BX.Landing.Utils.slice;var u=BX.Landing.Utils.style;var p=BX.Landing.Utils.bind;var c=BX.Landing.Utils.unbind;var g=BX.Landing.Utils.data;var v=BX.Landing.Utils.remove;var m=BX.Landing.Utils.nextSibling;var f=BX.Landing.Utils.prevSibling;var L=BX.Landing.Utils.escapeHtml;var B=BX.Landing.Utils.findParent;var A=BX.Landing.Utils.offsetTop;var D=BX.Landing.Utils.offsetLeft;BX.Landing.UI.Field.DragAndDropList=function(e){BX.Landing.UI.Field.BaseField.apply(this,arguments);t(this.layout,"landing-ui-field-dnd-list");this.isMultiple=n(e.multiple)?e.multiple:false;this.items=a(e.items)?e.items:[];this.value=a(e.value)?e.value:[];this.onDragStart=this.onDragStart.bind(this);this.onDragEnd=this.onDragEnd.bind(this);this.onDragOver=this.onDragOver.bind(this);this.onItemDragOver=this.onItemDragOver.bind(this);this.onItemDragLeave=this.onItemDragLeave.bind(this);this.onDragLeave=this.onDragLeave.bind(this);this.onDrop=this.onDrop.bind(this);this.onDrag=this.onDrag.bind(this);this.onRemoveClick=this.onRemoveClick.bind(this);this.onElementClick=this.onElementClick.bind(this);this.onMouseWheel=this.onMouseWheel.bind(this);this.onMouseOver=this.onMouseOver.bind(this);this.onMouseLeave=this.onMouseLeave.bind(this);if(typeof window.onwheel!=="undefined"){this.wheelEventName="wheel"}else if(typeof window.onmousewheel!=="undefined"){this.wheelEventName="mousewheel"}this.target=s("div",{props:{className:"landing-ui-field-dnd-target"},children:[s("div",{props:{className:"landing-ui-field-dnd-target-browser-header"},children:[s("span"),s("span"),s("span")]})]});this.addButton=new BX.Landing.UI.Button.BaseButton("add_catalog_item",{onClick:this.onAddItemClick.bind(this),className:"landing-ui-field-dnd-add-button"});this.valueArea=s("div",{props:{classList:"landing-ui-field-dnd-list-value"}});this.itemsArea=s("div",{props:{classList:"landing-ui-field-dnd-list-items"}});o(this.valueArea,this.target);o(this.target,this.input);o(this.addButton.layout,this.target);p(this.valueArea,"dragover",this.onDragOver);p(this.valueArea,"dragleave",this.onDragLeave);p(this.valueArea,"drop",this.onDrop);this.items.forEach(function(t){o(this.createItem(t),this.itemsArea)},this);this.value.forEach(function(t){var e=this.getItem(t);if(e){o(this.createItem(e),this.valueArea)}},this);this.adjustPlaceholder();this.value=this.getValue()};BX.Landing.UI.Field.DragAndDropList.prototype={constructor:BX.Landing.UI.Field.DragAndDropList,__proto__:BX.Landing.UI.Field.BaseField.prototype,onDragStart:function(e){this.dragItem=e.currentTarget;this.dragIndex=d(this.valueArea.children).findIndex(function(t){return t===e.currentTarget});this.valueAreaRect=this.valueArea.getBoundingClientRect();t(this.dragItem,"landing-ui-ondrag");t(this.valueArea,"landing-ui-ondrag")},onDragEnd:function(){e(this.valueArea,"landing-ui-over");e(this.dragItem,"landing-ui-ondrag");e(this.valueArea,"landing-ui-ondrag");d(this.valueArea.children).forEach(function(t){u(t,null)});this.cloned=null;this.dragItem=null;if(this.isChanged()){this.onValueChangeHandler(this);this.value=this.getValue()}},onDragOver:function(e){e.preventDefault();e.dataTransfer.dropEffect="copy";t(e.currentTarget,"landing-ui-over")},onItemDragOver:function(t){var e=t.currentTarget;if(this.itemsArea.contains(this.dragItem)||this.valueArea.contains(this.dragItem)){if(this.valueArea.contains(e)&&e!==this.cloned){var i=e.getBoundingClientRect();var n=i.top+i.height/2;if(!this.cloned&&!this.valueArea.contains(this.dragItem)){this.cloned=this.createItemFromElement(this.dragItem);o(this.cloned,this.valueArea)}if(!this.cloned&&this.valueArea.contains(this.dragItem)){this.cloned=this.dragItem}if(t.clientY>n&&m(e)!==this.cloned){return r(this.cloned,e)}if(t.clientY<n&&f(e)!==this.cloned){return l(this.cloned,e)}}}this.adjustPopupPosition()},onAddItemClick:function(t){t.preventDefault();t.stopPropagation();if(!this.popup){this.popup=new BX.Main.Popup({id:"catalog_blocks_list",bindElement:this.addButton.layout,content:this.itemsArea,autoHide:true,height:176});this.popup.contentContainer.style.overflowX="hidden";p(this.popup.popupContainer,"mouseover",this.onMouseOver);p(this.popup.popupContainer,"mouseleave",this.onMouseLeave);var e=BX.Landing.PageObject.getRootWindow();p(e.document,"click",this.onDocumentClick.bind(this));o(this.popup.popupContainer,B(this.addButton.layout,{className:"landing-ui-panel-content-body-content"}))}if(this.popup.isShown()){this.popup.close()}else{this.popup.show()}this.adjustPopupPosition()},onMouseOver:function(){p(this.popup.popupContainer,this.wheelEventName,this.onMouseWheel);p(this.popup.popupContainer,"touchmove",this.onMouseWheel)},onMouseLeave:function(){c(this.popup.popupContainer,this.wheelEventName,this.onMouseWheel);c(this.popup.popupContainer,"touchmove",this.onMouseWheel)},onMouseWheel:function(t){t.stopPropagation();t.preventDefault();var e=BX.Landing.UI.Panel.Content.getDeltaFromEvent(t);var i=this.popup.contentContainer.scrollTop;requestAnimationFrame(function(){this.popup.contentContainer.scrollTop=i-e.y}.bind(this))},adjustPopupPosition:function(){if(this.popup){requestAnimationFrame(function(){var t=B(this.addButton.layout,{className:"landing-ui-panel-content-body-content"});var e=A(this.addButton.layout,t);var i=D(this.addButton.layout,t);var n=this.addButton.layout.getBoundingClientRect();var a=this.popup.popupContainer.getBoundingClientRect();var s=14;this.popup.popupContainer.style.top=e+n.height+s+"px";this.popup.popupContainer.style.left=i-a.width/2+n.width/2+"px";this.popup.setAngle({offset:71,position:"top"})}.bind(this))}},createItemFromElement:function(t){var e=t.querySelector("img");var i={name:t.innerText,value:g(t,"value")};if(e){i.image=e.src}return this.createItem(i)},onDragLeave:function(t){e(t.currentTarget,"landing-ui-over")},onItemDragLeave:function(t){t.stopPropagation()},onDrop:function(t){t.stopPropagation();if(this.itemsArea.contains(this.dragItem)||this.valueArea.contains(this.dragItem)){if(!this.valueArea.contains(this.dragItem)&&!this.valueArea.contains(this.cloned)){var e=this.createItemFromElement(this.dragItem);o(e,this.valueArea);this.cloned=null;this.adjustPlaceholder();this.adjustPopupPosition()}}if(this.isChanged()){this.onValueChangeHandler(this);this.value=this.getValue()}},onDrag:function(t){if(this.cloned&&this.valueArea.contains(this.cloned)){if(t.clientX>this.valueAreaRect.right){v(this.cloned);this.cloned=null;this.adjustPlaceholder();this.adjustPopupPosition()}}},onRemoveClick:function(t){t.preventDefault();t.stopPropagation();v(t.currentTarget.parentNode);this.adjustPlaceholder();this.adjustPopupPosition();if(this.isChanged()){this.onValueChangeHandler(this);this.value=this.getValue()}},onElementClick:function(t){t.preventDefault();t.stopPropagation();if(this.itemsArea.contains(t.currentTarget)){var e=this.createItemFromElement(t.currentTarget);o(e,this.valueArea);this.adjustPlaceholder();this.adjustPopupPosition()}if(this.isChanged()){this.onValueChangeHandler(this);this.value=this.getValue()}},getSelectedItem:function(){return d(this.valueArea.children).find(function(t){return i(t,"landing-ui-selected")})||d(this.itemsArea.children).find(function(t){return i(t,"landing-ui-selected")})},onDocumentClick:function(){if(this.popup){this.popup.close()}},adjustPlaceholder:function(){if(d(this.valueArea.children).length===0){this.placeholder=this.createValuePlaceholder();o(this.placeholder,this.valueArea)}else if(this.placeholder){v(this.placeholder);this.placeholder=null}},getItem:function(t){return this.items.find(function(e){return e.value==t})},createValuePlaceholder:function(){return s("div",{props:{className:"landing-ui-field-dnd-value-placeholder"},children:[s("span",{html:BX.Landing.Loc.getMessage("LANDING_FIELD_CATALOG_CONSTRUCTOR_PLACEHOLDER_TEXT")})]})},createItem:function(t){var e=s("div",{props:{className:"landing-ui-field-dnd-list-item"+(t.image?" landing-ui-with-image":"")},attrs:{title:t.name},html:t.image?s("img",{props:{src:t.image}}).outerHTML:L(t.name)});var i=s("span",{props:{className:"landing-ui-field-dnd-list-item-remove"}});o(i,e);g(e,"data-value",t.value);h(e,"draggable","true");p(e,"dragstart",this.onDragStart);p(e,"dragend",this.onDragEnd);p(e,"dragover",this.onItemDragOver);p(e,"dragleave",this.onItemDragLeave);p(e,"drag",this.onDrag);p(i,"click",this.onRemoveClick);p(e,"click",this.onElementClick);return e},isChanged:function(){return JSON.stringify(this.value)!==JSON.stringify(this.getValue())},getValue:function(){var t=d(this.valueArea.children);t=t.filter(function(t){return i(t,"landing-ui-field-dnd-list-item")});return t.map(function(t){return g(t,"data-value")})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/field/sortable_list.min.js?16992580222604";s:6:"source";s:44:"/bitrix/js/landing/ui/field/sortable_list.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var i=BX.Landing.Utils.remove;var e=BX.Landing.Utils.unbind;var t=BX.Landing.Utils.addClass;var n=BX.Landing.Utils.removeClass;var a=BX.Landing.Utils.encodeDataValue;var r=BX.Landing.Utils.prepend;var l=BX.Landing.Utils.append;var s=BX.Landing.Utils.create;var d=BX.Landing.Utils.data;var g=BX.Landing.Utils.slice;var o=BX.Landing.Utils.bind;BX.Landing.UI.Field.SortableList=function(i){BX.Landing.UI.Field.DragAndDropList.apply(this,arguments);t(this.layout,"landing-ui-field-sortable-list");this.makePreview();r(this.preview,this.target)};BX.Landing.UI.Field.SortableList.prototype={constructor:BX.Landing.UI.Field.SortableList,__proto__:BX.Landing.UI.Field.DragAndDropList.prototype,onDragStart:function(i){BX.Landing.UI.Field.DragAndDropList.prototype.onDragStart.call(this,i);t(this.preview,"landing-ui-ondrag");t(this.dragItem,"landing-ui-ondrag")},onDragEnd:function(i){BX.Landing.UI.Field.DragAndDropList.prototype.onDragEnd.call(this,i);n(this.preview,"landing-ui-ondrag");n(this.dragItem,"landing-ui-ondrag");this.makePreview()},onElementClick:function(){},makePreview:function(){if(!this.preview){this.preview=s("div",{props:{className:"landing-ui-field-sortable-list-preview"}})}this.preview.innerHTML="";this.getValue().forEach(function(i){l(this.createPreviewItem(this.getItem(i).preview,i),this.preview)},this)},createItem:function(t){var n=BX.Landing.UI.Field.DragAndDropList.prototype.createItem.call(this,t);i(n.querySelector(".landing-ui-field-dnd-list-item-remove"));e(n,"drag",this.onDrag);r(s("span",{props:{className:"landing-ui-field-dnd-list-item-drag"}}),n);o(n,"mouseover",this.highlightByValue.bind(this,t.value));o(n,"mouseout",this.removeHighLightByValue.bind(this,t.value));return n},createPreviewItem:function(i,e){return s("div",{props:{className:"landing-ui-field-sortable-list-preview-item"},attrs:{"data-value":a(e)},children:[s("img",{props:{src:i},events:{mouseover:this.highlightByValue.bind(this,e),mouseout:this.removeHighLightByValue.bind(this,e)}})]})},highlightByValue:function(i){var e=this.getPreviewByValue(i);var n=this.getElementByValue(i);if(e){t(e,"landing-ui-active")}if(n){t(n,"landing-ui-active")}},removeHighLightByValue:function(i){var e=this.getPreviewByValue(i);var t=this.getElementByValue(i);if(e){n(e,"landing-ui-active")}if(t){n(t,"landing-ui-active")}},getElementByValue:function(i){return g(this.valueArea.children).find(function(e){return d(e,"data-value")==i})},getPreviewByValue:function(i){return g(this.preview.children).find(function(e){return d(e,"data-value")==i})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/field/position_field.min.js?16992580221930";s:6:"source";s:45:"/bitrix/js/landing/ui/field/position_field.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var i=BX.Landing.Utils.addClass;var t=BX.Landing.Utils.clone;var e=BX.Landing.Utils.append;var a=BX.Landing.Utils.create;var n=[{name:"",value:"top-left"},{name:"",value:"top-center"},{name:"",value:"top-right"},{name:"",value:"middle-left"},{name:"",value:"middle-center"},{name:"",value:"middle-right"},{name:"",value:"bottom-left"},{name:"",value:"bottom-center"},{name:"",value:"bottom-right"}];BX.Landing.UI.Field.Position=function(s){this.dataItems=s.items?t(s.items):{};this.mode=s.mode?s.mode:"ball";if(Object.keys(this.dataItems).length){s.items=n.map(function(i){if(i.value in this.dataItems){if("content"in this.dataItems[i.value]){i.name=this.dataItems[i.value].content}if("value"in this.dataItems[i.value]){i.value=this.dataItems[i.value].value}}return i},this)}else{s.items=n}BX.Landing.UI.Field.ButtonGroup.apply(this,arguments);i(this.layout,"landing-ui-field-position");i(this.layout,"landing-ui-field-position-mode-"+this.mode);this.wrapper=a("div",{props:{className:"landing-ui-field-position-wrapper"}});this.container=a("div",{props:{className:"landing-ui-field-position-container"},children:this.buttons.map(function(i){return i.layout})});e(this.container,this.wrapper);var l=a("div",{props:{className:"landing-ui-field-position-stripes"},children:[a("span",{props:{className:"landing-ui-field-position-stripes-item"}}),a("span",{props:{className:"landing-ui-field-position-stripes-item"}}),a("span",{props:{className:"landing-ui-field-position-stripes-item"}}),a("span",{props:{className:"landing-ui-field-position-stripes-item"}}),a("span",{props:{className:"landing-ui-field-position-stripes-item"}})]});e(l,this.wrapper);e(this.wrapper,this.input);this.setValue(s.value,true);this.value=this.getValue()};BX.Landing.UI.Field.Position.prototype={constructor:BX.Landing.UI.Field.Position,__proto__:BX.Landing.UI.Field.ButtonGroup.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:64:"/bitrix/js/landing/ui/field/checkbox_field.min.js?16992580222746";s:6:"source";s:45:"/bitrix/js/landing/ui/field/checkbox_field.js";s:3:"min";s:49:"/bitrix/js/landing/ui/field/checkbox_field.min.js";s:3:"map";s:49:"/bitrix/js/landing/ui/field/checkbox_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var i=BX.Landing.Utils.addClass;var t=BX.Landing.Utils.isArray;var e=BX.Landing.Utils.isPlainObject;var n=BX.Landing.Utils.isFunction;var a=BX.Landing.Utils.create;var l=BX.Landing.Utils.random;var s=BX.Landing.Utils.escapeHtml;var r=BX.Landing.Utils.append;var c=BX.Landing.Utils.slice;var u=BX.Landing.Utils.encodeDataValue;var d=BX.Landing.Utils.decodeDataValue;var h=BX.Landing.Utils.isNumber;var o=BX.Landing.Utils.isBoolean;var p=BX.Landing.Utils.data;var f=BX.Landing.Utils.clone;BX.Landing.UI.Field.Checkbox=function(e){BX.Landing.UI.Field.BaseField.apply(this,arguments);i(this.layout,"landing-ui-field-checkbox");this.onChangeHandler=n(e.onChange)?e.onChange:function(){};this.items=t(e.items)?e.items:[];this.value=t(e.value)?e.value:null;this.depth=h(e.depth)?e.depth:0;this.compact=o(e.compact)?e.compact:false;this.multiple=e.multiple!==false;p(this.layout,"data-depth",this.depth);p(this.layout,"data-compact",this.compact);if(t(this.value)){this.value=this.value.map(function(i){return d(i)})}if(!t(this.value)){this.value=this.items.filter(function(i){return i.checked}).map(function(i){return d(i.value)})}this.content=this.value;this.items.forEach(this.addItem,this)};BX.Landing.UI.Field.Checkbox.prototype={constructor:BX.Landing.UI.Field.Checkbox,__proto__:BX.Landing.UI.Field.BaseField.prototype,addItem:function(i){if(e(i)){var t="checkbox_item_"+l();var n=a("div",{props:{className:"landing-ui-field-checkbox-item"+(i.disabled?" landing-ui-disabled":"")},children:[a("input",{props:{className:"landing-ui-field-checkbox-item-checkbox"},attrs:{id:t,type:"checkbox",value:u(i.value),checked:this.value.find(function(t){return t==i.value})!==undefined},events:{change:this.onItemChange.bind(this)}}),a("label",{props:{className:"landing-ui-field-checkbox-item-label"},attrs:{for:t,title:BX.Text.encode(i.name)},html:i.html?i.html:s(i.name)})]});r(n,this.input)}return n},onItemChange:function(){this.onChangeHandler(this);this.onValueChangeHandler(this);this.emit("onChange")},isChanged:function(){var i=f(this.content).sort();var t=this.getValue().sort();return JSON.stringify(i)!==JSON.stringify(t)},setValue:function(i){if(t(i)){c(this.input.children).forEach(function(i){i.querySelector("input").checked=false});i.forEach(function(i){var t=c(this.input.children).find(function(t){return d(t.querySelector("input").value)==i},this);if(t){t.querySelector("input").checked=true}},this)}},getValue:function(){var i=c(this.input.children).filter(function(i){return i.querySelector("input").checked}).map(function(i){return d(i.querySelector("input").value)});if(!this.multiple){return i.length>0?i[0]:false}return i}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/field/radio_field.min.js?1699258022469";s:6:"source";s:42:"/bitrix/js/landing/ui/field/radio_field.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.Radio=function(i){BX.Landing.UI.Field.Checkbox.apply(this,arguments)};BX.Landing.UI.Field.Radio.prototype={constructor:BX.Landing.UI.Field.Radio,__proto__:BX.Landing.UI.Field.Checkbox.prototype,superclass:BX.Landing.UI.Field.Checkbox.prototype,addItem:function(i){var e=this.superclass.addItem.call(this,i);if(e){var n=e.querySelector("input");if(n){n.type="radio";n.name=this.id}}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:67:"/bitrix/js/landing/ui/field/multiselect_field.min.js?16992580225813";s:6:"source";s:48:"/bitrix/js/landing/ui/field/multiselect_field.js";s:3:"min";s:52:"/bitrix/js/landing/ui/field/multiselect_field.min.js";s:3:"map";s:52:"/bitrix/js/landing/ui/field/multiselect_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var i=BX.Landing.Utils.addClass;var t=BX.Landing.Utils.hasClass;var n=BX.Landing.Utils.removeClass;var e=BX.Landing.Utils.isArray;var a=BX.Landing.Utils.isFunction;var s=BX.Landing.Utils.create;var l=BX.Landing.Utils.random;var o=BX.Landing.Utils.escapeHtml;var u=BX.Landing.Utils.append;var d=BX.Landing.Utils.slice;var p=BX.Landing.Utils.encodeDataValue;var r=BX.Landing.Utils.remove;var h=BX.Landing.Utils.data;var c=BX.Landing.Utils.bind;var g=BX.Landing.Utils.style;var f=BX.Landing.Utils.clone;var v=BX.Landing.Utils.offsetLeft;var m=BX.Landing.Utils.offsetTop;var B=BX.Landing.Utils.findParent;var C=BX.Landing.Utils.decodeDataValue;var L=BX.Landing.Collection.BaseCollection;function X(i,t,n){i.forEach(function(i){var a=new BX.Landing.UI.Field.Checkbox({id:i.value,items:[{name:i.name,value:i.value,checked:i.selected}],depth:n,compact:true,onChange:t.onCheckboxChange});t.fields.add(a);if(a.layout){u(a.layout,t.getPopup().contentContainer)}if(i.selected){t.addPlaceholder(i)}if(e(i.items)){n+=1;X(i.items,t,n);n-=1}})}BX.Landing.UI.Field.MultiSelect=function(t){BX.Landing.UI.Field.BaseField.apply(this,arguments);i(this.layout,"landing-ui-field-multiselect");this.onChangeHandler=a(t.onChange)?t.onChange:function(){};this.items=e(t.items)?t.items:[];this.value=e(t.value)?t.value:null;this.content=this.value;this.fields=new L;this.button=new BX.Landing.UI.Button.BaseButton("dropdown_button",{text:BX.Landing.Loc.getMessage("LINK_URL_SUGGESTS_SELECT"),className:"landing-ui-button-select-link",onClick:this.onButtonClick.bind(this)});this.grid=s("div",{props:{className:"landing-ui-field-multiselect-grid"},children:[s("div",{props:{className:"landing-ui-field-multiselect-grid-left"},children:[this.input]}),s("div",{props:{className:"landing-ui-field-multiselect-grid-right"},children:[this.button.layout]})]});u(this.grid,this.layout);this.onInputClick=this.onInputClick.bind(this);this.onCheckboxChange=this.onCheckboxChange.bind(this);var n=BX.Landing.PageObject.getRootWindow();c(this.input,"click",this.onInputClick);c(n.document,"click",this.onDocumentClick.bind(this));requestAnimationFrame(function(){X(this.items,this,0);if(e(this.value)){this.value=this.value.map(function(i){return C(i)});this.setValue(this.value,true)}else{this.value=this.getValue();this.content=this.value}}.bind(this))};BX.Landing.UI.Field.MultiSelect.prototype={constructor:BX.Landing.UI.Field.MultiSelect,__proto__:BX.Landing.UI.Field.BaseField.prototype,addPlaceholder:function(i){var t=s("div",{props:{className:"landing-ui-field-multiselect-placeholder"},attrs:{"data-item":p(i),title:o(i.name)},children:[s("span",{props:{className:"landing-ui-field-multiselect-placeholder-text"},html:o(i.name)}),s("span",{props:{className:"landing-ui-field-multiselect-placeholder-remove"},events:{click:this.onPlaceholderRemoveClick.bind(this,i)}})]});u(t,this.input)},onPlaceholderRemoveClick:function(i,t,n){if(t){t.preventDefault();t.stopPropagation()}var e=this.getPlaceholderByItem(i);if(e){r(e);this.adjustPopupPosition();var a=this.fields.get(i.value);if(a){a.layout.querySelector("input").checked=false}}if(!n){this.onValueChangeHandler(this)}},onCheckboxChange:function(i){if(i instanceof BX.Landing.UI.Field.Checkbox){var t=i.getValue();if(t.length){this.addPlaceholder(i.items[0]);this.adjustPopupPosition()}else{this.onPlaceholderRemoveClick(i.items[0],null,true)}this.onValueChangeHandler(this)}},getPlaceholderByItem:function(i){return d(this.input.children).find(function(t){return h(t,"data-item").value===i.value})},getPopup:function(){if(this.popup){return this.popup}this.popup=new BX.Main.Popup({id:this.selector+"_"+l(),bindElement:this.input,autoHide:true,maxHeight:142,events:{onPopupClose:function(){n(this.input,"landing-ui-active");if(t(this.layout.parentElement.parentElement,"landing-ui-form-style")){void g(this.layout.parentElement.parentElement,{"z-index":null,position:null})}}.bind(this)}});if(this.popup.popupContainer){i(this.popup.popupContainer,"landing-ui-field-multiselect-popup");var e=B(this.input,{className:"landing-ui-panel-content-body-content"},document.body);if(e){u(this.popup.popupContainer,e)}}return this.popup},showPopup:function(){this.getPopup().show();this.adjustPopupPosition();this.setValue(this.getValue(),true)},adjustPopupPosition:function(){if(this.popup){var i=B(this.input,{className:"landing-ui-panel-content-body-content"});if(BX.Type.isDomNode(i)){var t=m(this.input,i);var n=v(this.input,i);var e=this.input.getBoundingClientRect();var a=2;requestAnimationFrame(function(){this.popup.popupContainer.style.top=t+e.height+a+"px";this.popup.popupContainer.style.left=n+"px";this.popup.popupContainer.style.width=e.width+"px"}.bind(this))}}},onInputClick:function(t){if(t){t.stopPropagation()}var e=this.getPopup();if(e.isShown()){n(this.input,"landing-ui-active");return e.close()}i(this.input,"landing-ui-active");return this.showPopup()},onButtonClick:function(i){i.preventDefault();i.stopPropagation();this.onInputClick()},onDocumentClick:function(){this.getPopup().close()},getValue:function(){return d(this.input.children).map(function(i){return h(i,"data-item").value})},isChanged:function(){var i=f(this.content).sort();var t=this.getValue().sort();return JSON.stringify(i)!==JSON.stringify(t)},getItemByValue:function(i,t){var n=null;function e(i,t){return i.forEach(function(i){if(t==i.value){n=i;return}if(i.items){e(i.items,t)}},this)}e(i,t);return n},setValue:function(i,t){if(e(i)){this.input.innerHTML="";i.forEach(function(i){var t=this.getItemByValue(this.items,i);if(t){this.addPlaceholder(t);var n=this.fields.find(function(t){return t.id===i}.bind(this));if(n){n.setValue([i])}}},this)}if(!t){this.onValueChangeHandler(this)}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:62:"/bitrix/js/landing/ui/field/filter_field.min.js?16992580221673";s:6:"source";s:43:"/bitrix/js/landing/ui/field/filter_field.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var i=BX.Landing.Utils.addClass;var t=BX.Landing.Utils.removeClass;var n=BX.Landing.Utils.isPlainObject;var e=BX.Landing.Utils.append;var a=BX.Landing.Utils.findParent;var s=BX.Landing.Utils.offsetLeft;var l=BX.Landing.Utils.offsetTop;var o=BX.Landing.Utils.rect;var r=BX.Landing.Utils.onCustomEvent;var p=BX.Landing.Utils.bind;BX.Landing.UI.Field.Filter=function(t){BX.Landing.UI.Field.BaseField.apply(this,arguments);i(this.layout,"landing-ui-field-filter");this.input.innerHTML=t.html;requestAnimationFrame(function(){BX.ajax.processScripts(BX.processHTML(t.html).SCRIPT,undefined,function(){this.filter=BX.Main.filterManager.getById(t.filterId);this.value=n(t.value)?t.value:{};e(this.filter.getPopup().popupContainer,a(this.layout,{className:"landing-ui-panel-content-body"}));r(this.filter.getPopup(),"onPopupShow",this.adjustPopupPosition.bind(this));p(a(this.layout,{className:"landing-ui-panel-content-body-content"}),"scroll",this.adjustPopupPosition.bind(this));this.filter.getApi().setFields(this.value);this.filter.getApi().apply()}.bind(this))}.bind(this))};BX.Landing.UI.Field.Filter.prototype={constructor:BX.Landing.UI.Field.Filter,__proto__:BX.Landing.UI.Field.BaseField.prototype,getValue:function(){var i=this.filter.getFilterFieldsValues();if(n(i)){if("FIND"in i){delete i["FIND"]}return i}return{}},adjustPopupPosition:function(){if(this.filter.getPopup()){var i=this.input.getBoundingClientRect();var t=6;requestAnimationFrame(function(){this.filter.getPopup().popupContainer.style.top=i.top+i.height+t+"px";this.filter.getPopup().popupContainer.style.left=i.left+"px"}.bind(this))}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/field/font_field.min.js?16992580225233";s:6:"source";s:41:"/bitrix/js/landing/ui/field/font_field.js";s:3:"min";s:45:"/bitrix/js/landing/ui/field/font_field.min.js";s:3:"map";s:45:"/bitrix/js/landing/ui/field/font_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Runtime.loadExtension("landing.ui.component.link");var t=BX.Landing.Utils.isFunction;var e=BX.Landing.Utils.isPlainObject;var n=BX.Landing.Utils.bind;var i=BX.Landing.Utils.proxy;var a=BX.Landing.Utils.escapeHtml;var s=BX.Landing.Utils.addClass;var l=BX.Landing.Utils.clone;var o=/g-font-(?!size-|weight-)([a-z0-9-]+)/gi;var r=/[a-z0-9 ]*[a-z0-9]/i;var h=/['|"]/g;var c=/ /g;var u=["H1","H2","H3","H4","H5","H6","H7"];BX.Landing.UI.Field.Font=function(l){BX.Landing.UI.Field.BaseField.apply(this,arguments);s(this.layout,"landing-ui-field-font");this.value=l.value;this.headlessMode=l.headlessMode===true;this.frame=l.frame;this.items=[];this.defaultFontFamily=null;this.defaultFontLink=new BX.Landing.UI.Component.Link({text:BX.Landing.Loc.getMessage("LANDING_EDIT_BLOCK_DEFAULT_FONT")});s(this.defaultFontLink.getLayout(),"landing-ui-field-font-link");if(e(l.items)){var o=Object.keys(this.items);this.items=o.map((function(t){return{name:this.items[t],value:t}}),this)}this.onChangeHandler=t(l.onChange)?l.onChange:function(){};this.onValueChangeHandler=t(l.onValueChange)?l.onValueChange:function(){};if(this.value){this.content=a(this.value.family);this.input.innerHTML=this.value.family}else{this.content=a(this.content);this.input.innerHTML=this.content}if(this.frame){if(l.styleNode.currentTarget){this.element=l.styleNode.currentTarget}else{this.element=this.frame.document.querySelectorAll(this.selector)[0]}if(this.element){var r=BX.style(this.element,"font-family");if(r){r=r.replace(h,"");this.content=r.split(",")[0];this.input.innerHTML=this.content}this.createLinkContainer();this.setConditionLink()}}if(this.content.search(new RegExp("var\\(--[a-z-]*\\)"))!==-1){var c=window.getComputedStyle(document.body).getPropertyValue("font-family");this.input.innerHTML=c.replace(h,"").split(",")[0]}n(this.input,"click",i(this.onInputClick,this));this.defaultFontLink.subscribe("onClick",i(this.onDefaultFontLinkClick,this))};function d(t){return"g-font-"+t.toLowerCase().replace(c,"-")}BX.Landing.UI.Field.Font.prototype={constructor:BX.Landing.UI.Field.Font,__proto__:BX.Landing.UI.Field.BaseField.prototype,onInputClick:function(t){t.preventDefault();t.stopPropagation();BX.Landing.UI.Panel.GoogleFonts.getInstance().show().then(function(t){if(!this.response){this.response=l(BX.Landing.UI.Panel.GoogleFonts.getInstance().response);this.response.forEach((function(t){this.items.push({name:t.family,value:d(t.family)})}),this)}this.setValue(t)}.bind(this))},onDefaultFontLinkClick:function(){if(this.defaultFontFamily){const t=this.element.classList.value.match(o);if(t!==null){t.forEach((t=>{this.element.classList.remove(t)}))}this.content=this.defaultFontFamily.replace(h,"").split(",")[0];const e={family:this.content};this.setValue(e)}},createLinkContainer:function(){this.linkContainer=document.createElement("div");this.linkContainer.classList.add("landing-ui-component-link-container");this.layout.append(this.linkContainer)},setConditionLink:function(){if(this.element){if(u.includes(this.element.tagName)){const t=document.createElement("H2");document.body.appendChild(t);this.defaultFontFamily=getComputedStyle(t).fontFamily;t.remove()}else{this.defaultFontFamily=getComputedStyle(document.body).fontFamily}this.defaultFont=this.defaultFontFamily.match(r)[0];this.currentFont=getComputedStyle(this.element).fontFamily.match(r)[0];if(this.defaultFont!==this.currentFont){this.linkContainer.append(this.defaultFontLink.getLayout())}else if(this.linkContainer.hasChildNodes()){this.linkContainer.removeChild(this.linkContainer.firstChild)}}},setValue:function(t,n){if(e(t)){var i=d(t.family);var s=[100,200,300,400,500,600,700,800,900];var l=":wght@"+s.join(";");var o=t.family.replace(c,"+");var r=o+l;var h=BX.Landing.UI.Panel.GoogleFonts.getInstance().client.makeUrl({family:r});if(this.headlessMode){this.value={family:t.family,public:"https://fonts.google.com/specimen/"+o,uri:h};this.input.innerHTML=a(t.family);this.emit("onChange")}else{const e=BX.Landing.UI.Tool.FontManager.getInstance();e.addFont({className:i,family:o,href:h,category:t.category},window);this.input.innerHTML=a(t.family);this.onChangeHandler(i,this.items,this.postfix,this.property);this.onValueChangeHandler(this);e.removeUnusedFonts();if(!n){let t="";e.getUsedLoadedFonts().forEach((function(e){if(e.element){e.element.setAttribute("rel","stylesheet");e.element.removeAttribute("media");t+="<noscript>"+e.element.outerHTML+"</noscript>\n";e.element.setAttribute("rel","preload");e.element.setAttribute("onload","this.removeAttribute('onload');this.rel='stylesheet'");e.element.setAttribute("as","style");t+=e.element.outerHTML+"\n"}if(e.CSSDeclaration){t+=e.CSSDeclaration.outerHTML}}));t=t.replace("async@load","all").replace(/data-loadcss="true"/g,"");BX.Landing.Backend.getInstance().action("Landing::updateHead",{content:t})}}}this.setConditionLink()},getValue:function(){return this.value},onFrameLoad:function(){const t=Array.from(this.element.classList.value.matchAll(o));if(t){const e=t[t.length-1][1].split("-").map((t=>t.charAt(0).toUpperCase()+t.slice(1))).join(" ");this.content=e;this.setValue({family:e},true)}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/field/html_field.min.js?16992580221233";s:6:"source";s:41:"/bitrix/js/landing/ui/field/html_field.js";s:3:"min";s:45:"/bitrix/js/landing/ui/field/html_field.min.js";s:3:"map";s:45:"/bitrix/js/landing/ui/field/html_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var t=BX.Landing.Utils.addClass;var n=BX.Landing.Utils.bind;var i=BX.Landing.Utils.proxy;var e=BX.Landing.Utils.decodeDataValue;BX.Landing.UI.Field.Html=function(s){BX.Landing.UI.Field.BaseField.apply(this,arguments);t(this.layout,"landing-ui-field-html");this.onContentChange=i(this.onContentChange,this);this.onMousewheel=i(this.onMousewheel,this);n(this.input,"input",this.onContentChange);n(this.input,"keydown",this.onContentChange);n(this.input,"mousewheel",this.onMousewheel);this.input.value=e(this.content);setTimeout(function(){this.adjustHeight()}.bind(this),20)};BX.Landing.UI.Field.Html.prototype={constructor:BX.Landing.UI.Field.Html,__proto__:BX.Landing.UI.Field.BaseField.prototype,createInput:function(){return BX.create("textarea",{props:{className:"landing-ui-field-input"},html:this.content})},onMousewheel:function(t){t.stopPropagation()},onPaste:function(){},onContentChange:function(){this.adjustHeight();this.onValueChangeHandler(this)},adjustHeight:function(){this.input.style.height="0px";this.input.style.height=Math.min(this.input.scrollHeight,180)+"px"},getValue:function(){return this.input.value}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/field/embed_field.min.js?16992580223108";s:6:"source";s:42:"/bitrix/js/landing/ui/field/embed_field.js";s:3:"min";s:46:"/bitrix/js/landing/ui/field/embed_field.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/field/embed_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var e=BX.Landing.Utils.bind;var i=BX.Landing.Utils.fireCustomEvent;var t=BX.Landing.Utils.getQueryParams;var a=BX.Landing.Utils.remove;var n=BX.Landing.Utils.create;BX.Landing.UI.Field.Embed=function(e){e.textOnly=true;var i=e.content;e.content=i.source||i.src;e.placeholder=BX.Landing.Loc.getMessage("LANDING_EMBED_NOT_BG_FIELD_DESCRIPTION");e.description=e.description||"<span class='landing-ui-anchor-preview'>"+BX.Landing.Loc.getMessage("LANDING_EMBED_NOT_BG_FIELD_DESCRIPTION")+"</span>";BX.Landing.UI.Field.Text.apply(this,arguments);this.hiddenInput=n("input",{props:{type:"hidden",value:i.src||this.input.innerText}});this.error=BX.create("div",{props:{className:"landing-ui-field-error"}});BX.Dom.append(this.error,this.layout);BX.Dom.style(this.description,"margin-bottom","0px");this.adjustForm()};BX.Landing.UI.Field.Embed.isBgVideo=false;BX.Landing.UI.Field.Embed.prototype={constructor:BX.Landing.UI.Field.Embed,__proto__:BX.Landing.UI.Field.Text.prototype,onInputInput:function(){var e=this.getValue();this.adjustForm(true);this.onInputHandler(e);this.onValueChangeHandler(this);var i=new BX.Event.BaseEvent({data:{value:e},compatData:[e]});this.emit("change",i)},isEmbedUrl:function(e){return BX.Landing.Utils.Matchers.youtube.test(e)||BX.Landing.Utils.Matchers.vimeo.test(e)||BX.Landing.Utils.Matchers.rutube.test(e)||BX.Landing.Utils.Matchers.vk.test(e)||BX.Landing.Utils.Matchers.vine.test(e)||BX.Landing.Utils.Matchers.facebookVideos.test(e)},getValue:function(){return{src:this.mediaService?this.mediaService.getEmbedURL():this.input.innerText,preview:this.mediaService?this.mediaService.getEmbedPreview():"",source:this.input.innerText,ratio:this.mediaService&&this.mediaService.isVertical?BX.Landing.Block.Node.Embed.DEFAULT_RATIO_V:BX.Landing.Block.Node.Embed.DEFAULT_RATIO_H}},adjustForm:function(e){var i=String(this.input.innerText).trim();this.hideError();if(this.isEmbedUrl(i)){if(this.mediaService&&this.mediaService.form){a(this.mediaService.form.layout)}const r=new BX.Landing.MediaService.Factory;this.mediaService=r.create(i,!e?t(this.hiddenInput.value):{});this.mediaService.setBgVideoMode(this.constructor.isBgVideo);if(this.mediaService){var n=this.mediaService.getSettingsForm();if(n){this.layout.appendChild(n.layout)}if(!this.mediaService.isDataLoaded){this.readyToSave=false;BX.addCustomEvent(this.mediaService,"onDataLoaded",(()=>{this.readyToSave=true;this.emit("onChangeReadyToSave")}));BX.addCustomEvent(this.mediaService,"onDataLoadError",(e=>{this.readyToSave=false;this.showError(e.message)}))}this.emit("onChangeReadyToSave")}}else{if(this.mediaService){a(this.mediaService.form.layout)}if(BX.Type.isStringFilled(i)){this.showError(BX.Landing.Loc.getMessage("LANDING_EMBED_ERROR_WRONG_SOURCE_TEXT_ALL"))}}},showError:function(e){BX.Dom.append(BX.Landing.UI.Field.BaseField.createError(e),this.error);BX.Dom.style(this.description,"margin-bottom",null)},hideError:function(){BX.Dom.clean(this.error);BX.Dom.style(this.description,"margin-bottom","0px")}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/landing/ui/field/embed_bg_field.min.js?1699258022939";s:6:"source";s:45:"/bitrix/js/landing/ui/field/embed_bg_field.js";s:3:"min";s:49:"/bitrix/js/landing/ui/field/embed_bg_field.min.js";s:3:"map";s:49:"/bitrix/js/landing/ui/field/embed_bg_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");const n=BX.Landing.Utils.bind;const e=BX.Landing.Utils.fireCustomEvent;const i=BX.Landing.Utils.getQueryParams;const t=BX.Landing.Utils.remove;const d=BX.Landing.Utils.create;BX.Landing.UI.Field.EmbedBg=function(n){n.description="<span class='landing-ui-anchor-preview'>"+BX.Landing.Loc.getMessage("LANDING_EMBED_BG_FIELD_DESCRIPTION")+"</span>";BX.Landing.UI.Field.Embed.apply(this,arguments);BX.Dom.addClass(this.error,"landing-ui-error")};BX.Landing.UI.Field.EmbedBg.isBgVideo=true;BX.Landing.UI.Field.EmbedBg.prototype={constructor:BX.Landing.UI.Field.EmbedBg,__proto__:BX.Landing.UI.Field.Embed.prototype,isEmbedUrl:function(n){return BX.Landing.Utils.Matchers.youtube.test(n)||BX.Landing.Utils.Matchers.vk.test(n)},getValue:function(){const n=BX.Landing.UI.Field.Embed.prototype.getValue.call(this);delete n.ratio;return n}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/ui/field/date_field.min.js?16992580221896";s:6:"source";s:41:"/bitrix/js/landing/ui/field/date_field.js";s:3:"min";s:45:"/bitrix/js/landing/ui/field/date_field.min.js";s:3:"map";s:45:"/bitrix/js/landing/ui/field/date_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");var t=BX.Landing.Utils.create;var e=BX.Landing.Utils.bind;var i=BX.Landing.Utils.fireCustomEvent;var a="s";var n="ms";BX.Landing.UI.Field.Date=function(i){i.textOnly=true;BX.Landing.UI.Field.BaseField.apply(this,arguments);this.format=i.format===a||i.format===n?i.format:a;this.time=i.time===true;this.hiddenInput=t("input",{props:{type:"hidden"},value:i.content});e(this.input,"click",this.onInputClick.bind(this));this.setValue(this.formatDateToValue(i.content))};BX.Landing.UI.Field.Date.prototype={constructor:BX.Landing.UI.Field.Date,__proto__:BX.Landing.UI.Field.BaseField.prototype,onInputClick:function(){var t={node:this.input,field:this.hiddenInput,bTime:this.time,value:BX.date.format(this.getFormat(),new Date(this.formatDateToValue(this.hiddenInput.value)*1e3)),bHideTime:!this.time,callback_after:function(t){this.setValue(t.getTime()/1e3)}.bind(this)};return top.BX.calendar(t)},getFormat:function(){return BX.date.convertBitrixFormat(BX.Landing.Loc.getMessage(this.time?"FORMAT_DATETIME":"FORMAT_DATE"))},reset:function(){this.setValue("")},setValue:function(t){if(t){this.input.innerText=BX.date.format(this.getFormat(),new Date(t*1e3));this.hiddenInput.value=this.formatValue(t);this.onValueChangeHandler(this);var e=new BX.Event.BaseEvent({data:{value:this.getValue()},compatData:[this.getValue()]});this.emit("change",e)}},formatValue:function(t){switch(this.format){case a:return t;case n:return t*1e3;default:break}},formatDateToValue:function(t){switch(this.format){case a:return t;case n:return t/1e3;default:break}},getValue:function(){return this.formatValue(this.formatDateToValue(this.hiddenInput.value))},clone:function(t){var e=Object.assign({},t||this.data,{content:(new Date).getTime()});var i=new this.constructor(e);if(this.type){i.type=this.type}return i}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:68:"/bitrix/js/landing/ui/field/block_source_field.min.js?16992580221561";s:6:"source";s:49:"/bitrix/js/landing/ui/field/block_source_field.js";s:3:"min";s:53:"/bitrix/js/landing/ui/field/block_source_field.min.js";s:3:"map";s:53:"/bitrix/js/landing/ui/field/block_source_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.BlockSource=function(e){BX.Landing.UI.Field.BaseField.apply(this,arguments);BX.Landing.Utils.addClass(this.layout,"landing-ui-field-block-source");this.onSourceChangeHandler=e.onSourceChange;this.value=e.value;this.sourceField=this.createLinkField();this.layout.innerHTML="";BX.Landing.Utils.append(this.sourceField.layout,this.layout)};BX.Landing.UI.Field.BlockSource.prototype={constructor:BX.Landing.UI.Field.BlockSource,__proto__:BX.Landing.UI.Field.BaseField.prototype,getSources:function(){return BX.Landing.Main.getInstance().options.sources},createLinkField:function(){return new BX.Landing.UI.Field.LinkUrl({selector:"source",title:BX.Landing.Loc.getMessage("LANDING_BLOCK__SOURCE_TITLE"),textOnly:true,disableCustomURL:true,disablePages:true,disallowType:true,allowedTypes:[BX.Landing.UI.Field.LinkUrl.TYPE_BLOCK],customPlaceholder:BX.Landing.Loc.getMessage("LANDING_BLOCK__BLOCK_SOURCE_PLACEHOLDER"),options:{siteId:BX.Landing.Main.getInstance().options.site_id,landingId:BX.Landing.Main.getInstance().id,filter:{"=TYPE":BX.Landing.Main.getInstance().options.params.type}},content:this.value,onValueChange:function(e){var n=null;if(BX.type.isPlainObject(e)&&BX.type.isPlainObject(e.source)){n=Object.keys(e.source)[0]}var i=this.getSources().find((function(e){return e.id===n}));setTimeout(function(){this.onSourceChangeHandler(i)}.bind(this),0)}.bind(this)})},getValue:function(){return this.sourceField.getValue()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:69:"/bitrix/js/landing/ui/field/dynamic_image_field.min.js?16992580221947";s:6:"source";s:50:"/bitrix/js/landing/ui/field/dynamic_image_field.js";s:3:"min";s:54:"/bitrix/js/landing/ui/field/dynamic_image_field.min.js";s:3:"map";s:54:"/bitrix/js/landing/ui/field/dynamic_image_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.DynamicImage=function(e){BX.Landing.UI.Field.BaseField.apply(this,arguments);BX.addClass(this.layout,"landing-ui-field-dynamic-image");BX.remove(this.input);this.reference=e.reference;this.linkField=e.linkField;this.dropdownField=new BX.Landing.UI.Field.Dropdown({title:e.title,items:e.dropdownItems,content:BX.type.isPlainObject(e.value)?e.value.id:undefined});this.checkboxField=new BX.Landing.UI.Field.Checkbox({title:BX.Landing.Loc.getMessage("LANDING_BLOCK__DYNAMIC_LINK_ACTION_FIElD_LABEL"),items:[{name:BX.Landing.Loc.getMessage("LANDING_BLOCK__DYNAMIC_IMAGE_MAKE_LINK_TO_DETAIL"),value:true,checked:function(){if(BX.type.isPlainObject(e.value)){return[true,"true"].includes(e.value.link)}return false}()}],multiple:false});BX.remove(this.dropdownField.header);BX.remove(this.checkboxField.header);this.grid=this.createGrid();this.dropdownContainer=this.grid.children[0];this.checkboxContainer=this.grid.children[1];this.layout.appendChild(this.grid);this.dropdownContainer.appendChild(this.dropdownField.layout);if(!e.hideCheckbox){this.checkboxContainer.appendChild(this.checkboxField.layout)}if(BX.type.isPlainObject(e.value)){this.setValue(e.value)}};BX.Landing.UI.Field.DynamicImage.prototype={constructor:BX.Landing.UI.Field.DynamicImage,__proto__:BX.Landing.UI.Field.BaseField.prototype,createGrid:function(){return BX.create({tag:"div",props:{className:"landing-ui-field-dynamic-image-grid"},children:[BX.create({tag:"div",props:{className:"landing-ui-field-dynamic-image-grid-reference"}}),BX.create({tag:"div",props:{className:"landing-ui-field-dynamic-image-grid-link"}})]})},getValue:function(){return{id:this.dropdownField.getValue(),link:this.checkboxField.getValue()}},setValue:function(e){if(BX.type.isPlainObject(e)){this.dropdownField.setValue(e.id);this.checkboxField.setValue(e.link)}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:71:"/bitrix/js/landing/ui/field/dynamic_dropdown_field.min.js?1699258022430";s:6:"source";s:53:"/bitrix/js/landing/ui/field/dynamic_dropdown_field.js";s:3:"min";s:57:"/bitrix/js/landing/ui/field/dynamic_dropdown_field.min.js";s:3:"map";s:57:"/bitrix/js/landing/ui/field/dynamic_dropdown_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.DynamicDropdown=function(n){BX.Landing.UI.Field.DynamicImage.apply(this,arguments);BX.addClass(this.layout,"landing-ui-field-dynamic-dropdown")};BX.Landing.UI.Field.DynamicDropdown.prototype={constructor:BX.Landing.UI.Field.DynamicDropdown,__proto__:BX.Landing.UI.Field.DynamicImage.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/field/pages_field.min.js?16992580221478";s:6:"source";s:42:"/bitrix/js/landing/ui/field/pages_field.js";s:3:"min";s:46:"/bitrix/js/landing/ui/field/pages_field.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/field/pages_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.Pages=function(e){BX.Landing.UI.Field.BaseField.apply(this,arguments);BX.remove(this.input);this.layout.classList.add("landing-ui-field-pages");this.rangeField=this.createRangeField(Number(e.value));this.gridLeft=this.createGridLeft();this.gridRight=this.createGridRight();this.grid=this.createGrid([this.gridLeft,this.gridRight]);this.layout.appendChild(this.grid);this.gridLeft.appendChild(this.rangeField.layout)};BX.Landing.UI.Field.Pages.prototype={constructor:BX.Landing.UI.Field.Pages,__proto__:BX.Landing.UI.Field.BaseField.prototype,createRangeField:function(e){var i=new BX.Landing.UI.Field.Range({items:Array.from({length:100},function(e,i){return{name:i,value:i}}),content:BX.type.isNumber(e)?e:undefined});BX.remove(i.header);return i},createGridLeft:function(){return BX.create("div",{props:{className:"landing-ui-field-pages-grid-left"}})},createGridRight:function(){return BX.create("div",{props:{className:"landing-ui-field-pages-grid-right"}})},createGrid:function(e){return BX.create("div",{props:{className:"landing-ui-field-pages-grid"},children:e})},createButtonField:function(){return new BX.Landing.UI.Button.BaseButton({text:BX.Landing.Loc.getMessage("LANDING_CARDS__ADD_NEW_PAGE_BUTTON"),className:["landing-ui-button-select-link","landing-ui-field-pages-add-button"]})},getValue:function(){return this.rangeField.getValue()}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:68:"/bitrix/js/landing/ui/field/click_action_field.min.js?16992580222334";s:6:"source";s:49:"/bitrix/js/landing/ui/field/click_action_field.js";s:3:"min";s:53:"/bitrix/js/landing/ui/field/click_action_field.min.js";s:3:"map";s:53:"/bitrix/js/landing/ui/field/click_action_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.ClickAction=function(i){BX.Landing.UI.Field.BaseField.apply(this,arguments);BX.addClass(this.layout,"landing-ui-field-click-action");BX.remove(this.input);this.reference=i.reference;this.linkField=i.linkField;this.textField=new BX.Landing.UI.Field.Text({title:BX.Landing.Loc.getMessage("LANDING_BLOCK__DYNAMIC_LINK_TEXT_FIELD_LABEL"),textOnly:true,content:i.content||""});this.actionField=new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_BLOCK__DYNAMIC_LINK_ACTION_FIElD_LABEL"),items:this.getActions(),onValueChange:this.onActionChange.bind(this)});this.grid=this.createGrid();this.textContainer=this.grid.children[0];this.actionContainer=this.grid.children[1];this.additionalContainer=this.grid.children[2];this.layout.appendChild(this.grid);this.textContainer.appendChild(this.textField.layout);this.actionContainer.appendChild(this.actionField.layout);if(BX.type.isPlainObject(i.value)){this.setValue(i.value)}this.onActionChange()};BX.Landing.UI.Field.ClickAction.prototype={constructor:BX.Landing.UI.Field.ClickAction,__proto__:BX.Landing.UI.Field.BaseField.prototype,createGrid:function(){return BX.create({tag:"div",props:{className:"landing-ui-field-click-action-grid"},children:[BX.create({tag:"div",props:{className:"landing-ui-field-click-action-grid-text"}}),BX.create({tag:"div",props:{className:"landing-ui-field-click-action-grid-action"}}),BX.create({tag:"div",props:{className:"landing-ui-field-click-action-layout-additional"}})]})},getActions:function(){return this.reference.actions.map(function(i){return{name:i.name,value:i.type}})},onActionChange:function(){var i=this.actionField.getValue();if(i==="link"){this.additionalContainer.appendChild(this.linkField.layout);return}this.additionalContainer.innerHTML=""},getValue:function(){var i=this.linkField.getValue();if(BX.type.isPlainObject(i)){delete i.text}return{id:this.reference.id,text:this.textField.getValue(),action:this.actionField.getValue(),link:i}},setValue:function(i){if(BX.type.isPlainObject(i)){this.textField.setValue(i.text);this.actionField.setValue(i.action);if(i.link){this.linkField.setValue(i.link,true);this.linkField.hrefInput.makeDisplayedHrefValue()}this.onActionChange()}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/ui/field/color_field.min.js?16992580222119";s:6:"source";s:42:"/bitrix/js/landing/ui/field/color_field.js";s:3:"min";s:46:"/bitrix/js/landing/ui/field/color_field.min.js";s:3:"map";s:46:"/bitrix/js/landing/ui/field/color_field.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.UI.Field");BX.Landing.UI.Field.ColorPalette=function(t){BX.Landing.UI.Field.ButtonGroup.apply(this,arguments);this.pseudoElement=typeof t.pseudoElement==="string"?t.pseudoElement:null;this.pseudoClass=typeof t.pseudoClass==="string"?t.pseudoClass:null;this.layout.classList.add("landing-ui-field-color");this.stylePath=t.stylePath;this.initButtons()};function t(t,e,s){var n=document.styleSheets;var o=n.length;for(var l=0;l<o;l++){if("href"in document.styleSheets[l]&&(document.styleSheets[l].href&&document.styleSheets[l].href.indexOf("/templates/landing24/")!==-1||document.styleSheets[l].href&&document.styleSheets[l].href.indexOf("/landing24/template_")!==-1||document.styleSheets[l].href&&document.styleSheets[l].href.indexOf("/landing24/kernel_landing_assets_")!==-1)||s&&document.styleSheets[l].href&&document.styleSheets[l].href.indexOf(s)!==-1){var i=document.styleSheets[l].cssRules;if(i){var a=i.length;for(var u=0;u<a;u++){if(i[u].selectorText===t){return i[u].style[e]}}}}}}BX.Landing.UI.Field.ColorPalette.prototype={constructor:BX.Landing.UI.Field.ColorPalette,__proto__:BX.Landing.UI.Field.ButtonGroup.prototype,initButtons:function(){this.buttons.forEach(function(e){e.layout.classList.add(e.layout.value);e.layout.innerHTML='<span class="landing-ui-button-inner landing-ui-pattern-transparent"></span>';var s=BX.Landing.UI.Adapter.CSSProperty.get(this.property);if((s!=="background-image"&&s!=="background-color"||this.pseudoElement)&&!this.pseudoClass){BX.DOM.read(function(){var t=getComputedStyle(e.layout,this.pseudoElement).getPropertyValue(s);BX.DOM.write(function(){e.layout.classList.remove(e.layout.value);e.layout.style["background-color"]=t})}.bind(this))}else if(this.pseudoClass){BX.DOM.read(function(){var n=t("."+e.layout.value+this.pseudoClass,s,this.stylePath);BX.DOM.write(function(){e.layout.classList.remove(e.layout.value);e.layout.style["background-color"]=n})}.bind(this))}},this)},reset:function(){this.buttons.forEach(function(t){t.layout.classList.remove("landing-ui-active")})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:51:"/bitrix/js/landing/ui/style_node.js?169925802210232";s:6:"source";s:35:"/bitrix/js/landing/ui/style_node.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing.UI");

	const slice = BX.Landing.Utils.slice;

	/**
	 * Implements interface for works with style node
	 *
	 * @param {{
	 * 		id: [string],
	 * 		node: HTMLElement|HTMLElement[],
	 * 		selector: string,
	 * 		relativeSelector: string,
	 * 		property: string,
	 * 		[onClick]: function,
	 * 		iframe: HTMLIFrameElement|Window
	 * }} options
	 *
	 * @constructor
	 */
	BX.Landing.UI.Style = function(options)
	{
		this.node = "node" in options ? options.node : null;
		this.id = "id" in options ? options.id : null;
		this.selector = "selector" in options ? options.selector : null;
		this.relativeSelector = "relativeSelector" ? options.relativeSelector : null;
		this.clickHandler = "onClick" in options ? options.onClick : (function() {});
		this.iframe = "iframe" in options ? options.iframe : null;
		this.affects = new BX.Landing.Collection.BaseCollection();
		this.inlineProperties = [];
		this.computedProperties = [];
		this.pseudoElement = null;
		this.isSelectGroupFlag = null;
		this.onFrameLoad();
	};

	BX.Landing.UI.Style.SERVICE_CLASSES = [
		'landing-card',
		'slick-slide',
		'slick-current',
		'slick-active',
	];

	BX.Landing.UI.Style.prototype = {
		/**
		 * Handles iframe load event
		 */
		onFrameLoad: function()
		{
			if (this.node)
			{
				this.node = BX.type.isArray(this.node) ? this.node : [this.node];
			}
			else
			{
				this.node = this.getNode(true);
			}
			this.currentTarget = this.node[0];

			this.node.forEach(function (node) {
				node.addEventListener("click", this.onClick.bind(this));
				node.addEventListener("mouseover", this.onMouseEnter.bind(this));
				node.addEventListener("mouseleave", this.onMouseLeave.bind(this));
			}, this);

			this.value = this.getValue();
		},


		getNode: function(all)
		{
			const elements = slice(this.iframe.document.querySelectorAll(this.relativeSelector));

			if (this.isSelectGroup() || all)
			{
				return elements;
			}

			return this.currentTarget ? [elements[this.getElementIndex(this.currentTarget)]] : [];
		},

		getTargetElement: function()
		{
			return this.currentTarget;
		},

		getElementIndex: function(element)
		{
			return [].indexOf.call(this.getNode(true), element);
		},


		/**
		 * Handles node click event
		 * @param {MouseEvent} event
		 */
		onClick: function(event)
		{
			if (BX.Landing.UI.Panel.StylePanel.getInstance().isShown())
			{
				event.preventDefault();
				event.stopPropagation();
				this.currentTarget = event.currentTarget;
				this.clickHandler();
			}
		},


		/**
		 * Handles mouse enter event on node
		 * @param {MouseEvent} event
		 */
		onMouseEnter: function(event)
		{
			event.preventDefault();
			event.stopPropagation();
			this.highlight(event.currentTarget);
		},


		/**
		 * Handles mouse leave event on node
		 * @param {MouseEvent} event
		 */
		onMouseLeave: function(event)
		{
			event.preventDefault();
			event.stopPropagation();

			this.unHighlight();

			var node = BX.type.isArray(this.node) && this.node.length ? this.node[0] : this.node;
			BX.fireEvent(node.parentNode, "mouseenter");
		},

		isSelectGroup: function()
		{
			if (this.isSelectGroupFlag !== null)
			{
				return this.isSelectGroupFlag;
			}

			return window.localStorage.getItem("selectGroup") === "true";
		},

		/**
		 * Forced set isSelectGroup flag just for current style node
 		 * @param value
		 */
		setIsSelectGroup: function(value)
		{
			this.isSelectGroupFlag = !!value;
		},

		/**
		 * Unset force set isSelectGroup flag
		 */
		unsetIsSelectGroupFlag: function()
		{
			this.isSelectGroupFlag = null;
		},

		/**
		 * Highlights this node
		 * @param {HTMLElement|Node} target
		 */
		highlight: function(target)
		{
			if (BX.Landing.UI.Panel.StylePanel.getInstance().isShown())
			{
				if (this.isSelectGroup())
				{
					target = this.node;
				}

				BX.Landing.UI.Highlight.getInstance().show(target);
			}
		},


		/**
		 * Hides highlight for this node
		 */
		unHighlight: function()
		{
			BX.Landing.UI.Highlight.getInstance().hide();
		},


		/**
		 * Checks that this node style is changed
		 * @returns {*}
		 */
		isChanged: function()
		{
			const currentValue = this.getValue();
			if (JSON.stringify(this.value) !== JSON.stringify(currentValue))
			{
				return true;
			}
			else
			{
				return this.lastValue !== undefined && JSON.stringify(this.lastValue) !== JSON.stringify(currentValue);
			}
		},

		/**
		 * Set list of used inline properties for get them in value
		 * @param {string|array} property
		 */
		setInlineProperty: function (property)
		{
			if (!BX.Type.isArray(property))
			{
				property = [property];
			}
			property.forEach(function (prop)
			{
				if (this.inlineProperties.indexOf(prop) === -1)
				{
					this.inlineProperties.push(prop);
				}
			}, this);

			// recalculate value after changes
			this.value = this.getValue();
		},

		/**
		 * Set list of properties for get computed styles
		 * @param {string|array} property
		 */
		setComputedProperty: function (property)
		{
			if (!BX.Type.isArray(property))
			{
				property = [property];
			}
			property.forEach(function (prop)
			{
				if (this.computedProperties.indexOf(prop) === -1)
				{
					this.computedProperties.push(prop);
				}
			}, this);

			// recalculate value after changes
			this.value = this.getValue();
		},

		/**
		 * Set list of properties for get computed styles
		 * @param {string} pseudo
		 */
		setPseudoElement: function(pseudo)
		{
			this.pseudoElement = pseudo;

			// recalculate value after changes
			this.value = this.getValue();
		},

		/**
		 * Sets node value
		 * @param {string|object.<string>} value className
		 * @param {object[]} items
		 * @param {string} postfix
		 * @param {string} affect
		 * @param {object} [exclude]
		 */
		setValue: function(value, items, postfix, affect, exclude)
		{
			this.lastValue = this.currentValue;
			this.currentValue = this.getValue();

			if(!value)
			{
				return;
			}

			affect = !!affect ? affect : "";
			if (affect.length)
			{
				this.setAffects(affect);
			}

			if (BX.type.isObjectLike(value))
			{
				if ("from" in value && "to" in value)
				{
					value.from += "-min";
					value.to += "-max";
				}

				if(!("style" in value))
				{
					var keys = Object.keys(value);
					value = keys.map(function(key) {
						return value[key];
					});
				}
			}
			else
			{
				value = [value];
			}

			this.getNode().forEach(function(node) {
				if (BX.type.isArray(value))
				{
					this.setValueClass(node, value, items, affect);
				}
				if (BX.type.isObjectLike(value))
				{
					// todo: need min max?
					if("style" in value)
					{
						this.setValueStyle(node, value.style);
					}

					if (
						"className" in value
						&& BX.type.isArray(value.className)
					)
					{
						this.setValueClass(node, value.className, items, affect);
					}
				}

				if (affect)
				{
					if (affect !== "background-image")
					{
						slice(node.querySelectorAll("*")).forEach(function(child) {
							child.style[affect] = null;
							if (affect === "color")
							{
								child.removeAttribute("color");
							}
						});
					}
				}

				if (exclude)
				{
					exclude.items.forEach(function(item)
					{
						node.classList.remove(item.value);
					});
				}
			}, this);
		},

		/**
		 *
		 * @param {string|[string]} affects
		 */
		setAffects(affects)
		{
			affects = BX.Type.isArray(affects) ? affects : [affects];
			affects.forEach(affect => {
				if (affect !== "background-image")
				{
					this.affects.add(affect);
				}
			})
		},

		setValueClass: function(node, value, items, affect) {
			if (BX.type.isArray(items))
			{
				node.style[affect] = null;

				value.forEach(function(valueItem)
				{
					items.forEach(function(item)
					{
						if (value.indexOf(item.value) === -1 &&
							value.indexOf(item.value + "-min") === -1 &&
							value.indexOf(item.value + "-max") === -1)
						{
							node.classList.remove(item.value);
							node.classList.remove(item.value + "-min");
							node.classList.remove(item.value + "-max");
						}
					});

					node.classList.add(valueItem);
				});
			}
		},

		setValueStyle: function (node, style)
		{
			this.inlineProperties.forEach(function (prop)
			{
				if (prop in style)
				{
					node.style.setProperty(prop, style[prop]);
				}
			});
		},

		/**
		 * Gets style node value
		 * @param isNeedComputed boolean - true if need match computed styles
		 * @returns {{classList: string[], affect: ?string, style: ?{string: string}}}
		 */
		getValue: function(isNeedComputed)
		{
			const node = this.getNode().length ? this.getNode()[0] : null;
			const style = {};
			if (node)
			{
				let isAllInlineProps = false;
				if (this.inlineProperties.length)
				{
					isAllInlineProps = true;
					const styleObj = node.style;
					this.inlineProperties.forEach(prop => {
						style[prop] = styleObj.getPropertyValue(prop).trim() || null;
						if (prop === 'background-image' && !!style[prop])
						{
							style[prop] = style[prop].replaceAll('"', '\'');
						}
						isAllInlineProps = isAllInlineProps && !!style[prop];
					});
				}
				if (!!isNeedComputed && this.computedProperties.length && !isAllInlineProps)
				{
					this.computedProperties.forEach(prop => {
						style[prop] =
							getComputedStyle(node, this.pseudoElement).getPropertyValue(prop)
							|| null;
					});
				}
			}

			return {
				classList: node ? this.sanitizeClassList(slice(node.classList)) : [],
				affect: this.affects.toArray(),
				style: style,
			};
		},

		/**
		 * Remove service classes from class list
		 * @param {[string]} classes
		 * @returns {[string]} - array without service classes
		 */
		sanitizeClassList: function(classes)
		{
			const result = [];
			classes.forEach(classItem => {
				if (BX.Landing.UI.Style.SERVICE_CLASSES.indexOf(classItem) === -1)
				{
					result.push(classItem);
				}
			});

			return result;
		},

		/**
		 * Remove service classes from classes string
		 * @param {string} classes
		 * @returns {string} - classes string without service classes
		 */
		sanitizeClassName: function(classes)
		{
			return this.sanitizeClassList(classes.split(' ')).join(' ');
		},
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:58:"/bitrix/js/landing/events/block_event.min.js?1699258017520";s:6:"source";s:40:"/bitrix/js/landing/events/block_event.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.Event");BX.Landing.Event.Block=function(n){this.block=typeof n.block==="object"?n.block:null;this.card=typeof n.card==="object"?n.card:null;this.node=typeof n.node==="object"?n.node:null;this.data=typeof n.data!=="undefined"?n.data:null;this.forceInitHandler=typeof n.onForceInit==="function"?n.onForceInit:function(){}};BX.Landing.Event.Block.prototype={forceInit:function(){this.forceInitHandler()},makeRelativeSelector:function(n){return"#"+this.block.id+" "+n}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:45:"/bitrix/js/landing/group.min.js?1699258017576";s:6:"source";s:27:"/bitrix/js/landing/group.js";s:3:"min";s:31:"/bitrix/js/landing/group.min.js";s:3:"map";s:31:"/bitrix/js/landing/group.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing");BX.Landing.Group=function(n){this.id=n.id;this.name=typeof n.name==="string"?n.name:null;this.nodes=n.nodes;this.callback=typeof n.onClick==="function"?n.onClick:function(){};var i=this.onClick.bind(this);this.nodes.forEach(function(n){n.node.addEventListener("click",i)})};BX.Landing.Group.prototype={onClick:function(n){if(!BX.Landing.UI.Panel.StylePanel.getInstance().isShown()){n.preventDefault();n.stopPropagation();n.stopImmediatePropagation();this.callback(this);return false}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:44:"/bitrix/js/landing/block.js?1699258018145888";s:6:"source";s:27:"/bitrix/js/landing/block.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
;(function() {
	"use strict";

	BX.namespace("BX.Landing");

	// Utils
	var deepFreeze = BX.Landing.Utils.deepFreeze;
	var style = BX.Landing.Utils.style;
	var insertAfter = BX.Landing.Utils.insertAfter;
	var insertBefore = BX.Landing.Utils.insertBefore;
	var append = BX.Landing.Utils.append;
	var isPlainObject = BX.Landing.Utils.isPlainObject;
	var isBoolean = BX.Landing.Utils.isBoolean;
	var isNumber = BX.Landing.Utils.isNumber;
	var isString = BX.Landing.Utils.isString;
	var isArray = BX.Landing.Utils.isArray;
	var isEmpty = BX.Landing.Utils.isEmpty;
	var addClass = BX.Landing.Utils.addClass;
	var removeClass = BX.Landing.Utils.removeClass;
	var hasClass = BX.Landing.Utils.hasClass;
	var toggleClass = BX.Landing.Utils.toggleClass;
	var create = BX.Landing.Utils.create;
	var debounce = BX.Landing.Utils.debounce;
	var throttle = BX.Landing.Utils.throttle;
	var fireCustomEvent = BX.Landing.Utils.fireCustomEvent;
	var onCustomEvent = BX.Landing.Utils.onCustomEvent;
	var bind = BX.Landing.Utils.bind;
	var unbind = BX.Landing.Utils.unbind;
	var getClass = BX.Landing.Utils.getClass;
	var rect = BX.Landing.Utils.rect;
	var setTextContent = BX.Landing.Utils.setTextContent;
	var translateY = BX.Landing.Utils.translateY;
	var nextSibling = BX.Landing.Utils.nextSibling;
	var prevSibling = BX.Landing.Utils.prevSibling;
	var join = BX.Landing.Utils.join;
	var slice = BX.Landing.Utils.slice;
	var decodeDataValue = BX.Landing.Utils.decodeDataValue;
	var encodeDataValue = BX.Landing.Utils.encodeDataValue;
	var data = BX.Landing.Utils.data;
	var attr = BX.Landing.Utils.attr;
	var removePanels = BX.Landing.Utils.removePanels;
	var getCSSSelector = BX.Landing.Utils.getCSSSelector;
	var remove = BX.Landing.Utils.remove;
	var clone = BX.Landing.Utils.clone;
	var trim = BX.Landing.Utils.trim;
	var prepend = BX.Landing.Utils.prepend;
	var random = BX.Landing.Utils.random;
	var htmlToElement = BX.Landing.Utils.htmlToElement;
	var proxy = BX.Landing.Utils.proxy;
	var escapeText = BX.Landing.Utils.escapeText;
	var isValidElementId = BX.Landing.Utils.isValidElementId;

	// Collections
	var BaseCollection = BX.Landing.Collection.BaseCollection;
	var NodeCollection = BX.Landing.Collection.NodeCollection;
	var FormCollection = BX.Landing.UI.Collection.FormCollection;
	var CardCollection = BX.Landing.Collection.CardCollection;
	var PanelCollection = BX.Landing.UI.Collection.PanelCollection;

	// Panels
	var BaseButtonPanel = BX.Landing.UI.Panel.BaseButtonPanel;
	var CardActionPanel = BX.Landing.UI.Panel.CardAction;
	var ContentEditPanel = BX.Landing.UI.Panel.ContentEdit;

	// Buttons
	var BaseButton = BX.Landing.UI.Button.BaseButton;
	var ActionButton = BX.Landing.UI.Button.ActionButton;
	var PlusButton = BX.Landing.UI.Button.Plus;
	var CardActionButton = BX.Landing.UI.Button.CardAction;

	// Factories
	var StyleFactory = BX.Landing.UI.Factory.StyleFactory;

	// Forms
	var BaseForm = BX.Landing.UI.Form.BaseForm;
	var StyleForm = BX.Landing.UI.Form.StyleForm;
	var CardForm = BX.Landing.UI.Form.CardForm;
	var CardsForm = BX.Landing.UI.Form.CardsForm;

	// Other
	var Group = BX.Landing.Group;
	var BlockEvent = BX.Landing.Event.Block;
	var TabCard = BX.Landing.UI.Card.TabCard;
	var DynamicFieldsGroup = BX.Landing.UI.Card.DynamicFieldsGroup;

	// noinspection JSUnusedLocalSymbols
	/**
	 * Access denied
	 * @type {string}
	 */
	var ACCESS_D = "D";

	/**
	 * Design only
	 * @type {string}
	 */
	var ACCESS_V = "V";

	/**
	 * Edit without delete
	 * @type {string}
	 */
	var ACCESS_W = "W";

	/**
	 * All access
	 * @type {string}
	 */
	var ACCESS_X = "X";


	function getTypeSettings(prop)
	{
		let lp = BX.Landing.Main.getInstance();
		let namespaces = Object.keys(lp.options.style);

		for (let i = 0; i < namespaces.length; i++)
		{
			let namespace = namespaces[i];
			let type = lp.options.style[namespace]["style"][prop];

			if (!type)
			{
				continue;
			}

			type.attrKey = prop;

			if (prop === "background")
			{
				type.items = type.items.concat(lp.options.style[namespace]["style"]["background-overlay"].items);
			}

			return type;
		}

		return null;
	}

	function getAttrsTypeSettings(prop)
	{
		let lp = BX.Landing.Main.getInstance();
		let namespaces = Object.keys(lp.options.attrs);

		for (let i = 0; i < namespaces.length; i++)
		{
			let namespace = namespaces[i];
			let attr = lp.options.attrs[namespace]["attrs"][prop];

			if (!attr)
			{
				continue;
			}

			attr.attrKey = prop;
			return attr;
		}

		return {};
	}

	function isGroup(prop)
	{
		let lp = BX.Landing.Main.getInstance();
		let namespaces = Object.keys(lp.options.style);

		for (let i = 0; i < namespaces.length; i++)
		{
			let namespace = namespaces[i];

			if (!lp.options.style[namespace]["group"])
			{
				continue;
			}

			if (prop in lp.options.style[namespace]["group"])
			{
				return true;
			}
		}

		return false;
	}

	function getGroupTypes(group)
	{
		let lp = BX.Landing.Main.getInstance();
		let namespaces = Object.keys(lp.options.style);

		for (let i = 0; i < namespaces.length; i++)
		{
			let namespace = namespaces[i];

			if (!lp.options.style[namespace]["group"])
			{
				continue;
			}

			if (lp.options.style[namespace]["group"][group])
			{
				return lp.options.style[namespace]["group"][group];
			}
		}

		return [];
	}


	/**
	 * Shows loader for button
	 * @param {BX.Landing.UI.Button.BaseButton} button
	 */
	function showButtonLoader(button)
	{
		if (!!button)
		{
			if (!button.loader)
			{
				button.loader = new BX.Loader({
					target: button.layout,
					size: 16
				});

				void style(button.loader.layout.querySelector(".main-ui-loader-svg-circle"), {
					"stroke-width": "4px"
				});
			}

			button.loader.show();
			addClass(button.text, "landing-ui-hide-icon");
		}
	}


	/**
	 * Hides button loader
	 * @param {BX.Landing.UI.Button.BaseButton} button
	 */
	function hideButtonLoader(button)
	{
		if (!!button)
		{
			if (button.loader)
			{
				button.loader.hide();
				removeClass(button.text, "landing-ui-hide-icon");
			}
		}
	}


	/**
	 * @param {string} selector
	 * @return {boolean|*}
	 */
	function isNodeSelector(selector)
	{
		return !!selector && selector.includes("@");
	}

	var onBlockInitDebounced = BX.debounce(function() {
		BX.Landing.PageObject.getBlocks().forEach(function(block) {
			block.adjustSortButtonsState();
		});
	}, 400);

	onCustomEvent("BX.Landing.Block:init", onBlockInitDebounced);

	/**
	 * Implements interface for works with landing block
	 *
	 * @param {HTMLElement} element
	 * @param {blockOptions} options
	 *
	 * @property {BX.Landing.UI.Collection.PanelCollection.<BX.Landing.UI.Panel.BasePanel>} panels - Panels collection
	 * @property {BX.Landing.Collection.CardCollection.<BX.Landing.Block.Card>} cards - Cards collection
	 * @property {BX.Landing.Collection.NodeCollection.<BX.Landing.Block.Node>} nodes - Nodes collection
	 * @property {blockManifest} manifest
	 *
	 * @constructor
	 */
	BX.Landing.Block = function(element, options)
	{
		this.node = element;
		this.parent = element.parentElement;
		this.content = element.firstElementChild;
		this.siteId = data(element.parentElement, "data-site");
		this.lid = data(element.parentElement, "data-landing");
		this.id = isNumber(parseInt(options.id)) ? parseInt(options.id) : 0;
		this.selector = join("#block", (isNumber(options.id) ? options.id : 0), " > :first-child");
		this.repoId = isNumber(options.repoId) ? options.repoId : null;
		this.active = isBoolean(options.active) ? options.active : true;
		this.allowedByTariff = isBoolean(options.allowedByTariff) ? options.allowedByTariff : true;
		this.manifest = isPlainObject(options.manifest) ? options.manifest : {};
		this.manifest.nodes = isPlainObject(options.manifest.nodes) ? options.manifest.nodes : {};
		this.manifest.cards = isPlainObject(options.manifest.cards) ? options.manifest.cards : {};
		this.manifest.attrs = isPlainObject(options.manifest.attrs) ? options.manifest.attrs : {};
		this.onStyleInputWithDebounce = debounce(this.onStyleInput, 300, this);
		this.changeTimeout = null;
		this.php = options.php;
		this.designed = options.designed;
		this.access = options.access;
		this.anchor = options.anchor;
		this.savedAnchor = options.anchor;
		this.requiredUserActionOptions = options.requiredUserAction;
		this.dynamicParams = options.dynamicParams || {};
		this.sections = options.sections ? options.sections.split(',') : [];

		// Make entities collections
		this.nodes = new NodeCollection();
		this.cards = new CardCollection();
		this.panels = new PanelCollection();
		this.groups = new BaseCollection();
		this.changedNodes = new BaseCollection();
		this.styles = new BaseCollection();
		this.forms = new FormCollection();
		this.menu = [];

		if (isPlainObject(this.requiredUserActionOptions) && !isEmpty(this.requiredUserActionOptions))
		{
			this.showRequiredUserAction(this.requiredUserActionOptions);
			this.requiredUserActionIsShown = true;
		}

		this.onEditorEnabled = this.onEditorEnabled.bind(this);
		this.onEditorDisabled = this.onEditorDisabled.bind(this);
		this.adjustPanelsPosition = this.adjustPanelsPosition.bind(this);
		this.onMouseMove = this.onMouseMove.bind(this);
		this.onStorage = this.onStorage.bind(this);
		this.onBlockRemove = this.onBlockRemove.bind(this);

		// Make manifest read only
		deepFreeze(this.manifest);

		// Apply block state
		this.node.classList[this.active ? "remove" : "add"]("landing-block-disabled");

		// Sets state
		this.state = "ready";

		// Init panels
		this.initPanels();
		this.initStyles();
		this.initMenu();
		this.adjustContextSensitivityStyles();

		var envOptions = BX.Landing.Env.getInstance().getOptions();
		var specialType = envOptions.specialType;
		if (this.isDefaultCrmFormBlock())
		{
			var showOptions = {
				formId: envOptions.formEditorData.formOptions.id,
				formOptions: this.getCrmFormOptions(),
				block: this,
				showWithOptions: true,
			};
			var uri = new BX.Uri(window.top.location.toString());
			if (BX.Text.toBoolean(uri.getQueryParam('formCreated')))
			{
				showOptions.state = 'presets';
			}

			void BX.Landing.UI.Panel.FormSettingsPanel
				.getInstance()
				.show(showOptions);
		}

		BX.Landing.PageObject.getBlocks().push(this);

		// Fire block init event

		var eventData = {};

		if (this.requiredUserActionIsShown)
		{
			eventData.requiredUserActionIsShown = true;
			eventData.layout = this.node.firstElementChild;
			eventData.button = this.node.firstElementChild.querySelector(".ui-btn");
		}

		fireCustomEvent(window, "BX.Landing.Block:init", [this.createEvent({data: eventData})]);

		onCustomEvent("BX.Landing.Editor:enable", this.onEditorEnabled);
		onCustomEvent("BX.Landing.Editor:disable", this.onEditorDisabled);
		onCustomEvent("BX.Landing.Block:afterRemove", this.onBlockRemove);

		bind(this.node, "mousemove", this.onMouseMove);
		bind(this.node, "keydown", this.adjustPanelsPosition);
		bind(top, "storage", this.onStorage);
	};


	BX.Landing.Block.storage = new BX.Landing.Collection.BlockCollection();


	BX.Landing.Block.prototype = {
		/**
		 * Handles mouse move event on block node
		 * Implements lazy initialization entities of block
		 * @private
		 */
		onMouseMove: function()
		{
			if (this.state === "ready")
			{
				unbind(this.node, "mousemove", this.onMouseMove);
				this.initEntities();
				this.lazyInitPanels();
				this.state = "complete";
			}
		},

		getBlockNode: function()
		{
			return this.node;
		},

		isAllowedByTariff: function()
		{
			return this.allowedByTariff;
		},

		showRequiredUserAction: function(data)
		{
			let container = this.node;
			if (data.targetNodeSelector)
			{
				container = this.node.querySelector(data.targetNodeSelector);
			}
			container.innerHTML = (
				"<div class=\"landing-block-user-action\">" +
					"<div class=\"landing-block-user-action-inner\">" +
						(data.header ? (
							"<h3>"+"<i class=\"fa fa-exclamation-triangle g-mr-15\"></i>"+data.header+"</h3><hr>"
						) : "") +
						(data.description ? (
							"<p>"+data.description+"</p>"
						) : "") +
						((data.href || data.onClick || data.className) && data.text ? (
							"<div>" +
								"<a href=\""+data.href+"\" class=\"landing-trusted-link ui-btn "+data.className+"\" target=\""+(data.target ? data.target : '')+"\">"+data.text+"</a>" +
							"</div>"
						) : "") +
					"</div>" +
				"</div>"
			);

			if (data.onClick)
			{
				var button = container.querySelector('.landing-block-user-action .ui-btn');
				bind(button, 'click', function(event) {
					event.preventDefault();

					try
					{
						BX.evalGlobal(data.onClick);
					}
					catch (err)
					{
						console.error(err);
					}
				});
			}
		},


		/**
		 * Disables content links and buttons
		 */
		disableLinks: function()
		{
			var selector = "a:not([class*='landing-ui']):not(.landing-trusted-link), .btn:not([class*='landing-ui']):not(.landing-trusted-link), button:not([class*='landing-ui']):not(.landing-trusted-link), input:not([class*='landing-ui'])";
			var items = slice(this.content.querySelectorAll(selector));

			items.forEach(function(item) {
				var isChildOfNode = this.nodes.some(function(node) {
					return node.node.contains(item);
				});

				var isMenuItem = this.menu.some(function(menu) {
					return menu.root.contains(item);
				});

				if (!this.nodes.getByNode(item) && !isChildOfNode && !isMenuItem)
				{
					item.style.pointerEvents = "none";
				}
			}, this);
		},


		/**
		 * Adjusts context sensitivity styles
		 */
		adjustContextSensitivityStyles: function()
		{
			if (hasClass(this.parent, "landing-sidebar"))
			{
				if (!hasClass(this.content, "landing-adjusted"))
				{
					var selectors = Object.keys(this.manifest.style.nodes);
					var needAdjust = selectors.filter(function(selector) {
						return (
							!!this.manifest.style.nodes[selector].type &&
							this.manifest.style.nodes[selector].type.indexOf("columns") !== -1
						);
					}, this);

					if (isEmpty(needAdjust))
					{
						return;
					}

					var columnsSettings = getTypeSettings("columns");

					if (columnsSettings === null)
					{
						return;
					}

					needAdjust.forEach(function(selector) {
						var styleNode = this.styles.get(selector);

						if (styleNode)
						{
							styleNode.setIsSelectGroup(true);
							styleNode.setValue("col-lg-12", columnsSettings.items);
							styleNode.unsetIsSelectGroupFlag();
						}
					}, this);

					var blockStyleNode = this.styles.get(this.selector);

					if (blockStyleNode)
					{
						blockStyleNode.setValue("landing-adjusted", ["landing-adjusted"]);
					}

					this.saveStyles();
				}
			}
		},


		/**
		 * Forces block initialization
		 */
		forceInit: function()
		{
			this.onMouseMove();
		},


		/**
		 * Creates block event object
		 * @param {object} [options]
		 * @returns {BX.Landing.Event.Block}
		 */
		createEvent: function(options)
		{
			return new BlockEvent({
				block: this.node,
				node: !!options && !!options.node ? options.node : null,
				card: !!options && !!options.card ? options.card : null,
				data: (!!options && options.data) || {},
				onForceInit: this.forceInit.bind(this)
			});
		},


		/**
		 * Initializes block entities
		 * @private
		 */
		initEntities: function()
		{
			this.initCards();
			this.initNodes();
			this.initGroups();
			this.disableLinks();
		},

		initMenu: function()
		{
			if (BX.type.isPlainObject(this.manifest.menu))
			{
				this.menu = Object.entries(this.manifest.menu).map(function(entry) {
					var code = entry[0];
					var value = entry[1];

					return new BX.Landing.Menu.Menu({
						code: code,
						root: this.node.querySelector(code),
						manifest: value,
						block: this.id,
					});
				}, this);
			}
		},

		initCardsLabels: function()
		{
			this.cards.forEach(function(card) {
				card.label = this.createCardLabel(card.node, card.manifest);
			}, this);
		},


		/**
		 * Initializes groups
		 */
		initGroups: function()
		{
			var groupsIds = [];
			var groups = isPlainObject(this.manifest.groups) ? this.manifest.groups : {};

			this.nodes.forEach(function(node) {
				if (isString(node.manifest.group) && !groupsIds.includes(node.manifest.group))
				{
					groupsIds.push(node.manifest.group);
				}
			});

			groupsIds.forEach(function(groupId) {
				var nodes = this.nodes
					.filter(function(node) {
						return node.manifest.group === groupId;
					})
					.reduce(function(accumulator, node) {
						var nodeIndex = parseInt(node.selector.split("@")[1]);

						if (!accumulator[nodeIndex])
						{
							accumulator[nodeIndex] = new NodeCollection();
						}

						accumulator[nodeIndex].push(node);

						return accumulator;
					}, {});

				Object.keys(nodes).forEach(function(key) {
					this.groups.add(
						new Group({
							id: groupId,
							name: groups[groupId],
							nodes: nodes[key],
							onClick: this.onGroupClick.bind(this)
						})
					);
				}, this);
			}, this);
		},


		/**
		 * Handles event on group click
		 * @param {BX.Landing.Group} group
		 */
		onGroupClick: function(group)
		{
			if (!BX.Landing.UI.Panel.StylePanel.getInstance().isShown())
			{
				this.showContentPanel({
					name: group.name,
					nodes: group.nodes,
					compact: true,
					nodesOnly: true,
					showAll: true,
					hideCheckbox: true
				});
			}
		},


		/**
		 * Initializes block panels
		 */
		initPanels: function()
		{
			// Make "add block after this block" button
			if (!this.panels.get("create_action"))
			{
				var createPanel = new BaseButtonPanel(
					"create_action",
					"landing-ui-panel-create-action"
				);

				createPanel.addButton(
					new PlusButton("insert_after", {
						text: BX.Landing.Loc.getMessage("ACTION_BUTTON_CREATE"),
						onClick: throttle(this.addBlockAfterThis, 600, this)
					})
				);

				createPanel.show();
				this.addPanel(createPanel);

				if (this.isCrmFormPage())
				{
					var createBeforePanel = new BaseButtonPanel(
						"create_before_action",
						"landing-ui-panel-create-before-action"
					);

					createBeforePanel.addButton(
						new PlusButton("insert_before", {
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_CREATE"),
							onClick: throttle(this.addBlockBeforeThis, 600, this)
						})
					);

					createBeforePanel.show();
					this.addPanel(createBeforePanel);
				}

				createPanel.buttons[0].on("mouseover", this.onCreateButtonMouseover.bind(this));
				createPanel.buttons[0].on("mouseout", this.onCreateButtonMouseout.bind(this));
			}
		},

		isLastChildInArea: function()
		{
			return this.parent.querySelector("[class*='block-wrapper']:last-of-type") === this.node;
		},

		onCreateButtonMouseover: function()
		{
			if (this.isLastChildInArea() ||
				hasClass(this.parent, "landing-header") ||
				hasClass(this.parent, "landing-footer"))
			{
				var areas = BX.Landing.Main.getInstance().getLayoutAreas();

				if (areas.length > 1)
				{
					var addBlockPanel = this.panels.get("create_action");
					var addButton = addBlockPanel.buttons.get("insert_after");

					switch (true)
					{
						case hasClass(this.parent, "landing-main"):
							addButton.setText([
								BX.Landing.Loc.getMessage("ACTION_BUTTON_CREATE"),
								BX.Landing.Loc.getMessage("LANDING_ADD_BLOCK_TO_MAIN")
							].join(" "));
							break;
						case hasClass(this.parent, "landing-header"):
							addButton.setText([
								BX.Landing.Loc.getMessage("ACTION_BUTTON_CREATE"),
								BX.Landing.Loc.getMessage("LANDING_ADD_BLOCK_TO_HEADER")
							].join(" "));
							break;
						case hasClass(this.parent, "landing-sidebar"):
							addButton.setText([
								BX.Landing.Loc.getMessage("ACTION_BUTTON_CREATE"),
								BX.Landing.Loc.getMessage("LANDING_ADD_BLOCK_TO_SIDEBAR")
							].join(" "));
							break;
						case hasClass(this.parent, "landing-footer"):
							addButton.setText([
								BX.Landing.Loc.getMessage("ACTION_BUTTON_CREATE"),
								BX.Landing.Loc.getMessage("LANDING_ADD_BLOCK_TO_FOOTER")
							].join(" "));
							break;
					}

					clearTimeout(this.fadeTimeout);

					this.fadeTimeout = setTimeout(function() {
						addClass(this.parent, "landing-area-highlight");
						areas.forEach(function(area) {
							if (area !== this.parent)
							{
								addClass(area, "landing-area-fade");
							}
						}, this);
					}.bind(this), 400);
				}
			}
		},

		onCreateButtonMouseout: function()
		{
			clearTimeout(this.fadeTimeout);

			if (this.isLastChildInArea() ||
				hasClass(this.parent, "landing-header") ||
				hasClass(this.parent, "landing-footer"))
			{
				var areas = BX.Landing.Main.getInstance().getLayoutAreas();

				if (areas.length > 1)
				{
					var addButton = this.panels.get("create_action").buttons[0];
					addButton.setText(BX.Landing.Loc.getMessage("ACTION_BUTTON_CREATE"));

					removeClass(this.parent, "landing-area-highlight");

					areas.forEach(function(area) {
						removeClass(area, "landing-area-fade");
					}, this);
				}
			}
		},

		isInSidebar: function()
		{
			return !!this.node.closest(".landing-sidebar");
		},


		initSidebarActionPanel: function()
		{
			if (this.isInSidebar() && !this.panels.contains("sidebar_actions"))
			{
				var sidebarActionsPanel = new BaseButtonPanel(
					"sidebar_actions",
					"landing-ui-panel-sidebar-actions"
				);

				sidebarActionsPanel.addButton(
					new ActionButton("showSidebarActions", {
						onClick: this.onShowSidebarActionsClick.bind(this),
					})
				);

				this.addPanel(sidebarActionsPanel);
				sidebarActionsPanel.show();
			}
		},

		showFeedbackForm: function() {
			BX.Landing.Main.getInstance().showSliderFeedbackForm({
				blockName: this.manifest.block.name,
				blockCode: this.manifest.code,
				blockSection: this.manifest.block.section,
				landingId: BX.Landing.Main.getInstance().id,
				target: "blockActions"
			});
			if (this.blockActionsMenu)
			{
				this.blockActionsMenu.close();
			}
			if (this.sidebarActionsMenu)
			{
				this.sidebarActionsMenu.close();
			}
		},

		onShowSidebarActionsClick: function(event)
		{
			var bindElement = (
				this.panels.get("sidebar_actions").buttons.get('showSidebarActions')
			);

			if (!this.sidebarActionsMenu)
			{
				this.sidebarActionsMenu = BX.Main.MenuManager.create({
					id: this.id + '_sidebar_actions',
					bindElement: bindElement.layout,
					className: "landing-ui-block-actions-popup",
					angle: {position: "top", offset: 95},
					offsetTop: -6,
					offsetLeft: -26,
					events: {
						onPopupClose: function() {
							this.panels.get("sidebar_actions").buttons.get("showSidebarActions").deactivate();
							removeClass(this.node, "landing-ui-hover");
						}.bind(this)
					},
					items: [
						(function() {
							if (
								(isPlainObject(this.manifest.nodes) || isPlainObject(this.manifest.attrs))
								&& this.isAllowedByTariff()
							)
							{
								return new BX.Main.MenuItem({
									id: "content",
									text: BX.Landing.Loc.getMessage("ACTION_BUTTON_CONTENT"),
									onclick: function() {
										this.onShowContentPanel();
										this.sidebarActionsMenu.close();
									}.bind(this)
								});
							}
						}.bind(this))(),
						(function() {
							if (isPlainObject(this.manifest.style) && this.isAllowedByTariff())
							{
								return new BX.Main.MenuItem({
									id: "style",
									text: BX.Landing.Loc.getMessage("ACTION_BUTTON_STYLE"),
									onclick: function() {
										this.onStyleShow();
										this.sidebarActionsMenu.close();
									}.bind(this),
									className: this.access < ACCESS_V ? "landing-ui-disabled" : ""
								});
							}
						}.bind(this))(),
						(function() {
							if (isPlainObject(this.manifest.style) && this.isAllowedByTariff())
							{
								return new BX.Main.MenuItem({
									id: "designblock",
									text: BX.Landing.Loc.getMessage("LANDING_BLOCKS_ACTIONS_DESIGN_BLOCK"),
									className: !this.isDesignBlockAllowed() ? "landing-ui-disabled" : "",
									onclick: function() {
										this.onDesignerBlockClick();
										this.sidebarActionsMenu.close();
									}.bind(this)
								});
							}
						}.bind(this))(),
						(function() {
							if (this.isAllowedByTariff())
							{
								return new BX.Main.MenuItem({
									delimiter: true,
								});
							}
						}.bind(this))(),
						(function() {
							var allPlacements = BX.Landing.Main.getInstance().options.placements.blocks;

							if (isPlainObject(allPlacements) && (this.manifest.code in allPlacements || allPlacements["*"]))
							{
								var placementsList = [];

								if (this.manifest.code in allPlacements)
								{
									Object.keys(allPlacements[this.manifest.code]).forEach(function(key) {
										placementsList.push(allPlacements[this.manifest.code][key]);
									}, this);
								}

								if (allPlacements["*"])
								{
									Object.keys(allPlacements["*"]).forEach(function(key) {
										placementsList.push(allPlacements["*"][key]);
									}, this);
								}

								if (placementsList.length)
								{
									if (typeof BX.Landing.PageObject.getRootWindow().BX.rest !== "undefined" &&
										typeof BX.Landing.PageObject.getRootWindow().BX.rest.AppLayout !== "undefined")
									{
										var codes = ["*", this.manifest.code];
										for (var i = 0, c = codes.length; i < c; i++)
										{
											var MessageInterface = BX.Landing.PageObject.getRootWindow().BX.rest.AppLayout.initializePlacement(
												"LANDING_BLOCK_" + codes[i]
											);
											if (MessageInterface)
											{
												MessageInterface.prototype.refreshBlock = function(params, cb) {
													var block = BX.Landing.PageObject.getBlocks().get(params.id);

													if (block)
													{
														block
															.reload()
															.then(cb);
													}
												};
											}

										}
									}

									return new BX.Main.MenuItem({
										id: "actions",
										text: BX.Landing.Loc.getMessage("ACTION_BUTTON_CONTENT_MORE"),
										items: placementsList.map(function(placement) {
											return new BX.Main.MenuItem({
												id: "placement_" + placement.id + "_" + random(),
												text: encodeDataValue(placement.title),
												onclick: this.onPlacementClick.bind(this, placement)
											})
										}, this),
										className: this.access < ACCESS_V ? "landing-ui-disabled" : ""
									});
								}
							}
						}.bind(this))(),

						new BX.Main.MenuItem({
							id: "down",
							text: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_SORT_DOWN"),
							onclick: function() {
								this.moveDown();
								this.sidebarActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							id: "up",
							text: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_SORT_UP"),
							onclick: function() {
								this.moveUp();
								this.sidebarActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							delimiter: true,
						}),
						new BX.Main.MenuItem({
							id: "show_hide",
							text: BX.Landing.Loc.getMessage(this.isEnabled() ? "ACTION_BUTTON_HIDE" : "ACTION_BUTTON_SHOW"),
							className: !this.isChangeStateBlockAllowed() ? "landing-ui-disabled" : "",
							onclick: function() {
								this.onStateChange();
								this.sidebarActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							delimiter: true,
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_ACTIONS_CUT"),
							className: !this.isRemoveBlockAllowed() ? "landing-ui-disabled" : "",
							onclick: function() {
								BX.Landing.Main.getInstance().onCutBlock.bind(BX.Landing.Main.getInstance(), this)();
								this.sidebarActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_ACTIONS_COPY"),
							onclick: function() {
								BX.Landing.Main.getInstance().onCopyBlock.bind(BX.Landing.Main.getInstance(), this)();
								this.sidebarActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							id: "block_paste",
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_ACTIONS_PASTE"),
							title: window.localStorage.landingBlockName,
							className: this.isPasteBlockAllowed() ? "": "landing-ui-disabled",
							onclick: function() {
								BX.Landing.Main.getInstance().onPasteBlock.bind(BX.Landing.Main.getInstance(), this)();
								this.sidebarActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							delimiter: true,
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("LANDING_BLOCKS_ACTIONS_FEEDBACK_BUTTON"),
							onclick: this.showFeedbackForm.bind(this)
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("LANDING_BLOCKS_ACTIONS_SAVE_BLOCK_BUTTON_MSGVER_1"),
							className: !this.isSaveBlockInLibraryAllowed() ? "landing-ui-disabled" : "",
							onclick: function() {
								this.saveBlock();
								this.sidebarActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							delimiter: true,
						}),
						new BX.Main.MenuItem({
							id: "remove",
							text: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_REMOVE"),
							onclick: function() {
								this.deleteBlock();
								this.sidebarActionsMenu.close();
							}.bind(this),
							className: !this.isRemoveBlockAllowed() ? "landing-ui-disabled" : ""
						})
					]
				});
			}

			this.sidebarActionsMenu.show();
			addClass(this.node, "landing-ui-hover");
		},


		/**
		 * Initializes action panels of block
		 * @private
		 */
		lazyInitPanels: function()
		{
			if (this.isInSidebar())
			{
				this.initSidebarActionPanel();
			}

			var allPlacements = BX.Landing.Main.getInstance().options.placements.blocks;

			// Make content actions panel
			if (
				!this.panels.contains("content_actions")
				&& (
					(isPlainObject(this.manifest.nodes) && !isEmpty(this.manifest.nodes))
					|| (isPlainObject(this.manifest.style) && !isEmpty(this.manifest.style))
					|| (isPlainObject(allPlacements) && !isEmpty(allPlacements))
				)
			)
			{
				var contentPanel = new BaseButtonPanel(
					"content_actions",
					"landing-ui-panel-content-action"
				);

				contentPanel.addButton(
					new ActionButton("collapse", {
						html: "<span class='fas fa-caret-right'></span>",
						onClick: this.onCollapseActionPanel.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_COLLAPSE")},
						separate: true,
					})
				);

				if (this.isAllowedByTariff())
				{
					if (isPlainObject(this.manifest.style))
					{
						contentPanel.addButton(
							new ActionButton("designblock", {
								text: BX.Landing.Loc.getMessage("LANDING_BLOCKS_ACTIONS_DESIGN_BLOCK"),
								onClick: this.onDesignerBlockClick.bind(this),
								disabled: !this.isDesignBlockAllowed(),
								attrs: { title: BX.Landing.Loc.getMessage("LANDING_BLOCKS_ACTIONS_DESIGN_BLOCK") },
								separate: true,
							})
						);

						contentPanel.addButton(
							new ActionButton("style", {
								text: BX.Landing.Loc.getMessage("ACTION_BUTTON_STYLE"),
								onClick: this.onStyleShow.bind(this),
								disabled: !this.isStyleModifyAllowed(),
								attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_DESIGN")},
								separate: true,
							})
						);
					}

					if (isPlainObject(this.manifest.nodes) || isPlainObject(this.manifest.attrs) )
					{
						contentPanel.addButton(
							new ActionButton("content", {
								text: BX.Landing.Loc.getMessage("ACTION_BUTTON_CONTENT"),
								onClick: this.onShowContentPanel.bind(this),
								attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_EDIT")},
								separate: true,
							})
						);
					}
				}
				else {
					contentPanel.addButton(
						new ActionButton("expired", {
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_EXPIRED"),
							separate: true,
						})
					);
				}

				if (isPlainObject(allPlacements) && (this.manifest.code in allPlacements || allPlacements["*"]))
				{
					var placementsList = [];

					if (this.manifest.code in allPlacements)
					{
						Object.keys(allPlacements[this.manifest.code]).forEach(function(key) {
							placementsList.push(allPlacements[this.manifest.code][key]);
						}, this);
					}

					if (allPlacements["*"])
					{
						Object.keys(allPlacements["*"]).forEach(function(key) {
							placementsList.push(allPlacements["*"][key]);
						}, this);
					}

					if (placementsList.length)
					{
						contentPanel.addButton(
							new ActionButton("actions", {
								html: BX.Landing.Loc.getMessage("ACTION_BUTTON_CONTENT_MORE"),
								onClick: this.onPlacementButtonClick.bind(this, placementsList),
								separate: true,
							})
						);

						if (typeof BX.Landing.PageObject.getRootWindow().BX.rest !== "undefined" &&
							typeof BX.Landing.PageObject.getRootWindow().BX.rest.AppLayout !== "undefined")
						{
							var codes = ["*", this.manifest.code];
							for (var i = 0, c = codes.length; i < c; i++)
							{
								var MessageInterface = BX.Landing.PageObject.getRootWindow().BX.rest.AppLayout.initializePlacement(
									"LANDING_BLOCK_" + codes[i]
								);
								if (MessageInterface)
								{
									MessageInterface.prototype.refreshBlock = function(params, cb) {
										var block = BX.Landing.PageObject.getBlocks().get(params.id);

										if (block)
										{
											block
												.reload()
												.then(cb);
										}
									};
								}

							}
						}
					}
				}

				if (isPlainObject(this.manifest.style))
				{
					var blockDisplay = new ActionButton("block_display_info", {
						html: "&nbsp;",
						separate: true,
						onClick: this.onStyleShow.bind(this),
					});

					bind(blockDisplay.layout, "mouseenter", this.onBlockDisplayMouseenter.bind(this));
					bind(blockDisplay.layout, "mouseleave", this.onBlockDisplayMouseleave.bind(this));

					contentPanel.addButton(
						blockDisplay
					);
				}

				contentPanel.show();
				this.addPanel(contentPanel);
			}


			// Make block actions panel
			if (!this.panels.get("block_action"))
			{
				var blockPanel = new BaseButtonPanel(
					"block_action",
					"landing-ui-panel-block-action"
				);

				var block = this.getBlockFromRepository(this.manifest.code);

				if (block && block.restricted)
				{
					var restrictedButton = new ActionButton("restricted", {
						html: "!",
						className: "landing-ui-block-restricted-button",
						onClick: this.onRestrictedButtonClick.bind(this),
						separate: true
					});

					bind(restrictedButton.layout, "mouseenter", this.onRestrictedButtonMouseenter.bind(this));
					bind(restrictedButton.layout, "mouseleave", this.onRestrictedButtonMouseleave.bind(this));
					blockPanel.addButton(restrictedButton);
				}


				blockPanel.addButton(
					new ActionButton("down", {
						html: BX.Landing.Loc.getMessage("ACTION_BUTTON_DOWN"),
						onClick: this.moveDown.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_SORT_DOWN")}
					})
				);

				blockPanel.addButton(
					new ActionButton("up", {
						html: BX.Landing.Loc.getMessage("ACTION_BUTTON_UP"),
						onClick: this.moveUp.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_SORT_UP")}
					})
				);

				blockPanel.addButton(
					new ActionButton("actions", {
						html: BX.Landing.Loc.getMessage("ACTION_BUTTON_ACTIONS"),
						onClick: this.showBlockActionsMenu.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_ADDITIONAL_ACTIONS")}
					})
				);

				blockPanel.addButton(
					new ActionButton("remove", {
						html: BX.Landing.Loc.getMessage("ACTION_BUTTON_REMOVE"),
						disabled: !this.isRemoveBlockAllowed(),
						onClick: this.deleteBlock.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_REMOVE")}
					})
				);

				blockPanel.addButton(
					new ActionButton("collapse", {
						html: "<span class='fas fa-caret-right'></span>",
						onClick: this.onCollapseActionPanel.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_BLOCK_ACTION_COLLAPSE")},
						separate: true
					})
				);

				blockPanel.show();
				this.addPanel(blockPanel);
			}

			this.adjustPanelsPosition();
			this.adjustSortButtonsState();
		},

		onCollapseActionPanel: function()
		{
			toggleClass(this.parent, "landing-ui-collapse");
		},

		getBlockFromRepository: function(code)
		{
			var blocks = BX.Landing.Main.getInstance().options.blocks;
			var categories = Object.keys(blocks);
			var category = categories.find(function(categoryId) {
				return code in blocks[categoryId].items;
			});

			if (category)
			{
				return blocks[category].items[code];
			}
		},


		onRestrictedButtonClick: function(event)
		{
			event.preventDefault();
		},

		onPlacementClick: function(placement)
		{
			BX.rest.AppLayout.openApplication(
				placement.app_id,
				{
					ID: this.id,
					CODE: this.manifest.code,
					LID: BX.Landing.Main.getInstance().id
				},
				{
					PLACEMENT: 'LANDING_BLOCK_' + placement.placement,
					PLACEMENT_ID: placement.id
				}
			);

			if (this.blockPlacementsActionsMenu)
			{
				this.blockPlacementsActionsMenu.close();
			}
		},


		onPlacementButtonClick: function(placements)
		{
			this.panels.get("content_actions").buttons.get("actions").activate();

			if (!this.blockPlacementsActionsMenu)
			{
				var blockActionButton = this.panels.get("content_actions").buttons.get("actions");
				var blockActionMenuId = join("block_", this.id, "content_placement_actions_", random());

				var menuItems = placements.map(function(placement) {
					return new BX.Main.MenuItem({
						id: "placement_" + (placement.id || random()) + "_" + random(),
						text: encodeDataValue(placement.title),
						disabled: placement.disabled === true,
						onclick: (typeof placement.onClick === 'function')
							? placement.onClick
							: this.onPlacementClick.bind(this, placement)
					})
				}, this);

				this.blockPlacementsActionsMenu = new BX.PopupMenuWindow({
					id: blockActionMenuId,
					bindElement: blockActionButton.layout,
					items: menuItems,
					angle: {position: "top", offset: 80},
					offsetTop: -6,
					events: {
						onPopupClose: function() {
							this.panels.get("content_actions").buttons.get("actions").deactivate();
							removeClass(this.node, "landing-ui-hover");
						}.bind(this)
					}
				});
			}

			addClass(this.node, "landing-ui-hover");
			this.blockPlacementsActionsMenu.show();
		},

		onDesignerBlockClick: function()
		{
			// get actual block content before designer edit
			var oldContent = null;
			BX.Landing.Backend.getInstance()
				.action("Block::getContent", {
					block: this.id,
					lid: this.lid,
					siteId: this.siteId,
					editMode: 1
				})
				.then(function(response) {
					oldContent = response.content;
				});

			// open slider with designer
			var envOptions = BX.Landing.Env.getInstance().getOptions();
			var sliderUrl = envOptions.params.sef_url["design_block"]
				.replace("__block_id__", this.id)
				.replace("__site_show__", this.siteId)
				.replace("__landing_edit__", this.lid)
				+ "&code=" + this.manifest.code
				+ "&designed=" + (this.designed ? "Y" : "N")
				+ "&deviceCode=" + BX.Landing.Main.getInstance().getDeviceCode();
			BX.SidePanel.Instance.open(
				sliderUrl,
				{
					cacheable: false,
					allowChangeHistory: false,
					requestMethod: "post",
					customLeftBoundary: 40,
					events: {
						onClose: function(event)
						{
							// get actual block content after designer edit
							BX.Landing.Backend.getInstance()
								.action("Block::getContent", {
									block: this.id,
									lid: this.lid,
									siteId: this.siteId,
									editMode: 1
								})
								.then(function(response) {
									var newContent = response.content;
									if (oldContent !== newContent)
									{
										BX.Landing.History.getInstance().push();
										this.reload().then(function()
										{
											fireCustomEvent("BX.Landing.Block:onDesignerBlockSave", [this.id]);
										}.bind(this));
										// analytic label on close
										var metrika = new BX.Landing.Metrika(true);
										metrika.sendLabel(
											null,
											"designerBlock",
											"close" +
											"&designed=" + (this.designed ? "Y" : "N") +
											"&code=" + this.manifest.code
										);
									}
								}.bind(this));
						}.bind(this)
					}
				}
			);

			if (this.blockPlacementsActionsMenu)
			{
				this.blockPlacementsActionsMenu.close();
			}
		},

		isDesignBlockAllowed: function()
		{
			return !(this.access < ACCESS_W || this.php || (this.isCrmFormPage() && this.isCrmFormBlock()));
		},

		isStyleModifyAllowed:function()
		{
			return !(this.access < ACCESS_V || isEmpty(this.manifest.style));
		},

		isEditBlockAllowed: function()
		{
			return this.access >= ACCESS_W;
		},

		isRemoveBlockAllowed: function()
		{
			return !(this.access < ACCESS_X || (this.isCrmFormBlock() && this.isDefaultCrmFormBlock()));
		},

		isPasteBlockAllowed: function()
		{
			return window.localStorage.landingBlockId && !this.isDefaultCrmFormBlock();
		},

		isSaveBlockInLibraryAllowed: function()
		{
			return !this.isDefaultCrmFormBlock();
		},

		isChangeStateBlockAllowed: function()
		{
			return !((this.access < ACCESS_W) || this.isDefaultCrmFormBlock());
		},

		saveBlock: function()
		{
			BX.Landing.Main.getInstance().showSaveBlock(this);
		},

		onRestrictedButtonMouseenter: function(event)
		{
			clearTimeout(this.displayBlockTimer);
			this.displayBlockTimer = setTimeout(function(target) {
				BX.Landing.UI.Tool.Suggest.getInstance().show(target, {
					description: BX.Landing.Loc.getMessage("LANDING_BLOCK_RESTRICTED_TEXT")
				});
			}.bind(this), 200, event.currentTarget);
		},

		onRestrictedButtonMouseleave: function()
		{
			clearTimeout(this.displayBlockTimer);
			BX.Landing.UI.Tool.Suggest.getInstance().hide();
		},

		onBlockDisplayMouseenter: function(event)
		{
			clearTimeout(this.displayBlockTimer);
			this.displayBlockTimer = setTimeout(function(target) {
				BX.Landing.UI.Tool.Suggest.getInstance().show(
					target,
					{
						name: create("div", {
							props: {className: "landing-ui-block-display-message-header"},
							html: BX.Landing.Loc.getMessage("LANDING_BLOCK_DISABLED_ON_DESKTOP_NAME_2")
						}).outerHTML,
						description: this.getBlockDisplayItems()
					}
				);
			}.bind(this), 300, event.currentTarget);
		},

		onBlockDisplayMouseleave: function()
		{
			clearTimeout(this.displayBlockTimer);
			BX.Landing.UI.Tool.Suggest.getInstance().hide();
		},

		getBlockDisplayItems: function()
		{
			function createItem(mod)
			{
				return create("div", {
					props: {className: "landing-ui-block-display-message"},
					attrs: {"data-mod": mod},
					children: [
						create("div", {
							props: {className: "landing-ui-block-display-message-left"},
							html: "&nbsp;"
						}),
						create("div", {
							props: {className: "landing-ui-block-display-message-right"},
							children: [
								create("p", {html: BX.Landing.Loc.getMessage("LANDING_BLOCK_HIDDEN_ON_"+(mod ? mod.toUpperCase() : ""))})
							]
						})
					]
				});
			}

			var result = create("div");

			if (hasClass(this.content, "l-d-lg-none"))
			{
				result.appendChild(createItem("desktop"));
			}

			if (hasClass(this.content, "l-d-md-none"))
			{
				result.appendChild(createItem("tablet"));
			}

			if (hasClass(this.content, "l-d-xs-none"))
			{
				result.appendChild(createItem("mobile"));
			}

			return result.outerHTML;
		},


		/**
		 * Adjusts block panels position
		 */
		adjustPanelsPosition: function()
		{
			var blockRect = rect(this.node);
			var contentActionsPanel = this.panels.get("content_actions");
			var blockActionsPanel = this.panels.get("block_action");
			var action = blockRect.height < 80 ? addClass : removeClass;

			if (contentActionsPanel)
			{
				action(contentActionsPanel.layout, "landing-ui-panel-actions-compact");
			}

			if (blockActionsPanel)
			{
				action(blockActionsPanel.layout, "landing-ui-panel-actions-compact");
			}
		},


		/**
		 * Handles editor enable event
		 * Event fires when the editor was show
		 * @param {HTMLElement} element
		 */
		onEditorEnabled: function(element)
		{
			if (this.node.contains(element))
			{
				addClass(this.node, "landing-ui-hover");
			}
		},


		/**
		 * Handles editor disable event
		 * Event fires when the editor was hidden
		 */
		onEditorDisabled: function()
		{
			removeClass(this.node, "landing-ui-hover");
		},


		onStorage: function()
		{
			var menu = (this.blockActionsMenu || this.sidebarActionsMenu);
			if (menu)
			{
				var item = menu.getMenuItem("block_paste");

				if (item)
				{
					if (window.localStorage.landingBlockId)
					{
						item.layout.item.setAttribute("title", window.localStorage.landingBlockName);
						removeClass(item.layout.item, "landing-ui-disabled");
						addClass(item.layout.item, "menu-popup-no-icon");
					}
					else
					{
						item.layout.item.setAttribute("title", "");
						addClass(item.layout.item, "landing-ui-disabled");
					}
				}
			}
		},


		/**
		 * Shows block popup menu with additional action menu
		 */
		showBlockActionsMenu: function()
		{
			this.panels.get("block_action").buttons.get("actions").activate();

			if (!this.blockActionsMenu)
			{
				var useSmallOffset = hasClass(this.node.parentElement, "landing-sidebar");
				var blockActionButton = this.panels.get("block_action").buttons.get("actions");
				var blockActionMenuId = join("block_", this.id, "_actions_", random());
				var landing = BX.Landing.Main.getInstance();

				this.blockActionsMenu = new BX.PopupMenuWindow({
					id: blockActionMenuId,
					bindElement: blockActionButton.layout,
					className: "landing-ui-block-actions-popup",
					angle: {position: "top", offset: useSmallOffset ? 70 : 146},
					offsetTop: -6,
					offsetLeft: -26,
					events: {
						onPopupClose: function() {
							this.panels.get("block_action").buttons.get("actions").deactivate();
							removeClass(this.node, "landing-ui-hover");
						}.bind(this),
						onPopupShow: function() {
							BX.Event.EventEmitter.emit('BX.Landing.PopupMenuWindow:onShow');
						}.bind(this)
					},
					items: [
						new BX.Main.MenuItem({
							id: "show_hide",
							text: BX.Landing.Loc.getMessage(this.isEnabled() ? "ACTION_BUTTON_HIDE" : "ACTION_BUTTON_SHOW"),
							className: !this.isChangeStateBlockAllowed() ? "landing-ui-disabled" : "",
							onclick: function() {
								this.onStateChange();
								this.blockActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_ACTIONS_CUT"),
							className: !this.isRemoveBlockAllowed() ? "landing-ui-disabled" : "",
							onclick: function() {
								landing.onCutBlock.bind(landing, this)();
								this.blockActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_ACTIONS_COPY"),
							className: this.isDefaultCrmFormBlock() ? "landing-ui-disabled" : "",
							onclick: function() {
								landing.onCopyBlock.bind(landing, this)();
								this.blockActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							id: "block_paste",
							text: BX.Landing.Loc.getMessage("ACTION_BUTTON_ACTIONS_PASTE"),
							title: window.localStorage.landingBlockName,
							className: this.isPasteBlockAllowed() ? "": "landing-ui-disabled",
							onclick: function() {
								landing.onPasteBlock.bind(landing, this)();
								this.blockActionsMenu.close();
							}.bind(this)
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("LANDING_BLOCKS_ACTIONS_FEEDBACK_BUTTON"),
							onclick: this.showFeedbackForm.bind(this)
						}),
						new BX.Main.MenuItem({
							delimiter: true,
						}),
						new BX.Main.MenuItem({
							text: BX.Landing.Loc.getMessage("LANDING_BLOCKS_ACTIONS_SAVE_BLOCK_BUTTON_MSGVER_1"),
							className: !this.isSaveBlockInLibraryAllowed() ? "landing-ui-disabled" : "",
							onclick: function() {
								this.saveBlock();
								this.blockActionsMenu.close();
							}.bind(this)
						}),
					]
				});
			}

			addClass(this.node, "landing-ui-hover");
			this.blockActionsMenu.show();
		},


		/**
		 * Moves the block up one position
		 * @param {boolean} [preventHistory = false] - Add this action to history or not. By default - add
		 */
		moveUp: function(preventHistory)
		{
			var prev = prevSibling(this.node, "block-wrapper");
			var current = this.node;

			if (prev)
			{
				var result = Promise.all([
					translateY(current, -rect(prev).height),
					translateY(prev, rect(current).height)
				]);

				result.then(function() {
					void style(current, {"transform": null, "transition": null});
					void style(prev, {"transform": null, "transition": null});
					insertBefore(current, prev);

					if (!preventHistory || typeof preventHistory === "object")
					{
						BX.Landing.Backend.getInstance()
							.action(
								"Landing::upBlock",
								{block: this.id, lid: this.lid, siteId: this.siteId},
								{code: this.manifest.code}
							)
							.then(() => {
								BX.Landing.History.getInstance().push();
							});
					}
				}.bind(this));
			}
		},


		/**
		 * Moves the block down one position
		 * @param {boolean} [preventHistory = false] - Add this action to history or not. By default - add
		 */
		moveDown: function(preventHistory)
		{
			var next = nextSibling(this.node, "block-wrapper");
			var current = this.node;

			if (!!next)
			{
				var result = Promise.all([
					translateY(current, rect(next).height),
					translateY(next, -rect(current).height)
				]);

				result.then(function() {
					void style(current, {"transform": null, "transition": null});
					void style(next, {"transform": null, "transition": null});
					insertAfter(current, next);

					if (!preventHistory || typeof preventHistory === "object")
					{
						BX.Landing.Backend.getInstance()
							.action(
								"Landing::downBlock",
								{block: this.id, lid: this.lid, siteId: this.siteId},
								{code: this.manifest.code}
							)
							.then(() => {
								BX.Landing.History.getInstance().push();
							});
					}
				}.bind(this));
			}
		},


		/**
		 * Adds panel into this block
		 * @param {BX.Landing.UI.Panel.BasePanel} panel
		 * @param {*} [target = this.node]
		 */
		addPanel: function(panel, target)
		{
			if (!this.panels.contains(panel))
			{
				this.panels.add(panel);

				if (!target)
				{
					if (panel.id === 'content_edit' && window.parent)
					{
						let topWindow = BX.Landing.PageObject.getRootWindow();
						append(panel.layout, topWindow.document.body);
					}
					else
					{
						append(panel.layout, this.node);
					}
				}
				else
				{
					insertBefore(panel.layout, target);
				}
			}
		},

		/**
		 *
		 * @return {{code: string, id: string, type: string}|null}
		 */
		getBlockFormId: function()
		{
			var formScriptNode = this.node.querySelector('script[data-b24-form]');
			if (BX.Type.isDomNode(formScriptNode))
			{
				var formId = BX.Dom.attr(formScriptNode, 'data-b24-form');
				if (BX.Type.isStringFilled(formId))
				{
					var parsedFormId = formId.split('/');
					if (BX.Type.isArray(parsedFormId) && parsedFormId.length === 3)
					{
						var instanceId = '';
						var formUid = BX.Dom.attr(
							formScriptNode.previousSibling.firstChild,
							'id'
						);

						if (formUid)
						{
							instanceId = formUid.replace('b24-', '');
						}

						return {
							id: parsedFormId[1],
							type: parsedFormId[0],
							code: parsedFormId[2],
							instanceId: instanceId
						};
					}
				}
			}

			formScriptNode = this.node.querySelector('[data-b24form]');
			if (BX.Type.isDomNode(formScriptNode))
			{
				formId = BX.Dom.attr(formScriptNode, 'data-b24form');
				if (BX.Type.isStringFilled(formId))
				{
					parsedFormId = formId.split('|');
					if (BX.Type.isArray(parsedFormId) && parsedFormId.length === 3)
					{
						instanceId = '';
						formUid = BX.Dom.attr(
							formScriptNode.querySelector('.b24-form > div[id]'),
							'id'
						);

						if (formUid)
						{
							instanceId = formUid.replace('b24-', '');
						}

						return {
							id: parsedFormId[0],
							type: parsedFormId[2] || 'inline',
							code: parsedFormId[1],
							instanceId: instanceId
						};
					}
				}
			}

			return null;
		},

		getCrmFormOptions: function()
		{
			var formNode = this.node.querySelector('[data-b24form-use-style]');
			var useAllowed = BX.Dom.attr(formNode, 'data-b24form-use-style');
			var primaryMatcher = /--primary([\da-fA-F]{2})/;

			if (BX.Type.isDomNode(formNode) && BX.Text.toBoolean(useAllowed))
			{
				var designOptions = BX.Dom.attr(formNode, 'data-b24form-design');
				if (BX.Type.isPlainObject(designOptions))
				{
					var primaryColor = BX.Dom.style(document.documentElement, '--primary').trim();
					Object.entries(designOptions.color).forEach(function(entry) {
						if (
							entry[1] === '--primary'
							|| entry[1].match(primaryMatcher) !== null
						)
						{
							designOptions.color[entry[0]] = entry[1].replace('--primary', primaryColor);
						}
					});

					return {
						data: {
							design: designOptions,
						}
					};
				}
			}

			return {};
		},

		isCrmFormPage: function()
		{
			return BX.Landing.Env.getInstance().getOptions().specialType === 'crm_forms';
		},

		isCrmFormBlock: function()
		{
			return this.isCrmFormPage() && BX.Dom.attr(this.node, 'data-subtype') === 'form';
		},

		isDefaultCrmFormBlock: function()
		{
			return BX.Dom.hasClass(this.node, 'block-66-90-form-new-default');
		},

		/**
		 * Handles show panel event
		 * @private
		 */
		onShowContentPanel: function()
		{
			var formId = this.getBlockFormId();
			var type = BX.Text.capitalize(
				BX.Landing.Env.getInstance().getOptions().params.type
			);
			if (
				BX.Type.isPlainObject(formId)
				&& type !== 'SMN'
			)
			{
				var rootWindow = BX.Landing.PageObject.getRootWindow();
				void (function() {
						if (BX.Landing.UI.Panel.FormSettingsPanel)
						{
							return Promise.resolve([
								rootWindow.BX.Landing.UI.Panel,
								BX.Landing.UI.Panel
							]);
						}

						return Promise
							.all([
								rootWindow.BX.Runtime
									.loadExtension('landing.ui.panel.formsettingspanel'),
								BX.Runtime
									.loadExtension('landing.ui.panel.formsettingspanel')
							]);
					})()
					.then(function(result) {
						var FormSettingsPanel = result[1].FormSettingsPanel;
						if (FormSettingsPanel)
						{
							return FormSettingsPanel
								.getInstance()
								.show({
									formId: formId.id,
									instanceId: formId.instanceId,
									formOptions: this.getCrmFormOptions(),
									block: this,
								});
						}
					}.bind(this));
			}
			else
			{
				this.showContentPanel();
			}

			BX.Landing.UI.Panel.EditorPanel.getInstance().hide();
		},


		/**
		 * Handles state change event
		 * @private
		 */
		onStateChange: function()
		{
			if (this.isEnabled())
			{
				this.disable();
			}
			else
			{
				this.enable();
			}
		},


		/**
		 * Checks that block is enabled
		 * @return {boolean}
		 */
		isEnabled: function()
		{
			return this.active;
		},


		/**
		 * Enables block
		 */
		enable: function()
		{
			this.active = true;
			removeClass(this.node, "landing-block-disabled");

			let menu = (this.blockActionsMenu || this.sidebarActionsMenu);
			if (menu)
			{
				setTextContent(menu.getMenuItem("show_hide").getLayout().text, BX.Landing.Loc.getMessage("ACTION_BUTTON_HIDE"));
			}

			fireCustomEvent("BX.Landing.Block:changeState", [this.id, true]);

			BX.Landing.Backend.getInstance().action(
				"Landing::showBlock",
				{block: this.id, lid: this.lid, siteId: this.siteId},
				{code: this.manifest.code}
			);
		},


		/**
		 * Disables block
		 */
		disable: function()
		{
			this.active = false;
			addClass(this.node, "landing-block-disabled");

			let menu = (this.blockActionsMenu || this.sidebarActionsMenu);
			if (menu)
			{
				setTextContent(menu.getMenuItem("show_hide").getLayout().text, BX.Landing.Loc.getMessage("ACTION_BUTTON_SHOW"));
			}

			fireCustomEvent("BX.Landing.Block:changeState", [this.id, false]);

			BX.Landing.Backend.getInstance().action(
				"Landing::hideBlock",
				{block: this.id, lid: this.lid, siteId: this.siteId},
				{code: this.manifest.code}
			);
		},


		/**
		 * Creates card label
		 * @param {HTMLElement} node
		 * @param {cardManifest} manifest
		 * @return {div}
		 */
		createCardLabel: function(node, manifest)
		{
			var labelSelectors = [];

			if (isString(manifest.label))
			{
				labelSelectors.push(manifest.label);
			}
			else if (isArray(manifest.label))
			{
				labelSelectors = labelSelectors.concat(manifest.label);
			}

			var cardNodes = this.nodes.filter(function(currentNode) {
				return node.contains(currentNode.node);
			});

			var children = [];

			labelSelectors.forEach(function(selector) {
				var labelNode = cardNodes.find(function(currentNode) {
					return currentNode.manifest.code === selector;
				});

				if (labelNode)
				{
					var currentLabel;

					if (labelNode instanceof BX.Landing.Block.Node.Text)
					{
						currentLabel = create("span", {
							props: {className: "landing-card-title-text"},
							html: escapeText(create("div", {html: labelNode.getValue()}).innerText)
						});
						children.push(currentLabel);

						onCustomEvent(labelNode.getField(), "change", function(value) {
							currentLabel.innerHTML = escapeText(create("div", {html: value}).innerText);
						});

						return;
					}

					if (labelNode instanceof BX.Landing.Block.Node.Link)
					{
						currentLabel = create("span", {
							props: {className: "landing-card-title-link"},
							html: escapeText(labelNode.getValue().text)
						});
						children.push(currentLabel);

						onCustomEvent(labelNode.getField(), "change", function(value) {
							currentLabel.innerHTML = escapeText(value.text);
						});

						return;
					}

					if (labelNode instanceof BX.Landing.Block.Node.Icon)
					{
						currentLabel = create("span", {
							props: {className: "landing-card-title-icon"},
							children: [create("span", {props: {className: labelNode.getValue().classList.join(" ")}})]
						});
						children.push(currentLabel);

						onCustomEvent(labelNode.getField(), "change", function(value) {
							currentLabel.firstChild.className = "landing-card-title-icon " + value.classList.join(" ");
						});

						return;
					}

					if (labelNode instanceof BX.Landing.Block.Node.Img)
					{
						currentLabel = create("span", {
							props: {className: "landing-card-title-img"},
							attrs: {
								style: "background-color: #fafafa"
							},
							children: [create('img', {props: {src: labelNode.getValue().src}})]
						});
						children.push(currentLabel);

						onCustomEvent(labelNode.getField(), "change", function(value) {
							currentLabel.innerHTML = "";
							currentLabel.appendChild(create('img', {props: {src: value.src}}));
						});
					}
				}
			}, this);

			return create("div", {
				props: {className: "landing-card-title"},
				children: !isEmpty(children) ? children : manifest.name
			});
		},


		/**
		 * Init Cards of Block.
		 */
		initCards: function()
		{
			if (this.access < ACCESS_W)
			{
				return;
			}

			this.cards.clear();
			this.forEachCard(function(node, selector, index) {
				var manifest = BX.clone(this.manifest.cards[selector]);
				var cardSelector = join(selector, "@", index);

				if (this.isDynamicCards(selector))
				{
					manifest.allowInlineEdit = false;
				}

				removePanels(node);
				var instance = new BX.Landing.Block.Card(node, manifest, cardSelector);
				this.cards.add(instance);

				if (manifest.allowInlineEdit !== false)
				{
					var cardAction = new CardActionPanel(
						"cardAction",
						"landing-ui-panel-block-card-action"
					);
					cardAction.show();
					instance.addPanel(cardAction);

					cardAction.addButton(new CardActionButton("clone", {
						html: "&nbsp;",
						onClick: function(event) {
							event.stopPropagation();

							if (instance.manifest.sync)
							{
								var syncedSelectors = instance.manifest.sync;

								if (isString(instance.manifest.sync))
								{
									syncedSelectors = [instance.manifest.sync];
								}

								if (isArray(syncedSelectors))
								{
									syncedSelectors.forEach(function(currentSyncSelector) {
										this.cloneCard(join(currentSyncSelector, "@", index));
									}, this);
								}
							}

							this.cloneCard(cardSelector);
						}.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_CARD_ACTION_CLONE")}
					}));

					cardAction.addButton(new CardActionButton("remove", {
						html: "&nbsp;",
						onClick: function(event) {
							event.stopPropagation();

							if (instance.manifest.sync)
							{
								var syncedSelectors = instance.manifest.sync;

								if (isString(instance.manifest.sync))
								{
									syncedSelectors = [instance.manifest.sync];
								}

								if (isArray(syncedSelectors))
								{
									syncedSelectors.forEach(function(currentSyncSelector) {
										this.removeCard(join(currentSyncSelector, "@", index));
									}, this);
								}
							}

							this.removeCard(cardSelector);
						}.bind(this),
						attrs: {title: BX.Landing.Loc.getMessage("LANDING_TITLE_OF_CARD_ACTION_REMOVE")}
					}));
				}

				instance.selector = cardSelector;
				instance.sortIndex = index;

				this.adjustCardRemoveButton(cardSelector);
			});

			this.cards.sort(function(a, b) {
				return a.getIndex() > b.getIndex();
			});
		},


		/**
		 * Clones Card.
		 * @param {string} selector - Selector of Card, which want clone.
		 * @param {?boolean} [preventHistory = false]
		 * @return {Promise}
		 */
		cloneCard: function(selector, preventHistory)
		{
			var card = this.cards.getBySelector(selector);
			var cloneButton = card.panels.get("cardAction").buttons.get("clone");
			var requestData = {block: this.id, selector: selector, lid: this.lid, siteId: this.siteId};
			var queryParams = {code: this.manifest.code};
			var self = this;

			showButtonLoader(cloneButton);

			let clonePromise = Promise.resolve();
			if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
			{
				requestData.preventHistory = 0;
				clonePromise = BX.Landing.Backend.getInstance()
					.action("Landing\\Block::cloneCard", requestData, queryParams)
					.then(result => {
						BX.Landing.History.getInstance().push();

						return result;
					});
			}

			return clonePromise
				.then(function() {
					fireCustomEvent("BX.Landing.Block:Card:beforeAdd", [
						self.createEvent({card: card.node})
					]);
				})

				// Clone
				.then(function() {
					var clonedCard = BX.clone(card.node);
					removePanels(clonedCard);
					insertAfter(clonedCard, card.node);
					return clonedCard;
				})

				// After clone
				.then(function(clonedCard) {
					hideButtonLoader(cloneButton);

					fireCustomEvent("BX.Landing.Block:Card:add", [
						self.createEvent({card: clonedCard})
					]);

					self.initEntities();
					self.initStyles();
				})

				// Handle errors
				.catch(function() {
					hideButtonLoader(cloneButton);
					return Promise.reject();
				});
		},


		/**
		 * Removes Card.
		 * @param {String} selector - Selector of Card, which want remove.
		 * @param {?boolean} [preventHistory = false]
		 * @return {Promise}
		 */
		removeCard: function(selector, preventHistory)
		{
			var card = this.cards.getBySelector(selector);
			var removeButton = card.panels.get("cardAction").buttons.get("remove");
			var requestData = {block: this.id, selector: selector, lid: this.lid, siteId: this.siteId};
			var queryParams = {code: this.manifest.code};
			var self = this;

			showButtonLoader(removeButton);

			let removePromise = Promise.resolve();
			if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
			{
				requestData.preventHistory = 0;
				removePromise = BX.Landing.Backend.getInstance()
					.action("Landing\\Block::removeCard", requestData, queryParams)
					.then(result => {
						BX.Landing.History.getInstance().push();

						return result;
					});
			}

			return removePromise
				// Before remove
				.then(function() {
					fireCustomEvent("BX.Landing.Block:Card:beforeRemove", [
						self.createEvent({card: card.node})
					]);

					removePanels(card.node);
				})
				// Remove
				.then(function() {
					self.cards.remove(card);
					card.node.remove();
					self.initEntities();
					self.adjustCardRemoveButton(selector);
				})
				// After remove
				.then(function() {
					var afterEvent = self.createEvent({data: {selector: selector}});
					fireCustomEvent("BX.Landing.Block:Card:remove", [afterEvent]);
					hideButtonLoader(removeButton);
				})
				.catch(function() {
					hideButtonLoader(removeButton);
					return Promise.reject();
				});
		},


		adjustCardRemoveButton: function(selector)
		{
			var card = this.cards.getBySelector(selector);

			if (card)
			{
				var cardAction = card.panels.get("cardAction");
				if (cardAction)
				{
					var cardIntoSlider = BX.hasClass(card.node, 'landing-block-card-carousel-element');
					var cardsParent = card.node.closest(".landing-block-node-carousel-container");
					if (!cardIntoSlider || !cardsParent)
					{
						var lastCardInCollection = card.node.parentElement.children.length === 1;
						if (lastCardInCollection)
						{
							cardAction.buttons.get("remove").disable();
						}
						else
						{
							cardAction.buttons.get("remove").enable();
						}
					}
					else
					{
						var cardsAmount = cardsParent.querySelectorAll('.landing-block-card-carousel-element').length;
						if (cardsAmount > 1)
						{
							cardAction.buttons.get("remove").enable();
						}
						else
						{
							cardAction.buttons.get("remove").disable();
						}
					}
				}
			}
		},


		/**
		 * Adds card
		 * @param {{[index]: !int, container: !HTMLElement, content: string, selector: string}} settings
		 * @param {boolean} [preventHistory]
		 * @return {Promise}
		 */
		addCard: function(settings, preventHistory)
		{
			var selector = settings.selector.split("@")[0] + (settings.index > 0 ? "@"+(settings.index-1) : "");

			var requestData = {
				block: this.id,
				content: settings.content,
				selector: selector,
				lid: this.lid,
				siteId: this.siteId,
			};
			var queryParams = {code: this.manifest.code};
			var container = settings.container;
			var card = create("div", {html: settings.content}).firstElementChild;
			var self = this;

			let addPromise = Promise.resolve();
			if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
			{
				requestData.preventHistory = 0;
				addPromise = BX.Landing.Backend.getInstance()
					.action("Landing\\Block::addCard", requestData, queryParams)
					.then(result => {
						BX.Landing.History.getInstance().push();

						return result;
					});
			}

			return addPromise
				.then(function() {
					fireCustomEvent("BX.Landing.Block:Card:beforeAdd", [
						self.createEvent({card: card})
					]);
				})
				.then(function() {
					var targetCard;
					if (settings.index <= 0)
					{
						targetCard = self.cards.find(function(card) {
							return card.selector.includes(selector.split("@")[0])
						});

						if (targetCard)
						{
							prepend(card, targetCard.node.parentNode);
						}
					}
					else
					{
						targetCard = self.cards.getBySelector(selector.split("@")[0] + "@" + (settings.index-1));

						if (targetCard)
						{
							insertAfter(card, targetCard.node);
						}
					}

					removePanels(container);
					self.initEntities();

					fireCustomEvent("BX.Landing.Block:Card:add", [
						self.createEvent({card: card})
					]);
				})
		},


		/**
		 * @callback cardCallback
		 * @param {HTMLElement} node
		 * @param {string} selector
		 * @param {int} index
		 */
		/**
		 * Applies callback function for each card node
		 * @param {cardCallback} callback
		 */
		forEachCard: function(callback)
		{
			var cardSelectors = Object.keys(this.manifest.cards);

			cardSelectors.map(function(cardSelector) {
				var cards = slice(this.node.querySelectorAll(cardSelector));

				cards.forEach(function(node, index) {
					callback.apply(this, [node, cardSelector, index]);
				}, this);
			}, this);
		},


		/**
		 * Init Nodes of Block.
		 */
		initNodes: function()
		{
			if (this.access < ACCESS_W)
			{
				return;
			}

			var nodes = [];

			this.forEachNodeElements(function(element, selector, index) {
				var instance = this.nodes.getByNode(element);
				var nodeSelector = join(selector, "@", index);

				if (!instance)
				{
					var handler = getClass(this.manifest.nodes[selector].handler);
					var presetNode = element.closest('[data-card-preset]');
					var manifest = clone(this.manifest.nodes[selector]);
					var disallowField = false;

					manifest.sections = this.sections;

					if (presetNode)
					{
						var presetId = presetNode.dataset.cardPreset;

						Object.keys(this.manifest.cards).forEach(function(cardSelector) {
							if (presetNode.matches(cardSelector))
							{
								if (isPlainObject(this.manifest.cards[cardSelector].presets) &&
									isPlainObject(this.manifest.cards[cardSelector].presets[presetId]) &&
									isArray(this.manifest.cards[cardSelector].presets[presetId].disallow))
								{
									var isDisallow = this.manifest.cards[cardSelector].presets[presetId].disallow.find(function(disallowSelector) {
										return selector === disallowSelector;
									});

									if (isDisallow)
									{
										manifest.allowInlineEdit = false;
										disallowField = true;
									}
								}
							}
						}, this);
					}

					var isDynamic = this.cards.some(function(currentCard) {
						var cardCode = currentCard.selector.split("@")[0];

						return (
							this.isDynamicCards(cardCode)
							&& currentCard.node.contains(element)
						);
					}, this);

					if (isDynamic)
					{
						manifest.allowInlineEdit = false;
					}
					else
					{
						var isCardNode = this.cards.some(function(currentCard) {
							return currentCard.node.contains(element);
						});

						if (!isCardNode)
						{
							if (this.isDynamic())
							{
								manifest.allowInlineEdit = false;
							}
						}
					}

					instance = new handler({
						node: element,
						manifest: manifest,
						selector: nodeSelector,
						onChange: this.onNodeChange.bind(this),
						onChangeOptions: this.onNodeOptionsChange.bind(this),
						onAttributeChange: this.onAttributeChange.bind(this),
						onDesignShow: this.showStylePanel.bind(this),
						uploadParams: {
							action: "Block::uploadFile",
							block: this.id
						}
					});

					if (disallowField)
					{
						instance.getField().layout.hidden = true;
					}

					this.nodes.add(instance);
				}

				instance.selector = nodeSelector;
				nodes.push(instance);
			});

			this.nodes.clear();

			nodes.forEach(function(node) {
				this.nodes.add(node);
			}, this);

			this.nodes.sort(function(a, b) {
				return a.getIndex() > b.getIndex();
			});
		},


		/**
		 * Handles node options change event
		 * @param {*} data
		 * @return {Promise<Object, Object>}
		 */
		onNodeOptionsChange: function(data)
		{
			if (!isEmpty(data))
			{
				this.initStyles();

				var queryParams = {code: this.manifest.code};
				var requestBody = {};

				requestBody.data = data;
				requestBody.block = this.id;
				requestBody.siteId = this.siteId;

				return BX.Landing.Backend.getInstance()
					.action("Block::changeNodeName", requestBody, queryParams);
			}
		},


		/**
		 * @callback forEachNodeElementsCallback
		 * @param {HTMLElement} [element]
		 * @param {string} [selector]
		 * @param {int} [index]
		 */
		/**
		 * Applies callback for each element of node
		 * @param {forEachNodeElementsCallback} callback
		 */
		forEachNodeElements: function(callback)
		{
			Object.keys(this.manifest.nodes).forEach(function(selector) {
				try {
					slice(this.node.querySelectorAll(selector)).forEach(function(element, index) {
						if (!element.matches("[data-id=\"content_edit\"] *"))
						{
							callback.apply(this, [element, selector, index]);
						}
					}, this);
				} catch(err) {}
			}, this);
		},


		/**
		 * Shows content edit panel
		 * @param {{name: string, nodes: BX.Landing.Collection.NodeCollection, [compact]: boolean, [nodesOnly]}} [options]
		 */
		showContentPanel: function(options)
		{
			var nodes = !!options && options.nodes ? options.nodes : null;
			var formName = !!options && options.name ? options.name : null;
			var nodesOnly = !!options && options.nodesOnly ? options.nodesOnly : false;
			var showAll = !!options && options.showAll ? options.showAll : false;
			var compactMode = !!options && options.compact;
			var hideCheckbox = !!options && options.hideCheckbox;
			var contentPanel = this.panels.get("content_edit");

			if (!contentPanel)
			{
				contentPanel = new ContentEditPanel("content_edit", {
					title: BX.Landing.Loc.getMessage("LANDING_CONTENT_PANEL_TITLE"),
					subTitle: this.manifest.block.name,
					onSaveHandler: this.onContentSave.bind(this),
					onCancelHandler: this.onContentCancel.bind(this),
				});

				var formId = this.getBlockFormId();
				var type = BX.Text.capitalize(
					BX.Landing.Env.getInstance().getOptions().params.type
				);
				if (
					BX.Type.isPlainObject(formId)
					&& type !== 'SMN'
				)
				{
					var button = new BX.UI.Button({
						text: BX.Landing.Loc.getMessage('LANDING_SHOW_FORM_EDITOR'),
						color: BX.UI.Button.Color.LIGHT_BORDER,
						round: true,
						className: 'landing-ui-panel-top-button',
						onclick: function() {
							contentPanel.hide()
								.then(function() {
									this.onShowContentPanel();
								}.bind(this));
						}.bind(this)
					});

					BX.Dom.style(button.render(), {
						position: 'absolute',
						right: '50px',
					});

					BX.Dom.append(button.render(), contentPanel.header);
				}

				this.addPanel(contentPanel);
			}

			contentPanel.compact(compactMode);
			contentPanel.clear();

			var block = this.getBlockFromRepository(this.manifest.code);

			if (block && block.restricted)
			{
				append(this.getRestrictedMessage(), contentPanel.content);
			}

			this.tmpContent = create("div", {
				props: {hidden: true}
			});

			this.content.appendChild(this.tmpContent);
			var html = "";

			Object.keys(this.manifest.cards).forEach(function(cardSelector) {
				var card = this.manifest.cards[cardSelector];

				if (isPlainObject(card.presets))
				{
					Object.keys(card.presets).forEach(function(presetId) {
						var preset = card.presets[presetId];
						html += preset.html;
					}, this);
				}
			}, this);

			this.tmpContent.innerHTML = html;
			this.initEntities();
			this.initCardsLabels();

			var forms = this.getEditForms({
				nodes: nodes,
				formName: formName,
				nodesOnly: nodesOnly,
				showAll: showAll,
				hideCheckbox: hideCheckbox
			});

			forms.forEach(function(form) {
				contentPanel.appendForm(form);
			});

			this.tmpContent.innerHTML = "";
			contentPanel.show();

			setTimeout(function() {
				this.lastBlockState = this.fetchRequestData(contentPanel, true);
			}.bind(this), 300);
		},

		createHistoryEntry: function(newState)
		{
			Promise
				.all([
					this.lastBlockState,
					newState
				])
				.then(function(states) {
					var undoState = states[0];
					var redoState = states[1];

					BX.Landing.History.getInstance().push(
						new BX.Landing.History.Entry({
							block: this.id,
							selector: "#block" + this.id,
							command: "updateBlockState",
							undo: undoState,
							redo: redoState
						})
					);
				}.bind(this));

			return Promise.resolve(clone(newState));
		},

		/**
		 * Updates block's content.
		 * @param {string} content
		 * @param {boolean} [preventHistory = false] - Add this action to history or not. By default - add
		 */
		updateContent: function(content, preventHistory)
		{
			let updatePromise = Promise.resolve();
			if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
			{
				updatePromise = BX.Landing.Backend.getInstance().action(
					"Block::updateContent",
					{
						lid: this.lid,
						block: this.id,
						content: content.replaceAll(' style="', ' bxstyle="'),
						preventHistory: 0,
					},
					{code: this.manifest.code}
				);
			}

			const reloadPromise = this.reload();

			return Promise.all([updatePromise, reloadPromise]);
		},

		updateBlockState: function(state, preventHistory)
		{
			if (
				BX.type.isPlainObject(state)
				&& BX.type.isPlainObject(state.dynamicParams)
			)
			{
				this.dynamicParams = clone(state.dynamicParams);
			}
			else
			{
				this.dynamicParams = {};
			}

			Promise.resolve(state)
				.then(function(currentState) {
					return preventHistory ? currentState : this.createHistoryEntry(currentState);
				}.bind(this))
				.then(this.applyMenuChanges.bind(this))
				.then(this.applyContentChanges.bind(this))
				.then(this.applyCardsChanges.bind(this))
				.then(this.applyAttributeChanges.bind(this))
				.then(this.applySettingsChanges.bind(this))
				.then(data => {
					return this.saveChanges.bind(this)(data, preventHistory);
				})
				// Reload only blocks with component
				.then(this.reload.bind(this))
				.catch(console.warn);

			var contentPanel = this.panels.get('content_edit');

			if (contentPanel)
			{
				var contentForms = new FormCollection();

				contentPanel.forms.forEach(function(form) {
					if (form.type !== "attrs")
					{
						contentForms.add(form);

						if (form.childForms && form.childForms.length > 0)
						{
							form.childForms.forEach(function(childForm) {
								contentForms.add(childForm);
							});
						}
					}
				});

				contentForms.fetchFields().forEach(function(field) {
					if (field.tag)
					{
						var node = this.nodes.getBySelector(field.selector);
						if (node)
						{
							node.onChangeTag(field.tag);
						}
					}
				}, this);
			}
		},

		getRestrictedMessage: function()
		{
			return create("div", {
				props: {className: "ui-alert ui-alert-warning"},
				html: BX.Landing.Loc.getMessage("LANDING_BLOCK_RESTRICTED_TEXT"),
				attrs: {style: "margin-bottom: 20px"}
			})
		},


		/**
		 * Handles event on style panel show
		 */
		onStyleShow: function()
		{
			BX.Landing.UI.Panel.EditorPanel.getInstance().hide();

			if (this.isCrmFormPage() && this.isCrmFormBlock())
			{
				var formSelector = Object.entries(this.manifest.style.nodes).reduce(function(acc, item) {
					if (item[1].type === 'crm-form')
					{
						return item[0];
					}

					return acc;
				}, null);

				if (formSelector)
				{
					this.showStylePanel(formSelector);
				}
				else
				{
					this.showStylePanel(this.selector);
				}
			}
			else
			{
				this.showStylePanel(this.selector);
			}
		},


		/**
		 * Gets className postfix --lg --md --sm
		 */
		getPostfix: function()
		{
			return "";
		},


		/**
		 * Expands type groups
		 * @param {string|string[]} types
		 * @returns {string[]}
		 */
		expandTypeGroups: function(types)
		{
			var result = [];

			if (!BX.type.isArray(types))
			{
				types = [types];
			}

			types.forEach(function(type) {
				if (isGroup(type))
				{
					getGroupTypes(type).forEach(function(groupType) {
						result.push(groupType);
					});
				}
				else
				{
					result.push(type);
				}
			});

			return result;
		},


		/**
		 * Makes style editor form for style node
		 * @param {string} selector
		 * @param {{
		 * 		type: string|string[],
		 * 		name: string,
		 * 		[props],
		 * 		[title]
		 * 	}} settings
		 * @param {boolean} [isBlock = false]
		 * @returns {?BX.Landing.UI.Form.StyleForm}
		 */
		createStyleForm: function(selector, settings, isBlock)
		{
			var form = this.forms.get(selector);

			if (form)
			{
				this.forms.remove(form);
			}

			var type = !!settings.props ? settings.props : !!settings.type ? settings.type : null;
			var name = !!settings.title ? settings.title : !!settings.name ? settings.name : "";

			if (!!type && !!name)
			{
				var styleFactory = new StyleFactory({frame: window, postfix: this.getPostfix()});

				form = new StyleForm({
					id: selector,
					title: name,
					selector: selector,
					iframe: window
				});

				type = this.expandTypeGroups(type).reduce(function(acc, item) {
					if (!acc.includes(item))
					{
						acc.push(item);
					}

					return acc;
				}, []);

				type.forEach(function(type) {
					var typeSettings = getTypeSettings(type);
					if (typeSettings === null)
					{
						return;
					}
					var styleNode = this.styles.get(selector);
					var field = styleFactory.createField({
						block: this,
						styleNode: styleNode,
						selector: !isBlock ? this.makeRelativeSelector(selector) : selector,
						property: typeSettings.property,
						multiple: typeSettings.multiple === true,
						style: type,
						pseudoElement: typeSettings["pseudo-element"],
						pseudoClass: typeSettings["pseudo-class"],
						attrKey: typeSettings.attrKey,
						type: typeSettings.type,
						subtype: typeSettings.subtype,
						title: typeSettings.name,
						items: typeSettings.items,
						help: typeSettings.help,
						onChange: onChange.bind(this),
						onReset: onReset.bind(this)
					});

					// when field changed
					function onChange(value, items, postfix, affect) {
						// false handler by some fields events
						if (value instanceof  BX.Event.BaseEvent)
						{
							return;
						}

						var exclude = !!typeSettings.exclude ? getTypeSettings(typeSettings.exclude) : null;

						if (exclude)
						{
							form.fields.forEach(function(field) {
								if (field.style === typeSettings.exclude)
								{
									field.reset();
								}
							});
						}

						const event = this.createEvent({
							data: {
								selector: selector,
								value: value,
								items: items,
								postfix: postfix,
								affect: affect,
								exclude: exclude
							}
						});

						fireCustomEvent(window, "BX.Landing.Block:beforeApplyStyleChanges", [event]);
						styleNode.setValue(value, items, postfix, affect, exclude);

						const data = {node: styleNode.getNode(), data: styleNode.getValue()};
						fireCustomEvent("BX.Landing.Block:updateStyleWithoutDebounce", [
							this.createEvent(data)
						]);
						this.onStyleInputWithDebounce(data, false);
					}

					// when field reset
					function onReset(items, postfix, affect) {
						// todo: add cache for backend
						BX.Landing.Backend.getInstance()
							.action("Landing\\Block::getContentFromRepository", {
								code: this.manifest.code
							})
							.then(function(response) {
								var repo = document.createElement('div');
								repo.id = 'fake';
								repo.innerHTML = response;
								repo.style.display = 'none';
								window.document.body.append(repo);

								var targetNode = null;
								var targetSelector = null;
								if (isBlock)
								{
									targetSelector = '#fake > :first-child';
									targetNode = repo.firstElementChild;
								}
								else
								{
									targetSelector = '#fake ' + selector;
									var index = styleNode.getElementIndex(styleNode.getTargetElement());
									targetNode = repo.querySelectorAll(targetSelector)[index];
								}
								var fakeStyleNode = new BX.Landing.UI.Style({
									iframe: window,
									selector: targetSelector,
									relativeSelector: targetSelector,
									node: targetNode
								});
								initFieldByStyleNode(fakeStyleNode);

								// match new class list
								var resetStyleValue = fakeStyleNode.getValue();
								var resetClasses = [];
								var currStyleValue = styleNode.getValue();
								items.forEach(function(item) {
									if(resetStyleValue.classList.indexOf(item.value) !== -1)
									{
										resetClasses.push(item.value);
									}
									var currIndex = currStyleValue.classList.indexOf(item.value);
									if(currIndex !== -1)
									{
										delete currStyleValue.classList[currIndex];
									}
								});
								resetStyleValue.classList = currStyleValue.classList.concat(resetClasses);
								resetStyleValue.className = resetStyleValue.classList;
								onChange.bind(this)(resetStyleValue, items, postfix, affect);
								repo.remove();
							}.bind(this))
							.catch(function(error){
								// todo: show err panel
								console.error("Error on reset", error);
							});
					}

					// when field init
					function initFieldByStyleNode(styleNode)
					{
						styleNode.setInlineProperty(field.getInlineProperties());
						styleNode.setComputedProperty(field.getComputedProperties());
						styleNode.setPseudoElement(field.getPseudoElement());

						var preventEvent = true;
						var styleValue = styleNode.getValue(true);
						if (field.getInlineProperties().length > 0 || field.getComputedProperties().length > 0)
						{
							field.setValue(styleValue.style, preventEvent);
						}
						else
						{
							styleValue.classList.forEach(className => {
								if (typeSettings.items.some(item => item.value === className))
								{
									// buttons group set value via onFrameLoad
									if (!!field.buttons && field.multiple === true)
									{
										return;
									}
									field.setValue(className, preventEvent);
								}
							});
						}
					}
					initFieldByStyleNode(styleNode);

					form.addField(field);
				}, this);

				this.forms.add(form);
			}

			form.fields.forEach(function(field) {
				if (field.popup)
				{
					field.popup.close();
				}
			});

			return form;
		},


		initStyles: function()
		{
			if (this.access < ACCESS_V)
			{
				return;
			}

			this.styles.clear();
			var node = new BX.Landing.UI.Style({
				id: this.selector,
				iframe: window,
				selector: this.selector,
				relativeSelector: this.selector,
				onClick: this.onStyleClick.bind(this, this.selector)
			});

			this.styles.add(node);

			if (isPlainObject(this.manifest.style) &&
				isPlainObject(this.manifest.style.nodes))
			{
				Object.keys(this.manifest.style.nodes).forEach(function(selector) {
					var node = new BX.Landing.UI.Style({
						id: selector,
						iframe: window,
						selector: selector,
						relativeSelector: this.makeRelativeSelector(selector),
						onClick: this.onStyleClick.bind(this, selector)
					});

					this.styles.add(node);
				}, this);
			}
		},

		onStyleClick: function(selector)
		{
			this.showStylePanel(selector);
			var form = this.forms.get(selector);

			if (form)
			{
				BX.Landing.PageObject.getInstance().design().then(function(panel) {
					BX.Landing.UI.Panel.Content.scrollTo(panel.content, null);
				});
			}
		},


		/**
		 * Makes selector relative this block
		 * @param {string} selector
		 * @return {string}
		 */
		makeRelativeSelector: function(selector)
		{
			return join(this.selector, " ", selector);
		},


		/**
		 * Makes absolute selector
		 * @param {string} selector
		 * @return {string}
		 */
		makeAbsoluteSelector: function(selector)
		{
			selector = selector || this.selector;
			selector = trim(selector);
			var find = selector === this.selector ? " > :first-child" : this.selector;
			return trim(selector.replace(find, "").replace("!", ""));
		},


		/**
		 * Saves block style changes
		 * @param {boolean} [preventHistory = false] - Add this action to history or not. By default - add
		 */
		saveStyles: function(preventHistory)
		{
			const styles = this.styles.fetchChanges();

			if (styles.length)
			{
				styles.forEach(function(style) {
					if (style.selector === this.selector)
					{
						style.selector = style.selector.replace(" > :first-child", "");
					}

					if (!style.isSelectGroup() && style.selector !== this.makeAbsoluteSelector(this.selector))
					{
						style.selector = join(style.selector.split("@")[0], "@", style.getElementIndex(style.getNode()[0]));
					}

					if (style.isSelectGroup())
					{
						style.selector = style.selector.split("@")[0];
					}
				}, this);

				if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
				{
					const post = styles.fetchValues();
					BX.Landing.Backend.getInstance()
						.action(
							"Landing\\Block::updateStyles",
							{block: this.id, data: post, lid: this.lid, siteId: this.siteId, preventHistory: 0},
							{code: this.manifest.code},
						)
						.then(() => {
							BX.Landing.History.getInstance().push();
						});
				}
			}
		},


		/**
		 * Shows style editor panel
		 */
		showStylePanel: function(selector)
		{
			var FormSettingsPanel = BX.Reflection.getClass('BX.Landing.UI.Panel.FormSettingsPanel');
			var formMode = (
				FormSettingsPanel
				&& FormSettingsPanel.getInstance().isShown()
				|| BX.Landing.Main.getInstance().isControlsExternal()
			);
			var isBlock = this.isBlockSelector(selector);
			var options = this.getStyleOptions(selector);
			this.isMultiselection = this.content.querySelectorAll(selector).length > 1;

			BX.Landing.PageObject.getInstance().design()
				.then(function(stylePanel) {
					stylePanel.clearContent();

					if (options.type === 'crm-form')
					{
						var rootWindow = BX.Landing.PageObject.getRootWindow();

						return Promise
							.all([
								rootWindow.BX.Runtime.loadExtension('landing.formstyleadapter'),
								BX.Runtime.loadExtension('landing.formstyleadapter')
							])
							.then(function(result) {
								var FormStyleAdapter = result[1].FormStyleAdapter;
								var formStyleAdapter = new FormStyleAdapter({
									formId: this.getBlockFormId().id,
									instanceId: this.getBlockFormId().instanceId,
									currentBlock: this,
								});

								return Promise.all([
									stylePanel.show(formMode),
									formStyleAdapter.load()
								]);
							}.bind(this))
							.catch(function(error) {
								console.log(error);
							});
					}

					return stylePanel
						.show(formMode)
						.then(function(result) {
							return [result];
						});
				}.bind(this))
				.then(function(result) {
					var stylePanel = result[0];
					var formStyleAdapter = result[1];

					stylePanel.prepareFooter(this.isMultiselection);

					if (formStyleAdapter)
					{
						stylePanel.appendForm(formStyleAdapter.getStyleForm());
						return;
					}

					if (isArray(options.type) || isString(options.type))
					{
						if (options.type.length)
						{
							stylePanel.appendForm(
								this.createStyleForm(selector, options, isBlock)
							);
						}
					}

					if (isPlainObject(options.additional))
					{
						selector = options.selector ? options.selector : selector;
						stylePanel.appendForm(
							this.createAdditionalForm({
								form: StyleForm,
								selector: selector,
								group: options.additional,
								attrsType: options.additional.attrsType,
								onChange: this.onAttributeChange.bind(this)
							})
						);
						return;
					}

					if (isArray(options.additional))
					{
						options.additional.forEach(function(group) {
							stylePanel.appendForm(
								this.createAdditionalForm({
									form: StyleForm,
									selector: selector,
									group: group,
									onChange: this.onAttributeChange.bind(this)
								})
							);
						}, this);
					}
				}.bind(this))
				.catch(function(error) {
					if (BX.Type.isArrayFilled(error))
					{
						var accessDeniedCode = 510;
						var isAccessDenied = error.some(function(error) {
							return String(error.code) === String(accessDeniedCode);
						});

						if (isAccessDenied)
						{
							BX.Dom.append(
								this.getAccessMessage(),
								BX.Landing.UI.Panel.StylePanel.getInstance().content
							);
						}
					}
				}.bind(this));
		},

		getAccessMessage: function()
		{
			if (!this.accessMessage)
			{
				this.accessMessage = BX.create({
					tag: 'div',
					props: {className: 'landing-ui-access-error-message'},
					children: [
						BX.create({
							tag: 'div',
							props: {className: 'landing-ui-access-error-message-text'},
							text: BX.Landing.Loc.getMessage('LANDING_CRM_ACCESS_ERROR_MESSAGE')
						})
					]
				})
			}

			return this.accessMessage;
		},


		/**
		 * Gets style options for selector
		 * @param {!string} selector
		 * @return {object}
		 */
		getStyleOptions: function(selector)
		{
			if (this.isBlockSelector(selector))
			{
				return this.prepareBlockOptions(this.manifest.style.block);
			}

			return this.manifest.style.nodes[selector];
		},


		/**
		 * Creates additional form
		 * @param {object} options
		 * @return {BX.Landing.UI.Form.StyleForm}
		 */
		createAdditionalForm: function(options)
		{
			var form = new options.form({title: options.group.name, type: "attrs"});

			var attrsSet = [];
			if (!BX.Type.isUndefined(options.group.attrs))
			{
				attrsSet = options.group.attrs;
			}
			else
			{
				options.attrsType.forEach((atr) => {
					let attrSetItem = getAttrsTypeSettings(atr);
					if (attrSetItem)
					{
						attrsSet.push(attrSetItem);
					}
				})
			}
			attrsSet.forEach(function(attrOptions) {
				var currentSelector = attrOptions.selector || options.selector;
				var field;

				if (isArray(attrOptions.tabs))
				{
					var card = new TabCard({
						tabs: attrOptions.tabs.map(function(tabOptions) {
							return {
								id: random(),
								name: tabOptions.name,
								active: tabOptions.active,
								fields: tabOptions.attrs.map(function(attrOptions) {
									return this.createAttributeField(
										attrOptions,
										attrOptions.selector || options.selector,
										options.onChange
									);
								}, this)
							};
						}, this)
					});

					form.addCard(card);
					return;
				}

				field = this.createAttributeField(attrOptions, currentSelector, options.onChange);
				form.addField(field);
			}, this);

			BX.Event.EventEmitter.subscribe('BX.Landing.UI.Form.StyleForm:attributeChange', (event) => {
				var eventData = event.data;
				this.prepareAttributeValue(eventData, form);
			});
			return form;
		},

		prepareAttributeValue: function(eventData, form) {
			var dependencySet = eventData.data.dependency;
			if (dependencySet)
			{
				dependencySet.forEach((dependency) => {
					var value = eventData.getValue();
					var index = dependency['conditions'].indexOf(value);
					if (index >= 0)
					{
						form.fields.forEach((field) => {
							if (field.attribute === dependency['attribute'])
							{
								//action 'changeValue'
								if (dependency['action'] === 'changeValue')
								{
									var value = field.getValue();
									var index = dependency['attributeCurrentValues'].indexOf(value);
									if (index >= 0)
									{
										field.setValue(dependency['attributeNewValue'], true);
										this.onAttributeChange(field);
									}
								}
								//action 'hideSetting' need to do
							}
						})
					}
				})
			}
		},

		prepareBlockOptions: function(options)
		{
			options = isPlainObject(options) ? options : {};
			options = clone(options);
			options.name = BX.Landing.Loc.getMessage("BLOCK_STYLE_OPTIONS");

			if (!isPlainObject(options.type) && !isString(options.type) && !isArray(options.type))
			{
				options.type = [
					"display",
					"background",
					"padding-top",
					"padding-bottom",
					"padding-left",
					"padding-right",
					"margin-top"
				];
			}

			return options;
		},


		/**
		 * Creates attribute field
		 * @param {object} options
		 * @param {?string} selector
		 * @param {function} [onAttributeChange]
		 * @return {BX.Landing.UI.Field.BaseField}
		 */
		createAttributeField: function(options, selector, onAttributeChange)
		{
			var fieldFactory = this.createFieldFactory(selector, onAttributeChange);
			var element = this.getElementBySelector(selector);

			if (!element && selector.includes("@"))
			{
				var selectorFragments = selector.split("@");
				var elements = this.getElementsBySelector(selectorFragments[0]);

				if (elements.length && elements[parseInt(selectorFragments[1])])
				{
					element = elements[parseInt(selectorFragments[1])];
				}
			}

			var fieldOptions = clone(options);

			if (fieldOptions.value === null || fieldOptions.value === undefined)
			{
				fieldOptions.value = "";
			}

			if (element)
			{
				var value = data(element, fieldOptions.attribute);

				if (BX.Type.isNil(value))
				{
					value = attr(element, fieldOptions.attribute);
				}

				if (value !== null)
				{
					fieldOptions.value = value;
				}
			}

			return fieldFactory.create(fieldOptions);
		},


		onAttributeChange: function(field)
		{
			BX.Event.EventEmitter.emit('BX.Landing.UI.Form.StyleForm:attributeChange', field);
			clearTimeout(this.attributeChangeTimeout);

			if (!this.requestData)
			{
				this.requestData = {};
			}

			this.appendAttrFieldValue(this.requestData, field);

			Promise.resolve(this.requestData)
				.then(this.applyAttributeChanges.bind(this))
				.then(this.saveChanges.bind(this))
				// Reload only blocks with component
				.then(this.reload.bind(this))
				.then(function() {
					this.requestData = null;
				}.bind(this));
		},


		appendSettingsFieldValue: function(requestData, field)
		{
			requestData["settings"] = requestData["settings"] || {};
			requestData["settings"][field.attribute] = field.getValue();
			return requestData;
		},


		/**
		 * @param {object} requestData
		 * @param {BX.Landing.UI.Field.BaseField} field
		 * @return {object}
		 */
		appendAttrFieldValue: function(requestData, field)
		{
			var selector = this.makeAbsoluteSelector(field.selector);
			var value = field.getValue();

			requestData[selector] = requestData[selector] || {};
			requestData[selector]["attrs"] = requestData[selector]["attrs"] || {};
			if(BX.Type.isArray(field.attribute))
			{
				field.attribute.forEach(function(attr){
					var attrData = attr.replace('data-', '');
					var itemValue = value[attrData];
					if(itemValue !== undefined)
					{
						try {
							itemValue = encodeDataValue(itemValue);
						} catch(e) {
							itemValue = field.getValue()[attrData];
						}
						requestData[selector]["attrs"][attr] = itemValue;
					}
				});
			}
			else
			{
				try {
					value = encodeDataValue(value);
				} catch(e) {
					value = field.getValue();
				}
				requestData[selector]["attrs"][field.attribute] = value;
			}
			return requestData;
		},


		appendMenuValue: function(requestData, menu)
		{
			requestData[menu.code] = menu.serialize();
			return requestData;
		},


		/**
		 * Gets element by selector
		 * @param selector
		 * @return {*}
		 */
		getElementBySelector: function(selector)
		{
			if (this.isBlockSelector(selector))
			{
				return this.content;
			}

			var element;

			try
			{
				element = this.node.querySelector(selector);
			}
			catch (err)
			{
				element = null;
			}

			return element;
		},

		getElementsBySelector: function(selector)
		{
			if (this.isBlockSelector(selector))
			{
				return [this.content];
			}

			var elements;

			try
			{
				elements = slice(this.node.querySelectorAll(selector));
			}
			catch (err)
			{
				elements = [];
			}

			return elements;
		},


		/**
		 * Checks that this selector is block selector
		 * @param {string} selector
		 * @return {boolean}
		 */
		isBlockSelector: function(selector)
		{
			return !selector || selector === this.selector || ("#block"+this.id) === selector;
		},


		/**
		 * Creates FieldFactory instance
		 * @param {?string} selector
		 * @param {function} [onChange]
		 * @return {BX.Landing.UI.Factory.FieldFactory}
		 */
		createFieldFactory: function(selector, onChange)
		{
			return new BX.Landing.UI.Factory.FieldFactory({
				selector: !this.isBlockSelector(selector) ? this.makeRelativeSelector(selector) : selector,
				uploadParams: {
					action: "Block::uploadFile",
					block: this.id,
					lid: BX.Landing.Main.getInstance().id,
					id: BX.Landing.Main.getInstance().options.site_id
				},
				linkOptions: {
					siteId: BX.Landing.Main.getInstance().options.site_id,
					landingId: BX.Landing.Main.getInstance().id,
					filter: {
						"=TYPE": BX.Landing.Main.getInstance().options.params.type
					}
				},
				onValueChange: onChange || (function() {})
			});
		},


		/**
		 * Delete current block.
		 * @param {?boolean} [preventHistory = false]
		 * @return {void}
		 */
		deleteBlock: function(preventHistory)
		{
			var button = this.panels.get("block_action").buttons.get("remove");
			button.loader = button.loader || new BX.Loader({target: button.layout, size: 28});
			button.loader.show();
			addClass(button.text, "landing-ui-hide-icon");

			void style(button.loader.layout.querySelector(".main-ui-loader-svg-circle"), {
				"stroke-width": "4px"
			});
			void style(button.loader.layout.querySelector(".main-ui-loader-svg"), {
				"margin-top": "-10px"
			});

			BX.Landing.UI.Panel.EditorPanel.getInstance().hide();

			if (this.blockActionsMenu)
			{
				BX.Main.MenuManager.destroy(this.blockActionsMenu.id);
			}

			if (this.sidebarActionsMenu)
			{
				BX.Main.MenuManager.destroy(this.sidebarActionsMenu.id);
			}

			if (String(window.localStorage.getItem("landingBlockId")) === String(this.id))
			{
				window.localStorage.removeItem("landingBlockId");
			}

			let removePromise = Promise.resolve();
			if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
			{
				removePromise = BX.Landing.Backend.getInstance()
					.action(
						"Landing::markDeletedBlock",
						{block: this.id, lid: this.lid, siteId: this.siteId, preventHistory: 0},
						{code: this.manifest.code}
					)
					.then(result => {
						// Change history steps
						BX.Landing.History.getInstance().push();

						return result;
					});
			}
			removePromise
				.then(() => {
					button.loader.hide();
					removeClass(button.text, "landing-ui-hide-icon");

					var event = this.createEvent();
					fireCustomEvent("BX.Landing.Block:remove", [event]);

					slice(this.node.querySelectorAll(".landing-ui-panel")).forEach(remove);

					BX.Landing.PageObject.getBlocks().remove(this);
					remove(this.node);
					fireCustomEvent("Landing.Block:onAfterDelete", [this]);
					fireCustomEvent("BX.Landing.Block:afterRemove", [event]);
				}, () => {
					button.loader.hide();
					removeClass(button.text, "landing-ui-hide-icon");
				});
		},

		getFormEditorAddBlockTour: function()
		{
			var rootWindow = BX.Landing.PageObject.getRootWindow();
			return new rootWindow.BX.UI.Tour.Guide({
				steps: [
					{
						target: '[data-id="save_settings"]',
						title: BX.Landing.Loc.getMessage('LANDING_FORM_EDITOR_ADD_BLOCK_TOUR_STEP_1_TITLE'),
						text: BX.Landing.Loc.getMessage('LANDING_FORM_EDITOR_ADD_BLOCK_TOUR_STEP_1_TEXT'),
					},
				],
			});
		},

		/**
		 * Shows blocks list panel
		 */
		addBlockAfterThis: function()
		{
			var formSettingsPanel =
				(BX.Landing.UI && BX.Landing.UI.Panel && BX.Landing.UI.Panel.FormSettingsPanel)
					? BX.Landing.UI.Panel.FormSettingsPanel.getInstance()
					: null;
			if (
				this.isCrmFormPage()
				&& formSettingsPanel
				&& formSettingsPanel.isShown()
			)
			{
				if (!formSettingsPanel.isChanged())
				{
					formSettingsPanel
						.hide()
						.then(function() {
							BX.Landing.Main.getInstance().showBlocksPanel(this, null, null, true);
						}.bind(this));
				}
				else
				{
					this.getFormEditorAddBlockTour().start();
				}
			}
			else
			{
				BX.Landing.Main.getInstance().showBlocksPanel(this);
			}
		},

		addBlockBeforeThis: function()
		{
			var formSettingsPanel = BX.Landing.UI.Panel.FormSettingsPanel.getInstance();
			if (
				this.isCrmFormPage()
				&& formSettingsPanel.isShown()
			)
			{
				if (!formSettingsPanel.isChanged())
				{
					formSettingsPanel
						.hide()
						.then(function() {
							BX.Landing.Main.getInstance().showBlocksPanel(this, null, null, true);
						}.bind(this));
				}
				else
				{
					this.getFormEditorAddBlockTour().start();
				}
			}
			else
			{
				BX.Landing.Main.getInstance().showBlocksPanel(this, null, null, true);
			}
		},

		getFormEditorDesignTour: function()
		{
			var rootWindow = BX.Landing.PageObject.getRootWindow();
			return new rootWindow.BX.UI.Tour.Guide({
				steps: [
					{
						target: '[data-id="save_settings"]',
						title: BX.Landing.Loc.getMessage('LANDING_FORM_EDITOR_FORM_DESIGN_TOUR_STEP_1_TITLE'),
						text: BX.Landing.Loc.getMessage('LANDING_FORM_EDITOR_FORM_DESIGN_TOUR_STEP_1_TEXT'),
					},
				],
			});
		},

		onFormDesignClick: function()
		{
			var formSelector = Object.entries(this.manifest.style.nodes).reduce(function(acc, item) {
				if (item[1].type === 'crm-form')
				{
					return item[0];
				}

				return acc;
			}, null);

			if (formSelector)
			{
				this.showStylePanel(formSelector);
			}
			else
			{
				this.showStylePanel(this.selector);
			}
		},


		/**
		 * Handles node content change event
		 * @param {BX.Landing.Block.Node} node
		 * @param {?boolean} [preventHistory = false]
		 */
		onNodeChange: function(node, preventHistory)
		{
			const event = this.createEvent({node: node.node});
			fireCustomEvent("BX.Landing.Block:Node:update", [event]);

			if (!node.isSavePrevented())
			{
				clearTimeout(this.changeTimeout);
				this.changedNodes.add(node);

				this.changeTimeout = setTimeout(() => {
					if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
					{
						BX.Landing.Backend.getInstance()
							.action(
								"Landing\\Block::updateNodes",
								{
									block: this.id,
									data: this.changedNodes.fetchValues(),
									additional: this.changedNodes.fetchAdditionalValues(),
									lid: this.lid,
									siteId: this.siteId,
									preventHistory: 0,
								},
								{code: this.manifest.code}
							);
					}
					this.changedNodes.clear();
				}, 300);
			}
		},


		/**
		 * Checks that data contains pseudo selector
		 * @param {object} data
		 * @return {boolean}
		 */
		containsPseudoSelector: function(data)
		{
			return Object.keys(data).some(function(selector) {
				var result;

				if (selector === "cards")
				{
					return false;
				}

				if (selector === "dynamicState")
				{
					return false;
				}

				if (
					BX.type.isPlainObject(this.manifest.menu)
					&& selector in this.manifest.menu
				)
				{
					return false;
				}

				try
				{
					if (selector !== "#block" + this.id && selector !== "")
					{
						result = !this.node.querySelector(selector);
					}
					else
					{
						result = false;
					}
				}
				catch(err)
				{
					result = !isNodeSelector(selector);
				}

				return result;
			}, this);
		},

		/**
		 * Check if data contains attributes, that require block reload
		 * @param {object} data
		 * @return {boolean}
		 */
		containsReloadRequireAttributes: function(data)
		{
			if (
				isPlainObject(data)
				&& isPlainObject(this.manifest)
				&& isPlainObject(this.manifest.attrs)
			)
			{
				return Object.keys(this.manifest.attrs).some(function (selector)
				{
					return this.manifest.attrs[selector].some(function (attr)
					{
						if (
							attr.requireReload
							&& isPlainObject(data[selector])
							&& isPlainObject(data[selector].attrs)
							&& data[selector].attrs[attr.attribute]
						)
						{
							return true;
						}
						return false;
					}, this);
				}, this);
			}

			return false;
		},

		/**
		 * Applies content changes
		 * @param {object} data
		 * @return {Promise<Object>}
		 */
		applyContentChanges: function(data)
		{
			if (!isPlainObject(data))
			{
				return Promise.reject(
					new TypeError("BX.Landing.Block.applyContentChanges: data isn't object")
				);
			}

			var eventData = clone(data);

			Object.keys(eventData).forEach(function(selector) {
				if (!isNodeSelector(selector))
				{
					delete eventData[selector];
				}
			});

			if (!isEmpty(eventData))
			{
				var event = this.createEvent({data: eventData});
				fireCustomEvent(window, "BX.Landing.Block:beforeApplyContentChanges", [event]);
			}

			var valuePromises = [];

			Object.keys(data).forEach(function(selector) {
				if (isNodeSelector(selector))
				{
					var node = this.nodes.getBySelector(selector);

					if (node)
					{
						var valuePromise = node.setValue(data[selector], true, true);
						node.preventSave(false);
						if (valuePromise)
						{
							valuePromises.push(valuePromise);
							valuePromise.then(function() {
								data[selector] = node.getValue();
							});
						}
						else
						{
							data[selector] = node.getValue();
						}
					}
				}
			}, this);

			return Promise
				.all(valuePromises)
				.then(function() {
					return data;
				});
		},

		applyMenuChanges: function(data)
		{
			if (!isPlainObject(data))
			{
				return Promise.reject(
					new TypeError("BX.Landing.Block.applyContentChanges: data isn't object")
				);
			}

			var menuKeys = Object.keys(this.manifest.menu || {});
			if (menuKeys.length > 0)
			{
				menuKeys.forEach(function(code) {
					if (code in data)
					{
						var menu = this.menu.find(function(menuItem) {
							return menuItem.code === code;
						});

						menu.rebuild(data[code]);
					}
				}.bind(this));

				data.forceReload = true;
			}

			this.initMenu();

			return Promise.resolve(data);
		},

		/**
		 * @private
		 * @param data
		 * @return {Promise}
		 */
		applyCardsChanges: function(data)
		{
			if (!isPlainObject(data))
			{
				return Promise.reject(
					new TypeError("BX.Landing.Block.applyCardsChanges: data isn't object")
				);
			}

			var nodePromises = [];

			if ('cards' in data && isPlainObject(data.cards))
			{
				fireCustomEvent("BX.Landing.Block:Cards:beforeUpdate", [
					this.createEvent()
				]);

				var map = {};

				Object.keys(data.cards)
					.forEach(function(code) {
						var container = this.node.querySelector(code).parentElement;
						var oldCards = this.node.querySelectorAll(code);

						// Card data
						var values = data.cards[code].values;
						var presets = data.cards[code].presets;
						var indexes = data.cards[code].indexes;
						var source = data.cards[code].source;

						// Remove old cards
						container.innerHTML = "";

						// Make source
						Object.keys(values)
							.forEach(function(index) {
								source[index] = {value: 0, type: "card"};

								if (!isEmpty(presets) && !isEmpty(presets[index]))
								{
									if (
										!oldCards[indexes[index]]
										|| !BX.type.isString(indexes[index])
									)
									{
										source[index].type = "preset";
										source[index].value = presets[index];
										return;
									}
								}

								if (oldCards[indexes[index]])
								{
									source[index].type = "card";
									source[index].value = indexes[index];
								}
							}, this);

						// Make new cards
						Object.keys(values)
							.forEach(function(index) {
								if (source[index].type === "preset")
								{
									var preset = this.manifest.cards[code]["presets"][source[index].value]["html"];
									append(htmlToElement(preset), container);
									return;
								}

								append(clone(oldCards[source[index].value]), container);
							}, this);

						// Reinitialize entities
						this.initNodes();
						this.initCards();
						this.initGroups();

						// Apply nodes values
						Object.keys(values)
							.forEach(function(index) {
								var card = values[index];

								Object.keys(card)
									.forEach(function(key) {
										map[key] = key in map ? map[key] + 1 : 0;

										var node = this.nodes.getBySelector(join(key, "@", map[key]));

										if (node)
										{
											var newValue = card[key];
											var oldValue = node.getValue();

											if (isPlainObject(newValue) && isString(newValue.url))
											{
												newValue.url = decodeDataValue(newValue.url);
											}

											if (isPlainObject(oldValue) && isString(oldValue.url))
											{
												oldValue.url = decodeDataValue(oldValue.url);
											}

											try
											{
												newValue = JSON.stringify(newValue);
											} catch (e)
											{
												newValue = card[key];
											}

											try
											{
												oldValue = JSON.stringify(oldValue);
											} catch (e)
											{
												oldValue = node.getValue();
											}

											var nodePromise = node.setValue(card[key], true, true) || Promise.resolve();
											node.preventSave(false);
												nodePromise.then(function(selectorKey, mapKey, cardKey) {
													card[join(selectorKey, "@", mapKey)] = node.getValue();

													if (node.manifest.type === "img" || node.manifest.type === "icon")
													{
														card[join(selectorKey, "@", mapKey)]["url"] = encodeDataValue(cardKey["url"]);
													}

													delete card[key];
												}.bind(this, key, map[key], card[key]));

											nodePromises.push(nodePromise);
										}
									}, this);
							}, this);

						Promise
							.all(nodePromises)
							.then(function() {
								// Reinitialize additional entities
								this.initCardsLabels();
								this.initStyles();

								// Remove unnecessary
								delete data.cards[code].presets;
								delete data.cards[code].indexes;
							}.bind(this));
					}, this);

				Promise
					.all(nodePromises)
					.then(function() {
						fireCustomEvent("BX.Landing.Block:Cards:update", [
							this.createEvent()
						]);
					}.bind(this));
			}

			return Promise
				.all(nodePromises)
				.then(function() {
					return Promise.resolve(data);
				});
		},


		applySettingsChanges: function(requestData)
		{
			if (!isPlainObject(requestData))
			{
				return Promise.reject(
					new TypeError("BX.Landing.Block.applyAttributeChanges: requestData isn't object")
				);
			}

			if (isPlainObject(requestData.settings) &&
				!isEmpty(requestData.settings))
			{
				if (requestData.settings.id)
				{
					this.content.id = requestData.settings.id;
				}
			}

			return Promise.resolve(requestData);
		},


		/**
		 * Applies attributes changes
		 * @param {Object} requestData
		 */
		applyAttributeChanges: function(requestData)
		{
			if (!isPlainObject(requestData))
			{
				return Promise.reject(
					new TypeError("BX.Landing.Block.applyAttributeChanges: requestData isn't object")
				);
			}

			var eventData = clone(requestData);

			Object.keys(requestData).forEach(function(selector) {
				if (!(isPlainObject(requestData[selector]) && "attrs" in requestData[selector]))
				{
					delete eventData[selector];
				}
			});

			if (!isEmpty(eventData))
			{
				var event = this.createEvent({data: eventData});
				fireCustomEvent(window, "BX.Landing.Block:beforeApplyAttributesChanges", [event]);
			}

			var self = this;

			Object.keys(requestData).forEach(function(selector) {
				if (isPlainObject(requestData[selector]) && "attrs" in requestData[selector])
				{
					var elements = self.getElementsBySelector(selector);

					if (!elements.length && selector.includes("@"))
					{
						var selectorFragments = selector.split("@");

						elements = self.getElementsBySelector(selectorFragments[0]);

						if (elements[parseInt(selectorFragments[1])])
						{
							elements = [elements[parseInt(selectorFragments[1])]];
						}
					}

					Object.keys(requestData[selector].attrs).forEach(function(attribute) {
						elements.forEach(function(element) {
							var decodedValue = decodeDataValue(requestData[selector]["attrs"][attribute]);

							if (!attribute.includes("data-"))
							{
								attr(element, attribute, decodedValue);
							}
							else
							{
								data(element, attribute, decodedValue);
							}

							fireCustomEvent("BX.Landing.Block:Node:updateAttr", [
								self.createEvent({
									node: element,
									data: requestData[selector]["attrs"]
								})
							]);
						});
					});
				}
			});

			return Promise.resolve(requestData);
		},



		/**
		 * Saves changes on backend
		 * @param {Object} data
		 * @return {Promise<Object>}
		 */
		saveChanges: function(data, preventHistory)
		{
			if (!isPlainObject(data))
			{
				return Promise.reject(
					new TypeError("BX.Landing.Block.saveChanges: data isn't object")
				);
			}

			if (Object.keys(data).length)
			{
				var updateNodeParams = {code: this.manifest.code};
				var updateNodesData = {block: this.id, data: data, lid: this.lid, siteId: this.siteId};
				var batch = {};

				if (isPlainObject(data.settings) &&
					!isEmpty(data.settings))
				{
					if (data.settings.id)
					{
						batch.changeAnchor = {
							action: "Block::changeAnchor",
							data: {
								block: this.id,
								lid: this.lid,
								data: data.settings.id
							}
						};
					}

					delete data.settings;
				}

				if (!isEmpty(data))
				{
					var nodes = new NodeCollection();

					Object.keys(updateNodesData).forEach(function(selector) {
						nodes.add(this.nodes.getBySelector(selector));
					}, this);

					batch.updateNodes = {
						action: "Block::updateNodes",
						data: updateNodesData,
						additional: nodes.fetchAdditionalValues()
					};
				}

				if (!isEmpty(data.cards))
				{
					var cardsData = clone(data.cards);

					delete data.cards;

					var cardsSelectors = BX.Landing.Utils.arrayUnique(Object.keys(cardsData));
					cardsSelectors = cardsSelectors.length === 1 ? cardsSelectors + " *" : cardsSelectors.join(" *, ");
					var cardsNodesAdditionalValues = this.nodes.matches(cardsSelectors).fetchAdditionalValues();

					batch.updateCards = {
						action: "Block::updateCards",
						data: {
							block: this.id,
							lid: this.lid,
							siteId: this.siteId,
							data: cardsData,
							additional: cardsNodesAdditionalValues
						}
					};
				}

				if (data.cardsFirst)
				{
					var oldBatch = batch;
					batch = {};

					if (oldBatch.changeAnchor)
					{
						batch.changeAnchor = oldBatch.changeAnchor;
					}

					if (oldBatch.updateCards)
					{
						batch.updateCards = oldBatch.updateCards;
					}

					if (oldBatch.updateNodes)
					{
						batch.updateNodes = oldBatch.updateNodes;
					}

					delete data.cardsFirst;
				}

				if ((isBoolean(preventHistory) && !preventHistory) || !isBoolean(preventHistory))
				{
					return BX.Landing.Backend.getInstance()
						.batch("Landing\\Block::updateNodes", batch, updateNodeParams)
						.then(function() {
							return Promise.resolve(data);
						});
				}
			}

			return Promise.resolve(data);
		},


		/**
		 * Fetches request data from content panel
		 * @param {BX.Landing.UI.Panel.BasePanel} panel
		 * @param {boolean} all
		 * @return {Promise<Object>}
		 */
		fetchRequestData: function(panel, all)
		{
			var requestData = {};
			var forms = {};

			var fetchFields = function(collection, all) {
				return all ? collection : collection.fetchChanges();
			};

			forms.attrs = new FormCollection();
			forms.cards = new FormCollection();
			forms.dynamicCards = new FormCollection();
			forms.dynamicBlock = new FormCollection();
			forms.content = new FormCollection();
			forms.settings = new FormCollection();
			forms.menu = new FormCollection();

			panel.forms
				.forEach(function(form) {
					forms[form.type].push(form);
				});

			fetchFields(forms.content.fetchFields(), all)
				.reduce(proxy(this.appendContentFieldValue, this), requestData);

			var attrFields = new BaseCollection();

			forms.cards.forEach(function(form) {
				form.childForms.forEach(function(childForm) {
					childForm.fields.forEach(function(field) {
						if (field.type === "attr")
						{
							attrFields.add(field);
						}
					});
				});
			});

			fetchFields(attrFields, true)
				.reduce(proxy(this.appendAttrFieldValue, this), requestData);

			forms.cards
				.reduce(proxy(this.appendCardsFormValue, this), requestData);

			forms.dynamicCards
				.reduce(proxy(this.appendDynamicCardsFormValue, this), requestData);

			forms.dynamicBlock
				.reduce(proxy(this.appendDynamicBlockFormValue, this), requestData);

			fetchFields(forms.attrs.fetchFields(), all)
				.reduce(proxy(this.appendAttrFieldValue, this), requestData);

			fetchFields(forms.settings.fetchFields(), all)
				.reduce(proxy(this.appendSettingsFieldValue, this), requestData);

			forms.menu
				.reduce(proxy(this.appendMenuValue, this), requestData);

			requestData.dynamicState = Object.keys(this.manifest.cards)
				.reduce(function(acc, cardsCode) {
					acc[cardsCode] = (
						BX.type.isPlainObject(requestData.dynamicParams)
						&& cardsCode in requestData.dynamicParams
					);
					return acc;
				}, {});

			requestData.dynamicState.wrapper = (
				!!requestData.dynamicParams
				&& "wrapper" in requestData.dynamicParams
			);

			return Promise.resolve(requestData);
		},


		/**
		 * Appends content field value to request data
		 * @param {object} requestData
		 * @param {BX.Landing.UI.Field.BaseField} field
		 * @return {object}
		 */
		appendContentFieldValue: function(requestData, field)
		{
			return requestData[field.selector] = field.getValue(), requestData;
		},


		/**
		 * Appends cards value to request data
		 * @param {object} requestData
		 * @param {BX.Landing.UI.Form.CardsForm} form
		 * @return {object}
		 */
		appendCardsFormValue: function(requestData, form)
		{
			requestData.cards = requestData.cards || {};
			requestData.cards[form.code] = {};
			requestData.cards[form.code]['values'] = form.serialize();
			requestData.cards[form.code]['presets'] = form.getUsedPresets();
			requestData.cards[form.code]['indexes'] = form.getIndexesMap();
			requestData.cards[form.code]['source'] = {};

			return requestData;
		},

		appendDynamicCardsFormValue: function(requestData, form)
		{
			requestData.dynamicParams = requestData.dynamicParams || {};
			requestData.dynamicParams[form.code] = {};
			requestData.dynamicParams[form.code] = form.serialize();

			return requestData;
		},

		appendDynamicBlockFormValue: function(requestData, form)
		{
			requestData.dynamicParams = requestData.dynamicParams || {};
			requestData.dynamicParams.wrapper = form.serialize();

			return requestData;
		},


		/**
		 * Reloads block
		 * @todo Refactoring
		 * @param {object} data
		 * @return {Promise}
		 */
		reload: function(data)
		{
			if (isPlainObject(data))
			{
				var isNeedReload = this.containsPseudoSelector(data) || this.containsReloadRequireAttributes(data);
				if (!isNeedReload)
				{
					return Promise.resolve(data);
				}
			}

			var loader = new BX.Loader({target: this.parent.parentElement, color: "rgba(255, 255, 255, .8)"});
			loader.layout.style.position = "fixed";
			loader.layout.style.zIndex = "999";
			loader.show();
			BX.Landing.Main.getInstance().showOverlay();

			var self = this;
			return BX.Landing.Backend.getInstance()
				.action("Block::getContent", {
					block: this.id,
					lid: this.lid,
					siteId: this.siteId,
					editMode: 1
				})
				.then(function(response) {
					var event = this.createEvent();
					fireCustomEvent("BX.Landing.Block:remove", [event]);

					BX.Landing.Main.getInstance().currentBlock = self;
					BX.Landing.Main.getInstance().currentArea = self.parent;
					return BX.Landing.Main.getInstance().addBlock(response, true);
				}.bind(this))
				.then(function(block) {
					self.node = block;
					return Promise.resolve(data);
				})
				.then(function(data) {
					return new Promise(function(resolve) {
						setTimeout(function() {
							resolve(data);
							loader.hide();
							BX.Landing.Main.getInstance().hideOverlay();
						}, 800);
					});
				});
		},

		/**
		 * Handles content save event
		 */
		onContentSave: function()
		{
			var contentPanel = this.panels.get("content_edit");

			if (contentPanel)
			{
				contentPanel.hide();

				this.fetchRequestData(contentPanel)
					.then(function(requestData) {
						fireCustomEvent("BX.Landing.Block:onContentSave", [this.id]);
						return Object.assign(
							{},
							requestData,
							{
								cardsFirst: true
							}
						);
					}.bind(this))
					.then(this.updateBlockState.bind(this));
			}
		},

		/**
		 * Handles content cancel edit event
		 */
		onContentCancel: function()
		{
			this.panels.get("content_edit").hide();
			this.tmpContent.innerHTML = "";
			this.anchor = this.savedAnchor;
		},


		/**
		 * Gets cards CSS selector
		 * @return {string}
		 */
		getCardsSelector: function()
		{
			var cardsSelectors = Object.keys(this.manifest.cards);
			var allCards = join(cardsSelectors.join(","), ", ");
			var allCardsChild = join(cardsSelectors.join(" *,"), " *");

			return join(allCards, allCardsChild);
		},

		/**
		 * Style change handler
		 * @param event
		 * @param {boolean} [preventHistory = false] - Add this action to history or not. By default - add
		 */
		onStyleInput: function(event, preventHistory)
		{
			this.saveStyles(preventHistory);

			const styleEvent = this.createEvent(event);
			fireCustomEvent("BX.Landing.Block:updateStyle", [styleEvent]);
		},

		/**
		 * @private
		 * @param {object} options
		 * @return {BX.Landing.UI.Form.BaseForm}
		 */
		getBlockEditForm: function(options)
		{
			var preparedOptions = {};

			if (BX.type.isPlainObject(options))
			{
				preparedOptions = Object.assign({}, options);
			}

			var blockNodes = preparedOptions.nodes || this.nodes;

			// exclude nodes from cards
			if (this.cards.length > 0 && !options.hideCheckbox)
			{
				blockNodes = this.nodes.notMatches(
					this.getCardsSelector()
				);
			}

			var selectors = Object.keys(this.manifest.nodes);

			blockNodes = selectors
				.reduce(function(acc, selector) {
					if (!selector.includes(':'))
					{
						blockNodes
							.matches(selector)
							.getVisible()
							.filter(function(node) {
								return node.manifest.allowFormEdit !== false;
							})
							.forEach(function(node) {
								acc.push(node);
							});
					}

					return acc;
				}, new NodeCollection());

			var onBlockFormTypeChangeHandler = this.onBlockFormTypeChange.bind(this);

			var dynamicState = !!(
				!options.skipBlockState
				&& BX.type.isPlainObject(this.dynamicParams)
				&& this.dynamicParams.wrapper
			);

			var help = "";
			var helps = BX.Landing.Main.getInstance().options.helps;

			if (BX.type.isPlainObject(helps))
			{
				help = helps.DYNAMIC_BLOCKS;
			}

			var headerCheckbox = {
				text: BX.Landing.Loc.getMessage("LANDING_BLOCK__MAKE_A_DYNAMIC"),
				onChange: onBlockFormTypeChangeHandler,
				state: dynamicState,
				help: help
			};

			var blockForm = new BaseForm({
				title: options.formName || BX.Landing.Loc.getMessage("BLOCK_ELEMENTS"),
				description: this.manifest.block.formDescription,
				type: "content",
				code: this.id,
				headerCheckbox: (function() {
					if (!options.hideCheckbox && this.manifest.block.dynamic !== false)
					{
						return headerCheckbox;
					}

					return undefined;
				}.bind(this))()
			});

			if (dynamicState)
			{
				setTimeout(function() {
					onBlockFormTypeChangeHandler({
						form: blockForm,
						state: true
					});
				});
			}

			blockNodes.forEach(function(node) {
				blockForm.addField(node.getField());
			});

			return blockForm;
		},

		getMenuEditForms: function()
		{
			return this.menu.map(function(menu) {
				return menu.getForm();
			}, this);
		},

		/**
		 * @private
		 * @return {BX.Landing.UI.Form.BaseForm}
		 */
		getAttrsEditForm: function()
		{
			var keys = Object.keys(this.manifest.attrs);
			var fields = [];

			keys.forEach(function(selector) {
				var attr = this.manifest.attrs[selector];

				if (!attr.hidden)
				{
					attr = !isArray(attr) ? [attr] : attr;

					attr.forEach(function(options) {
						if (!options.hidden && isString(options.type))
						{
							fields.push(
								this.createAttributeField(options, options.selector || selector)
							);
						}
					}, this);
				}
			}, this);

			var attrsForm = new BaseForm({
				id: "attr",
				type: "attrs",
				title: BX.Landing.Loc.getMessage("BLOCK_SETTINGS"),
				description: this.manifest.block.attrsFormDescription
			});

			fields.forEach(function(field) {
				attrsForm.addField(field);
			});

			return attrsForm;
		},

		/**
		 * @private
		 * @return {Array}
		 */
		getAttrsAdditionalEditForms: function()
		{
			var keys = Object.keys(this.manifest.attrs);
			var forms = [];

			keys.forEach(function(selector) {
				var attr = this.manifest.attrs[selector];

				if (!attr.hidden)
				{
					attr = !isArray(attr) ? [attr] : attr;

					attr.forEach(function(options) {
						if (!options.hidden && isString(options.type))
						{
							return;
						}

						if (isString(options.name) && options.attrs)
						{
							forms.push(
								this.createAdditionalForm({
									form: BaseForm,
									selector: selector,
									group: options,
									onChange: (function() {})
								})
							);
						}
					}, this);
				}
			}, this);

			return forms;
		},

		/**
		 * @private
		 * @param skipState
		 * @return {Array}
		 */
		getCardsEditForms: function(skipState)
		{
			var cardsSelectors = Object.keys(this.manifest.cards);
			var nodesSelectors = Object.keys(this.manifest.nodes);
			var forms = [];

			var groupedCards = cardsSelectors.reduce(function(acc, selector) {
				var cards = this.cards.filter(function(card) {
					return card.selector.split("@")[0] === selector;
				});

				if (cards.length > 0)
				{
					cards.sort(function(a, b) {
						return a.sortIndex - b.sortIndex;
					});

					acc.set(selector, cards);
				}

				return acc;
			}.bind(this), new Map());

			groupedCards.forEach(function(cards, selector) {
				var checkboxState = (
					BX.type.isPlainObject(this.dynamicParams)
					&& selector in this.dynamicParams
					&& !skipState
				);

				var onCardsFormTypeHandler = this.onCardsFormTypeChange.bind(this);
				var groupLabel = this.manifest.cards[selector]['group_label'];

				var help = "";
				var helps = BX.Landing.Main.getInstance().options.helps;

				if (BX.type.isPlainObject(helps))
				{
					help = helps.DYNAMIC_BLOCKS;
				}

				var headerCheckbox = {
					text: BX.Landing.Loc.getMessage("LANDING_CARDS__MAKE_A_DYNAMIC"),
					onChange: onCardsFormTypeHandler,
					state: checkboxState,
					help: help
				};

				var cardsForm = new CardsForm({
					title: groupLabel || BX.Landing.Loc.getMessage("LANDING_CARDS_FROM_TITLE"),
					code: selector.split("@")[0],
					presets: cards[0].manifest.presets,
					sync: cards[0].manifest.sync,
					description: cards[0].manifest.formDescription,
					forms: forms,
					headerCheckbox: (function() {
						if (this.manifest.block.dynamic !== false)
						{
							return headerCheckbox;
						}

						return undefined;
					}.bind(this))()
				});

				forms.push(cardsForm);

				if (checkboxState)
				{
					setTimeout(function() {
						onCardsFormTypeHandler({
							form: cardsForm,
							state: true
						});
					});
				}

				cards.forEach(function(card) {
					var cardForm = new CardForm({
						label: card.getLabel() || card.getName(),
						labelBindings: card.manifest.label,
						selector: card.selector,
						preset: card.preset
					});

					var sortedCardNodes = new NodeCollection();

					var cardNodes = this.nodes.filter(function(node) {
						return card.node.contains(node.node)
					});

					if (cardNodes.length)
					{
						nodesSelectors.forEach(function(nodeSelector) {
							var matches = cardNodes.matches(nodeSelector);
							matches.forEach(sortedCardNodes.add, sortedCardNodes);
						}, this);

						sortedCardNodes.forEach(function(node) {
							if (node.manifest.allowFormEdit !== false)
							{
								cardForm.addField(node.getField());
							}
						});

						var additional = this.manifest.cards[selector].additional;
						if (isPlainObject(additional))
						{
							if (isArray(additional.attrs))
							{
								additional.attrs.forEach(function(attr) {
									var attrField = this.createAttributeField(attr, card.selector, (function() {}));
									attrField.type = "attr";
									cardForm.addField(attrField);
								}, this);
							}
						}

						if (this.tmpContent.contains(card.node))
						{
							cardsForm.addPresetForm(cardForm);
						}
						else
						{
							cardsForm.addChildForm(cardForm);
						}
					}
				}, this);
			}, this);

			return forms;
		},

		/**
		 * @private
		 * @return {BX.Landing.UI.Form.BaseForm}
		 */
		getBlockSettingsForm: function()
		{
			var blockSettingsForm = new BaseForm({
				title: BX.Landing.Loc.getMessage("BLOCK_SETTINGS"),
				type: "settings"
			});

			var fieldFactory = this.createFieldFactory("!" + this.selector);
			var errorMessage = null;
			var baseUrl = BX.Landing.Main.getInstance().options.url;

			if (baseUrl[0] === "/")
			{
				baseUrl = top.location.origin + baseUrl;
			}

			this.savedAnchor = (this.anchor || this.node.id);

			var previewText = join(baseUrl, "#", (this.anchor || this.node.id));
			var anchorField = fieldFactory.create({
				type: "text",
				name: BX.Landing.Loc.getMessage("BLOCK_SETTINGS_ANCHOR_FIELD"),
				description: "<span class='landing-ui-anchor-preview'>"+BX.Text.encode(previewText)+"</span>",
				attribute: "id",
				value: this.anchor || this.node.id,
				onInput: function() {
					var preview = anchorField.layout.querySelector(".landing-ui-anchor-preview");

					if (preview)
					{
						preview.innerHTML = BX.Text.encode(join(baseUrl, "#", BX.Text.decode(anchorField.getValue())));
					}

					this.anchor = anchorField.getValue();

					if (errorMessage)
					{
						remove(errorMessage);
					}

					if (this.node.id !== anchorField.getValue() &&
						document.getElementById(anchorField.getValue()))
					{
						errorMessage = BX.Landing.UI.Field.BaseField.createDescription(
							BX.Landing.Loc.getMessage("BLOCK_SETTINGS_ANCHOR_FIELD_VALIDATE_ERROR")
						);

						addClass(errorMessage, "landing-ui-error");

						append(errorMessage, anchorField.layout);
					}

					if (!isValidElementId(anchorField.getValue()))
					{
						errorMessage = BX.Landing.UI.Field.BaseField.createDescription(
							BX.Landing.Loc.getMessage("BLOCK_SETTINGS_ANCHOR_FIELD_VALIDATE_INVALID_ID")
						);

						addClass(errorMessage, "landing-ui-error");

						append(errorMessage, anchorField.layout);
					}
				}.bind(this)
			});

			blockSettingsForm.addField(anchorField);

			return blockSettingsForm;
		},

		/**
		 * Gets content edit forms
		 * @param {object} options
		 * @return {BX.Landing.UI.Collection.FormCollection}
		 */
		getEditForms: function(options)
		{
			var preparedOptions = {};

			if (BX.type.isPlainObject(options))
			{
				preparedOptions = Object.assign({}, options);
			}

			if (arguments.length > 1)
			{
				preparedOptions.nodes = arguments[0];
				preparedOptions.formName = arguments[1];
				preparedOptions.nodesOnly = arguments[2];
				preparedOptions.showAll = arguments[3];
				preparedOptions.skipCardsState = arguments[4];
				preparedOptions.skipBlockState = arguments[5];
			}

			var forms = new FormCollection();

			if (this.access >= ACCESS_W)
			{
				var isEditable = !(
					isEmpty(this.manifest.nodes)
					&& isEmpty(this.manifest.attrs)
					&& isEmpty(this.manifest.menu)
				);

				if (isEditable)
				{
					// Block form
					var blockEditForm = this.getBlockEditForm(preparedOptions);
					if (blockEditForm.fields.length > 0)
					{
						forms.add(blockEditForm);
					}

					var menuEditForms = this.getMenuEditForms(preparedOptions);
					if (menuEditForms.length > 0)
					{
						menuEditForms.forEach(function(menuForm) {
							forms.add(menuForm);
						});
					}

					if (!preparedOptions.nodesOnly)
					{
						// Attrs forms
						var attrsEditForm = this.getAttrsEditForm();

						if (attrsEditForm.fields.length > 0)
						{
							forms.add(attrsEditForm);
						}

						// Attrs additional forms
						var attrsAdditionalEditForms = this.getAttrsAdditionalEditForms();
						if (attrsAdditionalEditForms.length > 0)
						{
							attrsAdditionalEditForms.forEach(function(form) {
								forms.add(form);
							});
						}

						// Cards forms
						var cardsEditForms = this.getCardsEditForms(preparedOptions.skipCardsState);
						if (cardsEditForms.length > 0)
						{
							cardsEditForms.forEach(function(form) {
								forms.add(form);
							});
						}
					}
				}

				// Block settings
				var blockSettingsForm = this.getBlockSettingsForm();
				if (blockSettingsForm.fields.length > 0)
				{
					forms.push(blockSettingsForm);
				}
			}

			return forms;
		},

		/**
		 * @return {boolean}
		 */
		isLastBlockInArea: function()
		{
			return this.parent.querySelectorAll(".block-wrapper").length < 2;
		},


		/**
		 * Handles block remove event
		 */
		onBlockRemove: function()
		{
			this.adjustSortButtonsState();
		},


		/**
		 * Adjusts sort buttons state (disable/enable)
		 */
		adjustSortButtonsState: function()
		{
			var actionPanel = this.panels.get("block_action");

			if (actionPanel)
			{
				if (this.isLastBlockInArea())
				{
					actionPanel.buttons.get("up").disable();
					actionPanel.buttons.get("down").disable();
				}
				else
				{
					actionPanel.buttons.get("up").enable();
					actionPanel.buttons.get("down").enable();
				}
			}
		},

		getFieldType: function(field)
		{
			var node = this.nodes.getBySelector(field.selector);

			if (node)
			{
				return node.type;
			}

			return null;
		},

		getTypeReferences: function(references, type)
		{
			return references.filter(function(reference) {
				return reference.type === type;
			});
		},

		convertReferencesToDropdownItems: function(references)
		{
			var items = references.map(function(reference) {
				return {name: reference.name, value: reference.id};
			});

			items.push({
				name: BX.Landing.Loc.getMessage('LANDING_BLOCK__DYNAMIC_REFERENCE_HIDE'),
				html: (
					"<span class=\"landing-ui-field-dropdown-sep\"></span>" + BX.Landing.Loc.getMessage('LANDING_BLOCK__DYNAMIC_REFERENCE_HIDE')
				),
				value: '@hide'
			});

			return items;
		},

		getDefaultDropdownItems: function()
		{
			return [
				{name: BX.Landing.Loc.getMessage("LANDING_CARDS__DYNAMIC_FIELD_NOT_SET"), value: ""}
			];
		},

		getDynamicFiledValue: function(cardsCode, fieldSelector)
		{
			var state = this.dynamicParams || {};

			if (
				BX.type.isPlainObject(state[cardsCode])
				&& BX.type.isPlainObject(state[cardsCode].references)
			)
			{
				return state[cardsCode].references[fieldSelector];
			}
		},

		convertToDynamicFields: function(fields, cardCode, references)
		{
			return fields.map(function(field) {
				var type = this.getFieldType(field);

				if (
					type !== "text"
					&& type !== "img"
					&& type !== "link"
					&& type !== "link_ref"
				)
				{
					return field;
				}

				var typeReferences = this.getTypeReferences(references, type);
				var dropDownItems = this.convertReferencesToDropdownItems(typeReferences);
				var value = this.getDynamicFiledValue(cardCode, field.selector);

				if (type === "link")
				{
					if (
						BX.type.isPlainObject(typeReferences[0])
						&& BX.type.isArray(typeReferences[0].actions)
					)
					{
						return new BX.Landing.UI.Field.ClickAction({
							title: field.title,
							selector: field.selector,
							reference: typeReferences[0],
							linkField: field,
							value: value
						});
					}

					return field;
				}

				if (dropDownItems.length === 0)
				{
					dropDownItems = this.getDefaultDropdownItems();
				}

				if (type === "img")
				{
					return new BX.Landing.UI.Field.DynamicImage({
						title: field.title,
						selector: field.selector,
						dropdownItems: dropDownItems,
						value: BX.type.isString(value) ? {id: value} : value,
						hideCheckbox: cardCode === "wrapper"
					});
				}

				return new BX.Landing.UI.Field.DynamicDropdown({
					title: field.title,
					selector: field.selector,
					dropdownItems: dropDownItems,
					value: BX.type.isString(value) ? {id: value} : value,
					hideCheckbox: cardCode === "wrapper" || type === "link_ref"
				});
			}, this);
		},

		createDynamicCardsForm: function(options)
		{
			var help = "";
			var helps = BX.Landing.Main.getInstance().options.helps;

			if (BX.type.isPlainObject(helps))
			{
				help = helps.DYNAMIC_BLOCKS;
			}

			var dynamicForm = new BX.Landing.UI.Form.DynamicCardsForm({
				title: options.title,
				code: options.code,
				type: "dynamicCards",
				dynamicParams: options.dynamicParams,
				headerCheckbox: {
					text: BX.Landing.Loc.getMessage("LANDING_CARDS__MAKE_A_DYNAMIC"),
					onChange: this.onCardsFormTypeChange.bind(this),
					state: true,
					help: help
				},
				onSourceChange: function(source)
				{
					var dynamicFields = this.convertToDynamicFields(
						options.form.childForms[0].fields,
						options.code,
						source.references
					);

					var dynamicGroup = new DynamicFieldsGroup({
						id: "references",
						items: dynamicFields
					});

					var detailPageField = dynamicForm.detailPageGroup.fields[0];
					if (!BX.Type.isStringFilled(detailPageField.getValue().href))
					{
						var content = {text: '', href: ''};
						if (source && source.default && source.default.detail)
						{
							content.href = source.default.detail;
						}

						detailPageField.setValue(content);
						detailPageField.hrefInput.makeDisplayedHrefValue();
					}

					var oldCard = dynamicForm.cards.get('references');
					dynamicForm.replaceCard(oldCard, dynamicGroup);
				}.bind(this)
			});

			return dynamicForm;
		},

		onCardsFormTypeChange: function(event)
		{
			var contentPanel = this.panels.get("content_edit");
			var isDynamicEnabled = !!event.state;

			if (isDynamicEnabled)
			{
				var dynamicCardParams = {};

				if (
					BX.type.isPlainObject(this.dynamicParams)
					&& this.dynamicParams[event.form.code]
				)
				{
					dynamicCardParams = this.dynamicParams[event.form.code];
				}

				var value = Object.assign(
					{},
					dynamicCardParams
				);

				if (BX.type.isPlainObject(value.settings))
				{
					if (!('pagesCount' in value.settings))
					{
						value.settings.pagesCount = event.form.childForms.length;
					}
				}
				else
				{
					value.settings = {
						pagesCount: event.form.childForms.length
					};
				}

				var dynamicForm = this.createDynamicCardsForm({
					title: event.form.title,
					code: event.form.code,
					form: event.form,
					dynamicParams: value
				});

				contentPanel.replaceForm(event.form, dynamicForm);
				return;
			}

			delete this.dynamicParams[event.form.code];

			var staticForm = this.getCardsEditForms(true)
				.find(function(item) {
					return item.code === event.form.code;
				});

			contentPanel.replaceForm(event.form, staticForm);
		},

		isDynamicCards: function(cardsCode)
		{
			return cardsCode in this.dynamicParams;
		},

		onBlockFormTypeChange: function(event)
		{
			var contentPanel = this.panels.get("content_edit");
			var isDynamicEnabled = !!event.state;

			let restrictMessage = this.content.parentElement.querySelector('.landing-html-lock');
			if (restrictMessage)
			{
				if (!isDynamicEnabled)
				{
					this.content.style.display = 'flex';
					restrictMessage.style.display = 'none';
				}
				else
				{
					this.content.style.display = 'none';
					restrictMessage.style.display = 'flex';
				}
			}

			if (isDynamicEnabled)
			{
				var dynamicForm = this.createDynamicBlockForm({
					title: event.form.title,
					code: event.form.code,
					form: event.form,
					dynamicParams: this.dynamicParams
				});

				contentPanel.replaceForm(event.form, dynamicForm);
				return;
			}

			delete this.dynamicParams.wrapper;

			var staticForm = this.getBlockEditForm({
				skipBlockState: true
			});

			contentPanel.replaceForm(event.form, staticForm);
		},

		createDynamicBlockForm: function(options)
		{
			var help = "";
			var helps = BX.Landing.Main.getInstance().options.helps;

			if (BX.type.isPlainObject(helps))
			{
				help = helps.DYNAMIC_BLOCKS;
			}

			var dynamicForm = new BX.Landing.UI.Form.DynamicBlockForm({
				title: options.title,
				code: this.id,
				type: "dynamicBlock",
				dynamicParams: options.dynamicParams,
				headerCheckbox: {
					text: BX.Landing.Loc.getMessage("LANDING_BLOCK__MAKE_A_DYNAMIC"),
					onChange: this.onBlockFormTypeChange.bind(this),
					state: true,
					help: help
				},
				onSourceChange: function(source)
				{
					var oldCard = dynamicForm.cards.get('references');

					if (BX.type.isPlainObject(source))
					{
						var dynamicFields = this.convertToDynamicFields(
							options.form.fields,
							"wrapper",
							source.references
						);

						var dynamicGroup = new DynamicFieldsGroup({
							id: "references",
							items: dynamicFields
						});

						dynamicForm.replaceCard(oldCard, dynamicGroup);
						return;
					}

					dynamicForm.removeCard(oldCard);
				}.bind(this)
			});

			return dynamicForm;
		},

		isDynamic: function(code)
		{
			code = code || this.id;
			var panel = this.panels.get('content_edit');

			if (panel)
			{
				var form = panel.forms.toArray().find(function(form) {
					return form.code === code;
				});

				if (form)
				{
					return form.isCheckboxChecked();
				}
			}

			code = code === this.id ? "wrapper" : code;

			return (
				!!this.dynamicParams
				&& code in this.dynamicParams
			);
		}
	};
})();

/* End */
;
; /* Start:"a:4:{s:4:"full";s:41:"/bitrix/js/landing/card.js?16992580182792";s:6:"source";s:26:"/bitrix/js/landing/card.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function() {
	"use strict";

	BX.namespace("BX.Landing");

	var clone = BX.Landing.Utils.clone;
	var isPlainObject = BX.Landing.Utils.isPlainObject;
	var isEmpty = BX.Landing.Utils.isEmpty;
	var data = BX.Landing.Utils.data;
	var deepFreeze = BX.Landing.Utils.deepFreeze;


	/**
	 * Implements interface for works with cards of block
	 *
	 * @param {HTMLElement} node - Element of Card in Block.
	 * @param {cardManifest} manifest - Manifest of Card in Block.
	 * @param {string} selector - Selector of node
	 * @param {string} [label]
	 * @constructor
	 */
	BX.Landing.Block.Card = function(node, manifest, selector, label)
	{
		this.node = node;
		this.manifest = manifest || {};
		this.selector = selector;
		this.panels = new BX.Landing.UI.Collection.PanelCollection();
		this.form = null;
		this.node.classList.add("landing-card");
		this.label = label;
		this.preset = null;
		this.sortIndex = -1;

		if (isPlainObject(this.manifest.presets) && !isEmpty(this.manifest.presets))
		{
			var presetId = data(this.node, "data-card-preset");

			if (presetId)
			{
				this.preset = clone(this.manifest.presets[presetId]);
				this.preset.id = presetId;
				deepFreeze(this.preset);
			}
		}

		if (!BX.type.isDomNode(this.node))
		{
			throw new Error("BX.Landing.Block.Card: 'node' is not a DOMNode.");
		}

		if (!BX.type.isPlainObject(this.manifest))
		{
			throw new Error("BX.Landing.Block.Card: 'manifest' is not an Object.");
		}
	};


	/**
	 * Creates object.
	 * @static
	 */
	BX.Landing.Block.Card.init = function(node, manifest, selector)
	{
		return new BX.Landing.Block.Card(node, manifest, selector);
	};



	BX.Landing.Block.Card.prototype = {
		/**
		 * Gets card index
		 * @return {int}
		 */
		getIndex: function()
		{
			var index = parseInt(this.selector.split("@")[1]);
			index = BX.type.isNumber(index) ? index : 0;
			return index;
		},


		/**
		 * Gets card name
		 * @return {string}
		 */
		getName: function()
		{
			var name = (this.manifest.name || "") + " " + (this.getIndex() + 1);

			if (this.manifest.label)
			{
				var labelNode = this.node.querySelector("[data-selector*=\""+this.manifest.label+"\"]");

				if (labelNode && labelNode.innerHTML)
				{
					name = labelNode.innerHTML;
				}
			}

			return name;
		},


		getLabel: function()
		{
			return this.label;
		},


		/**
		 * Adds panel into card
		 * @param {BX.Landing.UI.Panel.BasePanel} panel
		 */
		addPanel: function(panel)
		{
			if (!!panel && panel instanceof BX.Landing.UI.Panel.BasePanel && !this.panels.contains(panel))
			{
				this.panels.add(panel);
				this.node.appendChild(panel.layout);
			}
		},


		clone: function()
		{
			return new BX.Landing.Block.Card(
				clone(this.node),
				clone(this.manifest),
				this.selector,
				clone(this.label)
			);
		}
	};
})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:45:"/bitrix/js/landing/node.min.js?16992580172544";s:6:"source";s:26:"/bitrix/js/landing/node.js";s:3:"min";s:30:"/bitrix/js/landing/node.min.js";s:3:"map";s:30:"/bitrix/js/landing/node.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.Block");var n=BX.Landing.Utils.isFunction;var e=BX.Landing.Utils.isString;var t=BX.Landing.Utils.isPlainObject;var i=BX.Landing.Utils.isArray;var o=BX.Landing.Utils.bind;var s=BX.Landing.Utils.proxy;var r=BX.Landing.Utils.data;BX.Landing.Block.Node=function(i){this.node=i.node;this.manifest=t(i.manifest)?i.manifest:{};this.selector=e(i.selector)?i.selector:"";this.onChangeHandler=n(i.onChange)?i.onChange:function(){};this.onDesignShow=n(i.onDesignShow)?i.onDesignShow:function(){};this.changeOptionsHandler=n(i.onChangeOptions)?i.onChangeOptions:function(){};this.onDocumentClick=s(this.onDocumentClick,this);this.onDocumentKeydown=s(this.onDocumentKeydown,this);o(document,"click",this.onDocumentClick);o(document,"keydown",this.onDocumentKeydown);Object.freeze(this.manifest);this.node.dataset.selector=this.selector;if(this.isAllowInlineEdit()){this.onAllowInlineEdit()}};BX.Landing.Block.Node.storage=[];BX.Landing.Block.Node.prototype={onDocumentClick:function(n){},onDocumentKeydown:function(n){if(n.keyCode===27){this.onEscapePress()}},onEscapePress:function(){},getField:function(){throw new Error("Must be implemented by subclass")},showEditor:function(){},hideEditor:function(){},onAllowInlineEdit:function(){},isAllowInlineEdit:function(){return this.manifest.allowInlineEdit!==false},isGrouped:function(){return typeof this.manifest.group==="string"&&this.manifest.group.length>0},setValue:function(n,e,t){throw new Error("Must be implemented by subclass")},getValue:function(){throw new Error("Must be implemented by subclass")},getAdditionalValue:function(){if(t(this.manifest.extend)&&i(this.manifest.extend.attrs)){return this.manifest.extend.attrs.reduce(function(n,e){return n[e]=r(this.node,e),n}.bind(this),{})}return{}},onChange:function(n){this.onChangeHandler.apply(null,[this,n])},getIndex:function(){var n=parseInt(this.selector.split("@")[1]);n=n===n?n:0;return n},preventSave:function(n){this.isSavePreventedValue=n},isSavePrevented:function(){return!!this.isSavePreventedValue},getBlock:function(){return BX.Landing.PageObject.getBlocks().getByChildNode(this.node)},preparePseudoUrl:function(n){let e=false;if(!(n.href==="#"&&n.target==="")){e=true}if(n.href==="selectActions:"){n.href="";n.enabled=false;e=true}if(n.href.startsWith("product:")){n.target="_self";e=true}if(n.enabled!==false){if(n.href===""||n.href==="#"){n.enabled=false;e=true}}if(n.target===""){n.target="_blank";e=true}if(e===true){return n}return null}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:51:"/bitrix/js/landing/node/text.min.js?169925801717809";s:6:"source";s:31:"/bitrix/js/landing/node/text.js";s:3:"min";s:35:"/bitrix/js/landing/node/text.min.js";s:3:"map";s:35:"/bitrix/js/landing/node/text.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing");var e=BX.Landing.Utils.escapeText;var t=BX.Landing.Utils.Matchers.headerTag;var n=BX.Landing.Utils.changeTagName;var i=BX.Landing.Utils.textToPlaceholders;BX.Landing.Block.Node.Text=function(e){BX.Runtime.loadExtension("landing.node.text.tableeditor");BX.Landing.Block.Node.apply(this,arguments);this.type="text";this.tableBaseFontSize="22";this.onClick=this.onClick.bind(this);this.onPaste=this.onPaste.bind(this);this.onDrop=this.onDrop.bind(this);this.onInput=this.onInput.bind(this);this.onKeyDown=this.onKeyDown.bind(this);this.onMousedown=this.onMousedown.bind(this);this.onMouseup=this.onMouseup.bind(this);this.node.addEventListener("mousedown",this.onMousedown);this.node.addEventListener("click",this.onClick);this.node.addEventListener("paste",this.onPaste);this.node.addEventListener("drop",this.onDrop);this.node.addEventListener("input",this.onInput);this.node.addEventListener("keydown",this.onKeyDown);document.addEventListener("mouseup",this.onMouseup)};BX.Landing.Block.Node.Text.currentNode=null;BX.Landing.Block.Node.Text.prototype={__proto__:BX.Landing.Block.Node.prototype,superClass:BX.Landing.Block.Node.prototype,constructor:BX.Landing.Block.Node.Text,onAllowInlineEdit:function(){this.node.setAttribute("title",e(BX.Landing.Loc.getMessage("LANDING_TITLE_OF_TEXT_NODE")))},onChange:function(e,t){this.superClass.onChange.call(this,t);if(!e){BX.Landing.UI.Panel.EditorPanel.getInstance().adjustPosition(this.node)}if(!t){BX.Landing.History.getInstance().push()}},onKeyDown:function(e){if(e.code==="Backspace"){this.onBackspaceDown(e)}this.onInput(e)},onInput:function(e){clearTimeout(this.inputTimeout);var t=e.keyCode||e.which;if(!(t===90&&(top.window.navigator.userAgent.match(/win/i)?e.ctrlKey:e.metaKey))){this.inputTimeout=setTimeout(function(){if(this.lastValue!==this.getValue()){this.onChange(true);this.lastValue=this.getValue()}}.bind(this),400)}if(this.isTable(e)){var n=parseInt(window.getComputedStyle(e.srcElement).getPropertyValue("font-size"));if(e.srcElement.textContent===""&&e.srcElement.classList.contains("landing-table-td")&&n<this.tableBaseFontSize){e.srcElement.classList.add("landing-table-td-height")}else{e.srcElement.classList.remove("landing-table-td-height")}}},onEscapePress:function(){if(this.isEditable()){if(this===BX.Landing.Block.Node.Text.currentNode){BX.Landing.UI.Panel.EditorPanel.getInstance().hide()}this.disableEdit()}},onDrop:function(e){e.preventDefault()},onPaste:function(e){e.preventDefault();if(e.clipboardData&&e.clipboardData.getData){var t=e.clipboardData.getData("text/plain");var n=BX.Text.encode(t);if(this.isLinkPasted(t)){n=this.prepareToLink(n)}var i=n.replace(new RegExp("\n","g"),"<br>");document.execCommand("insertHTML",false,i)}else{var a=window.clipboardData.getData("text");document.execCommand("paste",true,BX.Text.encode(a))}this.onChange()},onDocumentClick:function(e){if(this.isEditable()&&!this.fromNode){BX.Landing.UI.Panel.EditorPanel.getInstance().hide();this.disableEdit()}this.fromNode=false},onMousedown:function(e){if(!this.manifest.group){this.fromNode=true;if(this.manifest.allowInlineEdit!==false&&BX.Landing.Main.getInstance().isControlsEnabled()){e.stopPropagation();this.enableEdit();if(this.isTable(e)){this.disableEdit();BX.Landing.Block.Node.Text.currentNode.node.querySelectorAll(".landing-table-container").forEach((function(e){if(!e.hasAttribute("table-prepare")){BX.Landing.Block.Node.Text.prototype.prepareNewTable(e)}}));var t=parseInt(window.getComputedStyle(e.srcElement).getPropertyValue("font-size"));if(e.srcElement.textContent===""&&e.srcElement.classList.contains("landing-table-td")&&t<this.tableBaseFontSize){e.srcElement.classList.add("landing-table-td-height")}else{e.srcElement.classList.remove("landing-table-td-height")}}else{if(!this.manifest.textOnly&&!BX.Landing.UI.Panel.StylePanel.getInstance().isShown()){BX.Landing.UI.Panel.EditorPanel.getInstance().show(this.node,null,this.buttons)}if(BX.Landing.Block.Node.Text.nodeTableContainerList){BX.Landing.Block.Node.Text.nodeTableContainerList.forEach((function(e){e.tableEditor.unselect(e.tableEditor)}))}}BX.Landing.UI.Tool.ColorPicker.hideAll()}requestAnimationFrame((function(){if(e.target.nodeName==="A"||e.target.parentElement.nodeName==="A"){var t=document.createRange();t.selectNode(e.target);window.getSelection().removeAllRanges();window.getSelection().addRange(t)}}))}},onMouseup:function(){setTimeout(function(){this.fromNode=false}.bind(this),10)},onClick:function(e){if(this.isTable(e)){this.addTableButtons(e)}e.stopPropagation();e.preventDefault();this.fromNode=false;if(e.target.nodeName==="A"||e.target.parentElement.nodeName==="A"){var t=document.createRange();t.selectNode(e.target);window.getSelection().removeAllRanges();window.getSelection().addRange(t)}},isEditable:function(){return this.node.isContentEditable},enableEdit:function(){var e=BX.Landing.Block.Node.Text.currentNode;if(e){var t=BX.Landing.Block.Node.Text.currentNode.node;var n=t.querySelectorAll(".landing-table-container");if(n.length>0){n.forEach((function(e){if(!e.tableEditor){e.tableEditor=new BX.Landing.Node.Text.TableEditor.default(e)}}));BX.Landing.Block.Node.Text.nodeTableContainerList=n}}if(!this.isEditable()&&!BX.Landing.UI.Panel.StylePanel.getInstance().isShown()){if(this!==BX.Landing.Block.Node.Text.currentNode&&BX.Landing.Block.Node.Text.currentNode!==null){BX.Landing.Block.Node.Text.currentNode.disableEdit()}BX.Landing.Block.Node.Text.currentNode=this;this.buttons=[];this.buttons.push(this.getDesignButton());if(BX.Landing.Main.getInstance()["options"]["allow_ai_text"]){this.buttons.push(this.getAiTextButton())}if(this.isHeader()){this.buttons.push(this.getChangeTagButton());this.getChangeTagButton().onChangeHandler=this.onChangeTag.bind(this)}this.lastValue=this.getValue();this.node.contentEditable=true;this.node.setAttribute("title","")}},getDesignButton:function(){if(!this.designButton){this.designButton=new BX.Landing.UI.Button.Design("design",{html:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_DESIGN"),attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_DESIGN")},onClick:function(){BX.Landing.UI.Panel.EditorPanel.getInstance().hide();this.disableEdit();this.onDesignShow(this.manifest.code)}.bind(this)})}return this.designButton},getAiTextButton:function(){if(!this.aiTextButton){this.aiTextButton=new BX.Landing.UI.Button.AiText("ai_text",{html:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_AI_TEXT"),attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_AI_TEXT")},onClick:function(){BX.Landing.UI.Panel.EditorPanel.getInstance().hide();let e=BX.Landing.Main.getInstance()["options"]["blocks"];let t=this.manifest.sections;let n="";let i={};for(let a=0,s=t.length;a<s;a++){let s=t[a];if(e[s]&&e[s]["meta"]){if(e[s]["meta"]["ai_text_placeholder"]){n=e[s]["meta"]["ai_text_placeholder"]}if(e[s]["meta"]["ai_text_max_tokens"]){i["max_tokens"]=parseInt(e[s]["meta"]["ai_text_max_tokens"])}}}if(!this.aiTextPicker){let e=BX.Landing.Main.getInstance()["options"]["site_id"];let t=top.BX.AI?top.BX.AI.Picker:BX.AI.Picker;this.aiTextPicker=new t({moduleId:"landing",contextId:"text_site_"+e,analyticLabel:"landing_text",history:true,onSelect:function(e){this.node.innerHTML=e.data.replace(/(\r\n|\r|\n)/g,"<br>");this.onChange()}.bind(this),onTariffRestriction:function(){BX.UI.InfoHelper.show("limit_sites_TextAssistant_AI")}});this.aiTextPicker.setLangSpace(BX.AI.Picker.LangSpace.text)}this.aiTextPicker.setEngineParameters(i);this.aiTextPicker.text()}.bind(this)})}return this.aiTextButton},disableEdit:function(){if(this.isEditable()){this.node.contentEditable=false;if(this.lastValue!==this.getValue()){this.onChange();this.lastValue=this.getValue()}if(this.isAllowInlineEdit()){this.node.setAttribute("title",e(BX.Landing.Loc.getMessage("LANDING_TITLE_OF_TEXT_NODE")))}}},getField:function(){if(!this.field){this.field=new BX.Landing.UI.Field.Text({selector:this.selector,title:this.manifest.name,content:this.node.innerHTML,textOnly:this.manifest.textOnly,bind:this.node});if(this.isHeader()){this.field.changeTagButton=this.getChangeTagButton()}}else{this.field.setValue(this.node.innerHTML);this.field.content=this.node.innerHTML}return this.field},setValue:function(e,t,n){this.preventSave(t);this.lastValue=this.isSavePrevented()?this.getValue():this.lastValue;this.node.innerHTML=e;this.onChange(false,n)},getValue:function(){if(this.node.querySelector(".landing-table-container")!==null){const e=this.node.cloneNode(true);this.prepareTable(e);return i(e.innerHTML)}return i(this.node.innerHTML)},isHeader:function(){return t.test(this.node.nodeName)},isTable:function(e){var t=false;if(BX.Landing.Block.Node.Text.currentNode&&e){BX.Landing.Block.Node.Text.currentNode.node.querySelectorAll(".landing-table-container").forEach((function(n){if(n.contains(e.srcElement)){t=true}}))}return t},prepareNewTable:function(e){e.querySelectorAll("br").forEach((function(e){e.remove()}));e.setAttribute("table-prepare","true");BX.Landing.Block.Node.Text.currentNode.onChange(true)},addTableButtons:function(e){var t=[];var n=[];var i=[];var a=this.getTableButtons();var s=[a[0],a[1],a[2],a[3]];var o=BX.Landing.Block.Node.Text.currentNode.node;var l=null;var d=false;var r=false;var c=false;var g=true;if(e.srcElement.classList.contains("landing-table")||e.srcElement.classList.contains("landing-table-col-dnd")){g=false}if(e.srcElement.classList.contains("landing-table-row-add")){r=true}if(e.srcElement.classList.contains("landing-table-col-add")){c=true}var h=[];var u=o.querySelectorAll(".landing-table");if(u.length>0){u.forEach((function(t){if(t.contains(e.srcElement)){l=t;return true}}))}a.forEach((function(t){t["options"]["srcElement"]=e.srcElement;t["options"]["node"]=o;t["options"]["table"]=l}));if(e.srcElement.classList.contains("landing-table-row-dnd")){i=e.srcElement.parentNode.children;i=Array.from(i);if(this.getAmountTableRows(l)>1){n=[0,1,2,3,4,5,6]}else{n=[0,1,2,3,4,5]}n.forEach((function(e){a[e]["options"]["target"]="row";a[e]["options"]["setTd"]=i;t.push(a[e])}))}if(e.srcElement.parentNode.classList.contains("landing-table-col-dnd")){var f=e.srcElement.parentElement.parentElement.childNodes;var L=Array.from(f);var T=[];L.forEach((function(e){if(e.nodeType===1){T.push(e)}}));var E=T.indexOf(e.srcElement.parentElement);var p=e.srcElement.parentElement.parentElement.parentElement.childNodes;p.forEach((function(e){if(e.nodeType===1){var t=[];e.childNodes.forEach((function(e){if(e.nodeType===1){t.push(e)}}));if(t[E]){i.push(t[E])}}}));if(this.getAmountTableCols(l)>1){n=[0,1,2,3,4,5,7]}else{n=[0,1,2,3,4,5]}n.forEach((function(e){a[e]["options"]["target"]="col";a[e]["options"]["setTd"]=i;t.push(a[e])}))}if(e.srcElement.classList.contains("landing-table-th-select-all")){var B;if(e.srcElement.classList.contains("landing-table-th-select-all-selected")){B=true;const s=e.srcElement.parentElement.parentElement.childNodes;s.forEach((function(e){e.childNodes.forEach((function(e){i.push(e)}))}));n=[0,1,2,3,4,5,8,9,10];n.forEach((function(e){a[e]["options"]["target"]="table";a[e]["options"]["setTd"]=i;t.push(a[e])}))}else{B=false;BX.Landing.UI.Panel.EditorPanel.getInstance().hide()}}if(BX.Dom.hasClass(e.srcElement,"landing-table-td")||this.hasParentWithClass(e.srcElement,"landing-table-td")){i.push(e.srcElement);n=[3,2,1,0];n.forEach((function(e){a[e]["options"]["target"]="cell";a[e]["options"]["setTd"]=i;a[e].insertAfter="strikeThrough";t.push(a[e])}));d=true;h=["justifyLeft","justifyCenter","justifyRight","justifyFull","createTable","pasteTable"]}var I;let _=[];i.forEach((function(e){if(e.nodeType===1){I=undefined;if(e.classList.contains("text-left")){I="alignLeft"}if(e.classList.contains("text-center")){I="alignCenter"}if(e.classList.contains("text-right")){I="alignRight"}if(e.classList.contains("text-justify")){I="alignJustify"}_.push(I)}}));var b=0;var N=true;while(b<_.length&&N){if(b>0){if(_[b]!==_[b-1]){N=false}}b++}if(N){I=_[0]}else{I=undefined}if(I){s.forEach((function(e){if(e.id===I){e.layout.classList.add("landing-ui-active")}}))}if(t[0]&&t[1]&&t[2]&&t[3]){t[0]["options"]["alignButtons"]=s;t[1]["options"]["alignButtons"]=s;t[2]["options"]["alignButtons"]=s;t[3]["options"]["alignButtons"]=s}if(!this.manifest.textOnly){if(g){if(!r&&!c&&l){if(!d){if(B===false){BX.Landing.UI.Panel.EditorPanel.getInstance().hide()}else{BX.Landing.UI.Panel.EditorPanel.getInstance().show(l.parentNode,null,t,true)}}else{BX.Landing.UI.Panel.EditorPanel.getInstance().show(l.parentNode,null,t,true,h)}}}else{BX.Landing.UI.Panel.EditorPanel.getInstance().hide()}}},hasParentWithClass:function(e,t){let n=e.parentNode;while(n!==null){if(n.classList&&BX.Dom.hasClass(n,t)){return true}n=n.parentNode}return false},getChangeTagButton:function(){if(!this.changeTagButton){this.changeTagButton=new BX.Landing.UI.Button.ChangeTag("changeTag",{html:'<span class="landing-ui-icon-editor-'+this.node.nodeName.toLowerCase()+'"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_CHANGE_TAG")},onChange:this.onChangeTag.bind(this)})}this.changeTagButton.insertAfter="unlink";this.changeTagButton.activateItem(this.node.nodeName);return this.changeTagButton},getTableButtons:function(){this.buttons=[];this.buttons.push(new BX.Landing.UI.Button.AlignTable("alignLeft",{html:'<span class="landing-ui-icon-editor-left"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_LEFT")}}),new BX.Landing.UI.Button.AlignTable("alignCenter",{html:'<span class="landing-ui-icon-editor-center"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_CENTER")}}),new BX.Landing.UI.Button.AlignTable("alignRight",{html:'<span class="landing-ui-icon-editor-right"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_RIGHT")}}),new BX.Landing.UI.Button.AlignTable("alignJustify",{html:'<span class="landing-ui-icon-editor-justify"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_ALIGN_JUSTIFY")}}),new BX.Landing.UI.Button.ColorAction("tableTextColor",{text:BX.Landing.Loc.getMessage("EDITOR_ACTION_SET_FORE_COLOR"),attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_COLOR")}}),new BX.Landing.UI.Button.ColorAction("tableBgColor",{html:'<i class="landing-ui-icon-editor-fill-color"></i>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_CELL_BG")}}),new BX.Landing.UI.Button.DeleteElementTable("deleteRow",{html:'<span class="landing-ui-icon-editor-delete"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_DELETE_ROW_TABLE")}}),new BX.Landing.UI.Button.DeleteElementTable("deleteCol",{html:'<span class="landing-ui-icon-editor-delete"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_DELETE_COL_TABLE")}}),new BX.Landing.UI.Button.StyleTable("styleTable",{html:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE")+'<i class="fas fa-chevron-down g-ml-8"></i>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_STYLE")}}),new BX.Landing.UI.Button.CopyTable("copyTable",{text:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY"),attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_COPY")}}),new BX.Landing.UI.Button.DeleteTable("deleteTable",{html:'<span class="landing-ui-icon-editor-delete"></span>',attrs:{title:BX.Landing.Loc.getMessage("LANDING_TITLE_OF_EDITOR_ACTION_TABLE_DELETE")}}));return this.buttons},onChangeTag:function(e,t){this.node=n(this.node,e);this.node.addEventListener("mousedown",this.onMousedown);this.node.addEventListener("click",this.onClick);this.node.addEventListener("paste",this.onPaste);this.node.addEventListener("drop",this.onDrop);this.node.addEventListener("input",this.onInput);this.node.addEventListener("keydown",this.onInput);if(!this.getField().isEditable()&&!t){this.disableEdit();this.enableEdit()}var i={};i[this.selector]=e;if(!t){this.changeOptionsHandler(i).then((()=>{BX.Landing.History.getInstance().push()}))}},getAmountTableCols:function(e){return e.querySelectorAll(".landing-table-col-dnd").length},getAmountTableRows:function(e){return e.querySelectorAll(".landing-table-row-dnd").length},prepareTable:function(e){var t=["table-selected-all","landing-table-th-select-all-selected","landing-table-cell-selected","landing-table-row-selected","landing-table-th-selected","landing-table-th-selected-cell","landing-table-th-selected-top","landing-table-th-selected-x","landing-table-tr-selected-left","landing-table-tr-selected-y","landing-table-col-selected","landing-table-tr-selected","table-selected-all-right","table-selected-all-bottom"];t.forEach((function(t){e.querySelectorAll("."+t).forEach((function(e){e.classList.remove(t)}))}));return e},onBackspaceDown:function(e){var t=window.getSelection();var n=t.getRangeAt(0).startOffset;if(n===0){var i=t.focusNode;if(!BX.Type.isNil(i)&&i.nodeType!==3){if(i.firstChild.nodeType===3&&i.firstChild.firstChild.nodeType===3){i=i.firstChild.firstChild}else if(i.firstChild.nodeType!==3){i=i.firstChild}else{i=null}}if(i){var a=i.parentNode;var s=["BLOCKQUOTE","UL"];if(a&&s.includes(a.nodeName)){var o=document.createElement("div");o.append(i);a.append(o)}var l=i.parentNode.parentNode;while(l&&!s.includes(l.nodeName)){l=l.parentNode}if(l&&l.childNodes.length===1){l.after(i.parentNode);l.remove();e.preventDefault()}}}},isLinkPasted:function(e){var t=/^https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*)$/;return!!e.match(t)},prepareToLink:function(e){return"<a class='g-bg-transparent' href='"+e+"' target='_blank'> "+e+" </a>"}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:50:"/bitrix/js/landing/node/link.min.js?16992580173900";s:6:"source";s:31:"/bitrix/js/landing/node/link.js";s:3:"min";s:35:"/bitrix/js/landing/node/link.min.js";s:3:"map";s:35:"/bitrix/js/landing/node/link.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing");var t=BX.Landing.Utils.trim;var e=BX.Landing.Utils.isPlainObject;var i=BX.Landing.Utils.isString;var n=BX.Landing.Utils.textToPlaceholders;var a=BX.Landing.Utils.create;var s=BX.Landing.Utils.escapeText;var d=BX.Landing.Utils.decodeDataValue;BX.Landing.Block.Node.Link=function(t){BX.Landing.Block.Node.apply(this,arguments);this.type="link";if(!this.isGrouped()){this.node.addEventListener("click",this.onClick.bind(this))}if(this.isAllowInlineEdit()){this.node.setAttribute("title",BX.Landing.Loc.getMessage("LANDING_TITLE_OF_LINK_NODE"))}this.onChange=BX.Runtime.debounce(this.onChange,500);this.onContentUpdate=BX.Runtime.debounce(this.onContentUpdate,500)};BX.Landing.Block.Node.Link.prototype={__proto__:BX.Landing.Block.Node.prototype,constructor:BX.Landing.Block.Node.Link,onContentUpdate:function(){BX.Landing.History.getInstance().push();this.getField().setValue(this.getValue())},isMenuMode:function(){return this.manifest.menuMode===true},onClick:function(t){t.preventDefault();if(!this.isMenuMode()){t.stopPropagation()}if(this.isAllowInlineEdit()){BX.Landing.UI.Button.ColorAction.hideAll();if(!BX.Landing.UI.Panel.StylePanel.getInstance().isShown()){BX.Landing.UI.Panel.Link.getInstance().show(this)}}},isPrevented:function(){return this.getValue().target==="_popup"},setValue:function(t,e,n){this.startValue=this.startValue||this.getValue();this.preventSave(e);if(!this.containsImage()&&this.isAllowInlineEdit()){var a=this.getField(true).hrefInput;if(i(t.text)&&t.text.includes("{{name}}")){a.getPlaceholderData(t.href).then(function(e){this.node.innerHTML=t.text.replace(new RegExp("{{name}}"),'<span data-placeholder="name">'+e.name+"</span>")}.bind(this))}else{if(!this.getField().containsHtml()&&!this.manifest.skipContent){this.node.innerHTML=s(t.text)}}}this.node.setAttribute("href",d(t.href));this.node.setAttribute("target",s(t.target));if("attrs"in t){for(var r in t.attrs){if(t.attrs.hasOwnProperty(r)){this.node.setAttribute(r,t.attrs[r])}}}else{this.node.removeAttribute("data-url");this.node.removeAttribute("data-embed")}this.onChange(n);if(!n){this.onContentUpdate()}},containsImage:function(){return!!this.node.firstElementChild&&this.node.firstElementChild.tagName==="IMG"},getValue:function(){var i={text:n(t(this.node.innerHTML)),href:t(this.node.getAttribute("href")),target:t(this.node.getAttribute("target")||"_self")};if(this.node.getAttribute("data-url")){i.attrs={"data-url":t(this.node.getAttribute("data-url"))}}if(this.node.getAttribute("data-dynamic")){if(!e(i.attrs)){i.attrs={}}i.attrs["data-dynamic"]=this.node.getAttribute("data-dynamic")}if(this.manifest.skipContent){i["skipContent"]=true;delete i.text}if(i.href&&i.href.startsWith("selectActions:")){i.href="#"}return i},getField:function(t){var e=this.getValue();e.text=n(a("div",{html:e.text}).innerHTML);if(!this.field){var i=[BX.Landing.UI.Field.LinkUrl.TYPE_BLOCK,BX.Landing.UI.Field.LinkUrl.TYPE_PAGE,BX.Landing.UI.Field.LinkUrl.TYPE_CRM_FORM,BX.Landing.UI.Field.LinkUrl.TYPE_CRM_PHONE];if(BX.Landing.Main.getInstance().options.params.type===BX.Landing.Main.TYPE_STORE){i.push(BX.Landing.UI.Field.LinkUrl.TYPE_CATALOG)}if(BX.Landing.Main.getInstance().options.features.includes("diskFile")){i.push(BX.Landing.UI.Field.LinkUrl.TYPE_DISK_FILE)}this.field=new BX.Landing.UI.Field.Link({title:this.manifest.name,selector:this.selector,skipContent:this.manifest.skipContent,content:e,options:{siteId:BX.Landing.Main.getInstance().options.site_id,landingId:BX.Landing.Main.getInstance().id},allowedTypes:i})}else{if(!t){this.field.setValue(e);this.field.content=e;this.field.hrefInput.content=e.href;this.field.hrefInput.makeDisplayedHrefValue();this.field.hrefInput.setHrefTypeSwitcherValue(this.field.hrefInput.getHrefStringType());this.field.hrefInput.removeHrefTypeFromHrefString()}}return this.field}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:49:"/bitrix/js/landing/node/img.min.js?16992580176006";s:6:"source";s:30:"/bitrix/js/landing/node/img.js";s:3:"min";s:34:"/bitrix/js/landing/node/img.min.js";s:3:"map";s:34:"/bitrix/js/landing/node/img.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing");var e=BX.Landing.Utils.attr;var t=BX.Landing.Utils.data;var n=BX.Landing.Utils.encodeDataValue;var i=BX.Landing.Utils.decodeDataValue;BX.Landing.Block.Node.Img=function(e){BX.Landing.Block.Node.apply(this,arguments);this.type="img";this.editPanel=null;this.lastValue=null;this.field=null;this.uploadParams=e.uploadParams;if(!this.isGrouped()){this.node.addEventListener("click",this.onClick.bind(this))}if(this.isAllowInlineEdit()){this.node.setAttribute("title",BX.Landing.Loc.getMessage("LANDING_TITLE_OF_IMAGE_NODE"))}};function a(e){return e.node.nodeName!=="IMG"}function s(e){return e.node.nodeName==="IMG"}function d(e){return e.node.nodeName==="SPAN"||e.node.nodeName==="I"||e.node.nodeName==="EM"}function o(e){var t=e.node.style.getPropertyValue("background-image");if(t){var n=t.match(/url\((.*?)\)/);if(n&&n[1]){return n[1].replace(/["|']/g,"")}}return""}function r(e){var t=e.node.style.getPropertyValue("background-image");if(t){var n=t.match(/1x, url\(["|'](.*)["|']\) 2x\)/);if(n&&n[1]){return n[1].replace(/["|']/g,"")}}return""}function l(e){var t=parseInt(e.node.dataset.fileid);return t===t?t:-1}function c(e){var t=parseInt(e.node.dataset.fileid2x);return t===t?t:-1}function u(t){var n=e(t.node,"alt");return!!n?n:""}function g(e){var n=t(e.node,"data-pseudo-url");return!!n?n:""}function h(t){var n=e(t.node,"src");return!!n?n:""}function f(t){var n=e(t.node,"srcset");return!!n?n.replace(" 2x",""):""}function m(e,t){if(!s(e)){var n=BX.create("img",{attrs:{src:t.src,alt:t.alt,"data-fileid":t.id}});e.node.parentNode.insertBefore(n,e.node);BX.remove(e.node);e.node=n}else{e.node.src=t.src;e.node.alt=t.alt||"";e.node.dataset.fileid=t.id||-1;e.node.srcset=t.src2x?t.src2x+" 2x":"";e.node.dataset.fileid2x=t.id2x||-1}}function p(e,t){if(!a(e)){var n=BX.create("div",{attrs:{style:'background-image: url("'+t.src+'")',"data-fileid":t.id}});e.node.parentNode.insertBefore(n,e.node);BX.remove(e.node);e.node=n}else{if(t.src){const n=['background-image: url("'+t.src+'");'];if(t.src2x){n.push('background-image: -webkit-image-set(url("'+t.src+'") 1x, url("'+t.src2x+'") 2x);');n.push('background-image: image-set(url("'+t.src+'") 1x, url("'+t.src2x+'") 2x);')}const i=e.node.style;const a={};Array.from(i).map((e=>{a[e]=i.getPropertyValue(e)}));e.node.setAttribute("style",n.join(" "));for(let t in a){if(t!=="background-image"){e.node.style.setProperty(t,a[t])}}}else{if(e.node.style){e.node.style.removeProperty("background-image")}}e.node.dataset.fileid=t.id||-1;e.node.dataset.fileid2x=t.id2x||-1}}BX.Landing.Block.Node.Img.prototype={__proto__:BX.Landing.Block.Node.prototype,constructor:BX.Landing.Block.Node.Img,onClick:function(e){if(this.manifest.allowInlineEdit!==false&&BX.Landing.Main.getInstance().isControlsEnabled()&&(!BX.Landing.Block.Node.Text.currentNode||!BX.Landing.Block.Node.Text.currentNode.isEditable())&&!BX.Landing.UI.Panel.StylePanel.getInstance().isShown()){e.preventDefault();e.stopPropagation();BX.Landing.UI.Button.ColorAction.hideAll();if(!this.editPanel){this.editPanel=new BX.Landing.UI.Panel.Content(this.selector,{title:BX.Landing.Loc.getMessage("LANDING_IMAGE_PANEL_TITLE"),className:"landing-ui-panel-edit-image"});this.editPanel.appendFooterButton(new BX.Landing.UI.Button.BaseButton("save_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_SAVE"),onClick:this.save.bind(this),className:"landing-ui-button-content-save"}));this.editPanel.appendFooterButton(new BX.Landing.UI.Button.BaseButton("cancel_block_content",{text:BX.Landing.Loc.getMessage("BLOCK_CANCEL"),onClick:this.editPanel.hide.bind(this.editPanel),className:"landing-ui-button-content-cancel"}));window.parent.document.body.appendChild(this.editPanel.layout)}var t=new BX.Landing.UI.Form.BaseForm({title:this.manifest.name});t.addField(this.getField());this.editPanel.clear();this.editPanel.appendForm(t);this.editPanel.show();BX.Landing.UI.Panel.EditorPanel.getInstance().hide()}},save:function(){var e=this.editPanel.forms[0].fields[0].getValue();if(JSON.stringify(this.getValue())!==JSON.stringify(e)){this.setValue(e)}this.editPanel.hide()},getField:function(){if(!this.field){var e="";if(this.manifest.dimensions){var t=this.manifest.dimensions;var n=t.width||t.maxWidth||t.minWidth;var s=t.height||t.maxHeight||t.minHeight;if(n&&!s){e=BX.Landing.Loc.getMessage("LANDING_CONTENT_IMAGE_RECOMMENDED_WIDTH")+" ";e+=n+"px"}else if(s&&!n){e=BX.Landing.Loc.getMessage("LANDING_CONTENT_IMAGE_RECOMMENDED_HEIGHT")+" ";e+=s+"px"}else if(n&&s){e=BX.Landing.Loc.getMessage("LANDING_CONTENT_IMAGE_RECOMMENDED_SIZE")+" ";e+=n+"px&nbsp;/&nbsp;";e+=s+"px"}}var d=this.getValue();d.url=i(d.url);var o=!!this.node.closest("a")||!!this.manifest.disableLink;if(this.manifest["editInStyle"]!==true){this.field=new BX.Landing.UI.Field.Image({selector:this.selector,title:this.manifest.name,description:e,disableLink:o,content:d,dimensions:!!this.manifest.dimensions?this.manifest.dimensions:{},create2xByDefault:this.manifest.create2xByDefault,disableAltField:a(this),uploadParams:this.uploadParams})}}else{this.field.setValue(this.getValue());this.field.content=this.getValue();requestAnimationFrame(function(){this.field.adjustPreviewBackgroundSize()}.bind(this))}return this.field},setValue:function(t,n,i){this.lastValue=this.lastValue||this.getValue();this.preventSave(n);t.src=decodeURIComponent(t.src);if(s(this)){m(this,t)}if(a(this)){p(this,t)}if(t.url){const n=this.preparePseudoUrl(t.url);if(n!==null){e(this.node,"data-pseudo-url",n)}}this.onChange(i);if(!i){BX.Landing.History.getInstance().push()}this.lastValue=this.getValue()},getValue:function(){const e={type:"",src:"",alt:"",url:""};const t=l(this);if(t>0){e.id=t}const i=c(this);if(i>0){e.id2x=i}if(a(this)){e.type="background";e.src=o(this);const t=r(this);if(t){e.src2x=t}}if(s(this)){e.type="image";e.alt=u(this);e.src=h(this);const t=f(this);if(t){e.src2x=t}}e.url=n(g(this))||{text:"",href:"",target:"_self",enabled:false};return e}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:44:"/bitrix/js/landing/node/ul.js?16992580175944";s:6:"source";s:29:"/bitrix/js/landing/node/ul.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function() {

"use strict";

BX.namespace("BX.Landing");

/**
 * DOMNode of Block (Ul).
 * @param {nodeOptions} options
 */
BX.Landing.Block.Node.Ul = function(options)
{
	BX.Landing.Block.Node.apply(this, arguments);

	this.popup = null;
	this.nodeEditSubmit = null;
	this.nodeEditLi = [];
	this.content = [];

	// get all LI with BIU tags
	var ulLi = BX.findChildren(this.node, {tag: "li"});
	for (var i = 0, c = ulLi.length; i < c; i++)
	{
		var liContent = "";
		for (var j = 0, cc = ulLi[i].childNodes.length; j < cc; j++)
		{
			if (
				ulLi[i].childNodes[j].nodeType === 1 &&
				(
					ulLi[i].childNodes[j].tagName === "B" ||
					ulLi[i].childNodes[j].tagName === "I" ||
					ulLi[i].childNodes[j].tagName === "U"
				)
			)
			{
				liContent += ulLi[i].childNodes[j].outerHTML;
			}
			else if (
					ulLi[i].childNodes[j].nodeType === 3 &&
					BX.util.trim(ulLi[i].childNodes[j].textContent) !== ""
			)
			{
				liContent += " #VAL# ";
			}
		}
		this.content.push({
			content: BX.util.trim(ulLi[i].textContent),
			original: liContent
		});
	}

	BX.bind(this.node, "click", BX.delegate(this.onClick, this));
};


BX.Landing.Block.Node.Ul.prototype = {
	__proto__: BX.Landing.Block.Node.prototype,
	constructor: BX.Landing.Block.Node.Ul,

	/**
	 * Save content for Node.
	 * @returns {void}
	 */
	saveContent: function ()
	{
		var wasChanged = false;
		var isNulled = true;
		// change any li or not
		for (var i = 0, c = this.nodeEditLi.length; i < c; i++)
		{
			if (this.nodeEditLi[i] !== null)
			{
				var value = BX.util.trim(this.nodeEditLi[i].value);
				isNulled = false;
				if (
					typeof this.content[i] === "undefined" ||
					this.content[i].content !== value
				)
				{
					wasChanged = true;
					break;
				}
			}
			else
			{
				wasChanged = true;
				break;
			}
		}
		// save content
		if (!isNulled && wasChanged)
		{
			BX.cleanNode(this.node);
			this.content = [];
			for (var i = 0, c = this.nodeEditLi.length; i < c; i++)
			{
				if (this.nodeEditLi[i] !== null)
				{
					var value = BX.util.trim(this.nodeEditLi[i].value);
					var original = BX.data(this.nodeEditLi[i], "original");
					this.content.push({
						content: value,
						original: original
					});
					this.node.appendChild(BX.create("li", {
						html: original.replace("#VAL#", BX.util.htmlspecialchars(value))
					}));
				}
				else
				{
					this.content.push(false);
				}
			}
			this.markAsChanged();
		}
	},

	/**
	 * Return element for add new li item.
	 * @returns {DOMNode}
	 */
	getAddLiButton: function (i)
	{
		return BX.create("input", {
			attrs: {
				type: "button",
				value: "+"
			},
			dataset: {
				i: i
			},
			events: {
				click: BX.delegate(function ()
				{
					var button = BX.proxy_context;
					var i = parseInt(BX.data(button, "i"));
					var newLi = BX.create("input", {
						dataset: {
							original: this.content[i].original
						},
						attrs: {
							type: "text"
						}
					});
					BX.insertAfter(BX.create("div", {
						children: [
							newLi,
							this.getAddLiButton(i + 1),
							this.getRemoveLiButton(i + 1)
						]
					}), button.parentNode);
					this.nodeEditLi.splice(i + 1, 0, newLi);
					BX.focus(newLi);
				}, this)
			}
		});
	},

	/**
	 * Return element for remove li item.
	 * @returns {DOMNode}
	 */
	getRemoveLiButton: function (i)
	{
		return BX.create("input", {
			attrs: {
				type: "button",
				value: "-"
			},
			dataset: {
				i: i
			},
			events: {
				click: BX.delegate(function ()
				{
					var button = BX.proxy_context;
					this.nodeEditLi[BX.data(button, "i")] = null;
					BX.remove(button.parentNode);
				}, this)
			}
		});
	},

	/**
	 * Rerturn nodes for edit content.
	 * @param {Boolean} showbutton False if not show save button.
	 * @returns {Array of DOMNode}
	 */
	getEditNodes: function (showbutton)
	{
		var li, editLi = [];

		this.nodeEditLi = [];

		// edit li
		for (var i = 0, c = this.content.length; i < c; i++)
		{
			li = BX.create("input", {
				dataset: {
					original: this.content[i].original
				},
				attrs: {
					type: "text",
					value: BX.util.trim(this.content[i].content)
				}
			});
			this.nodeEditLi.push(li);

			editLi.push(BX.create("div", {
				children: [
					li,
					this.getAddLiButton(i),
					this.getRemoveLiButton(i)
				]
			}));
		}

		// save button
		if (showbutton !== false)
		{
			this.nodeEditSubmit = BX.create("input", {
				attrs: {
					type: "button",
					value: "Save"
				},
				events: {
					click: function ()
					{
						this.saveContent();
						this.popup.close();
					}.bind(this)
				}
			});
		}

		if (showbutton !== false)
		{
			editLi.push(this.nodeEditSubmit);
		}

		return editLi;
	},

	/**
	 * Click on field - edit mode.
	 * @param {MouseEvent} e
	 * @returns {void}
	 */
	onClick: function (e)
	{
		this.popup = BX.PopupWindowManager.create(
			"landing_node_img",
			BX.proxy_context,
			{
				closeIcon: false,
				autoHide: true,
				closeByEsc: true,
				contentColor: "white",
				angle: true,
				offsetLeft: 15,
				overlay: {
					backgroundColor: "#cdcdcd",
					opacity: ".1"
				},
				events: {
					onPopupClose: function ()
					{
						this.popup.destroy();
					}.bind(this)
				}
			}
		);

		// popup content
		this.popup.setContent(BX.create("div", {
			children: this.getEditNodes()
		}));

		this.popup.show();

		return BX.PreventDefault(e);
	},

	/*
	 * Get tags for show Node in settings form.
	 * @returns {Array}
	 */
	getSettingsForm: function ()
	{
		return [{
			name: this.getName(),
			node: BX.create("div", {
				children: this.getEditNodes(false)
			})
		}];
	},

	/*
	 * Callback on save settings form.
	 * @returns {void}
	 */
	saveSettingsForm: function ()
	{
		this.saveContent();
	},

	getValue: function ()
	{

	},

	setValue: function ()
	{

	},

	getField: function()
	{
		return new BX.Landing.UI.Field.BaseField({
			selector: this.selector,
			title: this.manifest.name
		});
	}
};

})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:49:"/bitrix/js/landing/node/map.min.js?16992580172472";s:6:"source";s:30:"/bitrix/js/landing/node/map.js";s:3:"min";s:34:"/bitrix/js/landing/node/map.min.js";s:3:"map";s:34:"/bitrix/js/landing/node/map.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing");var t=BX.Landing.Utils.debounce;var a=BX.Landing.Utils.data;var i=BX.Landing.Utils.proxy;var n=BX.Landing.Utils.onCustomEvent;var e=BX.Landing.Utils.encodeDataValue;BX.Landing.Block.Node.Map=function(t){BX.Landing.Block.Node.apply(this,arguments);this.type="map";this.attribute="data-map";this.hidden=true;this.createMap();this.lastValue=this.getValue();this.onBlockUpdateAttrs=this.onBlockUpdateAttrs.bind(this);n("BX.Landing.Block:Node:updateAttr",this.onBlockUpdateAttrs)};BX.Landing.Block.Node.Map.prototype={constructor:BX.Landing.Block.Node.Map,__proto__:BX.Landing.Block.Node.prototype,createMap:function(){this.mapOptions={mapContainer:this.node,mapOptions:a(this.node,"data-map"),theme:a(this.node,"data-map-theme"),roads:a(this.node,"data-map-roads")||[],landmarks:a(this.node,"data-map-landmarks")||[],labels:a(this.node,"data-map-labels")||[],onMapClick:i(this.onMapClick,this),onChange:t(this.onChange,500,this),fullscreenControl:false,mapTypeControl:false,zoomControl:false};this.map=BX.Landing.Provider.Map.create(this.node,this.mapOptions)},reinitMap:function(){const t=BX.Runtime.clone(this.mapOptions);this.mapOptions.mapOptions=a(this.node,"data-map");this.mapOptions.theme=a(this.node,"data-map-theme");this.mapOptions.roads=a(this.node,"data-map-roads")||[];this.mapOptions.landmarks=a(this.node,"data-map-landmarks")||[];this.mapOptions.labels=a(this.node,"data-map-labels")||[];if(t!==this.mapOptions){this.map.reinit(this.mapOptions)}},onBlockUpdateAttrs:function(t){if(t.node===this.node){this.reinitMap();this.lastValue=this.getValue()}},onMapClick:function(t){if(BX.Landing.UI.Panel.StylePanel.getInstance().isShown()){return}this.map.addMarker({latLng:this.map.getPointByEvent(t),title:"",description:"",showByDefault:false,draggable:true,editable:true});this.map.onMarkerClick(this.map.markers[this.map.markers.length-1])},onChange:function(t){if(this.isChanged()){if(!t){BX.Landing.History.getInstance().push()}this.lastValue=this.getValue();this.onChangeHandler(this,t)}},isChanged:function(){return JSON.stringify(this.getValue())!==JSON.stringify(this.lastValue)},getValue:function(){return this.map&&this.map.isApiLoaded()?this.map.getValue():null},getAttrValue:function(){return e(this.getValue())},setValue:function(t,a,i){this.map.setValue(t,i)},getField:function(){return new BX.Landing.UI.Field.BaseField({selector:this.selector,hidden:true})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:54:"/bitrix/js/landing/node/component.min.js?1699258017491";s:6:"source";s:36:"/bitrix/js/landing/node/component.js";s:3:"min";s:40:"/bitrix/js/landing/node/component.min.js";s:3:"map";s:40:"/bitrix/js/landing/node/component.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.Block.Node");BX.Landing.Block.Node.Component=function(n){BX.Landing.Block.Node.apply(this,arguments);this.type="component"};BX.Landing.Block.Node.Component.prototype={constructor:BX.Landing.Block.Node.Component,__proto__:BX.Landing.Block.Node.prototype,getField:function(){return new BX.Landing.UI.Field.BaseField({selector:this.selector})},getValue:function(){return""},setValue:function(n,o,e){}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:50:"/bitrix/js/landing/node/icon.min.js?16992580171728";s:6:"source";s:31:"/bitrix/js/landing/node/icon.js";s:3:"min";s:35:"/bitrix/js/landing/node/icon.min.js";s:3:"map";s:35:"/bitrix/js/landing/node/icon.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.Block.Node");var t=BX.Landing.Utils.encodeDataValue;var n=BX.Landing.Utils.decodeDataValue;var i=BX.Landing.Utils.data;var e=BX.Landing.Utils.attr;BX.Landing.Block.Node.Icon=function(t){BX.Landing.Block.Node.Img.apply(this,arguments);this.type="icon"};function s(t){var n=i(t.node,"data-pseudo-url");return!!n?n:""}function a(t){return t.node.className.split(" ")}function o(t,n){return BX.Landing.UI.Panel.IconPanel.getLibraries().then((function(i){i.forEach((function(n){n.categories.forEach((function(n){n.items.forEach((function(n){var i="";if(BX.Type.isObject(n)){i=n.options.join(" ")}else{i=n}var e=i.split(" ");e.forEach((function(n){if(n){t.node.classList.remove(n)}}))}))}))}));n.classList.forEach((function(n){t.node.classList.add(n)}))}))}BX.Landing.Block.Node.Icon.prototype={constructor:BX.Landing.Block.Node.Icon,__proto__:BX.Landing.Block.Node.Img.prototype,getField:function(){if(!this.field){var t=this.getValue();t.url=n(t.url);var i=!!this.node.closest("a");this.field=new BX.Landing.UI.Field.Icon({selector:this.selector,title:this.manifest.name,disableLink:i,content:t,dimensions:!!this.manifest.dimensions?this.manifest.dimensions:{}})}else{this.field.content=this.getValue()}return this.field},setValue:function(t,n,i){this.lastValue=this.lastValue||this.getValue();this.preventSave(n);return o(this,t).then(function(){if(t.url){const n=this.preparePseudoUrl(t.url);if(n!==null){e(this.node,"data-pseudo-url",n)}}this.onChange(i);if(!i){BX.Landing.History.getInstance().push()}this.lastValue=this.getValue()}.bind(this))},getValue:function(){return{type:"icon",src:"",id:-1,alt:"",classList:a(this),url:t(s(this))}}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:51:"/bitrix/js/landing/node/embed.min.js?16992580172431";s:6:"source";s:32:"/bitrix/js/landing/node/embed.js";s:3:"min";s:36:"/bitrix/js/landing/node/embed.min.js";s:3:"map";s:36:"/bitrix/js/landing/node/embed.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing");var e=BX.Landing.Utils.data;BX.Landing.Block.Node.Embed=function(e){BX.Landing.Block.Node.apply(this,arguments);this.type="embed";this.attribute=["data-src","data-source","data-preview"];this.onAttributeChangeHandler=e.onAttributeChange||function(){};this.lastValue=this.getValue();this.nodeContainer=this.node.closest(BX.Landing.Block.Node.Embed.CONTAINER_SELECTOR)};BX.Landing.Block.Node.Embed.CONTAINER_SELECTOR=".embed-responsive";BX.Landing.Block.Node.Embed.RATIO_CLASSES=["embed-responsive-16by9","embed-responsive-9by16","embed-responsive-4by3","embed-responsive-3by4","embed-responsive-21by9","embed-responsive-9by21","embed-responsive-1by1"];BX.Landing.Block.Node.Embed.DEFAULT_RATIO_V="embed-responsive-9by16";BX.Landing.Block.Node.Embed.DEFAULT_RATIO_H="embed-responsive-16by9";BX.Landing.Block.Node.Embed.prototype={constructor:BX.Landing.Block.Node.Embed,__proto__:BX.Landing.Block.Node.prototype,onChange:function(e){this.lastValue=this.getValue();this.onAttributeChangeHandler(this);this.onChangeHandler(this,e)},isChanged:function(){return JSON.stringify(this.getValue())!==JSON.stringify(this.lastValue)},getValue:function(){const n=this.nodeContainer?BX.Landing.Block.Node.Embed.RATIO_CLASSES.find((e=>this.nodeContainer.classList.contains(e))):"";return{src:this.node.src?this.node.src:e(this.node,"data-src"),source:e(this.node,"data-source"),preview:e(this.node,"data-preview"),ratio:n||""}},setValue:function(n,t,i){if(this.node.src){this.node.src=n.src}else{e(this.node,"data-src",n.src)}e(this.node,"data-source",n.source);if(n.preview){e(this.node,"data-preview",n.preview);this.node.style.backgroundImage='url("'+n.preview+'")'}else{e(this.node,"data-preview",null);this.node.style.backgroundImage=""}if(n.src&&n.ratio&&this.lastValue.src!==n.src&&BX.Landing.Block.Node.Embed.RATIO_CLASSES.indexOf(n.ratio)!==-1&&this.nodeContainer){BX.Landing.Block.Node.Embed.RATIO_CLASSES.forEach((e=>{n.ratio===e?BX.Dom.addClass(this.nodeContainer,e):BX.Dom.removeClass(this.nodeContainer,e)}))}if(this.isChanged()){if(!i){BX.Landing.History.getInstance().push()}this.onChange(i)}},getField:function(){const e={title:this.manifest.name,selector:this.selector,content:this.getValue()};if(BX.Dom.hasClass(this.node.parentNode,"bg-video__inner")){return new BX.Landing.UI.Field.EmbedBg(e)}return new BX.Landing.UI.Field.Embed(e)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:56:"/bitrix/js/landing/client/unsplash.min.js?16992580171537";s:6:"source";s:37:"/bitrix/js/landing/client/unsplash.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.Client");BX.Landing.Client.Unsplash=function(){if(BX.Landing.Client.Unsplash.instance){return BX.Landing.Client.Unsplash.instance}this.host="https://api.unsplash.com";this.clientId="2f2daddc0c0ea9983e1edd64ef83925faae6d6ab6bf35fe4eb64c2bcfc76fb75";this.perPage=31};BX.Landing.Client.Unsplash.getInstance=function(){return BX.Landing.Client.Unsplash.instance||(BX.Landing.Client.Unsplash.instance=new BX.Landing.Client.Unsplash)};BX.Landing.Client.Unsplash.prototype={makeUrl:function(n,e){e=typeof e==="object"?e:{};e.client_id=this.clientId;return BX.util.add_url_param(this.host+n,e)},download:function(n){var e=BX.util.add_url_param(n.links.download_location,{client_id:this.clientId});return new Promise(function(n){BX.ajax({url:e,method:"GET",headers:[{name:"Authorization",value:"Client-ID "+this.clientId}],onsuccess:function(e){try{var t=JSON.parse(e);n(t.url)}catch(e){n("");console.error(e)}}})}.bind(this))},request:function(n,e){return new Promise(function(t){BX.ajax({url:this.makeUrl(n,e),method:"GET",data:e,headers:[{name:"Authorization",value:"Client-ID "+this.clientId}],onsuccess:function(n){var e;try{e=JSON.parse(n);e="results"in e?e.results:e}catch(n){e=[];console.error(n)}t(e)}})}.bind(this))},popular:function(n){n=BX.type.isNumber(n)?n:1;return this.request("/photos",{order_by:"popular",per_page:this.perPage,page:n})},search:function(n,e){e=BX.type.isNumber(e)?e:1;return this.request("/search/photos",{per_page:this.perPage,page:e,query:encodeURI(n)})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:61:"/bitrix/js/landing/client/google_images.min.js?16992580171041";s:6:"source";s:42:"/bitrix/js/landing/client/google_images.js";s:3:"min";s:46:"/bitrix/js/landing/client/google_images.min.js";s:3:"map";s:46:"/bitrix/js/landing/client/google_images.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.Client");BX.Landing.Client.Google=function(){this.host="https://www.googleapis.com/customsearch/v1"};BX.Landing.Client.Google.getInstance=function(){return BX.Landing.Client.Google.instance||(BX.Landing.Client.Google.instance=new BX.Landing.Client.Google)};BX.Landing.Client.Google.prototype={makeUrl:function(e){e=typeof e==="object"?e:{};e.key=BX.Landing.Client.Google.key;e.searchType="image";e.rights="cc_attributte";e.imgSize="xxlarge";e.cx="001784514362171586730:5nd_tu8dtbw";e.safe="medium";e.imgType="photo";e.filter="1";e.num="10";return BX.util.add_url_param(this.host,e)},request:function(e){return new Promise(function(t,n){BX.ajax({url:this.makeUrl(e),method:"GET",data:e,onsuccess:function(e){var i,o;try{i=JSON.parse(e);i="items"in i?i.items:[]}catch(e){i=[];console.error(e);n(e);o=true}if(!o){t(i)}},onfailure:n})}.bind(this))},search:function(e,t){t=(BX.type.isNumber(t)?t:1)*10;return this.request({start:t,q:encodeURI(e)})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:60:"/bitrix/js/landing/client/google_fonts.min.js?16992580171141";s:6:"source";s:41:"/bitrix/js/landing/client/google_fonts.js";s:3:"min";s:45:"/bitrix/js/landing/client/google_fonts.min.js";s:3:"map";s:45:"/bitrix/js/landing/client/google_fonts.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.Client");var n=BX.Landing.Utils.isEmpty;var t=BX.Landing.Utils.clone;BX.Landing.Client.GoogleFonts=function(){this.key="AIzaSyCqOG-HakgzOQh9prxtkuWLA16lnkNZvsg";this.patch="https://www.googleapis.com/webfonts/v1/webfonts?sort=popularity&key=";this.fontUrl="https://";this.fontUrl+=window.fontsProxyUrl||"fonts.googleapis.com";this.fontUrl+="/css2";this.response={}};BX.Landing.Client.GoogleFonts.getInstance=function(){return BX.Landing.Client.GoogleFonts.instance||(BX.Landing.Client.GoogleFonts.instance=new BX.Landing.Client.GoogleFonts)};BX.Landing.Client.GoogleFonts.prototype={getList:function(){if(!n(this.response)){return Promise.resolve(t(this.response))}return this.request().then(function(n){this.response=n;return t(this.response)}.bind(this))},request:function(){return new Promise(function(n){BX.ajax({url:this.patch+this.key,method:"GET",onsuccess:function(t){var s;try{s=JSON.parse(t);s="items"in s?s.items:s}catch(n){s=[];console.error(n)}n(s)}})}.bind(this))},makeUrl:function(n){return BX.util.add_url_param(this.fontUrl,n)}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:71:"/bitrix/js/landing/mediaservice/base_mediaservice.min.js?16992580172709";s:6:"source";s:52:"/bitrix/js/landing/mediaservice/base_mediaservice.js";s:3:"min";s:56:"/bitrix/js/landing/mediaservice/base_mediaservice.min.js";s:3:"map";s:56:"/bitrix/js/landing/mediaservice/base_mediaservice.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");var e=BX.Landing.Utils.isArray;BX.Landing.MediaService.BaseMediaService=function(e,t){if(typeof e!=="string"){throw new TypeError("URL not a string")}this.url=encodeURI(e);this.settings=t||{};this.matcher=new RegExp("//");this.embedURL="";this.idPlace=0;this.type="iframe";this.params={};this.isDataLoaded=true;this.isBgVideoMode=false;this.isVertical=false};BX.Landing.MediaService.BaseMediaService.prototype={getMediaId:function(){return this.url.match(this.matcher)[this.idPlace]},getUserSettings:function(){var t={};var i=this.getSettingsForm();if(i){t=i.fields.fetchValues();Object.keys(t).forEach((function(i){if(e(t[i])){t[i]=encodeURIComponent(t[i].join(", "))}}))}return t},getSettings:function(){return BX.util.objectMerge(BX.clone(this.params),BX.Landing.Utils.getQueryParams(this.url),BX.clone(this.settings))},getEmbedURL:function(){var e=this.embedURL;var t=this.url.match(this.matcher);if(typeof this.embedURL==="string"){[].slice.call(t).forEach((function(t,i){e=e.replace(new RegExp("\\$"+i,"g"),t)}));var i=BX.util.objectMerge(this.getSettings(),this.getUserSettings());e=BX.util.add_url_param(e,i)}if(typeof this.embedURL==="function"){e=this.embedURL(t)}return e},getEmbedPreview:function(){var e=this.previewURL;var t=this.url.match(this.matcher);if(typeof this.previewURL==="string"){[].slice.call(t).forEach((function(t,i){e=e.replace(new RegExp("\\$"+i,"g"),t)}));return e}else if(typeof this.previewURL==="function"){return this.previewURL(t)}return false},getEmbedElement:function(){return BX.create("iframe",{attrs:{src:this.getEmbedURL(),frameborder:"0",gesture:"media",allow:"encrypted-media",allowfullscreen:true}})},getURLPreview:function(){return BX.Landing.Utils.getURLPreview(this.url)},getURLPreviewElement:function(){return this.getURLPreview().then(function(e){var t=e.DESCRIPTION;var i=e.TITLE;if(i.length+t.length>120){if(i.length>120){t="";i=i.slice(0,120)+"..."}else if(i.length+t.length>120){t=t.slice(0,t.length-(i.length+t.length-120))+"..."}}return BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview"},children:[BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview-image"},attrs:{style:'background-image: url("'+e.IMAGE+'")'}}),BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview-text"},children:[BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview-text-title"},text:i}),BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview-text-description"},text:t})]})]})}.bind(this))},getSettingsForm:function(){return null},setBgVideoMode(e){this.isBgVideoMode=!!e}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:74:"/bitrix/js/landing/mediaservice/youtube_mediaservice.min.js?16992580173285";s:6:"source";s:55:"/bitrix/js/landing/mediaservice/youtube_mediaservice.js";s:3:"min";s:59:"/bitrix/js/landing/mediaservice/youtube_mediaservice.min.js";s:3:"map";s:59:"/bitrix/js/landing/mediaservice/youtube_mediaservice.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.Youtube=function(e,i){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.youtube;this.embedURL="//www.youtube.com/embed/$6";this.previewURL="//img.youtube.com/vi/$6/sddefault.jpg";this.loadEmbedInfo();this.idPlace=6;this.params={autoplay:0,controls:1,loop:0,mute:0,rel:0,start:0,html5:1}};BX.Landing.MediaService.Youtube.validate=function(e){return BX.Landing.Utils.Matchers.youtube.test(e)};BX.Landing.MediaService.Youtube.prototype={constructor:BX.Landing.MediaService.Youtube,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var e=this.getSettings();this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_AUTOPLAY"),description:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_AUTOPLAY_DESC_NEW"),selector:"autoplay",content:!this.isBgVideoMode?parseInt(e.autoplay):1,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}],onChange:!this.isBgVideoMode?n:()=>{},disabled:this.isBgVideoMode}));function n(e){if(e===1){i.setValue(1);i.disable();if(!i.descriptionText){i.setDescription(BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_SOUND_ALERT"))}}else if(e===0){i.removeDescription();i.enable();i.setValue(0)}}var i=new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_SOUND"),selector:"mute",content:!this.isBgVideoMode?parseInt(e.mute):1,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:0},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:1}],disabled:this.isBgVideoMode});this.form.addField(i);this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_CONTROLS"),selector:"controls",content:!this.isBgVideoMode?parseInt(e.controls):0,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}],disabled:this.isBgVideoMode}));this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_LOOP"),selector:"loop",content:!this.isBgVideoMode?parseInt(e.loop):1,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}],disabled:this.isBgVideoMode}));var t=new BX.Landing.UI.Field.Unit({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_START"),selector:"start",unit:BX.Landing.Loc.getMessage("LANDING_CONTENT_MEDIA_SECONDS_SHORT"),content:parseInt(e.start),placeholder:"40"});this.form.addField(t);if(!this.isBgVideoMode){n(parseInt(e.autoplay))}}return this.form},loadEmbedInfo:function(){const e="https://www.youtube.com/oembed?format=json&url="+this.url;BX.ajax({url:e,method:"GET",dataType:"json",onsuccess:e=>{if(e.height&&e.width&&e.height>e.width){this.isVertical=true}if(e.thumbnail_url){this.previewURL=e.thumbnail_url}}})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:72:"/bitrix/js/landing/mediaservice/rutube_mediaservice.min.js?1699258017971";s:6:"source";s:54:"/bitrix/js/landing/mediaservice/rutube_mediaservice.js";s:3:"min";s:58:"/bitrix/js/landing/mediaservice/rutube_mediaservice.min.js";s:3:"map";s:58:"/bitrix/js/landing/mediaservice/rutube_mediaservice.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.Rutube=function(e,t){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.rutube;this.embedURL="//rutube.ru/play/embed/$2";this.idPlace=2;this.params={t:0}};BX.Landing.MediaService.Rutube.validate=function(e){return BX.Landing.Utils.Matchers.rutube.test(e)};BX.Landing.MediaService.Rutube.prototype={constructor:BX.Landing.MediaService.Rutube,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var e=this.getSettings();var t=new BX.Landing.UI.Field.Unit({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_START"),unit:BX.Landing.Loc.getMessage("LANDING_CONTENT_MEDIA_SECONDS_SHORT"),selector:"t",content:parseInt(e.t),placeholder:"40"});this.form.addField(t)}return this.form}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:69:"/bitrix/js/landing/mediaservice/vk_mediaservice.min.js?16992580173055";s:6:"source";s:50:"/bitrix/js/landing/mediaservice/vk_mediaservice.js";s:3:"min";s:54:"/bitrix/js/landing/mediaservice/vk_mediaservice.min.js";s:3:"map";s:54:"/bitrix/js/landing/mediaservice/vk_mediaservice.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.Vk=function(e,t){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.vk;this.isDataLoaded=false;this.embedInfoLoader=this.loadEmbedInfo();this.embedInfoLoader.then((e=>{this.isDataLoaded=true;BX.onCustomEvent(this,"onDataLoaded")})).catch((e=>{BX.onCustomEvent(this,"onDataLoadError",[{message:e}])}));this.embedInfo=null;this.embedURL=()=>{if(this.embedInfo){const e=BX.util.objectMerge(this.getSettings(),this.getUserSettings());if(this.isAnotherService()&&e.autoplay==1){e.mute=1}this.embedInfo.embedUrl=BX.util.add_url_param(this.embedInfo.embedUrl,e)}return this.embedInfo?this.embedInfo["embedUrl"]:""};this.previewURL=()=>this.embedInfo?this.embedInfo["preview"]:"";this.idPlace=3;this.params={autoplay:0}};BX.Landing.MediaService.Vk.validate=function(e){return BX.Landing.Utils.Matchers.vk.test(e)};BX.Landing.MediaService.Vk.prototype={constructor:BX.Landing.MediaService.Vk,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var e=this.getSettings();this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_AUTOPLAY"),description:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_AUTOPLAY_DESC_NEW"),selector:"autoplay",content:!this.isBgVideoMode?parseInt(e.autoplay):1,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}],disabled:this.isBgVideoMode}))}return this.form},loadEmbedInfo:function(){const e=BX.Landing.Backend.getInstance();return e.action("Vk::isAuthorized").then((t=>{if(!t){return e.action("Vk::getAuthUrl").then((e=>new Promise((t=>{BX.addCustomEvent(window,"seo-client-auth-result",(e=>{e.reload=false;t()}));BX.util.popup(e,800,600)}))))}return Promise.resolve()})).then((()=>{const t=this.url.match(this.matcher);if(t&&t.length){const i=t[this.idPlace];return e.action("Vk::getVideoInfo",{videoId:i}).then((e=>{this.embedInfo={embedUrl:e.player,preview:e.preview.url};this.isAnotherService(this.embedInfo.embedUrl);{this.convertToAnotherService(this.embedInfo.embedUrl)}return this.embedInfo})).catch((e=>{if(e.type==="error"&&BX.Type.isArray(e.result)){const t=[];e.result.forEach((e=>{t.push(e.error_description)}));return Promise.reject(t.join(". "))}}))}return Promise.reject("Wrong VK video url")}))},isAnotherService:function(){return BX.Landing.Utils.Matchers.youtube.test(this.embedInfo.embedUrl)},convertToAnotherService:function(){const e=this.embedInfo.embedUrl;if(BX.Landing.Utils.Matchers.youtube.test(e)){const t=e.match(BX.Landing.Utils.Matchers.youtube)[4];this.url="https://www.youtube.com/watch?v="+t}},getURLPreview:function(){return this.embedInfoLoader.then((()=>BX.Landing.Utils.getURLPreview(this.url))).then((e=>{e.IMAGE=this.embedInfo.preview;return e}))}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:72:"/bitrix/js/landing/mediaservice/vimeo_mediaservice.min.js?16992580172897";s:6:"source";s:53:"/bitrix/js/landing/mediaservice/vimeo_mediaservice.js";s:3:"min";s:57:"/bitrix/js/landing/mediaservice/vimeo_mediaservice.min.js";s:3:"map";s:57:"/bitrix/js/landing/mediaservice/vimeo_mediaservice.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.Vimeo=function(e,a){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.vimeo;this.embedURL="//player.vimeo.com/video/$2";this.idPlace=3;this.params={autoplay:1,loop:0,hd:1,muted:0,background:0,show_title:1,show_byline:1,show_portrait:0,fullscreen:1,api:1}};BX.Landing.MediaService.Vimeo.validate=function(e){return BX.Landing.Utils.Matchers.vimeo.test(e)};BX.Landing.MediaService.Vimeo.prototype={constructor:BX.Landing.MediaService.Vimeo,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var e=this.getSettings();this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_AUTOPLAY"),selector:"autoplay",content:parseInt(e.autoplay),items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}],onChange:a}));function a(e){if(e===1){n.setValue(1);n.disable();if(!n.descriptionText){n.setDescription(BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_SOUND_ALERT"))}}else if(e===0){n.removeDescription();n.enable();n.setValue(0)}}var n=new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_SOUND"),selector:"muted",content:e.muted,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:0},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:1}]});this.form.addField(n);a(parseInt(e.autoplay));this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_CONTROLS"),selector:"background",content:parseInt(e.background),items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:0},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:1}]}));this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_QUALITY"),selector:"quality",content:e.quality,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_QUALITY_AUTO"),value:""},{name:"4k ("+BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_QUALITY_HIGH")+")",value:"4k"},{name:"2k",value:"2k"},{name:"1080p",value:"1080p"},{name:"780p",value:"780p"},{name:"360p ("+BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_QUALITY_LOW")+")",value:"360p"}]}));this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_LOOP"),selector:"loop",content:e.loop,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}]}))}return this.form}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:71:"/bitrix/js/landing/mediaservice/vine_mediaservice.min.js?16992580171047";s:6:"source";s:52:"/bitrix/js/landing/mediaservice/vine_mediaservice.js";s:3:"min";s:56:"/bitrix/js/landing/mediaservice/vine_mediaservice.min.js";s:3:"map";s:56:"/bitrix/js/landing/mediaservice/vine_mediaservice.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.Vine=function(e,i){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.vine;this.embedURL="//vine.co/v/$1/embed/simple";this.idPlace=1;this.params={autoplay:1}};BX.Landing.MediaService.Vine.validate=function(e){return BX.Landing.Utils.Matchers.vine.test(e)};BX.Landing.MediaService.Vine.prototype={constructor:BX.Landing.MediaService.Vine,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var e=this.getSettings();this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_AUTOPLAY"),selector:"autoplay",content:parseInt(e.autoplay),items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}]}))}return this.form}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:76:"/bitrix/js/landing/mediaservice/instagram_mediaservice.min.js?16992580171215";s:6:"source";s:57:"/bitrix/js/landing/mediaservice/instagram_mediaservice.js";s:3:"min";s:61:"/bitrix/js/landing/mediaservice/instagram_mediaservice.min.js";s:3:"map";s:61:"/bitrix/js/landing/mediaservice/instagram_mediaservice.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.Instagram=function(e,i){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.instagram;this.embedURL="//instagram.com/p/$2/embed/captioned";this.idPlace=1;this.params={}};BX.Landing.MediaService.Instagram.validate=function(e){return BX.Landing.Utils.Matchers.instagram.test(e)};BX.Landing.MediaService.Instagram.prototype={constructor:BX.Landing.MediaService.Instagram,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_CAPTIONED"),selector:"captioned",items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}],onChange:function(e){if(e===1){if(this.embedURL.indexOf("captioned")===-1){this.embedURL=this.embedURL+"captioned"}}else{this.embedURL=this.embedURL.replace("captioned","")}}.bind(this)}))}return this.form}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:85:"/bitrix/js/landing/mediaservice/google_maps_search_mediaservice.min.js?16992580171169";s:6:"source";s:66:"/bitrix/js/landing/mediaservice/google_maps_search_mediaservice.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.GoogleMapsSearch=function(e,i){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.googleMapsSearch;this.embedURL=function(e){var i="";if(e[5]){i=e[5].replace("query=","q=").replace("api=1","")}else if(e[9]){i=e[9]}return"//maps.google."+e[2]+"/maps?q="+i+"&output=embed"}};BX.Landing.MediaService.GoogleMapsSearch.validate=function(e){return BX.Landing.Utils.Matchers.googleMapsSearch.test(e)};BX.Landing.MediaService.GoogleMapsSearch.prototype={constructor:BX.Landing.MediaService.GoogleMapsSearch,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getURLPreviewElement:function(){return new Promise(function(e){var i='<span class="fa fa-map"></span>&nbsp;Google Maps';setTimeout(function(){e(BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview landing-ui-mediaservice-url-preview-map"},children:[BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview-text"},children:[BX.create("div",{props:{className:"landing-ui-mediaservice-url-preview-text-title"},html:i})]})]}))},400)})}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:83:"/bitrix/js/landing/mediaservice/google_maps_place_mediaservice.min.js?1699258017828";s:6:"source";s:65:"/bitrix/js/landing/mediaservice/google_maps_place_mediaservice.js";s:3:"min";s:0:"";s:3:"map";s:0:"";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.GoogleMapsPlace=function(e,a){BX.Landing.MediaService.GoogleMapsSearch.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.googleMapsPlace;this.embedURL=function(e){var a="//maps.google."+e[2]+"/?ll="+(e[9]?e[9]+"&z="+Math.floor(e[10])+(e[12]?e[12].replace(/^\//,"&"):""):e[12])+"&output="+(e[12]&&e[12].indexOf("layer=c")>0?"svembed":"embed");if(e[8]){a="//maps.google."+e[2]+"/maps?q="+decodeURI(decodeURI(e[8]))+"&output=embed"}return a}};BX.Landing.MediaService.GoogleMapsPlace.validate=function(e){return BX.Landing.Utils.Matchers.googleMapsPlace.test(e)};BX.Landing.MediaService.GoogleMapsPlace.prototype={constructor:BX.Landing.MediaService.GoogleMapsPlace,__proto__:BX.Landing.MediaService.GoogleMapsSearch.prototype}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:82:"/bitrix/js/landing/mediaservice/facebook_page_plugin_service.min.js?16992580172767";s:6:"source";s:63:"/bitrix/js/landing/mediaservice/facebook_page_plugin_service.js";s:3:"min";s:67:"/bitrix/js/landing/mediaservice/facebook_page_plugin_service.min.js";s:3:"map";s:67:"/bitrix/js/landing/mediaservice/facebook_page_plugin_service.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");var e=BX.Landing.Utils.isString;BX.Landing.MediaService.FacebookPages=function(e,a){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.facebookPages;this.pageUrl=encodeURIComponent(e.replace(/\/$/,""));this.embedURL="https://www.facebook.com/plugins/page.php?href="+this.pageUrl;this.params={tabs:"timeline",width:340,small_header:false,adapt_container_width:true,hide_cover:false,show_facepile:true}};BX.Landing.MediaService.FacebookPages.validate=function(e){if(e.endsWith&&(e.endsWith("facebook.com/")||e.endsWith("facebook.com"))){return false}return BX.Landing.Utils.Matchers.facebookPages.test(e)};BX.Landing.MediaService.FacebookPages.prototype={constructor:BX.Landing.MediaService.FacebookPages,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var a=this.getSettings();this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_PAGE_SMALL_HEADER"),selector:"small_header",content:a.small_header==="true"||a.small_header===true,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:true},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:false}]}));this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_PAGE_COVER"),selector:"hide_cover",content:a.hide_cover==="true"||a.hide_cover===true,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:false},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:true}]}));this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_PAGE_FACES"),selector:"show_facepile",content:a.show_facepile==="true"||a.show_facepile===true,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:true},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:false}]}));var i=[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_PAGE_TABS_TIMELINE"),value:"timeline"},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_PAGE_TABS_MESSAGES"),value:"messages"},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_PAGE_TABS_EVENTS"),value:"events"}];var t=e(a.tabs)?a.tabs.split(", "):[];if(t.length){i.forEach(function(e){e.selected=t.includes(e.value)})}this.form.addField(new BX.Landing.UI.Field.MultiSelect({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_PAGE_TABS"),selector:"tabs",value:t,items:i}))}return this.form}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:81:"/bitrix/js/landing/mediaservice/facebook_post_embed_service.min.js?16992580171228";s:6:"source";s:62:"/bitrix/js/landing/mediaservice/facebook_post_embed_service.js";s:3:"min";s:66:"/bitrix/js/landing/mediaservice/facebook_post_embed_service.min.js";s:3:"map";s:66:"/bitrix/js/landing/mediaservice/facebook_post_embed_service.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.FacebookPosts=function(e,t){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.facebookPosts;this.pageUrl=encodeURIComponent(e.replace(/\/$/,""));this.embedURL="https://www.facebook.com/plugins/post.php?href="+this.pageUrl;this.params={width:500,show_text:true}};BX.Landing.MediaService.FacebookPosts.validate=function(e){return BX.Landing.Utils.Matchers.facebookPosts.test(e)};BX.Landing.MediaService.FacebookPosts.prototype={constructor:BX.Landing.MediaService.FacebookPosts,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var e=this.getSettings();this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_POST_FULL"),selector:"show_text",content:e.show_text==="true"||e.show_text===true,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:true},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:false}]}))}return this.form}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:82:"/bitrix/js/landing/mediaservice/facebook_video_embed_service.min.js?16992580171239";s:6:"source";s:63:"/bitrix/js/landing/mediaservice/facebook_video_embed_service.js";s:3:"min";s:67:"/bitrix/js/landing/mediaservice/facebook_video_embed_service.min.js";s:3:"map";s:67:"/bitrix/js/landing/mediaservice/facebook_video_embed_service.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.FacebookVideos=function(e,i){BX.Landing.MediaService.BaseMediaService.apply(this,arguments);this.matcher=BX.Landing.Utils.Matchers.facebookVideos;this.pageUrl=encodeURIComponent(e.replace(/\/$/,""));this.embedURL="https://www.facebook.com/plugins/video.php?href="+this.pageUrl;this.params={width:500,show_text:0}};BX.Landing.MediaService.FacebookVideos.validate=function(e){return BX.Landing.Utils.Matchers.facebookVideos.test(e)};BX.Landing.MediaService.FacebookVideos.prototype={constructor:BX.Landing.MediaService.FacebookVideos,__proto__:BX.Landing.MediaService.BaseMediaService.prototype,getSettingsForm:function(){if(!this.form){this.form=new BX.Landing.UI.Form.BaseForm;var e=this.getSettings();this.form.addField(new BX.Landing.UI.Field.Dropdown({title:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_FB_POST_FULL"),selector:"show_text",content:!isNaN(parseInt(e.show_text))?parseInt(e.show_text):0,items:[{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_YES"),value:1},{name:BX.Landing.Loc.getMessage("LANDING_CONTENT_URL_MEDIA_NO"),value:0}]}))}return this.form}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:68:"/bitrix/js/landing/mediaservice/service_factory.min.js?1699258017847";s:6:"source";s:50:"/bitrix/js/landing/mediaservice/service_factory.js";s:3:"min";s:54:"/bitrix/js/landing/mediaservice/service_factory.min.js";s:3:"map";s:54:"/bitrix/js/landing/mediaservice/service_factory.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing.MediaService");BX.Landing.MediaService.Factory=function(){};BX.Landing.MediaService.Factory.prototype={services:{youtube:"BX.Landing.MediaService.Youtube",rutube:"BX.Landing.MediaService.Rutube",vk:"BX.Landing.MediaService.Vk",vimeo:"BX.Landing.MediaService.Vimeo",vine:"BX.Landing.MediaService.Vine",instagram:"BX.Landing.MediaService.Instagram",facebookVideos:"BX.Landing.MediaService.FacebookVideos",facebookPosts:"BX.Landing.MediaService.FacebookPosts"},create:function(e,i){const n=this.getRelevantClass(e);if(n){return new n(e,i)}return null},getRelevantClass:function(e){let i=null;for(let n in this.services){if(this.services.hasOwnProperty(n)&&BX.getClass(this.services[n])["validate"](e)){i=BX.getClass(this.services[n]);break}}return i}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:54:"/bitrix/js/landing/error_manager.min.js?16992580222325";s:6:"source";s:35:"/bitrix/js/landing/error_manager.js";s:3:"min";s:39:"/bitrix/js/landing/error_manager.min.js";s:3:"map";s:39:"/bitrix/js/landing/error_manager.map.js";}"*/
(function(){"use strict";BX.namespace("BX.Landing");var n=BX.Landing.Utils.clone;var e={"Landing::addBlock":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__ADD_BLOCK"),"Landing::deleteBlock":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__DELETE_BLOCK"),"Landing::upBlock":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__SAVE_CHANGES"),"Landing::downBlock":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__SAVE_CHANGES"),"Landing::showBlock":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__SAVE_CHANGES"),"Landing::hideBlock":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__SAVE_CHANGES"),"Block::cloneCard":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__CLONE_CARD"),"Block::removeCard":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__DELETE_CARD"),"Block::updateStyles":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__SAVE_CHANGES"),"Block::updateNodes":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__SAVE_CHANGES"),"Site::getList":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__SITE_GET_LIST"),"Block::getList":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__BLOCK_GET_LIST"),"Utils::uploadFile":BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__UPLOAD_FILE"),UNKNOWN_ACTION:BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__UNKNOWN_ACTION"),BAD_IMAGE:BX.Landing.Loc.getMessage("LANDING_ACTION_ERROR__BAD_IMAGE")};BX.Landing.ErrorManager=function(){this.stack=[];this.showTimeout=null};BX.Landing.ErrorManager.getInstance=function(){var n=BX.Landing.PageObject.getRootWindow();if(!n.BX.Landing.ErrorManager.instance){n.BX.Landing.ErrorManager.instance=new BX.Landing.ErrorManager}return n.BX.Landing.ErrorManager.instance};BX.Landing.ErrorManager.prototype={add:function(n){if(n.type==="error"){n.action=n.action in e?n.action:"UNKNOWN_ACTION";this.stack.push({action:n.action,description:e[n.action],hideSupportLink:n.hideSupportLink});return this.show()}},show:function(){clearTimeout(this.showTimeout);this.showTimeout=setTimeout(function(){var e=n(this.stack);this.stack=[];var a=e.map(this.createErrorMessage,this).join("");var i=e.some(function(n){return n.hideSupportLink===true});BX.Landing.UI.Panel.Alert.getInstance().show("error",a,i)}.bind(this),100)},createErrorMessage:function(n){return'<div class="landing-ui-error-item">'+n.description+"</div>"}}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:86:"/bitrix/js/landing/external/webfontloader/webfontloader_landing.min.js?169925801712558";s:6:"source";s:66:"/bitrix/js/landing/external/webfontloader/webfontloader_landing.js";s:3:"min";s:70:"/bitrix/js/landing/external/webfontloader/webfontloader_landing.min.js";s:3:"map";s:70:"/bitrix/js/landing/external/webfontloader/webfontloader_landing.map.js";}"*/
(function(){function t(t,n,i){return t.call.apply(t.bind,arguments)}function n(t,n,i){if(!t)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(i,e);return t.apply(n,i)}}return function(){return t.apply(n,arguments)}}function i(e,o,a){i=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?t:n;return i.apply(null,arguments)}var e=Date.now||function(){return+new Date};function o(t,n){this.a=t;this.m=n||t;this.c=this.m.document}var a=!!window.FontFace;function s(t,n,i,e){n=t.c.createElement(n);if(i)for(var o in i)i.hasOwnProperty(o)&&("style"==o?n.style.cssText=i[o]:n.setAttribute(o,i[o]));e&&n.appendChild(t.c.createTextNode(e));return n}function r(t,n,i){t=t.c.getElementsByTagName(n)[0];t||(t=document.documentElement);t.insertBefore(i,t.lastChild)}function f(t){t.parentNode&&t.parentNode.removeChild(t)}function c(t,n,i){n=n||[];i=i||[];for(var e=t.className.split(/\s+/),o=0;o<n.length;o+=1){for(var a=!1,s=0;s<e.length;s+=1)if(n[o]===e[s]){a=!0;break}a||e.push(n[o])}n=[];for(o=0;o<e.length;o+=1){a=!1;for(s=0;s<i.length;s+=1)if(e[o]===i[s]){a=!0;break}a||n.push(e[o])}t.className=n.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function h(t,n){for(var i=t.className.split(/\s+/),e=0,o=i.length;e<o;e++)if(i[e]==n)return!0;return!1}function l(t){if("string"===typeof t.f)return t.f;var n=t.m.location.protocol;"about:"==n&&(n=t.a.location.protocol);return"https:"==n?"https:":"http:"}function u(t){return t.m.location.hostname||t.a.location.hostname}function p(t,n,i){function e(){h&&o&&f&&(h(c),h=null)}n=s(t,"link",{rel:"stylesheet",href:n,media:"all"});var o=!1,f=!0,c=null,h=i||null;a?(n.onload=function(){o=!0;e()},n.onerror=function(){o=!0;c=Error("Stylesheet failed to load");e()}):setTimeout((function(){o=!0;e()}),0);r(t,"head",n)}function d(t,n,i,e){var o=t.c.getElementsByTagName("head")[0];if(o){var a=s(t,"script",{src:n}),r=!1;a.onload=a.onreadystatechange=function(){r||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(r=!0,i&&i(null),a.onload=a.onreadystatechange=null,"HEAD"==a.parentNode.tagName&&o.removeChild(a))};o.appendChild(a);setTimeout((function(){r||(r=!0,i&&i(Error("Script load timeout")))}),e||5e3);return a}return null}function g(){this.a=0;this.c=null}function v(t){t.a++;return function(){t.a--;m(t)}}function w(t,n){t.c=n;m(t)}function m(t){0==t.a&&t.c&&(t.c(),t.c=null)}function y(t){this.a=t||"-"}y.prototype.c=function(t){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return n.join(this.a)};function b(t,n){this.c=t;this.f=4;this.a="n";var i=(n||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function x(t){return k(t)+" "+(t.f+"00")+" 300px "+j(t.c)}function j(t){var n=[];t=t.split(/,\s*/);for(var i=0;i<t.length;i++){var e=t[i].replace(/['"]/g,"");-1!=e.indexOf(" ")||/^\d/.test(e)?n.push("'"+e+"'"):n.push(e)}return n.join(",")}function _(t){return t.a+t.f}function k(t){var n="normal";"o"===t.a?n="oblique":"i"===t.a&&(n="italic");return n}function T(t){var n=4,i="n",e=null;t&&((e=t.match(/(normal|oblique|italic)/i))&&e[1]&&(i=e[1].substr(0,1).toLowerCase()),(e=t.match(/([1-9]00|normal|bold)/i))&&e[1]&&(/bold/i.test(e[1])?n=7:/[1-9]00/.test(e[1])&&(n=parseInt(e[1].substr(0,1),10))));return i+n}function S(t,n){this.c=t;this.f=t.m.document.documentElement;this.h=n;this.a=new y("-");this.j=!1!==n.events;this.g=!1!==n.classes}function C(t){t.g&&c(t.f,[t.a.c("wf","loading")]);A(t,"loading")}function N(t){if(t.g){var n=h(t.f,t.a.c("wf","active")),i=[],e=[t.a.c("wf","loading")];n||i.push(t.a.c("wf","inactive"));c(t.f,i,e)}A(t,"inactive")}function A(t,n,i){if(t.j&&t.h[n])if(i)t.h[n](i.c,_(i));else t.h[n]()}function E(){this.c={}}function W(t,n,i){var e=[],o;for(o in n)if(n.hasOwnProperty(o)){var a=t.c[o];a&&e.push(a(n[o],i))}return e}function F(t,n){this.c=t;this.f=n;this.a=s(this.c,"span",{"aria-hidden":"true"},this.f)}function I(t){r(t.c,"body",t.a)}function P(t){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+j(t.c)+";"+("font-style:"+k(t)+";font-weight:"+(t.f+"00")+";")}function B(t,n,i,e,o,a){this.g=t;this.j=n;this.a=e;this.c=i;this.f=o||3e3;this.h=a||void 0}B.prototype.start=function(){var t=this.c.m.document,n=this,i=e(),o=new Promise((function(o,a){function s(){e()-i>=n.f?a():t.fonts.load(x(n.a),n.h).then((function(t){1<=t.length?o():setTimeout(s,25)}),(function(){a()}))}s()})),a=new Promise((function(t,i){setTimeout(i,n.f)}));Promise.race([a,o]).then((function(){n.g(n.a)}),(function(){n.j(n.a)}))};function O(t,n,i,e,o,a,s){this.v=t;this.B=n;this.c=i;this.a=e;this.s=s||"BESbswy";this.f={};this.w=o||3e3;this.u=a||null;this.o=this.j=this.h=this.g=null;this.g=new F(this.c,this.s);this.h=new F(this.c,this.s);this.j=new F(this.c,this.s);this.o=new F(this.c,this.s);t=new b(this.a.c+",serif",_(this.a));t=P(t);this.g.a.style.cssText=t;t=new b(this.a.c+",sans-serif",_(this.a));t=P(t);this.h.a.style.cssText=t;t=new b("serif",_(this.a));t=P(t);this.j.a.style.cssText=t;t=new b("sans-serif",_(this.a));t=P(t);this.o.a.style.cssText=t;I(this.g);I(this.h);I(this.j);I(this.o)}var L={D:"serif",C:"sans-serif"},D=null;function $(){if(null===D){var t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);D=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))}return D}O.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f["sans-serif"]=this.o.a.offsetWidth;this.A=e();H(this)};function q(t,n,i){for(var e in L)if(L.hasOwnProperty(e)&&n===t.f[L[e]]&&i===t.f[L[e]])return!0;return!1}function H(t){var n=t.g.a.offsetWidth,i=t.h.a.offsetWidth,o;(o=n===t.f.serif&&i===t.f["sans-serif"])||(o=$()&&q(t,n,i));o?e()-t.A>=t.w?$()&&q(t,n,i)&&(null===t.u||t.u.hasOwnProperty(t.a.c))?U(t,t.v):U(t,t.B):M(t):U(t,t.v)}function M(t){setTimeout(i((function(){H(this)}),t),50)}function U(t,n){setTimeout(i((function(){f(this.g.a);f(this.h.a);f(this.j.a);f(this.o.a);n(this.a)}),t),0)}function z(t,n,i){this.c=t;this.a=n;this.f=0;this.o=this.j=!1;this.s=i}var G=null;z.prototype.g=function(t){var n=this.a;n.g&&c(n.f,[n.a.c("wf",t.c,_(t).toString(),"active")],[n.a.c("wf",t.c,_(t).toString(),"loading"),n.a.c("wf",t.c,_(t).toString(),"inactive")]);A(n,"fontactive",t);this.o=!0;K(this)};z.prototype.h=function(t){var n=this.a;if(n.g){var i=h(n.f,n.a.c("wf",t.c,_(t).toString(),"active")),e=[],o=[n.a.c("wf",t.c,_(t).toString(),"loading")];i||e.push(n.a.c("wf",t.c,_(t).toString(),"inactive"));c(n.f,e,o)}A(n,"fontinactive",t);K(this)};function K(t){0==--t.f&&t.j&&(t.o?(t=t.a,t.g&&c(t.f,[t.a.c("wf","active")],[t.a.c("wf","loading"),t.a.c("wf","inactive")]),A(t,"active")):N(t.a))}function R(t){this.j=t;this.a=new E;this.h=0;this.f=this.g=!0}R.prototype.load=function(t){this.c=new o(this.j,t.context||this.j);this.g=!1!==t.events;this.f=!1!==t.classes;Q(this,new S(this.c,t),t)};function J(t,n,e,o,a){var s=0==--t.h;(t.f||t.g)&&setTimeout((function(){var t=a||null,r=o||null||{};if(0===e.length&&s)N(n.a);else{n.f+=e.length;s&&(n.j=s);var f,h=[];for(f=0;f<e.length;f++){var l=e[f],u=r[l.c],p=n.a,d=l;p.g&&c(p.f,[p.a.c("wf",d.c,_(d).toString(),"loading")]);A(p,"fontloading",d);p=null;null===G&&(G=window.FontFace?(d=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent))?42<parseInt(d[1],10):!0:!1);G?p=new B(i(n.g,n),i(n.h,n),n.c,l,n.s,u):p=new O(i(n.g,n),i(n.h,n),n.c,l,n.s,t,u);h.push(p)}for(f=0;f<h.length;f++)h[f].start()}}),0)}function Q(t,n,i){var e=[],o=i.timeout;C(n);var e=W(t.a,i,t.c),a=new z(t.c,n,o);t.h=e.length;n=0;for(i=e.length;n<i;n++)e[n].load((function(n,i,e){J(t,a,n,i,e)}))}function V(t,n){this.c=t;this.a=n}function X(t,n,i){var e=l(t.c);t=(t.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,"");return e+"//"+t+"/"+n+".js"+(i?"?v="+i:"")}V.prototype.load=function(t){function n(){if(a["__mti_fntLst"+e]){var i=a["__mti_fntLst"+e](),o=[],s;if(i)for(var r=0;r<i.length;r++){var f=i[r].fontfamily;void 0!=i[r].fontStyle&&void 0!=i[r].fontWeight?(s=i[r].fontStyle+i[r].fontWeight,o.push(new b(f,s))):o.push(new b(f))}t(o)}else setTimeout((function(){n()}),50)}var i=this,e=i.a.projectId,o=i.a.version;if(e){var a=i.c.m;d(this.c,X(i,e,o),(function(o){o?t([]):(a["__MonotypeConfiguration__"+e]=function(){return i.a},n())})).id="__MonotypeAPIScript__"+e}else t([])};function Y(t,n){this.c=t;this.a=n}Y.prototype.load=function(t){var n,i,e=this.a.urls||[],o=this.a.families||[],a=this.a.testStrings||{},s=new g;n=0;for(i=e.length;n<i;n++)p(this.c,e[n],v(s));var r=[];n=0;for(i=o.length;n<i;n++)if(e=o[n].split(":"),e[1])for(var f=e[1].split(","),c=0;c<f.length;c+=1)r.push(new b(e[0],f[c]));else r.push(new b(e[0]));w(s,(function(){t(r,a)}))};function Z(t,n,i){var e=window.fontsProxyUrl??"fonts.googleapis.com";e="//"+e+"/css";t?this.c=t:this.c=n+e;this.a=[];this.f=[];this.g=i||""}function tt(t,n){for(var i=n.length,e=0;e<i;e++){var o=n[e].split(":");3==o.length&&t.f.push(o.pop());var a="";2==o.length&&""!=o[1]&&(a=":");t.a.push(o.join(a))}}function nt(t){if(0==t.a.length)throw Error("No fonts to load!");if(-1!=t.c.indexOf("kit="))return t.c;for(var n=t.a.length,i=[],e=0;e<n;e++)i.push(t.a[e].replace(/ /g,"+"));n=t.c+"?family="+i.join("%7C");0<t.f.length&&(n+="&subset="+t.f.join(","));0<t.g.length&&(n+="&text="+encodeURIComponent(t.g));return n}function it(t){this.f=t;this.a=[];this.c={}}var et={latin:"BESbswy","latin-ext":"\xe7\xf6\xfc\u011f\u015f",cyrillic:"\u0439\u044f\u0416",greek:"\u03b1\u03b2\u03a3",khmer:"\u1780\u1781\u1782",Hanuman:"\u1780\u1781\u1782"},ot={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},at={i:"i",italic:"i",n:"n",normal:"n"},st=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function rt(t){for(var n=t.f.length,i=0;i<n;i++){var e=t.f[i].split(":"),o=e[0].replace(/\+/g," "),a=["n4"];if(2<=e.length){var s;var r=e[1];s=[];if(r)for(var r=r.split(","),f=r.length,c=0;c<f;c++){var h;h=r[c];if(h.match(/^[\w-]+$/)){var l=st.exec(h.toLowerCase());if(null==l)h="";else{h=l[2];h=null==h||""==h?"n":at[h];l=l[1];if(null==l||""==l)l="4";else var u=ot[l],l=u?u:isNaN(l)?"4":l.substr(0,1);h=[h,l].join("")}}else h="";h&&s.push(h)}0<s.length&&(a=s);3==e.length&&(e=e[2],s=[],e=e?e.split(","):s,0<e.length&&(e=et[e[0]])&&(t.c[o]=e))}t.c[o]||(e=et[o])&&(t.c[o]=e);for(e=0;e<a.length;e+=1)t.a.push(new b(o,a[e]))}}function ft(t,n){this.c=t;this.a=n}var ct={Arimo:!0,Cousine:!0,Tinos:!0};ft.prototype.load=function(t){var n=new g,i=this.c,e=new Z(this.a.api,l(i),this.a.text),o=this.a.families;tt(e,o);var a=new it(o);rt(a);p(i,nt(e),v(n));w(n,(function(){t(a.a,a.c,ct)}))};function ht(t,n){this.c=t;this.a=n}ht.prototype.load=function(t){var n=this.a.id,i=this.c.m;n?d(this.c,(this.a.api||"https://use.typekit.net")+"/"+n+".js",(function(n){if(n)t([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){n=i.Typekit.config.fn;for(var e=[],o=0;o<n.length;o+=2)for(var a=n[o],s=n[o+1],r=0;r<s.length;r++)e.push(new b(a,s[r]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(t){}t(e)}}),2e3):t([])};function lt(t,n){this.c=t;this.f=n;this.a=[]}lt.prototype.load=function(t){var n=this.f.id,i=this.c.m,e=this;n?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[n]=function(n,i){for(var o=0,a=i.fonts.length;o<a;++o){var s=i.fonts[o];e.a.push(new b(s.name,T("font-weight:"+s.weight+";font-style:"+s.style)))}t(e.a)},d(this.c,l(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+u(this.c)+"/"+n+".js",(function(n){n&&t([])}))):t([])};var ut=new R(window);ut.a.c.custom=function(t,n){return new Y(n,t)};ut.a.c.fontdeck=function(t,n){return new lt(n,t)};ut.a.c.monotype=function(t,n){return new V(n,t)};ut.a.c.typekit=function(t,n){return new ht(n,t)};ut.a.c.google=function(t,n){return new ft(n,t)};var pt={load:i(ut.load,ut)};"function"===typeof define&&define.amd?define((function(){return pt})):"undefined"!==typeof module&&module.exports?module.exports=pt:(window.WebFont=pt,window.WebFontConfig&&ut.load(window.WebFontConfig))})();
/* End */
;
//# sourceMappingURL=kernel_landing_master.map.js